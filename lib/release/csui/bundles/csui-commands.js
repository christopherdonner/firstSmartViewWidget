csui.define("csui/utils/command.error",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/base"],function(e,i,n,t,s,o){function r(e,i){function s(){if(i&&n.isString(i))this.errorDetails=i;else if(i instanceof t.Model)this.node=i;else if(i&&n.isObject(i)&&(i.errorDetails&&n.isString(i.errorDetails)&&(this.errorDetails=i.errorDetails),i.node instanceof t.Model&&(this.node=i.node),i.requestError&&n.isObject(i.requestError))){var e=new o.RequestErrorMessage(i.requestError);this.message?this.errorDetails||(this.errorDetails=e.message):(this.message=e.message,this.errorDetails||(this.errorDetails=e.errorDetails))}}if(!e)throw new Error("No argument passed");if(e instanceof Error)this.message=e.message,e.stack&&(this.stack=e.stack);else if(n.isString(e))this.message=e;else{var r=new o.RequestErrorMessage(e);this.message=r.message,this.errorDetails=r.errorDetails,this.statusCode=r.statusCode}s.call(this),this.name="CommandError"}return r.prototype=Object.create(Error.prototype),r}),csui.define("csui/utils/commands/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/utils/commands/nls/root/localized.strings",{"ShortcutPickerTitle":"Select target for Shortcut","CommandNameAddItemMetadata":"Add Item with metadata","CommandNameAddVersion":"AddVersion","CommandNameCopy":"Copy","CommandVerbCopy":"copy","DialogTitleSingleCopy":"Copy {0} item","DialogTitleCopy":"Copy {0} items","SomeFilesNotCopiedSuccessfully":"Some items were not successfully copied.","CopyingNodes":"Copying {0} nodes","CopyingNode":"Copying 1 node","CopyPageLeavingWarning":"If you leave the page now, pending items will not be copied.","CopyingOneItem":"Copying item","CopyItems":"Copying {0} items","CopySomeItems":"Copying {0} items","CopyItemsNoneMessage":"No items copied.","CopyOneItemSuccessMessage":"1 item successfully copied.","CopySomeItemsSuccessMessage":"{0} items successfully copied.","CopyManyItemsSuccessMessage":"{0} items successfully copied.","CopyOneItemFailMessage":"1 item failed to copy.","CopySomeItemsFailMessage":"{0} items failed to copy.","CopyManyItemsFailMessage":"{0} items failed to copy.","CopySomeItemsFailMessage2":"{2} items failed to copy.","CopyManyItemsFailMessage2":"{2} items failed to copy.","DeleteCommandConfirmDialogTitle":"Delete","DeleteCommandConfirmDialogHtml":"<span class='msgIcon WarningIcon'><%- message %></span>","DeleteCommandConfirmDialogSingleMessage":"Do you want to delete {0}?","DeleteCommandConfirmDialogMultipleMessage":"Do you want to delete {0} items?","CommandNameDelete":"Delete","CommandVerbDelete":"delete","DeletePageLeavingWarning":"If you leave the page now, pending items will not be deleted.","DeleteItemFailed":"Deleting item {0} failed.","DeleteItems":"Deleting {0} items","DeletingOneItem":"Deleting item","DeletingSomeItems":"Deleting {0} items","DeleteItemsNoneMessage":"No items deleted.","DeleteOneItemSuccessMessage":"1 item successfully deleted.","DeleteSomeItemsSuccessMessage":"{0} items successfully deleted.","DeleteManyItemsSuccessMessage":"{0} items successfully deleted.","DeleteOneItemFailMessage":"1 item failed to delete.","DeleteSomeItemsFailMessage":"{0} items failed to delete.","DeleteManyItemsFailMessage":"{0} items failed to delete.","DeleteSomeItemsFailMessage2":"{2} items failed to delete.","DeleteManyItemsFailMessage2":"{2} items failed to delete.","ApplyingManyItemsSuccessMessage":"Applied successfully to {0} items.","ApplyingOneItemFailMessage":"Failed to apply to 1 item.","ApplyingManyItemsFailMessage2":"Failed to apply to {0} items.","CommandNameDownload":"Download","CommandVerbDownload":"download","CommandNameMove":"Move","CommandNameVerbMove":"move","DialogTitleSingleMove":"Move {0} item","DialogTitleMove":"Move {0} items","SomeFilesNotMovedSuccessfully":"Some items were not successfully moved.","MovePageLeavingWarning":"If you leave the page now, pending items will not be moved.","MovingNodes":"Moving {0} nodes","MovingNode":"Moving 1 node","MovingOneItem":"Moving item","MovingItems":"Moving {0} items","MovingSomeItems":"Moving {0} items","MoveItemsNoneMessage":"No items moved.","MoveOneItemSuccessMessage":"1 item successfully moved.","MoveSomeItemsSuccessMessage":"{0} items successfully moved.","MoveManyItemsSuccessMessage":"{0} items successfully moved.","MoveOneItemFailMessage":"1 item failed to move.","MoveSomeItemsFailMessage":"{0} items failed to move.","MoveManyItemsFailMessage":"{0} items failed to move.","MoveSomeItemsFailMessage2":"{2} items failed to move.","MoveManyItemsFailMessage2":"{2} items failed to move.","CommandNamePaste":"Paste","CommandNameReserve":"Reserve","CommandVerbReserve":"reserve","ReservePageLeavingWarning":"If you leave the page now, pending items will not be reserved.","ReserveItemsNoneMessage":"No items reserved.","ReserveOneItemSuccessMessage":"1 item successfully reserved.","ReserveSomeItemsSuccessMessage":"{0} items successfully reserved.","ReserveManyItemsSuccessMessage":"{0} items successfully reserved.","ReserveOneItemFailMessage":"1 item failed to reserve.","ReserveSomeItemsFailMessage":"{0} items failed to reserve.","ReserveManyItemsFailMessage":"{0} items failed to reserve.","CommandNameFavorite":"Add Favorite","CommandVerbFavorite":"update Favorites","CommandDoneVerbFavorite":"added to Favorites","CommandRemovedVerbFavorite":"removed from Favorites","updateFavoriteFailTitle":"Update Favorite","updateFavoriteFailMessage":'Failed to update Favorite for node "{0}". \n\n{1}',"CommandDescriptionToggle":"Description Toggle","CommandHideDescription":"Hide description","CommandShowDescription":"Show description","CommandNameEmailLink":"Share","CommandVerbEmailLink":"share","EmailLinkSubject":"I want to share the following links with you","EmailLinkDesktop":"Link for Desktop and Android","EmailAppleLinkFormat":"Link for iOS Mobile","EmailLinkCommandFailedWithTooMuchItemsErrorMessage":"Share failed. Too many items were selected.","EmailLinkCommandFailedWithTooMuchItemsDetailErrorMessage":"Only ~10 items can be shared at one time.","SignOutCommandName":"Sign Out","SwitchToClassicCommandName":"Classic View","CommandNameUnreserve":"Unreserve","CommandVerbUnreserve":"unreserve","UnreservePageLeavingWarning":"If you leave the page now, pending items will not be unreserved.","UnreserveItemsNoneMessage":"No items unreserved.","UnreserveOneItemSuccessMessage":"1 item successfully unreserved.","UnreserveSomeItemsSuccessMessage":"{0} items successfully unreserved.","UnreserveManyItemsSuccessMessage":"{0} items successfully unreserved.","UnreserveOneItemFailMessage":"1 item failed to unreserve.","UnreserveSomeItemsFailMessage":"{0} items failed to unreserve.","UnreserveManyItemsFailMessage":"{0} items failed to unreserve.","UserProfileCommandName":"Profile","CommandVerbRename":"rename","CommandNameSaveFilter":"Save As","CommandVerbSaveFilter":"Save As","DialogTitleSaveFilter":"Save as","SaveFilterCommandSuccessfully":"{0} virtual folder created successfully.","NoEditUrl":"Web page for editing of this doucment is not available.","CommandNameCopyLink":"Copy link","CommandVerbCopyLink":"copy link","CopyLinkSuccessMessage":"Link copied to clipboard.","CopyLinkFailMessage":"Copy link has failed to copy the link to clipboard.","DeletePermissionCommandRemoveOwner":"Remove owner","DeletePermissionCommandRemoveGroup":"Remove owner group","DeletePermissionCommandRemovePublicAccess":"Remove Public Access","DeletePermissionCommandRemoveOther":"Remove from list","DeletePermissionCommandConfirmDialogTitle":"Remove {0}","DeletePermissionCommandConfirmDialogSingleMessage":"Do you want to remove {0} from this permissions list?","DeletePermissionCommandConfirmDialogPublicAccessMessage":"Are you sure you want to remove {0} from this permissions list?","DeletePermissionCommandSuccessMessage":"{0} was removed from the permissions list.","DeletePermissionCommandSuccessMessageWithCount":"{0} was removed from the permissions list of {1}.","DeletePermissionCommandFailMessage":"Failed to remove {0} from the permissions list.","publicAccess":"Public Access","RestorePublicAccessSuccessMessage":"{0} restored","RestorePublicAccessSuccessMessageWithCount":"{0} restored to the permission list of {1}","undefinedCollection":"Collection is undefined","EditPermissionCommandFailMessage":"Failed to edit {0} from the permissions list.","Owner":"owner","CommandNameAddOwnerOrOwnerGroup":"Add Owner Or Owner Group","AddOwnerOrGroup":"Add owner or owner group","AddOwner":"Add owner","AddOwnerGroup":"Add owner group","CommandNameAddUserorGroup":"Add user or group","CommandNameRestorePublicAccess":"Restore public access","AddButtonLabel":"Add","AddOwnerOrGroupDialogTitle":"Add Owner or Owner group","AddOwnerDialogTitle":"Add Owner","AddOwnerGroupDialogTitle":"Add Owner group","ChangeOwnerPermissionCommand":"Change owner","ChangeOwnerGroupPermissionCommand":"Change owner group","AddUserOrGroupSuccess":"{0} added successfully","AddUserOrGroupFailure":"{0} failed to add","AddUserOrGroupSuccessWithCount":"{0} was added to the permissions list of {1}.","formatForNone":"{0} items","formatForOne":"{0} item","formatForTwo":"{0} items","formatForFive":"{0} items","AppliedPermissions":"Permissions applied selected item","AppliedPermissionsOneSuccess":"Permissions applied to {0} item","AppliedPermissionsOnlySuccess":"Permissions applied to {0} items","AppliedPermissionsOneFailure":"Permissions failed to apply {0} item","AppliedPermissionsOnlyFailure":"Permissions failed to apply {0} items","AppliedPermissionsSuccessAndFailure":"Permissions applied to {0} items and failed to apply {1} items","CommandSuccessfullySingular":"{0} item successfully {1}.","CommandFailedSingular":"{0} item failed to {1}.","CommandSuccessfullyPlural":"{0} items successfully {1}.","CommandFailedPlural":"{0} items failed to {1}.","CommandFailedPartial":"{0} of {1} items failed to {2}.","NoConnectivity":"No connectivity","GoToOffline":"Go to offline files?","viewTypeUnsupported":"This content type is not currently supported on a mobile device.","MobileIOS":"iOS Mobile","DesktopAndroid":"Desktop and Android","Close":"Close","warnTitle":"Add Version","warnMessage":"This document is unreserved and the latest version was added by {0} {1} {2}. Do you want to continue?","yesButton":"Yes","noButton":"No","grammer":"on","otheruser":"other user","allUsersAndGroups":"Users and Groups","addUsersAndGroups":"Add users or groups","allGroups":"Groups","cancelButtonLabel":"Cancel","applyButtonLabel":"Apply","EditPerspective":"Edit page","CreatePerspective":"Create new perspective","ThumbnailTitle":"Grid View","ListViewTitle":"Browse View"}),csui.define("csui/utils/commands/versions/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/utils/commands/versions/nls/root/localized.strings",{"CommandNameVersionDelete":"Delete Version","CommandVerbVersionDelete":"delete","DeleteCommandConfirmDialogTitle":"Delete","VersionDeleteCommandConfirmDialogSingleMessage":"Do you want to delete version {0} from {1}?","VersionDeleteCommandConfirmDialogMultipleMessage":"Do you want to delete {0} versions?","DeleteVersionPageLeavingWarning":"If you leave the page now, pending versions will not be deleted.","DeleteVersions":"Deleting {0} versions","DeletingSomeVersions":"Deleting {0} versions","DeletingOneVersion":"Deleting version","DeleteVersionItemsNoneMessage":"No versions deleted.","DeleteVersionOneItemSuccessMessage":"1 version succeeded to delete.","DeleteVersionSomeItemsSuccessMessage":"{0} versions succeeded to delete.","DeleteVersionManyItemsSuccessMessage":"{0} versions succeeded to delete.","DeleteVersionOneItemFailMessage":"1 version failed to delete.","DeleteVersionSomeItemsFailMessage2":"{2} versions failed to delete.","DeleteVersionManyItemsFailMessage2":"{2} versions failed to delete.","CommandSuccessfullySingular":"{0} version successfully {1}.","CommandFailedSingular":"{0} version failed to {1}.","CommandSuccessfullyPlural":"{0} versions successfully {1}.","CommandFailedPlural":"{0} versions failed to {1}.","CommandFailedPartial":"{0} of {1} versions failed to {2}."}),csui.define("csui/utils/commandhelper",["require","module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/base","csui/utils/command.error","i18n!csui/utils/commands/nls/localized.strings","i18n!csui/utils/commands/versions/nls/localized.strings","csui/models/version","csui/lib/jquery.when.all"],function(e,i,n,t,s,o,r,a,c,l){"use strict";var u=i.config(),d=function(){};return t.extend(d.prototype,s.Events,{"checkNodeTypesAndRights":function(e,i,n){t.isArray(e)||e&&(e=[e]);var s=t.contains(i,-1);return e&&e.length&&t.all(e,function(e){return(t.contains(i,e.get("type"))||s&&e.get("container"))&&t.all(n,function(i){return e.get("perm_"+i)})})},"checkNodeTypes":function(e,i){t.isArray(e)||e&&(e=[e]);var n=t.contains(i,-1);return e&&e.length&&t.all(e,function(e){var s=o.isBackbone(e)?e.attributes:e;return t.contains(i,s.type)||n&&s.container})},"checkNodeRights":function(e,i){return t.isArray(e)||e&&(e=[e]),e&&e.length&&t.all(e,function(e){var n=o.isBackbone(e)?e.attributes:e;return t.all(i,function(e){return n["perm_"+e]})})},"getJustOneNode":function(e){return e.nodes&&1===e.nodes.length&&e.nodes.at(0)},"getAtLeastOneNode":function(e){return e.nodes?e.nodes:new(s.Collection.extend(e.collection?{"model":e.collection.model}:{}))},"updateNode":function(e,i){return e.save(i,{"wait":!0,"patch":!0,"silent":!0}).then(function(){return e.fetch({"force":!0})}).then(function(){return e},function(i){var t=new r(i,e);return n.Deferred().reject(t),t})},"handleExecutionResults":function(e,i){var s=n.Deferred(),o=n.Deferred();return csui.require(["csui/controls/globalmessage/globalmessage"],function(e){o.resolve(e)},o.reject),n.whenAll(o,e).always(function(e){var n=e[0],o=e[1];t.isArray(o)||(o=[o]);var r=0,d=0;if(t.each(o,function(e){void 0===e||e.cancelled||(e instanceof Error?d++:r++)}),0===d&&0===r)return void s.reject();var m=o[0];if(m instanceof l&&t.extend(a,c),1===o.length)if(1===r)i.suppressSuccessMessage||n.showMessage("success",t.str.sformat(a.CommandSuccessfullySingular,r,i.command.get("doneVerb")));else{var g=m.errorDetails||m.message;u.offlineSupport&&0===m.statusCode?s.reject(m):i.suppressFailMessage||m.suppressFailMessage||n.showMessage("error",t.str.sformat(a.CommandFailedSingular,d,i.command.get("verb")),g)}else 0===d?i.suppressSuccessMessage||n.showMessage("success",t.str.sformat(a.CommandSuccessfullyPlural,r,i.command.get("doneVerb"))):0===r?u.offlineSupport&&0===m.statusCode?s.reject(m):i.suppressFailMessage||m.suppressFailMessage||n.showMessage("error",t.str.sformat(a.CommandFailedPlural,d,i.command.get("verb"))):i.suppressFailMessage||m.suppressFailMessage||(i.customError?n.showMessage("error",o[1]):n.showMessage("error",t.str.sformat(a.CommandFailedPartial,d,o.length,i.command.get("verb"))));s.resolve(o)}),s.promise()},"_getErrorMessageFromResponse":function(e){var i;if(e&&e.responseJSON&&e.responseJSON.error)i=e.responseJSON.error;else{var t=o.MessageHelper.toHtml();o.MessageHelper.reset(),i=n(t).text()}return i},"refreshModelAttributesFromServer":function(e,i){var n=e.clone();return n.collection=i||e.collection,n.fetch().then(function(){return e.set(n.attributes),n.original&&(e.original=n.original),e})},"showOfflineMessage":function(e,i,n){if(e&&0===e.statusCode&&u.offlineSupport){var t=this;return csui.require(["csui/dialogs/modal.alert/modal.alert"],function(e){e.showInformation(a.GoToOffline,a.NoConnectivity,{"buttons":e.buttons.YesNo}).always(function(e){e?i?i():window.location.href="#offline.list":n?n():t.trigger("offline:refused")})}),!0}}}),new d}),csui.define("csui/models/command",["module","require","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/commandhelper"],function(e,i,n,t,s,o){return t.Model.extend({"idAttribute":"signature","constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments)},"enabled":function(e,i){var n=this.get("scope"),t=this._getNodesByScope(e,n),s=this.get("command_key");return this._checkPermittedActions(t,s,e.container)},"isNonPromoted":function(e){var i=this.get("scope"),t=this._getNodesByScope(e,i),s=this.get("command_key"),o=!1;if(t&&t.length){var r=this._getNonPromotedCheckFunctionsForSignatures(s);r&&n.find(t,function(e){var i=r(e);if(i&&!0===i.get("csuiNonPromotedAction"))return o=!0,!0})}return o},"_getNodesByScope":function(e,i){var n;switch(i){case"single":n=o.getJustOneNode(e),n&&(n=[n]);break;default:n=o.getAtLeastOneNode(e).models}return n},"_getCheckFunctionsForSignatures":function(e){var i;return e&&(n.isArray(e)&&e.length?i=function(i){return n.any(e,function(e){return i.actions&&i.actions.findRecursively(e)})}:n.isString(e)&&(i=function(i){return i.actions&&i.actions.findRecursively(e)})),i},"_getNonPromotedCheckFunctionsForSignatures":function(e){var i;return e&&(n.isArray(e)&&e.length?i=function(i){var t;return n.find(e,function(e){return!!(t=i.actions&&i.actions.findRecursively(e))}),t}:n.isString(e)&&(i=function(i){return i.actions&&i.actions.findRecursively(e)})),i},"_checkPermittedActions":function(e,i,t){if(e&&e.length){var s=this._getCheckFunctionsForSignatures(i);return!s||n.all(e,s)}return!1},"_getNodeActionForSignature":function(e,i){var n;if(e){var t=this._getCheckFunctionsForSignatures(i);t&&(n=t.call(this,e))}return n}})}),csui.define("csui/integration/folderbrowser/commands/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/integration/folderbrowser/commands/go.to.node.history",["module","require","csui/lib/jquery","csui/lib/underscore","csui/models/command","csui/integration/folderbrowser/commands/nls/localized.strings"],function(e,i,n,t,s,o){"use strict";var r={};return s.extend({"defaults":{"signature":"Back","name":o.GoToHistory},"enabled":function(i,n){var s,o=t.extend({"enabled":!1},e.config()),a=i.context||n&&n.context;return!!a&&(o.enabled&&this._ensureGoBackList(a),s=r[a.cid]||[],o.enabled&&s.length>1)},"execute":function(e,i){var t=n.Deferred();return csui.require(["csui/utils/contexts/factories/next.node"],function(n){var s=e.context||i&&i.context,o=s.getModel(n),a=r[s.cid]||[];a.length>1&&(a.pop(),o.set("id",a[a.length-1])),t.resolve()},function(e){t.reject(e)}),t.promise()},"clearHistory":function(e){delete r[e.cid]},"_ensureGoBackList":function(e){var i=r[e.cid];i||(i=r[e.cid]=[],csui.require(["csui/utils/contexts/factories/node","csui/utils/contexts/factories/next.node"],function(n,t){function s(n){var t=e.getModel(n),s=t.get("id");s&&i[i.length-1]!==s&&i.push(s)}var o=e.getModel(t);s(n),e.on("request",function(){s(n)}),o.on("change:id",function(){s(t)})}))}})}),csui.define("csui/integration/folderbrowser/commands/nls/root/localized.strings",{"GoToHistory":"Go Back","OpenFullPageContainer":"Open Full Page Container"}),csui.define("csui/integration/folderbrowser/commands/open.full.page.container",["module","require","csui/lib/jquery","csui/lib/underscore","csui/models/command","csui/utils/node.links/node.links","i18n!csui/integration/folderbrowser/commands/nls/localized.strings"],function(e,i,n,t,s,o,r){"use strict";return s.extend({"defaults":{"signature":"Page","name":r.OpenFullPageContainer},"enabled":function(i,n){return t.extend({"enabled":!1},e.config()).enabled&&!!i.container},"execute":function(e,i){return window.open(o.getUrl(e.container)),n.Deferred().resolve().promise()}})}),csui.define("csui/models/commands",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/models/command"],function(e,i,n,t,s){return n.Collection.extend({"model":s,"constructor":function(e,i){n.Collection.prototype.constructor.apply(this,arguments)},"getAllSignatures":function(){return i.chain(this.pluck("command_key")).map(function(e){if(i.isArray(e)){var n=e[0];return"default"===n&&(n=["default","open",e[2]]),n}return e}).flatten().compact().unique().value()}})}),csui.define("csui/utils/commands",["csui/lib/underscore","csui/models/commands","csui-ext!csui/utils/commands"],function(e,i,n){"use strict";var t=new i;return e.extend(t,{"signatures":{"browse":"Browse","open":"Open","download":"Download","add":"Add","navigate":"Navigate","original":"Original"},"version":"1.0"}),n&&t.add(e.chain(n).flatten(!0).map(function(e){return new e}).value()),t}),csui.define("csui/utils/commands/add.categories",["require","csui/lib/jquery","csui/lib/underscore","csui/utils/base","csui/utils/log","csui/models/command"],function(e,i,n,t,s,o){return o.extend({"defaults":{"signature":"AddCategory","command_key":["addcategory","AddCategory"],"scope":"single"},"enabled":function(e,i){var n=this.get("scope"),t=this._getNodesByScope(e,n);if(t&&t.length>0){if(void 0===t[0].get("id")){var s=!0;return e.originalFormCollection&&e.originalFormCollection.each(function(e){"categories"===e.get("role_name")&&!1===e.get("schema").additionalProperties&&(s=!1)}),s}return o.prototype.enabled.apply(this,arguments)}},"execute":function(e,n){var t=i.Deferred();return csui.require(["csui/widgets/metadata/metadata.add.categories.controller"],function(e){(new e).AddNewCategory(n).done(function(e){n.addPropertiesCallback&&n.addPropertiesCallback.call(n.parentView,e.catModel),t.resolve()}).fail(function(e){t.reject(e)})},function(e){s.warn("Failed to load MetadataAddCategoriesController. {0}",e)&&console.warn(s.last),t.reject(e)}),t.promise()}})}),csui.define("hbs!csui/dialogs/file.open/impl/file.open",["module","hbs","csui/lib/handlebars"],function(e,i,n){var t=n.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,i,n,t){var s;return'<input type="file" style="display:none" '+this.escapeExpression((s=null!=(s=i.multiple||(null!=e?e.multiple:e))?s:i.helperMissing,"function"==typeof s?s.call(e,{"name":"multiple","hash":{}}):s))+">\r\n"}});return n.registerPartial("csui_dialogs_file.open_impl_file.open",t),t}),csui.define("csui/dialogs/file.open/file.open.dialog",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/log","csui/utils/base","hbs!csui/dialogs/file.open/impl/file.open"],function(e,i,n,t,s,o,r){"use strict";return s=s(e.id),t.ItemView.extend({"className":"csui-file-open","template":r,"templateHelpers":function(){return{"multiple":this.options.multiple?"multiple":""}},"ui":{"fileInput":"input"},"events":{"change @ui.fileInput":"_processFiles"},"constructor":function(e){this.className=i.result(this,"className");var o=n(document.body).find("> ."+this.className);o.length&&(s.debug("Removing an earlier file-open input element.")&&console.log(s.last),o.remove()),t.ItemView.prototype.constructor.call(this,e)},"onDestroy":function(){this.ui.fileInput.off()},"show":function(){s.debug("Showing a file-open input element.")&&console.log(s.last),this.render(),n(document.body).append(this.el),this.ui.fileInput.click(),this.ui.fileInput.trigger("focus")},"_processFiles":function(e){var i=e.originalEvent,n=i.target.files||i.dataTransfer&&i.dataTransfer.files;s.debug(n.length+" file(s) selected by a file-open input element.")&&console.log(s.last),this.trigger("add:files",n)}})}),csui.define("csui/utils/commands/add",["require","csui/lib/jquery","csui/lib/underscore","i18n!csui/utils/commands/nls/localized.strings","csui/utils/log","csui/utils/base","csui/utils/commandhelper","csui/models/command","csui/models/node/node.model","csui/dialogs/file.open/file.open.dialog"],function(e,i,n,t,s,o,r,a,c,l){"use strict";return a.extend({"defaults":{"signature":"Add"},"enabled":function(e){if(e||(e={}),e.container&&e.container.get("container")){if(298===e.container.get("type"))return!1;e.data||(e.data={});var i=e.data.addableTypes;return i&&n.any([0,1,140,144,298],function(e){return!!i.get(e)})}return!1},"execute":function(e,n){if(n&&void 0===n.addableType)throw new Error("Missing options.addableType");var t,o,r=this._getAddableTypeName(e,n);switch(n.addableType){case 0:case 298:e.forwardToTable=!0,t=new c({"type":n.addableType,"type_name":r,"container":!0,"name":""},{"connector":e.container.connector,"collection":e.collection}),o=i.Deferred().resolve(t).promise();break;case 140:e.forwardToTable=!0,t=new c({"type":n.addableType,"type_name":r,"container":!1,"name":""},{"connector":e.container.connector,"collection":e.collection}),o=i.Deferred().resolve(t).promise();break;case 1:e.forwardToTable=!0,o=this._selectShortcutTarget(e,n);break;case 144:e.suppressSuccessMessage=!0,o=this._selectFilesForUpload(e,n);break;default:var a='The "Add" action for the addableType '+n.addableType+" is not implemented";s.debug(a)&&console.log(s.last),o=i.Deferred().reject({"error":a,"commandSignature":this.signature}).promise()}return o},"_selectFilesForUpload":function(e,n){var t=i.Deferred(),s=new l({"multiple":!0});return t.resolve(),s.listenTo(s,"add:files",function(i){csui.require(["csui/controls/fileupload/fileupload"],function(o){t.resolve();var r=o.newUpload(e,n);r.addFilesToUpload(i,{"collection":e.collection}),r.listenTo(r,"destroy",function(){s.destroy()})})}).show(),t.promise()},"_selectShortcutTarget":function(e,n){var s=this,o=i.Deferred();return csui.require(["csui/dialogs/node.picker/node.picker"],function(i){var r={"dialogTitle":t.ShortcutPickerTitle,"connector":e.container.connector,"context":n.context,"initialContainer":e.container,"globalSearch":!0,"startLocation":"recent.containers","unselectableTypes":[141,142,133],"resolveShortcuts":!0,"resultOriginalNode":!0},a=s._getAddableTypeName(e,n);return s.nodePicker=new i(r),s.nodePicker.show().then(function(i){var n=i.nodes[0];return new c({"type":1,"type_name":a,"container":!1,"name":n.get("name"),"original_id":n.get("id"),"original_id_expand":n.attributes},{"connector":e.container.connector,"collection":e.collection})}).done(function(){o.resolve.apply(o,arguments)}).fail(function(){o.reject.apply(o,arguments)})},function(e){o.reject(e)}),o.promise()},"_getAddableTypeName":function(e,i){return i.addableTypeName?i.addableTypeName:e.data.addableTypes.findWhere({"type":i.addableType}).get("type_name")}},{"_getAddableTypesWithoutInlineFormAsMap":function(){return{"144":!0}},"isAddableTypeWithoutInlineForm":function(e){return!0===this._getAddableTypesWithoutInlineFormAsMap()[e]}})}),csui.define("csui/utils/commands/add.item.metadata",["module","require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/log","csui/utils/commandhelper","csui/models/command"],function(e,i,n,t,s,o,r,a){var c=a.extend({"defaults":{"signature":"AddItemMetadata","command_key":"Add_Item","scope":"single"},"execute":function(e,i){var n=t.Deferred();return csui.require(["csui/widgets/metadata/metadata.add.item.controller"],function(t){(new t).displayForm(e,i).done(function(){n.resolve.apply(n,arguments)}).fail(function(){n.reject.apply(n,arguments)})},function(e){n.reject(e)}),n.promise()}});return c.version="1.0",c}),csui.define("csui/utils/commands/add.version",["require","csui/lib/jquery","csui/lib/underscore","i18n!csui/utils/commands/nls/localized.strings","csui/models/command","csui/utils/commandhelper","csui/models/node/node.model","csui/models/actions","csui/dialogs/file.open/file.open.dialog","csui/utils/types/date","csui/utils/types/number","csui/utils/types/member","csui/lib/moment"],function(e,i,n,t,s,o,r,a,c,l,u,d,m){"use strict";function g(e,i){var n=[];(e.actions.findRecursively("download")||e.actions.findRecursively("Download"))&&n.push({"signature":"versions_download"},{"signature":"versions_open"}),(e.actions.findRecursively("delete")||e.actions.findRecursively("Delete"))&&n.push({"signature":"versions_delete"}),(e.actions.findRecursively("properties")||e.actions.findRecursively("Properties"))&&n.push({"signature":"versions_properties"}),i.actions.reset(n)}var p;return s.extend({"defaults":{"signature":"AddVersion","command_key":"addversion","name":t.CommandNameAddVersion,"scope":"single"},"execute":function(e,n){e||(e={});var t=i.Deferred(),s=e.nodes.models[0],o=s.get("versions").owner_id,r=e.context.getModel("user").id,a=this;return this.trigger("close:dialogView:form"),csui.require(["csui/utils/contexts/factories/connector"],function(){if(p=arguments[0],e.tableView&&(e.tableView.lockedForOtherContols=!1),e.connector=e.context.getObject(p),e.nodes.models[0].versions&&e.nodes.models[0].versions.allModels){var i=e.nodes.models[0].versions.allModels,c=i[i.length-1];o=c.get("owner_id").id||c.get("owner_id")}r===o||s.get("reserved")?a._fileOpenDialog(e,n):a._showWarnDialog(e,n,a),t.resolve(),e.suppressSuccessMessage=!0;var l=e.file;l&&this._uploadFiles(l,e).done(t.resolve).fail(t.reject)}),t.promise()},"_getBodyMessage":function(e){var i=m(),s=l.deserializeDate(e.create_date),o=i.diff(s,"days"),r=d.formatMemberName(e.owner_id_expanded||e.owner_id);return s=o>=4?l.formatExactDate(s):o>=2?l.formatFriendlyDateTimeNow(s)+" "+l.formatExactTimeOnly(s):l.formatDateTime(s),n.str.sformat(t.warnMessage,r,t.grammer,s)},"_fileOpenDialog":function(e,i){var n=new c({"multiple":!1}),t=this;n.listenTo(n,"add:files",function(s){t._uploadFiles(s[0],e,i).always(function(){n.destroy()})}).show()},"_showWarnDialog":function(e,i,s){this._getOwnerInfoOfLatestVersion(e).done(n.bind(function(i){csui.require(["csui/controls/dialog/dialog.view","css!csui/controls/globalmessage/impl/messagedialog"],function(o){s._dialog=new o({"iconLeft":"notification_warning","title":t.warnTitle,"bodyMessage":s._getBodyMessage(i.data),"status":e,"showTitleIcon":!0,"className":s.dialogClassName(),"buttons":[{"id":"Version","label":t.yesButton,"default":!0,"disabled":!1,"click":n.bind(s._onClickSelectButton,s,e)},{"label":t.noButton,"click":n.bind(s.onClickCancelButton,s)}]}),s._dialog.show()},s)},this)).fail(function(e){})},"_getOwnerInfoOfLatestVersion":function(e){var n=i.Deferred(),t=e.nodes.models[0],s=e.connector,o=s.extendAjaxOptions({"url":s.connection.url+"/nodes/"+t.get("id")+"/versions/latest?expand=member","type":"GET"});return i.ajax(o).done(function(e){n.resolve(e)}).fail(function(e){n.reject(e)}),n.promise()},"dialogClassName":function(){return"addversion-fornonreserve"},"onClickCancelButton":function(){this._dialog.destroy()},"_onClickSelectButton":function(e,i){i&&i.dialog.destroy(),e=this,e._fileOpenDialog(i.dialog.options.status,{})},"_uploadFiles":function(e,i){var n=o.getJustOneNode(i);return this._dialogProgressUpload(n,e,i)},"_dialogProgressUpload":function(e,n,t){var s=i.Deferred();return csui.require(["csui/controls/fileupload/impl/addversion.controller","csui/models/version"],function(e,i){var r=o.getJustOneNode(t);new e({"view":t.originatingView,"selectedNode":r}).uploadFile(n).then(function(e){return e.version.fetch().then(function(i){return e.version})}).then(function(e){if(r.versions||r.attributes&&r.attributes.versions){var i=e.get("file_size"),n=u.formatFileSize(i);e.set("file_size_formatted",n),e.isLocallyCreated=!0,g(r,e),!!r.versions&&r.versions.add(e,{"at":0}),Array.isArray(r.get("versions"))&&!!r.attributes&&!!r.attributes.versions&&r.attributes.versions.push(e.attributes)}}).then(function(){return!0}).then(function(){return!0}).done(s.resolve).fail(s.reject)},function(e){s.reject(e)}),s.promise()}})}),csui.define("csui/utils/commands/open.node.perspective",["require","csui/lib/jquery","csui/models/command","csui/utils/commandhelper"],function(e,i,n,t){"use strict";return n.extend({"execute":function(e,n){var s=i.Deferred();return csui.require(["csui/utils/contexts/factories/next.node"],function(i){var o=e.context||n&&n.context,r=o.getModel(i),a=t.getJustOneNode(e);r.set("id",a.get("id")),s.resolve()},function(e){s.reject(e)}),s.promise()}})}),csui.define("csui/utils/commands/browse",["csui/utils/commands/open.node.perspective","csui/utils/commandhelper"],function(e,i){"use strict";var n=e.extend({"defaults":{"signature":"Browse","command_key":["default","open","browse","Browse"],"scope":"single"},"enabled":function(e,t){if(!n.__super__.enabled.apply(this,arguments))return!1;var s=i.getJustOneNode(e);return s&&s.get("container")}});return n}),
csui.define("csui/utils/commands/collection/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/utils/commands/collection/nls/root/lang",{"collectCommandSignature":"Collect","addItemsToolTip":"Add Items","collectItemsDialogTitle":"Add items","selectButtonLabel":"Add selected","conflictsItemsHeader":"Listed items will not be added","conflictsDialogCloseLabel":"Close","CollectItemsNoneMessage":"No items added.","CollectOneItemSuccessMessage":"1 new item was successfully added","CollectManyItemsSuccessMessage":"{0} new items were successfully added","CollectOneItemFailMessage":"1 of your collected items already added","CollectManyItemsFailMessage":"{0} of your collected items are already added","RemoveCollectItemsCommandConfirmDialogHtml":"<span class='msgIcon WarningIcon'><%- message %></span>","RemoveCommandConfirmDialogSingleMessage":"Do you want to remove {0} from collection?","RemoveCommandConfirmDialogMultipleMessage":"Do you want to remove {0} items from collection?","RemoveCommandConfirmDialogTitle":"Remove from collection","RemoveItemsNoneMessage":"No items removed from collection.","RemoveOneItemSuccessMessage":"1 item successfully removed from collection.","RemoveSomeItemsSuccessMessage":"{0} items successfully removed from collection.","RemoveManyItemsSuccessMessage":"{0} items successfully removed from collection.","RemoveOneItemFailMessage":"1 item failed to remove from collection.","RemoveSomeItemsFailMessage":"{0} items failed to remove from collection.","RemoveManyItemsFailMessage":"{0} items failed to remove from collection.","RemoveSomeItemsFailMessage2":"{2} items failed to remove from collection.","RemoveManyItemsFailMessage2":"{2} items failed to remove from collection.","RemoveItems":"Removing {0} items from collection","RemovingOneItem":"Removing item from collection","RemovingSomeItems":"Removing {0} items from collection","CollectingOneItem":"Collecting item","CollectingItems":"Collecting {0} items","CollectManyItemsFailMessage2":"{2} items failed to Collecting.","removefromCollection":"Remove from collection"}),csui.define("csui/utils/commands/collection/collect.items",["module","require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/utils/command.error","csui/models/command","i18n!csui/utils/commands/collection/nls/lang","csui/utils/base","csui/models/nodes","csui/lib/underscore.string"],function(e,i,n,t,s,o,r,a,c,l,u){"use strict";var d=e.config();n.defaults(d,{"parallelism":3});var m,g,p,f,v,h,w=a.extend({"defaults":{"signature":"CollectionCanCollect","name":c.addItemsToolTip,"command_key":["collectionCanCollect"],"scope":"single","successMessages":{"formatForOne":c.CollectOneItemSuccessMessage,"formatForTwo":c.CollectManyItemsSuccessMessage,"formatForMany":c.CollectManyItemsSuccessMessage,"formatForFive":c.CollectManyItemsSuccessMessage},"errorMessages":{"formatForOne":c.CollectOneItemFailMessage,"formatForTwo":c.CollectManyItemsFailMessage,"formatForMany":c.CollectManyItemsFailMessage,"formatForFive":c.CollectManyItemsFailMessage}},"enabled":function(e){return 298===e.container.get("type")&&(e.nodes=new u([e.container]),w.__super__.enabled.apply(this,arguments))},"execute":function(e,i){var s=t.Deferred(),o=this;return csui.require(["csui/controls/globalmessage/globalmessage","csui/controls/conflict.resolver/impl/collection.conflicts/collection.conflicts.view","csui/utils/taskqueue","csui/models/fileuploads","csui/utils/page.leaving.blocker","csui/utils/contexts/factories/next.node"],function(){m=arguments[0],h=arguments[1],g=arguments[2],p=arguments[3],f=arguments[4],v=arguments[5],o._addToCollection(e,i).done(function(i){var t=i.nodes,r=n.map(t,function(e){return{"name":e.get("name"),"state":"pending","count":0,"total":1,"node":e}}),a=e.container,c=new p(r,{"connector":l}),l=e.container&&e.container.connector;e.container.collection=e.collection,o._announceOperationStart(e),c.each(function(e){var i=e.get("node");e.node=i,e.unset("node"),e.set("mime_type",i.get("mime_type"))}),o._addSelectedNodesToCollection(c,l,a,e.collection).then(function(e){m.hideFileUploadProgress();var i=o._checkPromises(e);i.failedNodes.length?o._showDialog(i.failedNodes).then(function(e,n){n.kill(),i.successNodes.length&&o._showGlobalMessage(i.successNodes.length)}):i.successNodes.length&&o._showGlobalMessage(i.successNodes.length)}),o._announceOperationEnd(e),s.resolve()}).fail(function(e){e&&!e.cancelled&&o.showError(e),s.reject()})}),s.promise()},"_addToCollection":function(e,i){var s=this,o=t.Deferred();return csui.require(["csui/dialogs/node.picker/node.picker"],function(t){var r=n.extend({"selectableTypes":[],"showAllTypes":!0,"orderBy":"type asc","dialogTitle":c.collectItemsDialogTitle,"selectButtonLabel":c.selectButtonLabel,"globalSearch":!0,"selectMultiple":!0,"context":i?i.context:e.context,"startLocations":["enterprise.volume","current.location","personal.volume","favorites","recent.containers"],"resolveShortcuts":!0},e);s.nodePicker=new t(r),s.nodePicker.show().done(function(){o.resolve.apply(o,arguments)}).fail(function(){o.reject.apply(o,arguments)})},function(e){o.reject(e)}),o.promise()},"_addSelectedNodesToCollection":function(e,i,s,o){var r=this,a=new g({"parallelism":d.parallelism}),l=0,u=n.map(e.models,function(e){var n=t.Deferred();return a.pending.add({"worker":function(){var t=e.node,a=t.get("id"),c=s.get("id");return r._collectNode(i,c,a).done(function(){e.set("count",1),e.deferred.resolve(e),r._addToCurrentTable(e.node,o,c),n.resolve(e)}).fail(function(i){n.resolve(e)}),n.promise()}}),l++,n.promise(u)});return m.showFileUploadProgress(e,{"oneFileTitle":c.CollectingOneItem,"oneFileSuccess":c.CollectOneItemSuccessMessage,"multiFileSuccess":c.CollectManyItemsSuccessMessage,"oneFilePending":c.CollectingOneItem,"multiFilePending":c.CollectingItems,"oneFileFailure":c.CollectOneItemFailMessage,"multiFileFailure":c.CollectManyItemsFailMessage2,"someFileSuccess":c.CollectManyItemsSuccessMessage,"someFilePending":c.CollectingItems,"someFileFailure":c.CollectManyItemsFailMessage2,"enableCancel":!1}),t.whenAll.apply(t,u)},"_collectNode":function(e,i,n){var s=t.Deferred(),o={"collection_id":i},r=e.extendAjaxOptions({"url":e.connection.url.replace("/v1","/v2")+"/nodes/"+n,"type":"PUT","data":"body="+encodeURIComponent(JSON.stringify(o)),"contentType":"application/x-www-form-urlencoded"});return t.ajax(r).done(function(e){s.resolve(e)}).fail(function(e){s.reject(e)}),s.promise()},"_getListView":function(e){return new h(n.extend({},{"collection":e}))},"_showDialog":function(e){var i=t.Deferred(),n=[{"id":"close","label":c.conflictsDialogCloseLabel,"toolTip":c.conflictsDialogCloseLabel,"click":function(e){i.resolve("close",e.dialog)}}];return this._showConflictDialog(e,n),i},"_showConflictDialog":function(e,i){var n=this;t.Deferred();csui.require(["csui/controls/dialog/dialog.view"],function(t){var s=l.formatMessage(e.length,n.get("errorMessages")),o=new t({"title":s,"midSize":!0,"iconLeft":"csui-icon-notification-information","className":"csui-collection-conflicts-dialog","view":n._getListView(e),"buttons":i});return o.show(),o})},"_checkPromises":function(e){n.isArray(e)||(e=[e]);var i=new s.Collection,t=new s.Collection;return n.each(e,function(e){void 0!==e&&(e.cancelled||void 0===e.get("count")||(e.get("count")?i.push(e):t.push(e)))}),{"successNodes":i,"failedNodes":t}},"_addToCurrentTable":function(e,i,n){e.isLocallyCreated=!0,e.refernce_id=n,e.fetch({"collection":i}).then(function(){i.unshift(e)})},"_showGlobalMessage":function(e){var i=l.formatMessage(e,this.get("successMessages"));m.showMessage("success",i)},"_announceOperationStart":function(e){var i=e.originatingView;i.blockActions&&i.blockActions(),f.enable(this.get("pageLeavingWarning"))},"_announceOperationEnd":function(e){f.disable();var i=e.originatingView;i.unblockActions&&i.unblockActions()}});return w}),csui.define("csui/utils/commands/multiple.items",["module","require","csui/lib/underscore","csui/lib/jquery","csui/utils/base","csui/utils/commandhelper","csui/utils/command.error"],function(e,i,n,t,s,o,r){"use strict";var a=e.config();n.defaults(a,{"parallelism":3});var c;return{"execute":function(e,i){return e.suppressFailMessage=!0,e.suppressSuccessMessage=!0,this._performActions(e,i)},"_performActions":function(e,i){var s,r=t.Deferred(),l=this;return csui.require(["csui/utils/taskqueue","csui/utils/page.leaving.blocker"],function(u){c=arguments[1],i=i||{},i.context||(i.context=e.context),l._announceStart(e);var d=o.getAtLeastOneNode(e),m=new u({"parallelism":i.parallelism||a.parallelism});s=d.map(function(e,n){var s=t.Deferred();return m.pending.add({"worker":function(){return l._performAction(e,i).done(s.resolve).fail(function(e){s.reject(e)}),s.promise()}}),s.promise()}),t.whenAll.apply(t,s).always(n.bind(l._announceFinish,l,e)).done(function(){e.suppressMultipleSuccessMessage||l.showSuccess(s),r.resolve.apply(r,arguments)}).fail(function(){e.suppressMultipleFailMessage||l.showError(s),r.reject.apply(r,arguments)})},function(e){r.reject(e)}),r.promise()},"showError":function(e){var i,n,t=this._checkPromises(e);if(t){var s=t.countFailed,o=t.countOk;i=this._getErrorMessage(s);var r;o>0?(n=this._getSuccessMessage(o),r=n+" "+i):r=i,csui.require(["csui/controls/globalmessage/globalmessage"],function(e){e.showMessage("error",r,void 0,{})})}},"showSuccess":function(e){var i,n=this._checkPromises(e);if(n){var t=n.countOk;i=this._getSuccessMessage(t),csui.require(["csui/controls/globalmessage/globalmessage"],function(e){e.showMessage("success",i,void 0,{})})}},"showSuccessWithLink":function(e,i){var n,t=this._checkPromises(e);if(t){var s=t.countOk;n=this._getSuccessMessage(s),csui.require(["csui/controls/globalmessage/globalmessage"],function(e){e.showMessage("success_with_link",n,void 0,i)})}},"_getErrorMessage":function(e){var i=this.get("errorMessages");return s.formatMessage(e,i)},"_getSuccessMessage":function(e){var i=this.get("successMessages");return s.formatMessage(e,i)},"_checkPromises":function(e){n.isArray(e)||(e=[e]);var i=0,t=0;return n.each(e,function(e){void 0!==e&&(e.cancelled||(e instanceof r?t++:void 0!==e.state&&"function"==typeof e.state?e.state()&&"resolved"===e.state().toLowerCase()?i++:t++:i++))}),{"countOk":i,"countFailed":t}},"_announceStart":function(e){var i=e.originatingView;i&&i.blockActions&&i.blockActions();var n=this.get("pageLeavingWarning");n&&c.enable(n)},"_announceFinish":function(e){this.get("pageLeavingWarning")&&c.disable();var i=e.originatingView;i&&i.unblockActions&&i.unblockActions()}}}),csui.define("csui/utils/commands/confirmable",["csui/lib/underscore","csui/lib/jquery","require","csui/utils/commands/multiple.items"],function(e,i,n,t){var s={"execute":function(e,n){var t=this;return this._confirmAction(e,n).then(function(){return t._performActions(e,n)},function(e){return i.Deferred().reject().promise()})},"_confirmAction":function(e,n){var t=i.Deferred();if(this._getConfirmTemplate){var s=this._getConfirmData(e,n),o=this._getConfirmTemplate(e,n)(s);csui.require(["csui/dialogs/modal.alert/modal.alert"],function(e){e.confirmQuestion(i(o).text(),s.title).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)})})}else t.resolve();return t.promise()}};return e.extend(s,e.omit(t,"execute")),s}),csui.define("csui/utils/commands/collection/remove.collected.items",["module","require","csui/lib/underscore","csui/lib/jquery","csui/models/command","csui/utils/commandhelper","i18n!csui/utils/commands/collection/nls/lang","csui/utils/commands/confirmable","csui/utils/commands/multiple.items","csui/utils/command.error"],function(e,i,n,t,s,o,r,a,c,l){"use strict";var u=e.config();n.defaults(u,{"parallelism":1});var d,m=s.extend({"defaults":{"signature":"RemoveCollectedItems","command_key":"removefromcollection","name":r.removefromCollection,"pageLeavingWarning":r.DeletePageLeavingWarning,"scope":"multiple","successMessages":{"formatForNone":r.RemoveItemsNoneMessage,"formatForOne":r.RemoveOneItemSuccessMessage,"formatForTwo":r.RemoveSomeItemsSuccessMessage,"formatForFive":r.RemoveManyItemsSuccessMessage},"errorMessages":{"formatForNone":r.RemoveItemsNoneMessage,"formatForOne":r.RemoveOneItemFailMessage,"formatForTwo":r.RemoveSomeItemsFailMessage,"formatForFive":r.RemoveManyItemsFailMessage}},"allowCollectionRefetch":!1,"_getConfirmTemplate":function(e,i){return n.template(r.RemoveCollectItemsCommandConfirmDialogHtml)},"_getConfirmData":function(e,i){var t=o.getAtLeastOneNode(e),s=1===t.length?n.str.sformat(r.RemoveCommandConfirmDialogSingleMessage,t.at(0).get("name")):n.str.sformat(r.RemoveCommandConfirmDialogMultipleMessage,t.length);return{"title":r.RemoveCommandConfirmDialogTitle,"message":s}},"_performAction":function(e,i){var n=e.node,s=t.Deferred(),o={"collection_id":i.container.get("id"),"operation":"remove"},r=i.container.connector,a=i.containerCollection,c=r.extendAjaxOptions({"url":r.connection.url.replace("/v1","/v2")+"/nodes/"+n.get("id"),"type":"PUT","data":"body="+encodeURIComponent(JSON.stringify(o)),"contentType":"application/x-www-form-urlencoded"}),u=t.ajax(c).done(function(i){e.set("count",1),a.remove(n),e.deferred.resolve(e),s.resolve(e)}).fail(function(i){var n=i?new l(i,e):i;e.deferred.reject(e,n),i||u.abort(),s.reject(n)});return s.promise()},"startGlobalMessage":function(e){d.showFileUploadProgress(e,{"oneFileTitle":r.RemovingOneItem,"oneFileSuccess":r.RemoveOneItemSuccessMessage,"multiFileSuccess":r.RemoveManyItemsSuccessMessage,"oneFilePending":r.RemovingOneItem,"multiFilePending":r.RemoveItems,"oneFileFailure":r.RemoveOneItemFailMessage,"multiFileFailure":r.RemoveManyItemsFailMessage2,"someFileSuccess":r.RemoveSomeItemsSuccessMessage,"someFilePending":r.RemovingSomeItems,"someFileFailure":r.RemoveSomeItemsFailMessage2,"enableCancel":!1})}});return n.extend(m.prototype,a,{"execute":function(e,i){var n=t.Deferred(),s=this;return e.suppressFailMessage=!0,e.suppressSuccessMessage=!0,csui.require(["csui/controls/globalmessage/globalmessage"],function(t){d=t,s._executeRemoveCollectionItems(e,i).then(n.resolve,n.reject)},n.reject),n.promise()},"_executeRemoveCollectionItems":function(e,i){var s=this;i||(i={});var r=o.getAtLeastOneNode(e),c=(1===r.length&&r.first(),t.Deferred()),m=e.data||{};e.context||i.context;i.parallelism||(i.parallelism=u.parallelism);var g=null==m.showProgressDialog||m.showProgressDialog;return a.execute.apply(this,arguments).done(function(n){g&&d.hideFileUploadProgress(),i.infiniteScroll&&e.collection.fetch({"reset":!1,"remove":!1,"merge":!0}),s.allowCollectionRefetch=!0,c.resolve(n)}).fail(function(e){var i=e&&n.find(e,function(e){return!(e instanceof l)}),t=i||e;c.reject(t)}),c.promise()},"_performActions":function(e,i){i||(i={});var s=this,o=t.Deferred(),r=e.data||{},a=null==r.showProgressDialog||r.showProgressDialog;return i.container||(i.container=e.container),i.containerCollection=e.collection,csui.require(["csui/models/fileuploads"],function(t){var r=e.nodes.models,l=n.map(r,function(e){return{"name":e.get("name"),"state":"pending","count":0,"total":1,"node":e}}),u=r&&r[0]&&r[0].connector,m=new t(l,{"connector":u}),g=n.defaults({"nodes":m},e);m.each(function(e){var i=e.get("node");e.node=i,e.unset("node"),e.set("mime_type",i.get("mime_type"))}),a&&s.startGlobalMessage(m),g.suppressMultipleSuccessMessage=!0,g.suppressMultipleFailMessage=!0,c._performActions.call(s,g,i).done(function(e){a&&d.hideFileUploadProgress(),s.showSuccess(e),o.resolve(e)}).fail(function(e){return a||s.showError(e),o.reject(e)})},o.reject),o.promise()}}),m}),csui.define("csui/utils/commands/copy",["module","require","csui/lib/underscore","csui/lib/jquery","i18n!csui/utils/commands/nls/localized.strings","csui/utils/log","csui/utils/url","csui/models/command","csui/utils/commandhelper","csui/utils/command.error","csui/utils/commands/multiple.items","csui/utils/node.links/node.links"],function(e,i,n,t,s,o,r,a,c,l,u,d){"use strict";var m=e.config();n.defaults(m,{"parallelism":3});var g,p,f,v,h,w,b,y=a.extend({});return n.extend(y.prototype,u),y.extend({"defaults":{"signature":"Copy","command_key":["copy","Copy"],"name":s.CommandNameCopy,"verb":s.CommandVerbCopy,"pageLeavingWarning":s.CopyPageLeavingWarning,"scope":"multiple","successMessages":{"formatForNone":s.CopyItemsNoneMessage,"formatForOne":s.CopyOneItemSuccessMessage,"formatForTwo":s.CopySomeItemsSuccessMessage,"formatForFive":s.CopyManyItemsSuccessMessage},"errorMessages":{"formatForNone":s.CopyItemsNoneMessage,"formatForOne":s.CopyOneItemFailMessage,"formatForTwo":s.CopySomeItemsFailMessage,"formatForFive":s.CopyManyItemsFailMessage}},"execute":function(e,i){var s=this,o=t.Deferred(),r=e.context||i&&i.context;return e.suppressSuccessMessage=!0,e.suppressFailMessage=!0,csui.require(["csui/controls/globalmessage/globalmessage","csui/controls/conflict.resolver/conflict.resolver","csui/utils/taskqueue","csui/dialogs/node.picker/impl/header/apply.properties.selector/apply.properties.selector.view","csui/models/fileuploads","csui/utils/page.leaving.blocker","csui/utils/contexts/factories/next.node"],function(){g=arguments[0],p=arguments[1],f=arguments[2],v=arguments[3],h=arguments[4],w=arguments[5],b=arguments[6],s._selectCopyOptions(e,i).done(function(i){var t=e.nodes,a=i.nodes[0],l=(i.openSelectedProperties,i.applyProperties),u=!!e.container&&a.get("id")===e.container.get("id");s._announceOperationStart(e);var m=t.map(function(e){var i={"id":e.get("id"),"name":e.get("name"),"container":e.get("container"),"mime_type":e.get("mime_type"),"original_id":e.get("original_id"),"original":e.original,"type":e.get("type"),"size":e.get("size"),"type_name":e.get("type_name"),"state":"pending","count":0,"total":1,"enableCancel":!1},n=e.get("type");return 144===n||749===n||736===n||30309===n?i.size_formatted=e.get("size_formatted"):140===n&&(i.url=e.get("url")),i.actions=e.actions,i}),p=n.map(m,function(e){return n.clone(e)});s._resolveNamingConflicts(a,p).done(function(p){n.each(p,function(e){void 0===e.id&&(e.id=n.findWhere(m,{"name":e.name}).id)}),s._metadataHandling(p,n.extend(i,{"context":r,"targetFolder":a})).done(function(){var i=new h(p);i.each(function(e){var i=t.findWhere({"id":e.get("id")});e.node.set(n.omit(i.attributes,"id"))});var m=e.container&&e.container.connector;if(void 0===m){var f=c.getAtLeastOneNode(e).first();f&&(m=f.connector)}s._copySelectedNodes(i,m,a,l,u,e.collection).done(function(e){if(g.hideFileUploadProgress(),e.length){var i={"context":r,"nextNodeModelFactory":b,"link_url":d.getUrl(a),"targetFolder":a};s.showSuccessWithLink(e,i)}o.resolve()}).always(function(i){s._announceOperationEnd(e,u)}).fail(function(e){o.reject()})}).fail(function(i){s._announceOperationEnd(e,u),o.reject()})}).fail(function(i){i&&i.userAction&&"cancelResolveNamingConflicts"===i.userAction?s.trigger("resolve:naming:conflicts:cancelled"):i&&!i.cancelled&&s.showError(i),s._announceOperationEnd(e,u),o.reject()})}).fail(function(e){e&&!e.cancelled&&s.showError(e),o.reject()})},o.reject),o.promise()},"_announceOperationStart":function(e){var i=e.originatingView;i.blockActions&&i.blockActions(),w.enable(this.get("pageLeavingWarning"))},"_announceOperationEnd":function(e,i){w.disable();var n=e.originatingView;n.unblockActions&&n.unblockActions()},"_selectCopyOptions":function(e,i){var o=this,r=t.Deferred();return csui.require(["csui/dialogs/node.picker/node.picker"],function(t){var a=!!e.container&&e.container.get("id")===e.nodes.models[0].get("id"),c=e.nodes.length,l=n.str.sformat(c>1?s.DialogTitleCopy:s.DialogTitleSingleCopy,c),u=n.extend({"command":"copy","selectableTypes":[-1],"unselectableTypes":[899],"showAllTypes":!0,"orderBy":"type asc","dialogTitle":l,"initialContainer":e.container||e.nodes.models[0].parent,"initialSelection":e.nodes,"startLocation":a?"recent.containers":"","includeCombineProperties":1===c,"propertiesSeletor":!0,"globalSearch":!0,"context":i?i.context:e.context,"startLocations":["enterprise.volume","current.location","personal.volume","favorites","recent.containers"],"resolveShortcuts":!0,"resultOriginalNode":!0},e);o.nodePicker=new t(u),o.nodePicker.show().done(function(){r.resolve.apply(r,arguments)}).fail(function(){r.reject.apply(r,arguments)})},function(e){r.reject(e)}),r.promise()},"_resolveNamingConflicts":function(e,i){var t=1===i.length?s.CopyingNode:n.str.sformat(s.CopyingNodes,i.length);return new p({"h1Label":t,"actionBtnLabel":s.CommandNameCopy,"excludeAddVersion":!0,"container":e,"files":i}).run()},"_metadataHandling":function(e,i){var n=t.Deferred();return csui.require(["csui/widgets/metadata/metadata.copy.move.items.controller"],function(t){var s,o=i.openSelectedProperties,r=i.applyProperties,a=new t;if(o)s=a.CopyMoveItemsWithMetadata;else{if(r!==v.APPLY_DESTINATION_PROPERTIES&&r!==v.COMBINE_ALL_PROPERTIES)return n.resolve();s=a.CopyMoveItemsRequiredMetadata}r===v.KEEP_ORIGINAL_PROPERTIES?i.inheritance="original":r===v.APPLY_DESTINATION_PROPERTIES?i.inheritance="destination":r===v.COMBINE_ALL_PROPERTIES&&(i.inheritance="merged"),i.action="copy",s.call(a,e,i).done(function(){n.resolve()}).fail(function(e){n.reject(e)})},function(e){o.warn("Failed to load MetadataCopyMoveItemsController. {0}",e)&&console.warn(o.last),n.reject(e)}),n.promise()},"_copySelectedNodes":function(e,i,o,r,a,c){var u=this,d=new f({"parallelism":m.parallelism}),p=n.map(e.models,function(e){var n=t.Deferred();return d.pending.add({"worker":function(){var t=e.attributes,s=o.get("id");return u._getCategories(t,i,s,r).done(function(o){u._copyNode(o,t,i,s,e.node).done(function(){e.set("count",1),e.deferred.resolve(e),a&&u._addToCurrentTable(e.node,c),n.resolve(t)}).fail(function(i){var t=new l(i);e.deferred.reject(e,t),n.reject(t)})}).fail(function(i){var t=new l(i);e.deferred.reject(e,t),n.reject(t)}),n.promise()}}),n.promise(p)});return g.showFileUploadProgress(e,{"oneFileTitle":s.CopyingOneItem,"oneFileSuccess":s.CopyOneItemSuccessMessage,"multiFileSuccess":s.CopyManyItemsSuccessMessage,"oneFilePending":s.CopyingOneItem,"multiFilePending":s.CopyItems,"oneFileFailure":s.CopyOneItemFailMessage,"multiFileFailure":s.CopyManyItemsFailMessage2,"someFileSuccess":s.CopySomeItemsSuccessMessage,"someFilePending":s.CopySomeItems,"someFileFailure":s.CopySomeItemsFailMessage2,"enableCancel":!1}),t.whenAll.apply(t,p)},"_addToCurrentTable":function(e,i){e.isLocallyCreated=!0,e.fetch({"collection":i}).then(function(){i.unshift(e)})},"_copyNode":function(e,i,n,t,s){var o={"original_id":i.id,"parent_id":t,"name":i.newName?i.newName:i.name,"roles":e};return s.connector||n.assignTo(s),s.save(void 0,{"data":o,"url":n.connection.url+"/nodes"})},"_getCategories":function(e,i,n,s){var o=t.Deferred();if(e.extended_data&&e.extended_data.roles)o.resolve(e.extended_data.roles);else{var r=i.extendAjaxOptions({"url":i.connection.url+"/forms/nodes/copy?"+t.param({"id":e.id,"parent_id":n})});t.ajax(r).then(function(e,i,n){var t,r=e.forms[1],a=r&&r.data||{};t={},t[v.KEEP_ORIGINAL_PROPERTIES]="original",t[v.APPLY_DESTINATION_PROPERTIES]="destination",t[v.COMBINE_ALL_PROPERTIES]="merged";var c=a[t[s]];o.resolve({"categories":c})}).fail(function(e){o.reject(e)})}return o.promise()}})}),csui.define("csui/utils/commands/copy.link",["module","require","csui/lib/underscore","csui/lib/jquery","csui/models/command","csui/utils/commandhelper","csui/utils/node.links/node.links","i18n!csui/utils/commands/nls/localized.strings"],function(e,i,n,t,s,o,r,a){"use strict";n.extend({},e.config());return s.extend({"defaults":{"signature":"CopyLink","name":a.CommandNameCopyLink},"enabled":function(e){return!!o.getJustOneNode(e)},"execute":function(e,i){var n=t.Deferred(),s=o.getJustOneNode(e),c=e.url?r.completeUrl(s,e.url):r.getUrl(s),l=this._copyToClipboard(c);return csui.require(["csui/controls/globalmessage/globalmessage"],function(e){l?(n.resolve(),e.showMessage("success",a.CopyLinkSuccessMessage)):(n.reject(),e.showMessage("error",a.CopyLinkFailMessage))},n.reject),n.promise()},"_copyToClipboard":function(e){if(window.clipboardData)return window.clipboardData.setData("Text",e),!0;var i=!1,n=document.createTextNode(e),t=document.createElement("span");if(t.style.color="black",t.style.background="tranparent",t.style.backgroundColor="white",t.appendChild(n),document.body.appendChild(t),window.getSelection){var s=window.getSelection();s.removeAllRanges();var o=document.createRange();o.selectNodeContents(n),s.addRange(o),i=document.execCommand("copy"),s.removeAllRanges()}return document.body.removeChild(t),i}})}),csui.define("csui/models/perspective/server.adaptor.mixin",["csui/lib/underscore","csui/lib/jquery","csui/utils/url"],function(e,i,n){"use strict";return{"mixin":function(i){return e.extend(i,{"makeServerAdaptor":function(e){return this},"isFetchableDirectly":function(){return this.get("id")>0},"urlBase":function(){var i=this.get("id"),t=this.connector.connection.url;if(i){if(e.isNumber(i)&&!(i>0))throw new Error("Unsupported id value");t=n.combine(t,"perspectives",i)}else t=n.combine(t,"perspectives");return t},"url":function(){return this.urlBase()},"parse":function(e){var i=e.perspectives;if(!i||0===i.length)return{};var n=i[0];return n.cascading=n.cascading+"",n.containerType=n.container_type,n.constantData=n.constant_data,n.overrideType=n.override_type,n.overrideId=n.override_id,n.nodepath=n.node_path,n.rules=n.rule_data,n.perspective=JSON.parse(n.perspective),n.constant_extraction_mode=n.container_type,n.pnodepath=n.perspective_node_path,n}})}}}),csui.define("csui/models/perspective/perspective.model",["module","csui/lib/underscore","csui/lib/backbone","csui/models/perspective/server.adaptor.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/mixins/connectable/connectable.mixin","csui/utils/log","csui/utils/base"],function(e,i,n,t,s,o,r,a){"use strict";var c=i.extend({"idAttribute":null},e.config()),l=n.Model.extend({"idAttribute":c.idAttribute,"constructor":function(e,t){n.Model.prototype.constructor.call(this,e,t),this.options=i.pick(t,["connector"]),this.makeUploadable(t).makeConnectable(t).makeServerAdaptor(t)},"isNew":function(){return!this.get("id")||0===this.get("id")},"isFetchable":function(){return!!this.get("id")},"prepareFormData":function(e,i){return{"pData":JSON.stringify(e)}}});return s.mixin(l.prototype),o.mixin(l.prototype),t.mixin(l.prototype),l}),csui.define("csui/utils/commands/create.perspective",["module","require","csui/lib/underscore","csui/lib/jquery","csui/models/command","csui/utils/commandhelper","csui/utils/url","csui/models/perspective/perspective.model","i18n!csui/utils/commands/nls/localized.strings"],function(e,i,n,t,s,o,r,a,c){"use strict";var l=window.csui.requirejs.s.contexts._.config.config["csui/utils/contexts/perspective"]||{};l=n.extend({"enableInlinePerspectiveEditing":!1},l,e.config());var u,d,m;return s.extend({"defaults":{"signature":"CreatePerspective","name":c.CreatePerspective},"enabled":function(e,i){var n=e.context||i&&i.context,t=n.perspective.attributes;return!(void 0!==t.id||!t.canEditPerspective||"node"!==n._applicationScope.attributes.id)},"execute":function(e,i){var n=e.context||i&&i.context;return i&&i.inlinePerspectiveEditing||l.enableInlinePerspectiveEditing?this._editInline(e,i,n):this._editInClassicPMan(e,i,n)},"_preparePerspectiveConfig":function(e){var i={"perspective":{"type":"flow","options":{"widgets":[{"type":"csui/widgets/nodestable"}]}},"overrideType":"genericContainer","scope":"local","containerType":"-1","cascading":"false"},n=o.getJustOneNode(status)||e.getModel(d),t=e.getCollection(m);return i.nodepath=this._getNodePath(t),i.node=n.get("id"),i.containerType=n.get("type"),i.title=n.get("name"),i},"_editInline":function(e,i,n){var s=t.Deferred(),o=this;return csui.require(["csui/utils/contexts/factories/node","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/ancestors","csui/perspective.manage/pman.view"],function(){d=arguments[0],u=arguments[1],m=arguments[2];var e=arguments[3],i=o._preparePerspectiveConfig(n,d,m);i.title=i.title+" "+(new Date).getTime();var t=new a(i,{"connector":n.getObject(u)});new e({"context":n,"perspective":t}).show(),s.resolve()},s.reject),s.promise()},"_editInClassicPMan":function(e,i,n){var s=t.Deferred(),o=this;return csui.require(["csui/utils/contexts/factories/connector","csui/utils/contexts/factories/node","csui/utils/contexts/factories/ancestors"],function(){u=arguments[0],d=arguments[1],m=arguments[2];var i=o._getForm(n,e);i.submit(),i.remove(),s.resolve()},s.reject),s.promise()},"_getForm":function(e,i){var n=t("<form target='_blank' method='POST' style='display:none;'></form>").attr({"action":this._getUrl(e,i)}).appendTo(document.body),s=this._getUrlQueryParameters(e,i);for(var o in s)s.hasOwnProperty(o)&&t('<input type="hidden" />').attr({"name":o,"value":s[o]}).appendTo(n);return n},"_getUrl":function(e,i){var n=e.getObject(u);return new r(n.connection.url).getCgiScript().toString()+"/perspectivemgr"},"_getUrlQueryParameters":function(e,i){var n=this._preparePerspectiveConfig(e,d,m);return n.ui={"elements":{"btn-mode-code":!0,"btn-view-general":!0,"btn-view-rules":!1,"btn-view-layout":!0,"btn-view-widgets":!0,"view-perspective-action":!0,"perspective-action-create":!0,"perspective-action-edit":!0,"perspective-action-copy":!0,"view-perspective-form":!0,"perspective-title":!0,"perspective-type":!0,"perspective-scope":!0,"perspective-nodetypes":!0,"perspective-node":!0,"perspective-cascading":!0,"display-size-msg":!1,"rules-code":!0,"layout-flow":!0,"layout-left-center-right":!0,"layout-grid":!1,"layout-tabbed":!1},"widgetGroupsBlacklist":[],"widgetsWhitelist":[],"disableGrouping":!1},{"config":JSON.stringify(n)}},"_getNodePath":function(e){var i="";return e.each(function(e){i+=i?":":"",i+=e.get("name")}),i}})}),csui.define("csui/utils/commands/node",["csui/lib/underscore","csui/models/command","csui/utils/commands/multiple.items"],function(e,i,n){var t=i.extend({"_performAction":function(e,i){throw new Error("Method not implemented in the descendant command.")}});return e.extend(t.prototype,n),t}),csui.define("csui/utils/commands/delete",["module","require","csui/lib/underscore","csui/lib/jquery","i18n!csui/utils/commands/nls/localized.strings","csui/utils/log","csui/utils/commandhelper","csui/utils/commands/node","csui/utils/commands/multiple.items","csui/utils/commands/confirmable","csui/utils/command.error"],function(e,i,n,t,s,o,r,a,c,l,u){"use strict";var d=e.config();n.defaults(d,{"parallelism":1});var m,g,p,f=a.extend({"defaults":{"signature":"Delete","command_key":["delete","Delete"],"name":s.CommandNameDelete,"verb":s.CommandVerbDelete,"pageLeavingWarning":s.DeletePageLeavingWarning,"scope":"multiple","successMessages":{"formatForNone":s.DeleteItemsNoneMessage,"formatForOne":s.DeleteOneItemSuccessMessage,"formatForTwo":s.DeleteSomeItemsSuccessMessage,"formatForFive":s.DeleteManyItemsSuccessMessage},"errorMessages":{"formatForNone":s.DeleteItemsNoneMessage,"formatForOne":s.DeleteOneItemFailMessage,"formatForTwo":s.DeleteSomeItemsFailMessage,"formatForFive":s.DeleteManyItemsFailMessage}},"allowCollectionRefetch":!1,"_getConfirmTemplate":function(e,i){return n.template(s.DeleteCommandConfirmDialogHtml)},"_getConfirmData":function(e,i){var t=r.getAtLeastOneNode(e),o=1===t.length?n.str.sformat(s.DeleteCommandConfirmDialogSingleMessage,t.at(0).get("name")):n.str.sformat(s.DeleteCommandConfirmDialogMultipleMessage,t.length);return{"title":s.DeleteCommandConfirmDialogTitle,"message":o}},"_performAction":function(e,i){var o=e.node,r=t.Deferred();if(o.collection){var a=o.destroy({"wait":!0}).done(function(){e.set("count",1),e.deferred.resolve(e),r.resolve(o)}).fail(function(i){var n=i?new u(i,o):i;e.deferred.reject(e,n),i||a.abort(),r.reject(n)});return r.promise()}return r.reject(new u(n.str.sformat(s.DeleteItemFailed,o.get("name")),{"errorDetails":"collection is undefined"}))},"startGlobalMessage":function(e,i){p.showFileUploadProgress(e,{"oneFileTitle":s.DeletingOneItem,"oneFileSuccess":s.DeleteOneItemSuccessMessage,
"multiFileSuccess":s.DeleteManyItemsSuccessMessage,"oneFilePending":s.DeletingOneItem,"multiFilePending":s.DeleteItems,"oneFileFailure":s.DeleteOneItemFailMessage,"multiFileFailure":s.DeleteManyItemsFailMessage2,"someFileSuccess":s.DeleteSomeItemsSuccessMessage,"someFilePending":s.DeletingSomeItems,"someFileFailure":s.DeleteSomeItemsFailMessage2,"enableCancel":!1,"originatingView":i.originatingView})}});return n.extend(f.prototype,l,{"execute":function(e,i){var n=t.Deferred(),s=this;return e.suppressFailMessage=!0,e.suppressSuccessMessage=!0,csui.require(["csui/models/fileuploads","csui/utils/contexts/factories/next.node","csui/controls/globalmessage/globalmessage"],function(t,o,r){m=t,g=o,p=r,s._executeDelete(e,i).then(n.resolve,n.reject)},n.reject),n.promise()},"_executeDelete":function(e,i){var s=this;i||(i={});var o=r.getAtLeastOneNode(e),a=1===o.length&&o.first(),c=t.Deferred(),m=e.data||{},f=e.context||i.context;i.parallelism||(i.parallelism=d.parallelism),i.originatingView=e.originatingView;var v=null==m.showProgressDialog||m.showProgressDialog;return l.execute.call(this,e,i).done(function(n){v&&p.hideFileUploadProgress(),a&&a===e.container?setTimeout(function(){var i=f.getModel(g),n=e.container.get("parent_id");i.set("id",n.id||n)}):i.infiniteScroll&&e.collection.fetch({"reset":!1,"remove":!1,"merge":!0}),s.allowCollectionRefetch=!0,c.resolve(n)}).fail(function(e){var i=e&&n.find(e,function(e){return!(e instanceof u)}),t=i||e;c.reject(t)}),c.promise()},"_performActions":function(e,i){var s=this,o=t.Deferred(),r=e.data||{},a=null==r.showProgressDialog||r.showProgressDialog,l=e.nodes.models,u=n.map(l,function(e){return{"name":e.get("name"),"state":"pending","count":0,"total":1,"node":e}}),d=l&&l[0]&&l[0].connector,g=new m(u,{"connector":d}),f=n.defaults({"nodes":g},e);return g.each(function(e){var i=e.get("node");e.node=i,e.unset("node"),e.set("mime_type",i.get("mime_type"))}),a&&this.startGlobalMessage(g,i),f.suppressMultipleSuccessMessage=!0,f.suppressMultipleFailMessage=!0,c._performActions.call(this,f,i).done(function(e){a&&p.hideFileUploadProgress(),o.resolve(e),setTimeout(function(){s.showSuccess(e)},500)}).fail(function(e){return a||s.showError(e),o.reject(e)}),o.promise()}}),f}),csui.define("csui/utils/commands/download",["module","csui/lib/underscore","csui/lib/jquery","csui/utils/base","i18n!csui/utils/commands/nls/localized.strings","csui/utils/log","csui/utils/command.error","csui/utils/url","csui/utils/commandhelper","csui/utils/connector","csui/models/command"],function(e,i,n,t,s,o,r,a,c,l,u){"use strict";return u.extend({"defaults":{"signature":"Download","command_key":["download","Download"],"name":s.CommandNameDownload,"verb":s.CommandVerbDownload,"doneVerb":s.CommandDoneVerbDownload,"scope":"single"},"execute":function(e,i){var n=c.getJustOneNode(e);if(n.original&&n.original.get("id")>0){var s=n.get("type");1===s?n=n.original:2===s&&n.set({"mime_type":n.original.get("mime_type")},{"silent":!0})}return t.isAppleMobile()?this._openContent(n,i):this._downloadContent(n,i)},"_downloadContent":function(e,n,t){return this._executeContentCommand(e,n).then(i.bind(function(i){var s=this._getContentUrl(e,n,t||"download",i);return this._performDownload(s)},this))},"_openContent":function(e,i){var t=this,s=window.open("");return this._executeContentCommand(e,i).then(function(o){return s.location.href=t._getContentUrl(e,i,"download",o),s.focus(),n.Deferred().resolve()},function(){return s.close(),n.Deferred().reject()})},"_executeContentCommand":function(e,i){var t=n.Deferred();return e.connector.requestContentAuthToken(e).done(function(e){t.resolve(e.token)}).fail(function(e){t.reject(new r(e))}),t.promise()},"_getContentUrl":function(e,i,n,t){return(e.get("version_number")?a.combine(e.connector.connection.url,"nodes",e.get("id"),"versions",e.get("version_number"),"content"):a.combine(e.connector.connection.url,"nodes",e.get("id"),"content"))+"?action="+n+"&token="+encodeURIComponent(t)},"_performDownload":function(e){var i=n("<iframe></iframe>").hide().attr("src",e).appendTo(n(document.body)),t=Math.min(l.prototype.connectionTimeout||6e4,6e4);return setTimeout(function(){i.remove()},t),n.Deferred().resolve()}})}),csui.define("csui/utils/commands/open.classic.page",["module","require","csui/lib/underscore","csui/lib/jquery","csui/utils/url","csui/utils/commandhelper","csui/models/command","i18n!csui/utils/commands/nls/localized.strings"],function(e,i,n,t,s,o,r,a){"use strict";var c=n.extend({"openInNewTab":!0},e.config());return r.extend({"execute":function(e,i){if(c.classicUnsupported)return this._classicUnsupported(e);var t=o.getJustOneNode(e);return this._navigateTo(t,n.extend({},e,i))},"getUrl":function(e,i){var o=e.connector||i.connector,r=new s(o.connection.url).getCgiScript(),a=this.getUrlQueryParameters(e,i);return a&&!n.isString(a)&&(a=t.param(a)),a&&(r+="?"+a),r},"getUrlQueryParameters":function(e,i){},"openInNewTab":function(){return c.openInNewTab},"shouldCloseTabAfterRedirect":!1,"_classicUnsupported":function(e){var i=t.Deferred();return e.suppressFailMessage=!0,csui.require(["csui/dialogs/modal.alert/modal.alert"],function(e){e.showInfo(a.viewTypeUnsupported)}),i.reject()},"_navigateTo":function(i,o){var r,a,c,l,u;try{r=this.getUrl(i,o)}catch(e){return t.Deferred().reject(e).promise()}return a=this.openInNewTab,n.isFunction(a)&&(a=a.call(this)),c=this.shouldCloseTabAfterRedirect,n.isFunction(c)&&(c=c.call(this)),c&&(a?(u=(i.connector||o.connector).connection,l=e.config().closeUrl||s.combine(u.supportPath,"csui/pages/close.html"),new s(l).isAbsolute()||(l="/"!==l[0]?s.appendQuery(new s(u.url).getCgiScript(),l):s.combine(new s(u.url).getOrigin(),l))):l=location.href,r=s.appendQuery(r,s.combineQueryString({"nextURL":l}))),a?window.open(r,"_blank").focus():location.href=r,t.Deferred().resolve().promise()}},{"openInNewTab":c.openInNewTab})}),csui.define("csui/utils/commands/edit",["csui/lib/jquery.parse.param","csui/utils/commandhelper","csui/utils/url","csui/utils/commands/open.classic.page","i18n!csui/utils/commands/nls/localized.strings"],function(e,i,n,t,s){"use strict";return t.extend({"defaults":{"signature":"Edit","command_key":"edit","scope":"single"},"shouldCloseTabAfterRedirect":!0,"getUrl":function(e,i){var t,o,r=this.get("command_key"),a=this._getNodeActionForSignature(e,r);if(a&&(t=a.get("href")))return new n(t).isAbsolute()||(o=(e.connector||i.connector).connection,t="/"!==t[0]?n.appendQuery(new n(o.url).getCgiScript(),t):n.combine(new n(o.url).getOrigin(),t)),t;throw new Error(s.NoEditUrl)}})}),csui.define("csui/utils/commands/editactivex",["csui/lib/jquery.parse.param","csui/utils/commandhelper","csui/utils/url","csui/utils/commands/open.classic.page"],function(e,i,n,t,s){"use strict";return t.extend({"defaults":{"signature":"EditActiveX","command_key":"editactivex","scope":"single"},"shouldCloseTabAfterRedirect":!0,"enabled":function(e,n){var t=i.getJustOneNode(e),s=this.get("command_key"),o=this._getNodeActionForSignature(t,s);if(o){var r=e.toolItem||n&&n.toolItem;if(r){var a=o.get("name");if(a)return r.set("name",a),!0}}return!1},"getUrl":function(e,i){var t,o,r=this.get("command_key"),a=this._getNodeActionForSignature(e,r);if(a&&(t=a.get("href")))return new n(t).isAbsolute()||(o=(e.connector||i.connector).connection,t="/"!==t[0]?n.appendQuery(new n(o.url).getCgiScript(),t):n.combine(new n(o.url).getOrigin(),t)),t;throw new Error(s.NoEditUrl)}})}),csui.define("csui/utils/commands/editofficeonline",["csui/lib/jquery.parse.param","csui/utils/commandhelper","csui/utils/url","csui/utils/commands/open.classic.page"],function(e,i,n,t,s){"use strict";return t.extend({"defaults":{"signature":"EditOfficeOnline","command_key":"editofficeonline","scope":"single"},"shouldCloseTabAfterRedirect":!0,"enabled":function(e,n){var t=i.getJustOneNode(e),s=this.get("command_key"),o=this._getNodeActionForSignature(t,s);if(o){var r=e.toolItem||n&&n.toolItem;if(r){var a=o.get("name");if(a)return r.set("name",a),!0}}return!1},"getUrl":function(e,i){var t,o,r=this.get("command_key"),a=this._getNodeActionForSignature(e,r);if(a&&(t=a.get("href")))return new n(t).isAbsolute()||(o=(e.connector||i.connector).connection,t="/"!==t[0]?n.appendQuery(new n(o.url).getCgiScript(),t):n.combine(new n(o.url).getOrigin(),t)),t;throw new Error(s.NoEditUrl)}})}),csui.define("csui/utils/commands/edit.perspective",["module","require","csui/lib/underscore","csui/lib/jquery","csui/models/command","csui/utils/url","csui/models/perspective/perspective.model","i18n!csui/utils/commands/nls/localized.strings"],function(e,i,n,t,s,o,r,a){"use strict";var c=window.csui.requirejs.s.contexts._.config.config["csui/utils/contexts/perspective"]||{};c=n.extend({"enableInlinePerspectiveEditing":!1},c,e.config());var l;return s.extend({"defaults":{"signature":"EditPerspective","name":a.EditPerspective},"enabled":function(e,i){var n=e.context||i&&i.context,t=n.perspective.attributes;return!!t.id&&t.canEditPerspective},"execute":function(e,i){var n=e.context||i&&i.context;return i&&i.inlinePerspectiveEditing||c.enableInlinePerspectiveEditing?this._editInline(e,i,n):this._editInClassicPMan(e,i,n)},"_editInline":function(e,i,s){var o=t.Deferred();return csui.require(["csui/perspective.manage/pman.view","csui/utils/contexts/factories/connector"],function(e,i){var t=s.perspective.get("id"),a=n.pick(s.perspective.attributes,"type","options"),c=new r({"id":t,"perspective":a},{"connector":s.getObject(i)});new e({"context":s,"perspective":c}).show(),o.resolve()},o.reject),o.promise()},"_editInClassicPMan":function(e,i,n){var s=t.Deferred(),o=this;return csui.require(["csui/utils/contexts/factories/connector"],function(){l=arguments[0];var i=o._getForm(n,e);i.submit(),i.remove(),s.resolve()},s.reject),s.promise()},"_getForm":function(e,i){var n=t("<form target='_blank' method='POST' style='display:none;'></form>").attr({"action":this._getUrl(e,i)}).appendTo(document.body),s=this._getUrlQueryParameters(e);for(var o in s)s.hasOwnProperty(o)&&t('<input type="hidden" />').attr({"name":o,"value":s[o]}).appendTo(n);return n},"_getUrl":function(e,i){var n=e.getObject(l);return new o(n.connection.url).getCgiScript().toString()+"/perspectivemgr"},"_getUrlQueryParameters":function(e){var i=e.perspective.attributes.id;return void 0!==i&&i>0?{"perspective_id":i}:{}}})}),csui.define("csui/utils/commands/editwebdav",["csui/lib/jquery.parse.param","csui/utils/commandhelper","csui/utils/url","csui/utils/commands/open.classic.page"],function(e,i,n,t,s){"use strict";return t.extend({"defaults":{"signature":"EditWebDAV","command_key":"editwebdav","scope":"single"},"shouldCloseTabAfterRedirect":!0,"enabled":function(e,n){var t=i.getJustOneNode(e),s=this.get("command_key"),o=this._getNodeActionForSignature(t,s);if(o){var r=e.toolItem||n&&n.toolItem;if(r){var a=o.get("name");if(a)return r.set("name",a),!0}}return!1},"getUrl":function(e,i){var t,o,r=this.get("command_key"),a=this._getNodeActionForSignature(e,r);if(a&&(t=a.get("href")))return new n(t).isAbsolute()||(o=(e.connector||i.connector).connection,t="/"!==t[0]?n.appendQuery(new n(o.url).getCgiScript(),t):n.combine(new n(o.url).getOrigin(),t)),t;throw new Error(s.NoEditUrl)}})}),csui.define("csui/utils/commands/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/utils/commands/nls/root/lang",{"EmailLinkSubject":"I want to share the following links with you","EmailLinkDesktop":"Link for Desktop and Android","EmailAppleLinkFormat":"Link for iOS Mobile","CommandNameReserve":"Reserve","CommandVerbReserve":"reserve","ReservePageLeavingWarning":"If you leave the page now, pending items will not be reserved.","ReserveItemsNoneMessage":"No items reserved.","ReserveOneItemSuccessMessage":"1 item successfully reserved.","ReserveSomeItemsSuccessMessage":"{0} items successfully reserved.","ReserveManyItemsSuccessMessage":"{0} items successfully reserved.","ReserveOneItemFailMessage":"1 item failed to reserve.","ReserveSomeItemsFailMessage":"{0} items failed to reserve.","ReserveManyItemsFailMessage":"{0} items failed to reserve.","CommandNameUnreserve":"Unreserve","CommandVerbUnreserve":"unreserve","UnreservePageLeavingWarning":"If you leave the page now, pending items will not be unreserved.","UnreserveItemsNoneMessage":"No items unreserved.","UnreserveOneItemSuccessMessage":"1 item successfully unreserved.","UnreserveSomeItemsSuccessMessage":"{0} items successfully unreserved.","UnreserveManyItemsSuccessMessage":"{0} items successfully unreserved.","UnreserveOneItemFailMessage":"1 item failed to unreserve.","UnreserveSomeItemsFailMessage":"{0} items failed to unreserve.","UnreserveManyItemsFailMessage":"{0} items failed to unreserve."}),csui.define("csui/utils/commands/email.link",["module","csui/lib/underscore","csui/lib/jquery","csui/utils/url","csui/utils/command.error","csui/models/command","csui/utils/commandhelper","csui/utils/node.links/node.links","i18n!csui/utils/commands/nls/lang","i18n!csui/utils/commands/nls/localized.strings","csui/lib/underscore.string"],function(e,i,n,t,s,o,r,a,c,l){"use strict";var u=i.extend({"rewriteApplicationURL":!1,"enableAppleSupport":!1,"appleNodeLinkBase":"x-otm-as-cs16://?launchUrl=nodes/"},e.config());return o.extend({"defaults":{"signature":"EmailLink","name":l.CommandNameEmailLink,"verb":l.CommandVerbEmailLink},"enabled":function(e){var i=r.getAtLeastOneNode(e);return i&&i.length},"execute":function(e,i){var t=n.Deferred(),s=r.getAtLeastOneNode(e),o=e.context||i&&i.context,a=this._getApplicationUrl(s,o),l=this._getNodesLinks(s,a),u="mailto:?subject="+encodeURIComponent(c.EmailLinkSubject)+"&body="+encodeURIComponent(l),d=this._openNewHref(u);return d?t.reject(d):t.resolve(),t.promise()},"_getApplicationUrl":function(e){var i=e.first().connector;return t.combine(new t(i.connection.url).getCgiScript(),"/app")},"_openNewHref":function(e){if(e.length>2048)return new s(l.EmailLinkCommandFailedWithTooMuchItemsErrorMessage);window.location.href=e},"_getNodesLinks":function(e,i){var n=u.enableAppleSupport,t=l.EmailAppleLinkFormat,s=c.EmailLinkDesktop+"\n",o=e.map(function(e){var s=a.getUrl(e),o=e.get("name")+":";if(u.rewriteApplicationURL){var r=s.lastIndexOf("#");r>=0&&(s=i+"/"+s.substr(r+1))}if(n){var c=1===e.get("type")?e.original.get("id"):e.get("id");t+="\n"+o+"\n"+u.appleNodeLinkBase+c}return o+"\n"+s}).join("\n");return n?s+o+"\n\n"+t:o}})}),csui.define("csui/utils/commands/execute.saved.query",["require","csui/lib/jquery","csui/utils/commandhelper","csui/models/command"],function(e,i,n,t){"use strict";return t.extend({"defaults":{"signature":"ExecuteSavedQuery","scope":"single"},"enabled":function(e){var i=n.getJustOneNode(e);return i&&258===i.get("type")},"execute":function(e,t){var s=i.Deferred();return csui.require(["csui/utils/contexts/factories/search.query.factory"],function(i){var o=n.getJustOneNode(e),r=e.context||t&&t.context,a=r.getModel(i);a.clear({"silent":!0}),a.set("query_id",o.get("id")),s.resolve()},s.reject),s.promise()}})}),csui.define("csui/utils/commands/favorite.add",["require","csui/lib/jquery","csui/utils/base","csui/lib/underscore","i18n!csui/utils/commands/nls/localized.strings","csui/utils/commandhelper","csui/utils/commands/node","csui/utils/command.error"],function(e,i,n,t,s,o,r,a){"use strict";return r.extend({"defaults":{"signature":"Favorite","command_key":["favorite","favorite"],"scope":"single","name":s.CommandNameFavorite,"verb":s.CommandVerbFavorite,"doneVerb":s.CommandDoneVerbFavorite},"enabled":function(e,i){if(i&&i.data&&i.data.useContainer)return e.container&&!e.container.get("favorite");var n=o.getAtLeastOneNode(e);return n&&1===n.length&&!n.models[0].get("favorite")},"execute":function(e,n){var t=i.Deferred(),s=e.originatingView;return csui.require(["csui/models/favorite.model","csui/dialogs/modal.alert/modal.alert"],function(i,n){var o;o=e.data&&e.data.useContainer?e.container:e.nodes.models[0];var r=o.get("id");new i({"node":o,"id":r,"selected":!1},{"connector":o.connector}).addToFavorites().done(function(e){o.set("favorite",!0),s.trigger("fav:change"),t.resolve(e)}).fail(function(e){t.reject(new a(e))})},function(e){t.reject(e)}),t.promise()}})}),csui.define("csui/utils/commands/favorite.remove",["require","csui/lib/jquery","csui/utils/base","csui/lib/underscore","i18n!csui/utils/commands/nls/localized.strings","csui/utils/commandhelper","csui/utils/commands/node","csui/utils/command.error"],function(e,i,n,t,s,o,r,a){"use strict";return r.extend({"defaults":{"signature":"NonFavorite","command_key":["nonfavorite","NonFavorite"],"scope":"single","verb":s.CommandVerbFavorite,"doneVerb":s.CommandRemovedVerbFavorite},"enabled":function(e,i){if(i&&i.data&&i.data.useContainer)return e.container&&e.container.get("favorite");var n=o.getAtLeastOneNode(e);return n&&1===n.length&&n.models[0].get("favorite")},"execute":function(e,n){var t=i.Deferred(),s=e.originatingView;return csui.require(["csui/models/favorite.model","csui/dialogs/modal.alert/modal.alert"],function(i,n){var o;o=e.data&&e.data.useContainer?e.container:e.nodes.models[0];var r=o.get("id");new i({"node":o,"id":r,"selected":!1},{"connector":o.connector}).removeFromFavorites().done(function(e){o.set("favorite",!1),s.trigger("fav:change"),t.resolve(e)}).fail(function(e){t.reject(new a(e))})},function(e){t.reject(e)}),t.promise()}})}),csui.define("csui/utils/commands/inlineedit",["require","csui/lib/underscore","csui/lib/jquery","csui/models/command","csui/utils/commandhelper"],function(e,i,n,t,s){"use strict";var o=t.extend({"defaults":{"signature":"InlineEdit","command_key":["rename","Rename"],"scope":"single"},"execute":function(e,i){var t=n.Deferred();return csui.require(["csui/controls/table/inlineforms/inlineform.factory"],function(i){var n=e.nodes&&1===e.nodes.length&&e.nodes.at(0),s=i.getInlineFormView(n.get("type"));s||(s=i.getInlineFormView(-1)),s&&(n.inlineFormView=s,n.set("csuiInlineFormErrorMessage","dummy",{"silent":!0}),n.unset("csuiInlineFormErrorMessage")),t.resolve()},function(e){t.reject(e)}),t.promise()}});return i.extend(o,{"version":"1.0"}),o}),csui.define("csui/utils/commands/move",["module","require","csui/lib/underscore","csui/lib/jquery","i18n!csui/utils/commands/nls/localized.strings","csui/utils/log","csui/utils/url","csui/models/command","csui/utils/commandhelper","csui/utils/command.error","csui/utils/commands/multiple.items","csui/utils/node.links/node.links"],function(e,i,n,t,s,o,r,a,c,l,u,d){"use strict";var m=e.config();n.defaults(m,{"parallelism":3});var g,p,f,v,h,w,b,y=a.extend({});return n.extend(y.prototype,u),y.extend({"defaults":{"signature":"Move","command_key":["move","Move"],"name":s.CommandNameMove,"verb":s.CommandNameVerbMove,"pageLeavingWarning":s.MovePageLeavingWarning,"scope":"multiple","successMessages":{"formatForNone":s.MoveItemsNoneMessage,"formatForOne":s.MoveOneItemSuccessMessage,"formatForTwo":s.MoveSomeItemsSuccessMessage,"formatForFive":s.MoveManyItemsSuccessMessage},"errorMessages":{"formatForNone":s.MoveItemsNoneMessage,"formatForOne":s.MoveOneItemFailMessage,"formatForTwo":s.MoveSomeItemsFailMessage,"formatForFive":s.MoveManyItemsFailMessage}},"allowCollectionRefetch":!1,"execute":function(e,i){var s=this,o=t.Deferred(),r=e.context||i&&i.context,a=[];return e.suppressFailMessage=!0,e.suppressSuccessMessage=!0,csui.require(["csui/controls/globalmessage/globalmessage","csui/controls/conflict.resolver/conflict.resolver","csui/utils/taskqueue","csui/dialogs/node.picker/impl/header/apply.properties.selector/apply.properties.selector.view","csui/models/fileuploads","csui/utils/page.leaving.blocker","csui/utils/contexts/factories/next.node"],function(){g=arguments[0],p=arguments[1],f=arguments[2],v=arguments[3],h=arguments[4],w=arguments[5],b=arguments[6],s._selectMoveOptions(e,i).done(function(i){var t=e.nodes,l=i.nodes[0],u=i.applyProperties;s._announceOperationStart(e);var m=t.map(function(e){var i={"id":e.get("id"),"name":e.get("name"),"container":e.get("container"),"mime_type":e.get("mime_type"),"original_id":e.get("original_id"),"original":e.original,"type":e.get("type"),"size":e.get("size"),"type_name":e.get("type_name"),"state":"pending","count":0,"total":1,"enableCancel":!1},n=e.get("type");return 144===n||749===n||736===n||30309===n?i.size_formatted=e.get("size_formatted"):140===n&&(i.url=e.get("url")),i.actions=e.actions,i}),p=n.map(m,function(e){return n.clone(e)});s._resolveNamingConflicts(l,p).done(function(p){n.each(p,function(e){void 0===e.id&&(e.id=n.findWhere(m,{"name":e.name}).id)}),s._metadataHandling(p,n.extend(i,{"context":r,"targetFolder":l})).done(function(){var i=new h(p);i.each(function(e){e.node=t.findWhere({"id":e.get("id")})});var m=e.container&&e.container.connector;if(void 0===m){var f=c.getAtLeastOneNode(e).first();f&&(m=f.connector)}s._moveSelectedNodes(i,m,l,u).done(function(t){if(t.length){g.hideFileUploadProgress();var c={"context":r,"nextNodeModelFactory":b,"link_url":d.getUrl(l),"targetFolder":l};s.showSuccessWithLink(t,c)}i.models&&i.models.length>0&&n.each(i.models,function(e){a.push(e.node)}),e.collection&&e.collection.remove(a),s.allowCollectionRefetch=!0,o.resolve(a)}).always(function(){s._announceOperationEnd(e),r.trigger("current:folder:changed")}).fail(function(){o.reject()})}).fail(function(){s._announceOperationEnd(e),o.reject()})}).fail(function(i){i&&i.userAction&&"cancelResolveNamingConflicts"===i.userAction?s.trigger("resolve:naming:conflicts:cancelled"):i&&!i.cancelled&&s.showError(i),s._announceOperationEnd(e),o.reject()})}).fail(function(e){e&&!e.cancelled&&s.showError(e),o.reject()})},o.reject),o.promise()},"_announceOperationStart":function(e){var i=e.originatingView;i.blockActions&&i.blockActions(),w.enable(this.get("pageLeavingWarning"))},"_announceOperationEnd":function(e){w.disable();var i=e.originatingView;i.unblockActions&&i.unblockActions()},"_selectMoveOptions":function(e,i){var o=this,r=t.Deferred();return csui.require(["csui/dialogs/node.picker/node.picker"],function(t){var a=!!e.container&&e.container.get("id")===e.nodes.models[0].get("id"),c=e.nodes.length,l=n.str.sformat(c>1?s.DialogTitleMove:s.DialogTitleSingleMove,c),u=n.extend({"command":"move","selectableTypes":[-1],"unselectableTypes":[899],"showAllTypes":!0,"orderBy":"type asc","dialogTitle":l,"initialContainer":e.container||e.nodes.models[0].parent,"initialSelection":e.nodes,"startLocation":a?"recent.containers":"","includeCombineProperties":1===c,"propertiesSeletor":!0,"globalSearch":!0,"context":i?i.context:e.context,"startLocations":["enterprise.volume","current.location","personal.volume","favorites","recent.containers"],"resolveShortcuts":!0,"resultOriginalNode":!0},e);o.nodePicker=new t(u),o.nodePicker.show().done(function(){r.resolve.apply(r,arguments)}).fail(function(){r.reject.apply(r,arguments)})},function(e){r.reject(e)}),r.promise()},"_resolveNamingConflicts":function(e,i){var t=1===i.length?s.MovingNode:n.str.sformat(s.MovingNodes,i.length);return new p({"h1Label":t,"actionBtnLabel":s.CommandNameMove,"excludeAddVersion":!0,"container":e,"files":i}).run()},"_metadataHandling":function(e,i){var n=t.Deferred();return csui.require(["csui/widgets/metadata/metadata.copy.move.items.controller"],function(t){var s,o=i.openSelectedProperties,r=i.applyProperties,a=new t;if(o)s=a.CopyMoveItemsWithMetadata;else{if(r!==v.APPLY_DESTINATION_PROPERTIES&&r!==v.COMBINE_ALL_PROPERTIES)return n.resolve();s=a.CopyMoveItemsRequiredMetadata}r===v.KEEP_ORIGINAL_PROPERTIES?i.inheritance="original":r===v.APPLY_DESTINATION_PROPERTIES?i.inheritance="destination":r===v.COMBINE_ALL_PROPERTIES&&(i.inheritance="merged"),i.action="move",s.call(a,e,i).done(function(){n.resolve()}).fail(function(e){n.reject(e)})},function(e){o.warn("Failed to load MetadataCopyMoveItemsController. {0}",e)&&console.warn(o.last),n.reject(e)}),n.promise()},"_moveSelectedNodes":function(e,i,o,r){var a=this,c=new f({"parallelism":m.parallelism}),u=n.map(e.models,function(e){var n=t.Deferred();return c.pending.add({"worker":function(){var t,s=e.attributes;return t=s.extended_data&&s.extended_data.roles?a._moveNodeWithMetadata(s,i,o.get("id"),r):a._moveNode(s,i,o.get("id"),r),t.done(function(){e.set("count",1),e.deferred.resolve(e),n.resolve(e)}).fail(function(i){var t=new l(i);e.deferred.reject(e,t),n.reject(t)}),n.promise()}}),n.promise(u)});return g.showFileUploadProgress(e,{"oneFileTitle":s.MovingOneItem,"oneFileSuccess":s.MoveOneItemSuccessMessage,"multiFileSuccess":s.MoveManyItemsSuccessMessage,"oneFilePending":s.MovingOneItem,"multiFilePending":s.MovingItems,"oneFileFailure":s.MoveOneItemFailMessage,"multiFileFailure":s.MoveManyItemsFailMessage2,"someFileSuccess":s.MoveSomeItemsSuccessMessage,"someFilePending":s.MovingSomeItems,"someFileFailure":s.MoveSomeItemsFailMessage2,"enableCancel":!1}),t.whenAll.apply(t,u)},"_moveNodeWithMetadata":function(e,i,n,s){var o,a;return o={"parent_id":n,"name":e.newName?e.newName:e.name,"roles":e.extended_data.roles},a=i.extendAjaxOptions({"url":r.combine(i.connection.url.replace("/v1","/v2"),"/nodes/",e.id),"method":"PUT","data":i.formatAjaxData(o),"contentType":i.getAjaxContentType()}),t.ajax(a)},"_moveNode":function(e,i,n,s){return this._getCategories(i,e.id,n).then(function(o){var a,c,l;return a={},a[v.KEEP_ORIGINAL_PROPERTIES]="original",a[v.APPLY_DESTINATION_PROPERTIES]="destination",a[v.COMBINE_ALL_PROPERTIES]="merged",c={"parent_id":n,"name":e.newName?e.newName:e.name,"roles":{"categories":o[a[s]]}},l=i.extendAjaxOptions({"url":r.combine(i.connection.url.replace("/v1","/v2"),"/nodes/",e.id),"method":"PUT","data":i.formatAjaxData(c),"contentType":i.getAjaxContentType()}),t.ajax(l)})},"_getCategories":function(e,i,n){var s=e.extendAjaxOptions({"url":e.connection.url+"/forms/nodes/move?"+t.param({"id":i,"parent_id":n})});return t.ajax(s).then(function(e,i,n){var t=e.forms[1];return t&&t.data||{}})}})}),csui.define("csui/utils/commands/navigate",["module","csui/lib/underscore","csui/lib/jquery","csui/utils/log","csui/utils/base","csui/utils/commandhelper","csui/models/command","csui/models/node/node.model"],function(e,i,n,t,s,o,r,a){"use strict";var c=i.extend({"openInNewTab":!0},e.config());return r.extend({"defaults":{"signature":"Navigate"},"enabled":function(e){var i=o.getJustOneNode(e);return i&&140===i.get("type")},"execute":function(e,i){var n=o.getJustOneNode(e);return this._navigateTo(n,i)},"_navigateTo":function(e,i){function t(){o||(o=window),o.location.href=l||(r.match(/^[a-zA-Z]+:\/\//)?r:"http://"+r),o.focus(),u.resolve()}var o,r=e.get("url"),l=e.get("absoluteUrl"),u=n.Deferred();return c.openInNewTab&&(o=window.open("","_blank")),r?t():(e=new a({"id":e.get("id")},{"connector":e.connector}),e.fetch().done(function(){r=e.get("url"),t()}).fail(function(e){o&&o.close(),u.reject(new s.Error(e))})),u.promise()}})}),csui.define("csui/utils/commands/open.plugins/open.plugins",["csui/lib/underscore","csui/lib/backbone","csui/models/mixins/rules.matching/rules.matching.mixin","csui-ext!csui/utils/commands/open.plugins/open.plugins"],function(e,i,n,t){"use strict";var s=i.Model.extend({"defaults":{"sequence":100,"plugin":null},"constructor":function(e,n){i.Model.prototype.constructor.apply(this,arguments),this.makeRulesMatching(n)}});n.mixin(s.prototype);var o=i.Collection.extend({"model":s,"comparator":"sequence","constructor":function(e,n){i.Collection.prototype.constructor.call(this,e,n)},"findByNode":function(e,i){var n,t;i&&(n=i.openInNewTab,t=i.widgetOnly);var s=this.find(function(i){var s=i.get("plugin");return(!0!==t&&(s.openWindow||s.getUrl||s.getUrlQuery)||!1!==t&&!0!==n&&(s.openWidget||s.createWidget))&&i.matchRules(e,i.attributes)});return s&&s.get("plugin")}}),r=new o;return t&&r.add(e.chain(t).flatten(!0).map(function(i){return e.defaults({"plugin":new i.plugin},i)}).value()),r}),csui.define("csui/utils/commands/open",["module","require","csui/lib/underscore","csui/lib/jquery","csui/utils/url","csui/utils/commandhelper","csui/utils/commands/download","csui/utils/commands/open.plugins/open.plugins"],function(e,i,n,t,s,o,r,a){"use strict";var c,l=n.extend({"openInNewTab":null,"forceDownload":!1},e.config());return r.extend({"defaults":{"signature":"Open","command_key":["default","open","download","Download"],"scope":"single"},"enabled":function(e,i){if(!r.__super__.enabled.apply(this,arguments))return!1;var t=o.getJustOneNode(e);return n.contains([144,749,736],t.get("type"))},"execute":function(e,i){var n=o.getJustOneNode(e);if(n.original&&n.original.get("id")>0){var t=n.get("type");1===t?n=n.original:2===t&&n.set({"mime_type":n.original.get("mime_type")},{"silent":!0})}return this._openContent(n,i)},"_openContent":function(e,i){if(l.forceDownload)return this._downloadContent(e,i,"download");var n=a.findByNode(e,{"openInNewTab":l.openInNewTab});if(n){if(l.openInNewTab)return this._openWindow(n,e,window.open(""),i);if(n.widgetView)return this._openWidget(n.widgetView,e,i);var t=!1===l.openInNewTab?window:window.open("");return this._openWindow(n,e,t,i)}return this._downloadContent(e,i,"download")},"_openWidget":function(e,i,n){var s=t.Deferred();return csui.require(["csui/utils/commands/impl/full.page.modal/full.page.modal.view",e],function(e,t){new e({"view":new t({"context":n.context,"model":i})}).on("destroy",function(){s.resolve()}).show()},s.reject),s.promise()},"_openWindow":function(e,i,n,s){var o=t.Deferred(),r=this;return csui.require(["csui/utils/open.authenticated.page"],function(){c=arguments[0],(e.getUrl&&e.getUrl(i)||e.getUrlQuery(i)).then(function(t){return r._openURL(e,i,n,t,s)},function(e){return n!==window&&n.close(),o.reject(e),t.Deferred().reject()}).then(function(){n.focus(),o.resolve()})},o.reject),o.promise()},"_openURL":function(e,i,n,o,r){var a=i.connector||r.connector;return e.getUrl||(o=s.appendQuery(new s(a.connection.url).getCgiScript(),s.combineQueryString(o))),e.needsAuthentication&&e.needsAuthentication(i)?c(a,o,{"window":n,"openInNewTab":l.openInNewTab}):(n.location.href=o,t.Deferred().resolve().promise())}})}),csui.define("csui/utils/commands/open.discussion",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i){return i.extend({"defaults":{"signature":"OpenDiscussion"},"enabled":function(i){var n=e.getJustOneNode(i);return n&&215===n.get("type")},"getUrlQueryParameters":function(e,i){return{"func":"ll","objAction":"view","objId":e.get("id"),"nexturl":location.href}}})}),csui.define("csui/utils/commands/open.form",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i){return i.extend({"defaults":{"signature":"OpenForm"},"enabled":function(i){var n=e.getJustOneNode(i);return n&&223===n.get("type")},"getUrlQueryParameters":function(e,i){return{"func":"ll","objAction":"EditForm","objId":e.get("id"),"nexturl":location.href}}})}),csui.define("csui/utils/commands/open.milestone",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i){return i.extend({"defaults":{"signature":"OpenMilestone"},"enabled":function(i){var n=e.getJustOneNode(i);return n&&212===n.get("type")},"getUrlQueryParameters":function(e,i){return{"func":"ll","objAction":"BrowseMilestone","objId":e.get("id"),"nexturl":location.href}}})}),csui.define("csui/utils/commands/open.channel",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i){return i.extend({"defaults":{"signature":"OpenChannel"},"enabled":function(i){var n=e.getJustOneNode(i);return n&&207===n.get("type")},"getUrlQueryParameters":function(e,i){return{"func":"ll","objAction":"ViewChannel","objId":e.get("id"),"nexturl":location.href}}})}),csui.define("csui/utils/commands/open.news",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i){return i.extend({"defaults":{"signature":"OpenNews"},"enabled":function(i){var n=e.getJustOneNode(i);return n&&208===n.get("type")},"getUrlQueryParameters":function(e,i){return{"func":"ll","objAction":"ViewNews","objId":e.get("id"),"nexturl":location.href}}})}),
csui.define("csui/utils/commands/open.poll",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i){return i.extend({"defaults":{"signature":"OpenPoll"},"enabled":function(i){var n=e.getJustOneNode(i);return n&&218===n.get("type")},"getUrlQueryParameters":function(e,i){return{"func":"ll","objAction":"OpenPoll","objId":e.get("id"),"nexturl":location.href}}})}),csui.define("csui/utils/commands/open.prospector",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i){return i.extend({"defaults":{"signature":"OpenProspector"},"enabled":function(i){var n=e.getJustOneNode(i);return n&&384===n.get("type")},"getUrlQueryParameters":function(e,i){return{"func":"ll","objAction":"ProspectorBrowse","objId":e.get("id"),"order":"-SCORE","summaries":1,"nexturl":location.href}}})}),csui.define("csui/utils/commands/open.specific.classic.page",["csui/utils/commands/open.classic.page","csui/utils/commandhelper","csui/utils/classic.nodes/classic.nodes"],function(e,i,n){"use strict";return e.extend({"defaults":{"signature":"OpenSpecificClassicPage"},"enabled":function(e){var t=i.getJustOneNode(e);if(t)return n.isSupported(t)},"getUrl":function(e,i){return n.getUrl(e)}})}),csui.define("csui/utils/commands/open.specific.node.perspective",["csui/utils/commands/open.node.perspective","csui/utils/commandhelper","csui/utils/smart.nodes/smart.nodes"],function(e,i,n){"use strict";return e.extend({"defaults":{"signature":"OpenSpecificNodePerspective"},"enabled":function(e){var t=i.getJustOneNode(e);if(t)return n.isSupported(t)}})}),csui.define("csui/utils/commands/open.task",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i){return i.extend({"defaults":{"signature":"OpenTask"},"enabled":function(i){var n=e.getJustOneNode(i);return n&&206===n.get("type")},"getUrlQueryParameters":function(e,i){return{"func":"ll","objAction":"BrowseTask","objId":e.get("id"),"nexturl":location.href}}})}),csui.define("csui/utils/commands/open.taskgroup",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i){return i.extend({"defaults":{"signature":"OpenTaskGroup"},"enabled":function(i){var n=e.getJustOneNode(i);return n&&205===n.get("type")},"getUrlQueryParameters":function(e,i){return{"func":"ll","objAction":"BrowseTaskGroup","objId":e.get("id"),"nexturl":location.href}}})}),csui.define("csui/utils/commands/open.tasklist",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i){return i.extend({"defaults":{"signature":"OpenTaskList"},"enabled":function(i){var n=e.getJustOneNode(i);return n&&204===n.get("type")},"getUrlQueryParameters":function(e,i){return{"func":"ll","objAction":"BrowseTaskList","objId":e.get("id"),"nexturl":location.href}}})}),csui.define("csui/utils/commands/open.topic",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i){return i.extend({"defaults":{"signature":"OpenTopic"},"enabled":function(i){var n=e.getJustOneNode(i),t=n&&n.get("type");return 130===t||134===t},"getUrlQueryParameters":function(e,i){return{"func":"ll","objAction":"view","objId":e.get("id"),"show":1,"nexturl":location.href}}})}),csui.define("csui/utils/commands/permissions",["module","require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/command.error","csui/utils/commandhelper","csui/models/command","csui/models/nodes"],function(e,i,n,t,s,o,r,a,c,l){"use strict";return c.extend({"defaults":{"signature":"permissions","command_key":["permissions","Permissions"],"scope":"multiple","commands":"csui/utils/commands"},"execute":function(e,i){var s,r=this,a=t.Deferred(),c=e.nodes,l=e.container,u=!0,d=e.originatingView?e.originatingView.$el.closest(".cs-metadata-navigation-wrapper"):[];c&&c.first()===l?(c=l,u=!1):(s=this._getAtLeastOneNode(e),c=c.first()),d.length>0&&d.addClass("cs-metadata-no-bg-color");var m=e.context||i&&i.context;return csui.require(["csui/widgets/metadata/impl/metadatanavigation/metadatanavigation.view","csui/widgets/metadata/metadata.view","csui/controls/dialog/dialog.view","csui/widgets/permissions/permissions.view",this.get("commands")],function(g,p,f,v,h){var w,b=(c.get("id"),e.data&&!!e.data.dialogView);if(e.originatingView instanceof g?(e.originatingView.mdv&&e.originatingView.mdv.model.get("shortcutNode")&&(c.attributes.shortcutNode=e.originatingView.mdv.model.get("shortcutNode")),w=new p({"model":c,"originatingView":e.originatingView,"containerCollection":e.collection,"context":m,"commands":h,"showCloseIcon":!e.originatingView,"showBackIcon":!e.originatingView,"activeTab":e.originatingView.mdv&&e.originatingView.mdv.metadataTabView&&e.originatingView.mdv.metadataTabView.options.activeTab,"selectedTab":e.originatingView.mdv&&e.originatingView.mdv.metadataTabView&&e.originatingView.mdv.metadataTabView.tabLinks.selected,"showPermissionView":!0})):u&&e.collection&&e.collection.models&&e.collection.models.length>0?w=new g({"container":l,"containerCollection":e.collection,"collection":s,"selected":c,"originatingView":e.originatingView,"context":m,"commands":h,"isExpandedView":e.originatingView&&!!e.originatingView.options.isExpandedView,"nameAttribute":i?i.nameAttribute:void 0,"showCloseIcon":!e.originatingView,"selectedTab":e.selectedTab,"showPermissionView":!0}):(e.originatingView&&void 0===e.originatingView.supportOriginatingView&&(e.originatingView.supportOriginatingView=!0),w=new p({"model":c,"originatingView":e.originatingView,"context":m,"commands":h,"showCloseIcon":!e.originatingView,"showBackIcon":!!e.originatingView,"selectedTab":e.selectedTab,"showPermissionView":!0})),e.originatingView instanceof g)e.originatingView.mdv&&e.originatingView.mdv.metadataTabView&&(e.originatingView.mdv.destroy(),e.originatingView.showPermissionView=!0,w.render(),o.triggerMethodOn(w,"before:show"),e.originatingView.$el.find(".metadata-content").append(w.el));else if(e.originatingView&&!b){var y,M,C=e.originatingView.$el;C.width();C.parent().append("<div class='cs-permissions-wrapper'></div>"),M=t(C.parent().find(".cs-permissions-wrapper")[0]),M.hide(),w.render(),o.triggerMethodOn(w,"before:show"),M.append(w.el),C.hide("blind",{"direction":"left","complete":function(){M.show("blind",{"direction":"right","complete":function(){o.triggerMethodOn(w,"show")}},100)}},100),C.promise().done(function(){e.originatingView.isDisplayed=!1}),y=function(){d.length>0&&d.removeClass("cs-metadata-no-bg-color"),M.hide("blind",{"direction":"right","complete":function(){C.show("blind",{"direction":"left","complete":function(){e.originatingView.triggerMethod("dom:refresh"),e.originatingView.isDisplayed=!0,!!e.collection&&(e.collection.requireSwitched=!1)}},100),w.destroy(),M.remove(),a.resolve()}},100)},r.listenTo(w,"metadata:close",n.bind(y,r)),r.listenTo(w,"metadata:close:without:animation",function(){C.show("blind",{"direction":"left","complete":function(){e.originatingView.triggerMethod("dom:refresh"),!!e.collection&&(e.collection.requireSwitched=!1)}},100),w.destroy(),M.remove(),a.resolve()})}else w.metadataTabView&&(w.metadataTabView.options.isExpandedView=!0),r.dialog=new f({"className":"cs-permissions","largeSize":!0,"view":w}),r.dialog.show(),r.dialog.ui.header.hide(),r.dialog.listenTo(w,"metadata:close",function(){r.dialog.destroy(),a.resolve()}),r.dialog.listenTo(w,"metadata:close:without:animation",function(){r.dialog.destroy(),a.resolve()})}),a.promise()},"_getAtLeastOneNode":function(e){return e.nodes?1===e.nodes.length&&e.collection?e.collection:e.nodes:new l}})}),csui.define("csui/utils/commands/properties",["module","require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/command.error","csui/utils/commandhelper","csui/models/command","csui/models/nodes"],function(e,i,n,t,s,o,r,a,c,l){"use strict";return c.extend({"defaults":{"signature":"Properties","command_key":["properties","Properties"],"scope":"multiple","commands":"csui/utils/commands"},"execute":function(e,i){var s,a=this,c=t.Deferred(),l=e.nodes,u=e.container,d=!0;l&&l.first()===u?(l=u,d=!1):s=this._getAtLeastOneNode(e);var m=e.context||i&&i.context,g=e.originatingView||i&&i.originatingView;return csui.require(["csui/widgets/metadata/impl/metadatanavigation/metadatanavigation.view","csui/widgets/metadata/metadata.view","csui/controls/dialog/dialog.view","csui/models/nodeversions",this.get("commands")],function(r,p,f,v,h){var w,b=e.data&&!!e.data.dialogView;if(d?e.collection&&e.collection.models&&e.collection.models.length>0?w=new r({"container":u,"containerCollection":e.collection,"collection":s,"selected":l,"originatingView":g,"context":m,"commands":h,"nameAttribute":i?i.nameAttribute:void 0,"showCloseIcon":!g,"selectedTab":e.selectedTab,"selectedProperty":e.selectedProperty,"showThumbnails":e.showThumbnails}):(g&&void 0===g.supportOriginatingView&&(g.supportOriginatingView=!0),w=new p({"model":l.get("id")?l:l.models[0],"originatingView":g,"context":m,"commands":h,"showCloseIcon":!g,"showBackIcon":!!g,"selectedTab":e.selectedTab,"selectedProperty":e.selectedProperty})):(g&&void 0===g.supportOriginatingView&&(g.supportOriginatingView=!0),w=new p({"model":l,"originatingView":g,"context":m,"commands":h,"showCloseIcon":!g,"showBackIcon":!!g,"selectedTab":e.selectedTab,"selectedProperty":e.selectedProperty})),g instanceof r&&!(e.collection instanceof v))g.mdv&&g.mdv.metadataTabView&&(w=null,g.showPermissionView=!1,g._showNode(l.get("id")?l:l.models[0]));else if(g&&!b){g.triggerMethod("metadata:created",w);var y,M,C=g.$el;C.width();C.parent().append("<div class='cs-properties-wrapper'></div>"),C.parent().addClass("csui-node-properties-wrapper"),M=t(C.parent().find(".cs-properties-wrapper")[0]),M.hide(),w.render(),o.triggerMethodOn(w,"before:show"),M.append(w.el),C.hide("blind",{"direction":"left","complete":function(){M.show("blind",{"direction":"right","complete":function(){o.triggerMethodOn(w,"show")}},100)}},100),C.promise().done(function(){g.isDisplayed=!1}),y=function(){M.hide("blind",{"direction":"right","complete":function(){C.show("blind",{"direction":"left","complete":function(){g.triggerMethod("dom:refresh"),g.isDisplayed=!0,!!e.collection&&(e.collection.requireSwitched=!1),g.trigger("properties:view:destroyed")}},100),C.parent().removeClass("csui-node-properties-wrapper"),w.destroy(),M.remove(),c.resolve()}},100)},a.listenTo(w,"metadata:close",n.bind(y,a)),a.listenTo(w,"metadata:close:without:animation",function(){C.show("blind",{"direction":"left","complete":function(){g.triggerMethod("dom:refresh"),!!e.collection&&(e.collection.requireSwitched=!1)}},100),w.destroy(),M.remove(),c.resolve()})}else a.dialog=new f({"className":"cs-properties","largeSize":!0,"view":w}),a.dialog.show(),a.dialog.ui.header.hide(),a.dialog.listenTo(w,"metadata:close",function(){a.dialog.destroy(),c.resolve()}),a.dialog.listenTo(w,"metadata:close:without:animation",function(){a.dialog.destroy(),c.resolve()})},function(e){c.reject(new r(e))}),c.promise()},"_getAtLeastOneNode":function(e){return e.nodes?1===e.nodes.length&&e.collection?e.collection:e.nodes:new l}})}),csui.define("csui/utils/commands/rename",["csui/models/command","csui/utils/commandhelper"],function(e,i){return e.extend({"defaults":{"signature":"Rename","command_key":["rename","Rename"],"scope":"single"},"rename":function(e,i){return e.save({"name":i},{"wait":!0,"patch":!0})},"execute":function(e,i){throw new Error("The 'Rename' action must be handled by the caller.")}})}),csui.define("csui/utils/commands/rename.favorite",["require","csui/lib/underscore","csui/lib/jquery","csui/models/command","csui/utils/commandhelper"],function(e,i,n,t,s){"use strict";var o=t.extend({"defaults":{"signature":"FavoriteRename","command_key":["favorite_rename"],"scope":"single"},"execute":function(e,i){var t=n.Deferred();return csui.require(["csui/controls/table/inlineforms/favorite/favorite.view"],function(i){var n=e.nodes&&1===e.nodes.length&&e.nodes.at(0);n.inlineFormView=i,n.set("csuiInlineFormErrorMessage","dummy",{"silent":!0}),n.unset("csuiInlineFormErrorMessage"),t.resolve()},function(e){t.reject(e)}),t.promise()}});return i.extend(o,{"version":"1.0"}),o}),csui.define("csui/utils/commands/reserve",["require","module","csui/lib/underscore","csui/lib/jquery","i18n!csui/utils/commands/nls/lang","i18n!csui/utils/commands/nls/localized.strings","csui/utils/commandhelper","csui/utils/commands/node"],function(e,i,n,t,s,o,r,a){"use strict";var c=i.config();return n.defaults(c,{"parallelism":2}),a.extend({"defaults":{"signature":"ReserveDoc","command_key":["reserve","ReserveDoc"],"name":s.CommandNameReserve,"verb":o.CommandVerbReserve,"pageLeavingWarning":o.ReservePageLeavingWarning,"scope":"multiple","successMessages":{"formatForNone":s.ReserveItemsNoneMessage,"formatForOne":s.ReserveOneItemSuccessMessage,"formatForTwo":s.ReserveSomeItemsSuccessMessage,"formatForFive":s.ReserveManyItemsSuccessMessage},"errorMessages":{"formatForNone":s.ReserveItemsNoneMessage,"formatForOne":s.ReserveOneItemFailMessage,"formatForTwo":s.ReserveSomeItemsFailMessage,"formatForFive":s.ReserveManyItemsFailMessage}},"_performAction":function(e,i){var n=t.Deferred();return e.isReservedClicked=!0,csui.require(["csui/utils/contexts/factories/user"],function(t){var s=i.context.getModel(t);s.ensureFetched().then(function(){return r.updateNode(e,{"reserved_user_id":s.get("id")})}).then(n.resolve,n.reject)},n.reject),n.promise()}})}),csui.define("csui/utils/commands/run.livereport",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i){return i.extend({"defaults":{"signature":"RunLiveReport"},"enabled":function(i){var n=e.getJustOneNode(i);return n&&299===n.get("type")},"getUrlQueryParameters":function(e,i){return{"func":"ll","objAction":"RunReport","objId":e.get("id"),"nexturl":location.href}}})}),csui.define("csui/utils/commands/sign.out",["module","require","csui/lib/underscore","csui/lib/jquery","csui/models/command","csui/utils/commandhelper","csui/utils/url","i18n!csui/utils/commands/nls/localized.strings"],function(e,i,n,t,s,o,r,a){"use strict";var c,l,u=n.extend({"signInPageUrl":"signin.html"},e.config());return s.extend({"defaults":{"signature":"SignOut","name":a.SignOutCommandName},"enabled":function(e,i){return!0},"execute":function(e,i){var n=t.Deferred(),s=e.context||i&&i.context,o=this;return csui.require(["csui/utils/contexts/factories/connector","csui/pages/start/impl/perspective.router"],function(){c=arguments[0],l=arguments[1],o._signOut(s).done(n.resolve).fail(n.reject)},n.reject),n.promise()},"_signOut":function(e){var i=e.getObject(c),n=new r(i.connection.url).getCgiScript();if(l.routesWithSlashes())return t.ajax(i.extendAjaxOptions({"url":r.combine(n,"api/v1/auth/logouttoken")})).then(function(e){i.authenticator.unauthenticate({"reason":"logged-out"}),location.href=n+"?func=csui.dologout&secureRequestToken="+encodeURIComponent(e.token)});i.authenticator.unauthenticate({"reason":"logged-out"});var s=u.signInPageUrl,o=location.search;return o+=o?"&":"?",o+="nextUrl="+encodeURIComponent(location.pathname),location.href=s+o+location.hash,t.Deferred().resolve().promise()}})}),csui.define("csui/utils/commands/switch.to.classic",["module","require","csui/lib/underscore","csui/lib/jquery","csui/models/command","csui/utils/commandhelper","csui/utils/url","i18n!csui/utils/commands/nls/localized.strings","csui/utils/commands/open.classic.page"],function(e,i,n,t,s,o,r,a,c){"use strict";var l,u,d=n.extend({"enabled":!0,"openInNewTab":null},e.config());return null==d.openInNewTab&&(d.openInNewTab=c.openInNewTab),s.extend({"defaults":{"signature":"SwitchToClassic","name":a.SwitchToClassicCommandName},"enabled":function(e,i){if(!d.enabled)return!1;var n=e.context||i&&i.context,t=n.getModel("applicationScope");return""===(t=t&&t.get("id"))||"node"===t},"execute":function(e,i){var n=t.Deferred(),s=e.context||i&&i.context,o=d.openInNewTab&&window.open("","_blank")||window,r=this;return o.focus(),csui.require(["csui/utils/contexts/factories/connector","csui/utils/contexts/factories/node"],function(){l=arguments[0],u=arguments[1],o.location.href=r._getUrl(s,e),n.resolve()},n.reject),n.promise()},"_getUrl":function(e,i){var n=e.getObject(l),t=new r(n.connection.url).getCgiScript(),s=this._getUrlQueryParameters(e,i),o=r.combineQueryString(s);return r.appendQuery(t,o)},"_getUrlQueryParameters":function(e,i){var n,t=o.getJustOneNode(i)||e.getModel(u);return void 0!==t&&t.get("id")>0?(n={"func":"ll","objId":t.get("id")},t.get("container")?(n.objAction="browse",n.viewType=1):n.objAction="properties"):n={},n}})}),csui.define("csui/utils/commands/unreserve",["i18n!csui/utils/commands/nls/lang","i18n!csui/utils/commands/nls/localized.strings","csui/utils/commandhelper","csui/utils/commands/node"],function(e,i,n,t){"use strict";return t.extend({"defaults":{"signature":"UnreserveDoc","command_key":["unreserve","UnreserveDoc"],"name":e.CommandNameUnreserve,"verb":i.CommandVerbUnreserve,"pageLeavingWarning":i.UnreservePageLeavingWarning,"scope":"multiple","successMessages":{"formatForNone":e.UnreserveItemsNoneMessage,"formatForOne":e.UnreserveOneItemSuccessMessage,"formatForTwo":e.UnreserveSomeItemsSuccessMessage,"formatForFive":e.UnreserveManyItemsSuccessMessage},"errorMessages":{"formatForNone":e.UnreserveItemsNoneMessage,"formatForOne":e.UnreserveOneItemFailMessage,"formatForTwo":e.UnreserveSomeItemsFailMessage,"formatForFive":e.UnreserveManyItemsFailMessage}},"_performAction":function(e,i){return e.isUnreservedClicked=!0,n.updateNode(e,{"reserved_user_id":null})}})}),csui.define("csui/utils/commands/user.profile",["require","csui/lib/jquery","csui/models/command","csui/utils/base","i18n!csui/utils/commands/nls/localized.strings"],function(e,i,n,t,s){"use strict";return n.extend({"defaults":{"signature":"UserProfile","name":s.UserProfileCommandName},"enabled":function(e,i){var n=e.toolItem||i&&i.toolItem;if(n){var s=e.context||i&&i.context,o=s.getModel("user"),r=t.formatMemberName(o);n.set("name",r)}return!0},"execute":function(e,n){var t=i.Deferred(),s=e.context||n&&n.context;return csui.require(["csui/utils/contexts/factories/user","esoc/controls/userwidget/userwidget.view"],function(e,i){var n=s.getModel(e),o=n.get("id");new i({"model":n,"connector":n.connector,"userid":o,"context":s,"baseElement":void 0,"showUserProfileLink":!0,"showMiniProfile":!1,"loggedUserId":o}).showUserProfileDialog(),t.resolve()},t.reject),t.promise()}})}),csui.define("csui/utils/commands/versions/delete",["require","module","csui/lib/underscore","csui/lib/jquery","i18n!csui/utils/commands/versions/nls/localized.strings","csui/utils/commandhelper","csui/utils/commands/delete"],function(e,i,n,t,s,o,r){"use strict";var a=r.extend({"defaults":{"signature":"VersionDelete","command_key":["versions_delete"],"name":s.CommandNameVersionDelete,"verb":s.CommandVerbVersionDelete,"pageLeavingWarning":s.DeleteVersionPageLeavingWarning,"scope":"multiple","successMessages":{"formatForNone":s.DeleteVersionItemsNoneMessage,"formatForOne":s.DeleteVersionOneItemSuccessMessage,"formatForTwo":s.DeleteVersionSomeItemsSuccessMessage,"formatForFive":s.DeleteVersionManyItemsSuccessMessage},"errorMessages":{"formatForNone":s.DeleteVersionItemsNoneMessage,"formatForOne":s.DeleteVersionOneItemFailMessage,"formatForTwo":s.DeleteVersionSomeItemsFailMessage,"formatForFive":s.DeleteVersionManyItemsFailMessage}},"enabled":function(e,i){if(!a.__super__.enabled.apply(this,arguments))return!1;var n=o.getAtLeastOneNode(e);return n.length>0&&e.container&&e.container.versions&&e.container.versions.allModels&&n.length<e.container.versions.allModels.length},"_getConfirmData":function(e,i){var t=o.getAtLeastOneNode(e);return e.originatingView.blockActions=!1,{"title":s.DeleteCommandConfirmDialogTitle,"message":1===t.length?n.str.sformat(s.VersionDeleteCommandConfirmDialogSingleMessage,t.at(0).get("version_number_name"),e.container.get("name")):n.str.sformat(s.VersionDeleteCommandConfirmDialogMultipleMessage,t.length)}},"startGlobalMessage":function(e){csui.require(["csui/controls/globalmessage/globalmessage"],function(i){i.showFileUploadProgress(e,{"oneFileTitle":s.DeletingOneVersion,"oneFileSuccess":s.DeleteVersionOneItemSuccessMessage,"multiFileSuccess":s.DeleteVersionManyItemsSuccessMessage,"oneFilePending":s.DeletingOneVersion,"multiFilePending":s.DeleteVersions,"oneFileFailure":s.DeleteVersionOneItemFailMessage,"multiFileFailure":s.DeleteVersionManyItemsFailMessage2,"someFileSuccess":s.DeleteVersionSomeItemsSuccessMessage,"someFilePending":s.DeletingSomeVersions,"someFileFailure":s.DeleteVersionSomeItemsFailMessage2,"enableCancel":!1})})}});return a}),csui.define("csui/utils/commands/versions/download",["csui/utils/commands/download","csui/utils/url","i18n!csui/utils/commands/nls/localized.strings"],function(e,i,n){"use strict";return e.extend({"defaults":{"signature":"VersionDownload","command_key":["versions_download"],"name":n.CommandNameDownload,"verb":n.CommandVerbDownload,"doneVerb":n.CommandDoneVerbDownload,"scope":"single"},"_getContentUrl":function(e,n,t,s){return i.combine(e.connector.connection.url,"nodes",e.get("id"),"versions",e.get("version_number"),"content")+"?action="+t+"&token="+encodeURIComponent(s)}})}),csui.define("csui/utils/commands/versions/open",["csui/utils/commands/open","csui/utils/url"],function(e,i){"use strict";return e.extend({"defaults":{"signature":"VersionOpen","command_key":["versions_open"],"scope":"single"},"_getContentUrl":function(e,n,t,s){return i.combine(e.connector.connection.url,"nodes",e.get("id"),"versions",e.get("version_number"),"content")+"?action="+t+"&token="+encodeURIComponent(s)}})}),csui.define("csui/utils/commands/versions/properties",["csui/utils/commands/properties","csui/models/version"],function(e,i){"use strict";return e.extend({"defaults":{"signature":"VersionProperties","command_key":"versions_properties","scope":"multiple","commands":"csui/utils/commands/versions"},"_getAtLeastOneNode":function(e){return e.collection&&1===e.nodes.length?e.collection:e.nodes}})}),csui.define("csui/utils/commands/versions",["csui/lib/underscore","csui/models/commands","csui/utils/commands/versions/delete","csui/utils/commands/versions/download","csui/utils/commands/versions/open","csui/utils/commands/versions/properties","csui-ext!csui/utils/commands/versions"],function(e,i,n,t,s,o,r){"use strict";var a=new i([new n,new t,new s,new o]);return r&&a.add(e.chain(r).flatten(!0).map(function(e){return new e}).value()),a}),csui.define("csui/utils/commands/filter",["module","csui/lib/underscore","csui/lib/jquery","csui/utils/log","csui/utils/base","csui/utils/commandhelper","csui/models/command"],function(e,i,n,t,s,o,r){"use strict";return r.extend({"defaults":{"signature":"Filter"},"enabled":function(i){return!1!==e.config().enabled&&(!(!i.container||!i.container.get("container"))&&this._isSupported(i.container))},"_isSupported":function(e){var i=[136,298];return-1===n.inArray(e.get("type"),i)},"execute":function(e,i){throw new Error("The 'Filter' action must be handled by the caller.")}})}),csui.define("csui/utils/commands/description.toggle",["require","csui/lib/jquery","csui/utils/base","csui/lib/underscore","i18n!csui/utils/commands/nls/localized.strings","csui/utils/commandhelper","csui/utils/commands/node","csui/utils/command.error"],function(e,i,n,t,s,o,r,a){"use strict";var c=/\baccessibleTable\b(?:=([^&]*)?)?/i.exec(location.search);return c=c&&"false"!==c[1],r.extend({"defaults":{"signature":"ToggleDescription","command_key":["description","description"],"scope":"single","name":s.CommandDescriptionToggle},"enabled":function(e,i){return!(c||!e.collection||e.thumbnailViewState)&&(e.originatingView&&e.originatingView.options.showDescriptions&&(e.toolItem.attributes.icon="icon icon-description-toggle icon-description-shown",e.toolItem.attributes.name=s.CommandHideDescription),void 0!==e.collection.find(function(e){return!!e.get("description")}))},"execute":function(e,i){var n,t=e.originatingView;t.options.showDescriptions?(t.options.showDescriptions=!1,n=s.CommandShowDescription,t.$el.find(".icon-description-toggle").addClass("icon-description-hidden").removeClass("icon-description-shown").parent().attr("title",n).attr("aria-label",n)):(t.options.showDescriptions=!0,n=s.CommandHideDescription,t.$el.find(".icon-description-toggle").removeClass("icon-description-hidden").addClass("icon-description-shown").parent().attr("title",n).attr("aria-label",n)),t.$el.find('.csui-configuration-view .binf-dropdown-menu li[data-csui-command="toggledescription"] a').attr("title",n).contents().first().replaceWith(n),t.trigger("csui.description.toggled",{"showDescriptions":t.options.showDescriptions})}})}),csui.define("csui/utils/commands/thumbnail.toggle",["module","require","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/underscore","csui/models/command","i18n!csui/utils/commands/nls/localized.strings"],function(e,i,n,t,s,o,r,a){"use strict";var c=e.config();o.defaults(c,{"enableGridView":!1});return r.extend({"defaults":{"signature":"Thumbnail","command_key":["thumbnail","thumbnail"],"scope":"single","name":"Thumbnail"},"enabled":function(e,i){return!(!e.collection||!c.enableGridView)&&(e.thumbnailViewState&&(e.toolItem.attributes.icon="icon icon-switch_list",e.toolItem.attributes.name=a.ListViewTitle,e.toolItem.attributes.title=a.ListViewTitle),!0)},"execute":function(e,i){var n,t=e.originatingView||i&&i.originatingView;t.thumbnailViewState?(n=a.ThumbnailTitle,t.$el.find(".binf-glyphicon-th-list").removeClass("binf-glyphicon-th-list").addClass("binf-glyphicon-th-large"),t.$el.find(".binf-glyphicon-th-large").parent().attr("title",n).attr("aria-label",n)):(n=a.ListViewTitle,t.$el.find(".binf-glyphicon-th-large").addClass("binf-glyphicon-th-list").removeClass("binf-glyphicon-th-large"),t.$el.find(".binf-glyphicon-th-list").parent().attr("title",n).attr("aria-label",n)),t.$el.find('.csui-configuration-view .binf-dropdown-menu li[data-csui-command="thumbnail"] a').attr("title",n).contents().first().replaceWith(n)}})}),csui.define("csui/utils/commands/save.filter",["module","require","csui/lib/underscore","csui/lib/jquery","i18n!csui/utils/commands/nls/localized.strings","csui/utils/log","csui/utils/url","csui/models/command","csui/models/node/node.model","csui/utils/node.links/node.links"],function(e,i,n,t,s,o,r,a,c,l){"use strict";var u=e.config();n.defaults(u,{"parallelism":3});var d,m,g,p,f,v,h;return a.extend({"defaults":{"signature":"SaveFilter","command_key":["savefilter","SaveFilter"],"name":s.CommandNameSaveFilter,"verb":s.CommandVerbSaveFilter},"execute":function(e,i){var o=this,r=t.Deferred(),a=e.context||i&&i.context;return e.suppressSuccessMessage=!0,csui.require(["csui/controls/globalmessage/globalmessage","csui/dialogs/modal.alert/modal.alert","csui/controls/conflict.resolver/conflict.resolver","csui/utils/taskqueue","csui/utils/page.leaving.blocker","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/next.node"],function(){d=arguments[0],m=arguments[1],g=arguments[2],p=arguments[3],f=arguments[4],v=arguments[5],h=arguments[6],o._selectSaveFilterOptions(e,i).done(function(i){var o=e.nodes,u=e.facets,m=i.nodes[0],g=i.filterName,p=e.connector.connection.url.replace("/v1","/v2"),f=[];t.each(u.filters,function(e,i){var n=[],s=[];i.values instanceof Array&&(t.each(i.values,function(e,i){n.push(i.id)}),s.push(i.id),s.push(n),f.push(s))});var w={"type":899,"location_id":o.models[0].get("id"),"name":g,"parent_id":m.get("id"),"selected_facets":f},b=(new FormData,e.connector.extendAjaxOptions({"url":p+"/nodes","type":"POST","data":"body="+encodeURIComponent(JSON.stringify(w)),"contentType":"application/x-www-form-urlencoded"}));t.ajax(b).done(function(e){r.resolve(e.results);var i=e.results.data.properties.id,t=new c({"id":i},{"connector":a.getObject(v)}),o=e.results.data.properties.name,u=n.str.sformat(s.SaveFilterCommandSuccessfully,o),m={"context":a,"nextNodeModelFactory":h,"link_url":l.getUrl(t),"targetFolder":t};d.showMessage("success_with_link",u,void 0,m)}).fail(function(e){if(r.reject(e),e&&e.responseText){var i=JSON.parse(e.responseText);d.showMessage("error",i.error)}})}).fail(function(e){r.reject(e)})},function(e){r.reject(e)}),r.promise()},"_selectSaveFilterOptions":function(e,i){var o=this,r=t.Deferred();return csui.require(["csui/dialogs/node.picker/node.picker"],function(t){var a=e.nodes.length,c=n.extend({"command":"savefilter","selectableTypes":[-1],"showAllTypes":!0,"orderBy":"type asc","dialogTitle":s.DialogTitleSaveFilter,"initialContainer":e.container||e.nodes.models[0].parent,"initialSelection":e.nodes,"startLocation":"","includeCombineProperties":1===a,"propertiesSeletor":!1,"saveFilter":!0,"globalSearch":!0,"context":i?i.context:e.context,"startLocations":["enterprise.volume","current.location","personal.volume","favorites","recent.containers"],"resolveShortcuts":!0,"resultOriginalNode":!0},e);o.nodePicker=new t(c),o.nodePicker.show().done(function(){r.resolve.apply(r,arguments)}).fail(function(e){r.reject.apply(r,arguments)})},function(e){r.reject(e)}),r.promise()}})}),csui.define("csui/utils/commands/maximize.widget.view",["require","csui/lib/jquery","csui/utils/base","csui/lib/underscore","i18n!csui/utils/commands/nls/localized.strings","csui/utils/commandhelper","csui/models/command"],function(e,i,n,t,s,o,r){"use strict";return r.extend({"defaults":{"signature":"MaximizeWidgetView","scope":"single"},"enabled":function(e,n){return i("body").hasClass("csui-support-maximize-widget")&&!1===i("body").hasClass("csui-maximized-widget-mode")},"execute":function(e,i){e.context.trigger("maximize:widget",{"widgetView":e.originatingView})}})}),csui.define("csui/utils/commands/restore.widget.size",["require","csui/lib/jquery","csui/utils/base","csui/lib/underscore","i18n!csui/utils/commands/nls/localized.strings","csui/utils/commandhelper","csui/models/command"],function(e,i,n,t,s,o,r){"use strict";return r.extend({"defaults":{"signature":"RestoreWidgetViewSize","scope":"single"},"enabled":function(e,n){return!this.checkMaximizeMode(e)&&(i("body").hasClass("csui-support-maximize-widget")&&!0===i("body").hasClass("csui-maximized-widget-mode"))},"checkMaximizeMode":function(e){return e&&e.context&&e.context.perspective&&e.context.perspective.get("showWidgetInMaxMode")},"execute":function(e,i){e.context.trigger("restore:widget:size",{"widgetView":e.originatingView})}})}),csui.define("csui/utils/commands/permissions/apply.permission",["module","require","csui/lib/underscore","csui/lib/jquery","csui/models/command","csui/utils/commandhelper","i18n!csui/utils/commands/nls/localized.strings"],function(e,i,n,t,s,o,r){"use strict";n.extend({},e.config());return s.extend({"defaults":{"signature":"ApplyPermission"},"enabled":function(e){o.getJustOneNode(e);return!1},"execute":function(e,i){var n=t.Deferred();return csui.require(["csui/controls/globalmessage/globalmessage"],function(e){n.resolve(),e.showMessage("success","Applied permissions to sub-items")},n.reject),n.promise()}})}),csui.define("csui/utils/commands/permissions/edit.permission",["module","require","csui/lib/underscore","csui/lib/backbone","csui/lib/jquery","csui/utils/base","csui/models/command","csui/utils/commandhelper","csui/utils/command.error","i18n!csui/utils/commands/nls/localized.strings"],function(e,i,n,t,s,o,r,a,c,l){"use strict";n.extend({},e.config());return r.extend({"defaults":{"signature":"EditPermission"},"enabled":function(e){var i=e.model,n=i&&i.collection,t=i&&i.get("right_id"),s=i&&i.get("type");return!e.filterId&&s&&(t||"public"===s)&&n&&n.options&&n.options.node&&!!n.options.node.get("id")&&(n.options.authenticatedUserPermissions&&n.options.authenticatedUserPermissions.hasEditPermissionRights()||e.admin_permissions)},"execute":function(e,i){var o=this,r=s.Deferred(),a=e.model,u=a.collection,d=e.targetView;o.targetView=d,e.suppressFailMessage=!0,e.suppressSuccessMessage=!0
;var m=this._getMessageWithUserDisplayName(l.EditPermissionCommandFailMessage,a);return u?(a.nodeId=u.options&&u.options.node&&u.options.node.get("id"),csui.require(["csui/widgets/permissions/impl/edit/edit.permission.helper","csui/utils/contexts/factories/user","csui/controls/globalmessage/globalmessage"],function(i,s,d){var m=e.originatingView.context.getModel(s);o.loginUserId=m.get("id"),o.editPermissionHelper=new i({"permissionModel":a,"popoverPlacement":"left","popoverAtBodyElement":!e.originatingView||!e.originatingView.options.isExpandedView,"popoverTragetElement":e.targetView.permissions.$el,"readonly":!1,"originatingView":e.originatingView,"applyTo":e.applyTo}),o.editPermissionHelper.listenTo(o.editPermissionHelper,"permissions:selected",function(e){var i={"permissions":e.permissions,"apply_to":e.apply_to,"include_sub_types":e.apply_to>0?[204,207,215,298,3030202]:[]};e.right_id&&(i.right_id=e.right_id),a.save(i,{"patch":!0,"wait":!0,"silent":!0}).done(function(e){u.options.authenticatedUserPermissions.fetch().done(function(){a.set(i,{"silent":!0}),o.editPermissionHelper.destroy(),o.editPermissionHelper.unblockActions(),r.resolve()}).fail(function(e){var i=e?new c(e,a):e;r.reject(a,i)});var s;e.results.success>0&&0===e.results.failure?s=n.str.sformat(1===e.results.success?l.AppliedPermissionsOneSuccess:l.AppliedPermissionsOnlySuccess,e.results.success):e.results.success>0&&e.results.failure>0?s=n.str.sformat(l.AppliedPermissionsSuccessAndFailure,e.results.success,e.results.failure):0===e.results.success&&e.results.failure>0&&(s=n.str.sformat(1===e.results.failure?l.AppliedPermissionsOneFailure:l.AppliedPermissionsOnlyFailure,e.results.failure));for(var m=t.Model.extend({"defaults":{"name":"","state":"pending","commandName":"ViewPermission"}}),g=[],p=t.Collection.extend({"model":m}),f=new p,v=0;e.results.failure>0&&v<e.results.data.length;v++)g[v]=new m({"name":e.results.data[v].name,"mime_type":"","state":"rejected"}),f.add(g[v]);var h=e.results.success>0&&e.results.failure>0?e.results.success:"",w=n.str.sformat(l.ApplyingManyItemsSuccessMessage,h),b=h>0?w:" ";e.results.failure>0&&d.showPermissionApplyingProgress(f,{"oneFileFailure":b+l.ApplyingOneItemFailMessage,"someFileFailure":b+n.str.sformat(l.ApplyingManyItemsFailMessage2,g.length),"multiFileFailure":b+n.str.sformat(l.ApplyingManyItemsFailMessage2,g.length)}),e.results.success>0&&e.results.failure<=0&&d.showMessage("success",s||l.AppliedPermissions)}).fail(function(e){var i=e?new c(e,a):e;d.showMessage("error",i),r.reject(a,i)})}),o.editPermissionHelper.listenTo(o.editPermissionHelper,"closed:permission:level:popover",function(){r.reject(a)})}),r.promise()):r.reject(new c(m,{"errorDetails":l.undefinedCollection}))},"_getMessageWithUserDisplayName":function(e,i){var t;return i.get("right_id_expand")?t=o.formatMemberName(i.get("right_id_expand")):"public"===i.get("type")&&(t=l.publicAccess),n.str.sformat(e,t)}})}),csui.define("csui/utils/commands/permissions/change.owner.permission",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/models/command","csui/utils/command.error","i18n!csui/utils/commands/nls/localized.strings"],function(e,i,n,t,s,o,r){"use strict";i.extend({},e.config());return s.extend({"defaults":{"signature":"ChangeOwnerPermission","scope":"single"},"enabled":function(e){var i=e.model,n=i&&i.collection,t=i&&i.get("type"),s=t&&("owner"===t&&null!==i.get("permissions")||"group"===t)&&n&&n.options&&n.options.node&&n.options.node.get("id")&&(n.options.authenticatedUserPermissions&&n.options.authenticatedUserPermissions.hasEditPermissionRights()||e.admin_permissions),o=s&&"owner"===t?r.ChangeOwnerPermissionCommand:r.ChangeOwnerGroupPermissionCommand;return"group"===t&&e.toolItem.attributes&&e.toolItem.attributes.icon&&(e.toolItem.attributes.icon="icon icon-group-change"),e.toolItem&&e.toolItem.set("name",o),s},"execute":function(e,s){var a=n.Deferred(),c=e.model,l=c.get("type"),u=c.collection,d=c.get("right_id_expand"),m=e.targetView.$el,g=this;if(g.targetView=e.originatingView.permissionsContentView,!u){var p=i.str.sformat(r.EditPermissionCommandFailMessage,r.Owner);return a.reject(new o(p,{"errorDetails":r.undefinedCollection}))}return c.nodeId=u.options&&u.options.node&&u.options.node.get("id"),csui.require(["csui/controls/table/inlineforms/permissions/user.picker/user.picker.view","csui/utils/contexts/factories/member","csui/models/permission/nodepermission.model","csui/utils/contexts/factories/user"],function(i,n,s,r){var p=e.originatingView.context.getModel(r);g.loginUserId=p.get("id");var f=e.context.getModel(n),v=new i({"context":e.options?e.options.context:e.context,"userPickerModel":f,"currentRow":m,"connector":e.connector,"memberFilter":{"type":"owner"===l?[0]:[1]}});m.addClass("csui-changeowner-permission"),m.find(".member-info").addClass("binf-hidden");var h=new t.Region({"el":m.find(".csui-inline-owner-change")});h.show(v),v.listenTo(v,"change:completed",function(e){h.currentView.destroy(),a.resolve()}),v.listenTo(v,"member:selected:save",function(e){var i=(s.getReadPermissions(),{"permissions":c.get("permissions"),"right_id":e.get("id"),"include_sub_types":[204,207,215,298,3030202]});c.set({"right_id_expand":e},{"silent":!0}),c.save(i,{"patch":!0,"wait":!0,"silent":!0}).done(function(){u.options.authenticatedUserPermissions.fetch().done(function(e){c.set(i,{"silent":!0}),h.currentView.destroy(),m.removeClass("csui-changeowner-permission"),m.find(".member-info").removeClass("binf-hidden"),a.resolve()}).fail(function(e){var i=e?new o(e,c):e;a.reject(c,i)})}).fail(function(e){var i=e?new o(e,c):e;c.set({"right_id_expand":d},{"silent":!0}),a.reject(c,i)})})}),a.promise()}})}),csui.define("csui/utils/commands/permissions/delete.permission",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/base","csui/models/command","csui/utils/commandhelper","csui/utils/command.error","csui/utils/commands/confirmable","i18n!csui/utils/commands/nls/localized.strings"],function(e,i,n,t,s,o,r,a,c,l,u){"use strict";var d,m=(t.extend({},e.config()),r.extend({"defaults":{"signature":"DeletePermission","scope":"single"},"allowCollectionRefetch":!1,"_getConfirmTemplate":function(e,i){return t.template(u.DeleteCommandConfirmDialogHtml)},"_getConfirmData":function(e,i){var n=e.model,t=u.DeletePermissionCommandConfirmDialogSingleMessage;"public"===n.get("type")&&(t=u.DeletePermissionCommandConfirmDialogPublicAccessMessage);var s=this._getMessageWithUserDisplayName(t,n);return{"title":this._getMessageWithUserDisplayName(u.DeletePermissionCommandConfirmDialogTitle,n),"message":s}},"_getMessageWithUserDisplayName":function(e,i){var n;i.get("right_id_expand")?n=o.formatMemberName(i.get("right_id_expand")):"public"===i.get("type")&&(n=u.publicAccess);return i.get("results")&&i.get("results").success>0?t.str.sformat(e,n,o.formatMessage(i.get("results").success,u)):t.str.sformat(e,n)},"enabled":function(e){var i=e.model,n=i&&i.collection,t=i&&i.get("right_id"),s=i&&i.get("type"),o=e.filterId,r=!o&&s&&(t||"public"===s)&&n&&n.options&&n.options.node&&n.options.node.get("id")&&(n.options.authenticatedUserPermissions&&n.options.authenticatedUserPermissions.hasEditPermissionRights()||e.admin_permissions);return r&&this.setCommandTitle(e.toolItem,i),r},"setCommandTitle":function(e,i){var n,t=i.get("type");n="owner"===t?u.DeletePermissionCommandRemoveOwner:"group"===t?u.DeletePermissionCommandRemoveGroup:"public"===t?u.DeletePermissionCommandRemovePublicAccess:u.DeletePermissionCommandRemoveOther,e.set("name",n)}}));return t.extend(m.prototype,l,{"execute":function(e,i){var t=n.Deferred(),s=this;return e.suppressFailMessage=!0,e.suppressSuccessMessage=!0,csui.require(["csui/controls/globalmessage/globalmessage","csui/widgets/permissions/impl/edit/apply.permission/apply.permission.view","csui/widgets/permissions/impl/edit/apply.permission/impl/header/apply.permission.header.view","csui/controls/progressblocker/blocker","csui/controls/dialog/dialog.view"],function(n,o,r,a,c){d=n,e.originatingView&&e.originatingView.model&&e.originatingView.model.get("container")?s._executeDeletePermission(e,i,r,o,a,c).then(t.resolve,t.reject):s._deletePermission(e,i).then(t.resolve,t.reject)},t.reject),t.promise()},"_deletePermission":function(e,i){i||(i={});var t=n.Deferred();return this._performActions(e,i),t.promise()},"_executeDeletePermission":function(e,i,s,o,r,a){i||(i={});var c=n.Deferred();this.originatingView=e.originatingView;var l=new s({"removePermission":!0,"permissionModel":e.model});this._view=new o({"context":e.context,"model":e.originatingView.model,"permissionModel":e.model,"removePermission":!0,"applyTo":e.applyTo,"originatingView":e.originatingView});var d=new a({"headerView":l,"view":this._view,"className":"csui-permissions-apply-dialog","midSize":!0,"buttons":[{"id":"apply","label":u.applyButtonLabel,"default":!0,"click":t.bind(this._performActions,this)},{"label":u.cancelButtonLabel,"close":!0}]});return d.listenTo(d,"hide",t.bind(this.onHideDialog,this)),r.imbue(d),d.show(),c.promise()},"onHideDialog":function(){var e=this.originatingView;e&&e.trigger("unblock:view:actions")},"_performActions":function(e,i){var t=this,s=n.Deferred(),o=e.dialog?e.dialog.options.view.options.permissionModel:e.model,r=o.get("type"),a=o.collection,l=e.dialog&&e.dialog.options.view.options.originatingView,m=this._getMessageWithUserDisplayName(u.DeletePermissionCommandFailMessage,o);if(t.orginatingView=l,a){o.nodeId=a.options&&a.options.node&&a.options.node.get("id");var g=a.options&&a.options.node&&a.options.node.get("container"),p=a.options&&a.options.node&&a.options.node.get("permissions_model");e.dialog&&(o.apply_to=g&&"advanced"===p&&e.dialog.options.view.subFolderSelected?2:g&&"advanced"===p?3:0,o.include_sub_types=o.apply_to>0?[204,207,215,298,3030202]:[]),t.originatingView&&t.originatingView.blockActions&&(t.destroyDialog(e),t.originatingView.blockActions());var f=o.destroy({"wait":!0}).done(function(e){o.set("results",e.results),t.originatingView&&t.originatingView.unblockActions&&t.originatingView.unblockActions(),a.options.authenticatedUserPermissions.fetch().done(function(){var e=t._getMessageWithUserDisplayName(o.get("results")&&o.get("results").success>0?u.DeletePermissionCommandSuccessMessageWithCount:u.DeletePermissionCommandSuccessMessage,o);d.showMessage("success",e),"owner"!==r&&"group"!==r||a.processForEmptyOwner&&a.processForEmptyOwner(),s.resolve(o)}).fail(function(e){var i=e?new c(e,o):e;t.originatingView&&t.originatingView.unblockActions&&t.originatingView.unblockActions(),s.reject(o,i)})}).fail(function(e){var i=e?new c(e,o):e;t.handleFailure(i,m),s.reject(o,i),e||f.abort()}).always(function(){t.originatingView&&t.originatingView.unblockActions&&t.originatingView.unblockActions()});return s.promise()}return t.destroyDialog(e),s.reject(new c(m,{"errorDetails":u.undefinedCollection}))},"handleFailure":function(e,i){var n,t=s.Model.extend({"defaults":{"name":"","state":"pending","commandName":"ViewPermission"}}),o=s.Collection.extend({"model":t}),r=new o;n=new t({"name":e,"mime_type":"","state":"rejected"}),r.add(n),d.showPermissionApplyingProgress(r,{"oneFileFailure":i})},"destroyDialog":function(e){e.dialog&&e.dialog.destroy()}}),m}),csui.define("csui/utils/commands/permissions/add.user.group",["module","require","csui/lib/underscore","csui/lib/jquery","csui/utils/base","i18n!csui/utils/commands/nls/localized.strings","csui/utils/log","csui/models/command","csui/utils/command.error"],function(e,i,n,t,s,o,r,a,c){"use strict";var l,u;return a.extend({"defaults":{"signature":"adduserorgroup","name":o.CommandNameAddUserorGroup},"enabled":function(){return!0},"execute":function(e,i){var s=this,o=t.Deferred();e.context||i&&i.context;return e.suppressSuccessMessage=!0,csui.require(["csui/models/permission/nodepermission.model","csui/controls/globalmessage/globalmessage","csui/dialogs/modal.alert/modal.alert"],function(t){l=arguments[1],u=arguments[2],s._selectAddUserOrGroupOptions(e,i).done(function(i){var r=i.members,a=i.permissions,u={"right_id":r.get("id"),"permissions":a,"apply_to":i.apply_to,"include_sub_types":i.apply_to>0?[204,207,215,298,3030202]:[]},d=new t(u,e);d.nodeId=e.nodeId,e.originatingView&&e.originatingView.blockActions&&e.originatingView.blockActions(),d.save(u,{"silent":!0,"wait":!0}).done(function(){d.set({"right_id_expand":n.clone(r.attributes),"type":"custom"},{"silent":!0}),l.showMessage("success",s._getMessageWithUserDisplayName(d)),e.originatingView&&e.originatingView.unblockActions&&e.originatingView.unblockActions(),o.resolve(d)}).fail(function(i){var n=i?new c(i,d):i;e.originatingView&&e.originatingView.unblockActions&&e.originatingView.unblockActions(),l.showMessage("error",n),o.reject(d,n)})}).fail(function(e){o.reject(e)})},function(e){o.reject(e)}),o.promise()},"_selectAddUserOrGroupOptions":function(e,i){var s=t.Deferred();return csui.require(["csui/dialogs/members.picker/members.picker.wizard"],function(i){var t=e.originalCollection&&e.originalCollection.models&&e.originalCollection.models.length>0?e.originalCollection.models:e.permissionCollection.models;t=n.filter(t,function(e){return"custom"===e.get("type")}),new i({"command":"adduserorgroup","context":e.context,"connector":e.connector,"dialogClass":"cs-permission-group-picker","displayName":o.allUsersAndGroups,"dialogTitle":o.addUsersAndGroups,"startLocation":"all.members","adduserorgroup":!0,"nodeModel":e.nodeModel,"addButtonLabel":o.AddButtonLabel,"availablePermissions":e.permissionCollection.availablePermissions,"startLocations":["all.members","member.groups"],"unselectableMembers":t,"applyTo":e.applyTo}).show().done(function(){s.resolve.apply(s,arguments)}).fail(function(e){s.reject.apply(s,arguments)})},function(e){s.reject(e)}),s.promise()},"_getMessageWithUserDisplayName":function(e){var i;e.get("right_id_expand")&&(i=s.formatMemberName(e.get("right_id_expand")));return e.get("results")&&e.get("results").success>0?n.str.sformat(o.AddUserOrGroupSuccessWithCount,i,s.formatMessage(e.get("results").success,o)):n.str.sformat(o.AddUserOrGroupSuccess,i)}})}),csui.define("csui/utils/commands/permissions/add.owner.group",["module","require","csui/lib/underscore","csui/lib/jquery","csui/utils/base","i18n!csui/utils/commands/nls/localized.strings","csui/utils/log","csui/models/command","csui/utils/command.error"],function(e,i,n,t,s,o,r,a,c){"use strict";var l,u;return a.extend({"defaults":{"signature":"addownerorgroup","name":o.CommandNameAddOwnerOrOwnerGroup},"enabled":function(e){var i=e.originalCollection?e.originalCollection:e.permissionCollection,n=i&&i.options&&i.options.authenticatedUserPermissions,t=i.findWhere({"type":"owner"}),s=t&&null===t.get("permissions"),r=!i.findWhere({"type":"group"}),a=i&&(n&&n.hasEditPermissionRights()||e.admin_permissions)&&(s||r||!t);return a&&e.toolItem&&(s?e.toolItem.set("name",o.AddOwnerOrGroup):r?e.toolItem.set("name",o.AddOwnerGroup):e.toolItem.set("name",o.AddOwner)),a},"execute":function(e,i){var s=this,o=t.Deferred();e.context||i&&i.context;return e.suppressSuccessMessage=!0,csui.require(["csui/models/permission/nodepermission.model","csui/controls/globalmessage/globalmessage","csui/dialogs/modal.alert/modal.alert"],function(t){l=arguments[1],u=arguments[2],s._selectAddOwnerOrOwnerGroupOptions(e,i).done(function(i){var r=i.members,a=i.permissions,u=0===r.get("type")?"owner":"group",d={"type":u,"right_id":r.get("id"),"permissions":a,"apply_to":i.apply_to,"include_sub_type":i.apply_to>0?[204,207,215,298,3030202]:[]},m={"right_id":r.get("id"),"apply_to":i.apply_to,"permissions":a},g=new t(d,e);g.nodeId=e.nodeModel?e.nodeModel.get("id"):e.nodeId,e.originatingView&&e.originatingView.blockActions&&e.originatingView.blockActions(),g.save(m,{"patch":!0,"silent":!0,"wait":!0}).done(function(){g.set({"right_id_expand":n.clone(r.attributes),"type":u,"addOwnerGroup":!0},{"silent":!0}),e.originatingView&&e.originatingView.unblockActions&&e.originatingView.unblockActions(),l.showMessage("success",s._getMessageWithUserDisplayName(g)),o.resolve(g)}).fail(function(i){var n=i?new c(i,g):i;e.originatingView&&e.originatingView.unblockActions&&e.originatingView.unblockActions(),l.showMessage("error",n),o.reject(g,n)})}).fail(function(e){o.reject(e)})},function(e){o.reject(e)}),o.promise()},"_selectAddOwnerOrOwnerGroupOptions":function(e,i){var n,s,r,a,c=t.Deferred(),l=e.originalCollection?e.originalCollection.findWhere({"type":"owner"}):e.permissionCollection.findWhere({"type":"owner"}),u=o.allUsersAndGroups;return l&&null===l.get("permissions")?(n=[0,1],s=o.AddOwnerOrGroupDialogTitle,r="all.members",a=["all.members","member.groups"]):(n=l?[1]:[0],s=l?o.AddOwnerGroupDialogTitle:o.AddOwnerDialogTitle,u=l?o.allGroups:u,r=l?"all.groups":"all.members",a=l?["all.groups","member.groups"]:["all.members","member.groups"]),csui.require(["csui/dialogs/members.picker/members.picker.wizard"],function(i){new i({"command":"addownerorownergroup","context":e.context,"connector":e.connector,"dialogClass":"cs-permission-group-picker","displayName":u,"dialogTitle":s,"startLocation":r,"nodeModel":e.nodeModel,"availablePermissions":e.permissionCollection.availablePermissions,"adduserorgroup":!0,"addButtonLabel":o.AddButtonLabel,"startLocations":a,"selectableTypes":n,"applyTo":e.applyTo}).show().done(function(){c.resolve.apply(c,arguments)}).fail(function(e){c.reject.apply(c,arguments)})},function(e){c.reject(e)}),c.promise()},"_getMessageWithUserDisplayName":function(e){var i;e.get("right_id_expand")&&(i=s.formatMemberName(e.get("right_id_expand")));return e.get("results")&&e.get("results").success>0?n.str.sformat(o.AddUserOrGroupSuccessWithCount,i,s.formatMessage(e.get("results").success,o)):n.str.sformat(o.AddUserOrGroupSuccess,i)}})}),csui.define("csui/utils/commands/permissions/restore.public.access",["module","require","csui/lib/underscore","csui/lib/jquery","i18n!csui/utils/commands/nls/localized.strings","csui/utils/base","csui/utils/log","csui/models/command","csui/utils/command.error"],function(e,i,n,t,s,o,r,a,c){"use strict";var l;return a.extend({"defaults":{"signature":"restorepublicaccess","name":s.CommandNameRestorePublicAccess},"enabled":function(e){var i=e.originalCollection?e.originalCollection:e.permissionCollection,n=i&&i.options&&i.options.authenticatedUserPermissions;return i&&n&&n.hasEditPermissionRights()&&!i.findWhere({"type":"public"})},"execute":function(e){var i,n,o=this,r=t.Deferred();e.permissionCollection;return csui.require(["csui/models/permission/nodepermission.model","csui/widgets/permissions/impl/edit/apply.permission/apply.permission.view","csui/widgets/permissions/impl/edit/apply.permission/impl/header/apply.permission.header.view","csui/controls/progressblocker/blocker","csui/controls/dialog/dialog.view","csui/controls/globalmessage/globalmessage"],function(t,a,u,d,m,g){l=g,e.originatingView&&e.originatingView.model&&e.originatingView.model.get("container")?o._executeApplyPermission(e,u,a,d,m,t).then(r.resolve,r.reject):(i=new t({"type":"public"},e),n={"permissions":t.getReadPermissions()},i.nodeId=e.nodeId,e.originatingView&&e.originatingView.blockActions&&e.originatingView.blockActions(),i.save(n,{"patch":!0,"wait":!0}).done(function(){i.set({"publicAccess":!0},{"silent":!0}),e.originatingView&&e.originatingView.unblockActions&&e.originatingView.unblockActions();var n=o._getMessageWithUserDisplayName(i.get("results")&&i.get("results").success>0?s.RestorePublicAccessSuccessMessageWithCount:s.RestorePublicAccessSuccessMessage,i);l.showMessage("success",n),r.resolve(i)}).fail(function(n){var t=n?new c(n,i):n;e.originatingView&&e.originatingView.unblockActions&&e.originatingView.unblockActions(),l.showMessage("error",t),r.reject(i,t)}))}),r.promise()},"_executeApplyPermission":function(e,i,o,r,a,c){var l=t.Deferred();this.originatingView=e.originatingView;var u=new i({"restorePublicAccess":!0});this._view=new o({"context":e.context,"model":e.originatingView.model,"permissionModel":new c({"type":"public"},e),"permissions":c.getReadPermissions(),"removePermission":!0,"collection":e.permissionCollection,"applyTo":e.applyTo,"originatingView":e.originatingView});var d=new a({"headerView":u,"view":this._view,"className":"csui-permissions-apply-dialog","midSize":!0,"buttons":[{"id":"apply","label":s.applyButtonLabel,"default":!0,"click":n.bind(this._performActions,this)},{"label":s.cancelButtonLabel,"close":!0}]});return d.listenTo(d,"hide",n.bind(this.onHideDialog,this)),r.imbue(d),d.show(),l.promise()},"onHideDialog":function(){var e=this.originatingView;e&&e.trigger("unblock:view:actions")},"_performActions":function(e,i){var n,o=this,r=t.Deferred(),a=e.dialog?e.dialog.options.view.options.permissionModel:e.model,u=e.dialog&&e.dialog.options.view.options.permissions,d=e.dialog&&e.dialog.options.view.options.originatingView,m=e.dialog.options.view.model,g=e.dialog&&e.dialog.options.view.options.collection,p=m&&m.get("container"),f=m&&m.get("permissions_model");o.originatingView=d,e.dialog&&(a.apply_to=p&&"advanced"===f&&e.dialog.options.view.subFolderSelected?2:p&&"advanced"===f?3:0,a.include_sub_types=a.apply_to>0?[204,207,215,298,3030202]:[]),n={"permissions":u,"apply_to":a.apply_to,"include_sub_types":a.include_sub_types},a.nodeId=m.get("id"),o.originatingView&&o.originatingView.blockActions&&o.originatingView.blockActions(),a.save(n,{"patch":!0,"wait":!0}).done(function(){a.set({"publicAccess":!0},{"silent":!0}),o.destroyDialog(e),g.addPublicAccess(a),o.originatingView&&o.originatingView.unblockActions&&o.originatingView.unblockActions();var i=o._getMessageWithUserDisplayName(a.get("results")&&a.get("results").success>0?s.RestorePublicAccessSuccessMessageWithCount:s.RestorePublicAccessSuccessMessage,a);l.showMessage("success",i),r.resolve(a)}).fail(function(i){var n=i?new c(i,a):i;o.destroyDialog(e),o.originatingView&&o.originatingView.unblockActions&&o.originatingView.unblockActions(),l.showMessage("error",n),r.reject(a,n)})},"_getMessageWithUserDisplayName":function(e,i){var t;"public"===i.get("type")&&(t=s.publicAccess);return i.get("results")&&i.get("results").success>0?n.str.sformat(e,t,o.formatMessage(i.get("results").success,s)):n.str.sformat(e,t)},"destroyDialog":function(e){e.dialog&&e.dialog.destroy()}})}),csui.define("csui/temporary/cop/commands/open.blog",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i){"use strict";return i.extend({"defaults":{"signature":"OpenBlog"},"enabled":function(i){var n=e.getJustOneNode(i),t=n&&n.get("type");return 356===t||357===t},"getUrlQueryParameters":function(e,i){return{"func":"ll","objAction":356===e.get("type")?"view":"viewincontainer","objId":e.get("id"),"nexturl":location.href}}})}),csui.define("csui/temporary/cop/commands/open.faq",["csui/lib/jquery","csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i,n){"use strict";return n.extend({"defaults":{"signature":"OpenFAQ"},"enabled":function(e){var n=i.getJustOneNode(e),t=n&&n.get("type");return 123475===t||123476===t},"getUrlQueryParameters":function(i,n){var t=123475===i.get("type"),s=e.param({"func":"ll","objAction":"view","objId":t?i.get("id"):i.get("volume_id"),"nexturl":location.href});return t?s:s+"#entry_"+i.get("id")}})}),csui.define("csui/temporary/cop/commands/open.forum",["csui/lib/jquery","csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i,n){"use strict";return n.extend({"defaults":{"signature":"OpenForum"},"enabled":function(e){var n=i.getJustOneNode(e),t=n&&n.get("type");return 123469===t||123470===t},"getUrlQueryParameters":function(e,i){return{"func":"ll","objAction":123469===e.get("type")?"view":"viewincontainer","objId":e.get("id"),"nexturl":location.href}}})}),csui.define("csui/temporary/cop/commands/open.wiki",["csui/lib/jquery","csui/utils/url","csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i,n,t){"use strict";return t.extend({"defaults":{"signature":"OpenWiki"},"enabled":function(e){var i=n.getJustOneNode(e),t=i&&i.get("type");return 5573===t||5574===t},"getUrl":function(e,n){var s=t.prototype.getUrl.apply(this,arguments);return 5573===e.get("type")?s:i.combine(s,"open",e.get("id"))},"getUrlQueryParameters":function(e,i){if(5573===e.get("type"))return{"func":"ll","objAction":"browse","objId":e.get("id"),"viewType":1,"nexturl":location.href}}})}),csui.define("csui/temporary/cop/commands/open.mailstore",["csui/utils/commandhelper","csui/utils/commands/open.classic.page"],function(e,i){"use strict";return i.extend({"defaults":{"signature":"OpenMailStore"},"enabled":function(i){var n=e.getJustOneNode(i);return 3030331===(n&&n.get("type"))},"getUrlQueryParameters":function(e,i){if(3030331===e.get("type"))return{"func":"ll","objAction":"browse","objId":e.get("id"),"viewType":1,"nexturl":location.href}}})}),csui.define("csui/utils/commands/goto.location",["require","csui/lib/jquery","csui/utils/base","csui/lib/underscore","i18n!csui/utils/commands/nls/localized.strings","csui/utils/commandhelper","csui/models/command"],function(e,i,n,t,s,o,r){"use strict";return r.extend({"defaults":{"signature":"goToLocation","scope":"single"},"enabled":function(e,i){var n=o.getJustOneNode(e);return n&&this._isSupported(n)},"_isSupported":function(e){var n=[144];return-1!==i.inArray(e.get("type"),n)},"execute":function(e,t){var s,r=i.Deferred(),a=o.getJustOneNode(e);return a&&this._isSupported(a)&&(s=a.parent,s&&void 0===s.get("type")?(s.fetch().done(function(){e.originatingView&&this.executeDefaultAction(s,e.originatingView)}).fail(function(e){csui.require(["csui/dialogs/modal.alert/modal.alert"],function(i){var t=new n.Error(e);i.showError(t.message)})}),r.resolve()):(e.originatingView&&this.executeDefaultAction(s,e.originatingView),r.resolve())),r.promise()},"executeDefaultAction":function(e,i){var n={"node":e};if(i.trigger("before:defaultAction",n),!n.cancel){var t=i;i.defaultActionController&&i.defaultActionController.executeAction(e,{"context":i.context,"originatingView":i}).done(function(){t.trigger("executed:defaultAction",n)})}}})}),csui.define("bundles/csui-commands",["csui/integration/folderbrowser/commands/go.to.node.history","csui/integration/folderbrowser/commands/open.full.page.container","csui/utils/commands","csui/utils/commands/add.categories","csui/utils/commands/add","csui/utils/commands/add.item.metadata","csui/utils/commands/add.version","csui/utils/commands/browse","csui/utils/commands/collection/collect.items","csui/utils/commands/collection/remove.collected.items","csui/utils/commands/confirmable","csui/utils/commands/copy","csui/utils/commands/copy.link","csui/utils/commands/create.perspective","csui/utils/commands/delete","csui/utils/commands/download","csui/utils/commands/edit","csui/utils/commands/editactivex","csui/utils/commands/editofficeonline","csui/utils/commands/edit.perspective","csui/utils/commands/editwebdav","csui/utils/commands/email.link","csui/utils/commands/execute.saved.query","csui/utils/commands/favorite.add","csui/utils/commands/favorite.remove","csui/utils/commands/inlineedit","csui/utils/commands/move","csui/utils/commands/multiple.items","csui/utils/commands/navigate","csui/utils/commands/node","csui/utils/commands/open","csui/utils/commands/open.node.perspective","csui/utils/commands/open.classic.page","csui/utils/commands/open.discussion","csui/utils/commands/open.form","csui/utils/commands/open.milestone","csui/utils/commands/open.channel","csui/utils/commands/open.news","csui/utils/commands/open.poll","csui/utils/commands/open.prospector","csui/utils/commands/open.specific.classic.page","csui/utils/commands/open.specific.node.perspective","csui/utils/commands/open.task","csui/utils/commands/open.taskgroup","csui/utils/commands/open.tasklist","csui/utils/commands/open.topic","csui/utils/commands/permissions","csui/utils/commands/properties","csui/utils/commands/rename","csui/utils/commands/rename.favorite","csui/utils/commands/reserve","csui/utils/commands/run.livereport","csui/utils/commands/sign.out","csui/utils/commands/switch.to.classic","csui/utils/commands/unreserve","csui/utils/commands/user.profile","csui/utils/commands/versions","csui/utils/commands/versions/delete","csui/utils/commands/versions/download","csui/utils/commands/versions/open","csui/utils/commands/versions/properties","csui/utils/commands/filter","csui/utils/commands/description.toggle","csui/utils/commands/thumbnail.toggle","csui/utils/commands/save.filter","csui/utils/commands/maximize.widget.view","csui/utils/commands/restore.widget.size","csui/utils/commands/permissions/apply.permission","csui/utils/commands/permissions/edit.permission","csui/utils/commands/permissions/change.owner.permission","csui/utils/commands/permissions/delete.permission","csui/utils/commands/permissions/add.user.group","csui/utils/commands/permissions/add.owner.group","csui/utils/commands/permissions/restore.public.access","i18n!csui/utils/commands/nls/localized.strings","csui/utils/commands/nls/root/localized.strings","i18n!csui/utils/commands/collection/nls/lang","csui/utils/commands/collection/nls/root/lang","csui/temporary/cop/commands/open.blog","csui/temporary/cop/commands/open.faq","csui/temporary/cop/commands/open.forum","csui/temporary/cop/commands/open.wiki","csui/temporary/cop/commands/open.mailstore","csui/dialogs/file.open/file.open.dialog","csui/models/command","csui/models/commands","csui/utils/command.error","csui/utils/commandhelper","csui/utils/commands/open.plugins/open.plugins","csui/utils/commands/goto.location"],{});
//# sourceMappingURL=csui-commands.js.map