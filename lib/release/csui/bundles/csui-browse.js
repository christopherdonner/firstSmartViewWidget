csui.define("csui/behaviors/item.name/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/behaviors/item.name/impl/nls/root/lang",{"nameErrorEmptyValue":"This is a required field.","nameErrorMaxLegthExceed":"Name cannot be longer than 248 characters.","nameErrorContainSemiColon":"Name cannot contain a colon.","error":"Unable to complete this request. Please try again later.","nameExists":"An item with the name '{name}' already exists.","renameTitle":"Rename","addFolderTitle":"Add folder"}),csui.define("csui/behaviors/item.name/item.name.behavior",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/models/version","csui/models/namequery","csui/utils/commands","i18n!csui/behaviors/item.name/impl/nls/lang"],function(e,t,i,s,n,o,r,l,a){return s.Behavior.extend({"ui":{"inputName":".title-input","saveButton":".cs-add-button"},"events":{"click @ui.name":"onClickName","click @ui.nameInput":"cancelEvent","keyup @ui.nameInput":"onKeyReleased","paste @ui.inputName":"mouseRightCicked","cut @ui.inputName":"mouseRightCicked","blur @ui.nameInput":"onBlurNameInput","mousedown @ui.nameEditCancelIcon":"cancelNameEdit","click @ui.nameEditCancelIcon":"cancelEvent","click @ui.nameEditDiv":"cancelEvent"},"constructor":function(e,i){s.Behavior.prototype.constructor.apply(this,arguments),this._nameSchema=t.extend({"required":!0,"readonly":!1},this.options.nameSchema),this.view=i,this.view.ItemNameBehavior=this,this.listenTo(this.view.model||this.view.options.model,"change:name",this.toggleButton)},"updateNameSchema":function(e){this._nameSchema=t.extend({"required":!0,"readonly":!1},e),this.toggleButton()},"toggleButton":function(e){if(this.ui&&this.ui.inputName&&this.ui.inputName.val){var t=this.ui.inputName.val().trim(),i=!0;this._isEditMode()&&!this._isCopyMoveAction()||(i=this._nameSchema.required&&0==t.length,this.view.trigger("update:button",{"disabled":i}))}},"_isEditMode":function(){return void 0!==this.view.model.get("id")},"_isCopyMoveAction":function(){return"copy"===this.view.model.get("action")||"move"},"mouseRightCicked":function(e){var t=this;setTimeout(function(){t.toggleButton(e)},100)},"onBeforeDestroy":function(){this.view._nodeIconView&&this.view._nodeIconView.destroy(),this.view.dropdownMenuView&&(this.view.cancelEventsToViewsPropagation(this.view.dropdownMenuView),this.view.dropdownMenuView.destroy())},"onKeyInView":function(i){if(!this.view.readonly){var s=i||window.event;if(9===s.keyCode&&""===this.getInputBoxValue())return s.preventDefault(),s.stopPropagation(),this.validate(""),void setTimeout(t.bind(function(){this.view.ui.nameInput.focus()},this),100);if(27===s.keyCode)return void this.cancelNameEdit(s);if(32===s.keyCode||13===s.keyCode){var o=!!(this.view.dropdownMenuView&&this.view.dropdownMenuView.$el.find(s.target).length>0),r=13===s.keyCode?200:0,l=s.target||s.srcElement;o?(s.preventDefault(),s.stopPropagation(),n.isMozilla()||n.isEdge()?e(l).click():setTimeout(function(){e(l).click()},r)):!0!==this.view.editing&&(s.preventDefault(),s.stopPropagation(),setTimeout(t.bind(function(){this._toggleEditMode(!0)},this),r))}}},"setEditModeFocus":function(){this.view.readonly||setTimeout(t.bind(function(){this.view.ui.nameInput instanceof Object&&(this._toggleEditMode(!0),this.view.ui.nameInput.focus(),this.view.ui.nameInput[0].select())},this),500)},"showInlineError":function(e){this.view.ui.titleError.attr("title",e),this.view.ui.titleError.text(e),this.view.ui.titleError.attr("role","alert")},"clearInlineError":function(){this.view.ui.titleError.attr("title",""),this.view.ui.titleError.text(""),this.view.ui.titleError.removeAttr("role")},"validateInputName":function(t){var i=e.Deferred(),s=!0;if(this.view.readonly)return this.clearInlineError(),!0;var n=void 0===t?this.getValue():t;n=n.trim();var o=this;return this._isValidName(n).done(function(e){e?(o._displayInlineError(n,e),s=!1,i.resolve(s)):(o.clearInlineError(),i.resolve(s))}).fail(function(){i.reject()}),i.promise()},"validate":function(e){if(this.view.readonly)return this.clearInlineError(),!0;var t=void 0===e?this.getValue():e;return t=t.trim(),t.length<1?(this.showInlineError(a.nameErrorEmptyValue),!1):t.length>248?(this.showInlineError(a.nameErrorMaxLegthExceed),!1):t.indexOf(":")>=0?(this.showInlineError(a.nameErrorContainSemiColon),!1):(this.clearInlineError(),!0)},"_isValidName":function(t){var i=!0,s=e.Deferred();if(t&&t.length<=248&&-1===t.indexOf(":")){var n=this.view.model,o=n.parent||this.view.options.container;return!o||o.get("id")&&-1!==o.get("id")?this.checkNameExists(t).done(function(e,t,n){null===e.results[0].id&&(i=!1),s.resolve(i)}).fail(s.reject):s.resolve(!1),s.promise()}return s.resolve(i),s.promise()},"checkNameExists":function(t){var i=this.view.model,s=i.parent||this.view.options.container,n=s.connector,o=e.Deferred();return new r(null,{"container":s,"connector":n}).runQuery(s.get("id"),[t]).done(o.resolve).fail(o.reject),o.promise()},"_displayInlineError":function(e,t){var i;e.length<1?i=a.nameErrorEmptyValue:e.length>248?i=a.nameErrorMaxLegthExceed:-1!==e.indexOf(":")?i=a.nameErrorContainSemiColon:t&&(i=a.nameExists.replace("{name}",e)),this.showInlineError(i)},"getValue":function(){return this.view.ui.name.text()},"getInputBoxValue":function(){return this.view.modelHasEmptyName&&!0!==this.view.inputBoxNameChange?"":this.view.ui.nameInput.val()},"setValue":function(e){this.view.ui.name.text(e),this.view.ui.name.attr("title",e)},"setInputBoxValue":function(e){e||(e=""),this.view.ui.nameInput.val(e)},"_toggleEditMode":function(e,t){if(void 0===t&&(t=!0),this.view.readonly&&(e=!1),e){if(this._isEditingEnabled()){this.view.editing=!0,this.view.ui.name.addClass("binf-hidden"),this.view.ui.nameEditIconDiv&&this.view.ui.nameEditIconDiv.addClass("binf-hidden"),this.view.ui.nameEditIcon&&this.view.ui.nameEditIcon.addClass("binf-hidden"),this.view.ui.nameDropdownMenuDiv&&this.view.ui.nameDropdownMenuDiv.addClass("binf-hidden"),this.view.ui.nameEditDiv.removeClass("binf-hidden"),t&&this.view.ui.nameInput.focus();var i=this.view.ui.nameInput[0],s=i.value,n=s?s.length:0;i.selectionEnd=0,144===this.view.model.get("type")&&s.lastIndexOf(".")>0&&s.lastIndexOf(".")<s.length-1&&(n=s.lastIndexOf(".")),i.selectionEnd=n,0===s.length&&(this.view.ui.nameInput[0].placeholder=this.view.placeHolderName),this.view.trigger("changed:editmode",this.view.editing)}}else this.view.$el.is(":visible")&&(this.view.editing=!1,this.view.ui.nameEditDiv.addClass("binf-hidden"),this.view.ui.name.removeClass("binf-hidden"),t&&this.view.ui.name.focus(),this.view.ui.nameDropdownMenuDiv&&this.view.ui.nameDropdownMenuDiv.removeClass("binf-hidden"),this.view.ui.nameEditIconDiv&&this.view.ui.nameEditIconDiv.removeClass("binf-hidden"),this.view.ui.nameEditIcon&&this.view.ui.nameEditIcon.removeClass("binf-hidden"),this.view.trigger("changed:editmode",this.view.editing))},"_isEditing":function(){return this.view.editing},"_isEditingEnabled":function(){if(this.view.readonly)return!1;if(void 0===this.view.model.get("id"))return!0;var e=l.get("Rename");return e&&e.enabled({"nodes":new i.Collection([this.view.model]),"context":this.view.options.context})},"onClickName":function(e){this.view.readonly||(e.preventDefault(),e.stopPropagation(),this.view.options.model instanceof o||this._toggleEditMode(!0))},"cancelEvent":function(e){e.preventDefault(),e.stopPropagation()},"onKeyReleased":function(e){this.view.readonly||(this.view.options&&"create"===this.view.options.mode||(e.preventDefault(),e.stopPropagation(),27===e.keyCode?this.cancelNameEdit(e):13===e.keyCode?this.view.options.originatingView&&t.isFunction(this.view.options.originatingView._validateAndSave)?this.view.options.originatingView._validateAndSave():this.view._validateAndSave():""===this.getInputBoxValue()&&(this.view.ui.nameInput[0].placeholder=this.view.placeHolderName?this.view.placeHolderName:"",this.view.inputBoxNameChange=!1)),this.toggleButton(e))},"onBlurNameInput":function(e){if(!this.view.readonly){if(e.preventDefault(),e.stopPropagation(),!0===this.view.cancelEdit)return void(this.view.cancelEdit=!1);this.view.modelHasEmptyName&&!0!==this.view.inputBoxNameChange?(this.setInputBoxValue(this.placeHolderName),this.validate("")):this.view.options.originatingView&&t.isFunction(this.view.options.originatingView._validateAndSave)?this.view.options.originatingView._validateAndSave():this.view._validateAndSave()}},"cancelNameEdit":function(e){this.view.readonly||(e.preventDefault(),e.stopPropagation(),this.cancelEdit=!0,this.clearInlineError(),this.view.inputBoxNameChange=!this.view.modelHasEmptyName,this.view.modelHasEmptyName&&!0!==this.view.inputBoxNameChange?(this.setInputBoxValue(""),this.validate(""),this.toggleButton(e)):(this.setInputBoxValue(this.getValue()),this._toggleEditMode(!1),this.toggleButton()))},"_getErrorMessageFromResponse":function(t){var i;if(t&&t.responseJSON&&t.responseJSON.error)i=t.responseJSON.error,n.MessageHelper.hasMessages()&&n.MessageHelper.reset();else if(n.MessageHelper.hasMessages()){var s=n.MessageHelper.toHtml();n.MessageHelper.reset(),i=e(s).text()}return i}})}),csui.define("hbs!csui/controls/table.rowselection.toolbar/impl/right.toolbar",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <div class="csui-condensed-header-toggle-container">\r\n    <button type="button" class="csui-condensed-header-toggle"\r\n            title="'+this.escapeExpression((n=null!=(n=t.toggleCondensedHeaderTooltip||(null!=e?e.toggleCondensedHeaderTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"toggleCondensedHeaderTooltip","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.toggleCondensedHeaderTooltip||(null!=e?e.toggleCondensedHeaderTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"toggleCondensedHeaderTooltip","hash":{}}):n))+'">\r\n      <span class="icon icon-condensed-header"></span>\r\n    </button>\r\n  </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.showCondensedHeaderToggle:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return i.registerPartial("csui_controls_table.rowselection.toolbar_impl_right.toolbar",s),s}),csui.define("csui/controls/table.rowselection.toolbar/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table.rowselection.toolbar/impl/nls/root/localized.strings",{"showCondensedHeaderTooltip":"Show header","hideCondensedHeaderTooltip":"Hide header"}),csui.define("css!csui/controls/table.rowselection.toolbar/impl/right.toolbar",[],function(){}),csui.define("csui/controls/table.rowselection.toolbar/impl/right.toolbar.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/controls/table.rowselection.toolbar/impl/right.toolbar","i18n!csui/controls/table.rowselection.toolbar/impl/nls/localized.strings","css!csui/controls/table.rowselection.toolbar/impl/right.toolbar"],function(e,t,i,s,n,o,r){"use strict";var l=i.ItemView.extend({"className":"csui-right-toolbar-view","template":o,"templateHelpers":function(){return{"showCondensedHeaderToggle":this.options.showCondensedHeaderToggle,"toggleCondensedHeaderTooltip":r.showCondensedHeaderTooltip}},"behaviors":{"TabableRegion":{"behaviorClass":n}},"ui":{"condensedHeaderToggleButton":".csui-condensed-header-toggle","condensedHeaderToggleIcon":".icon-condensed-header"},"events":{"keydown":"onKeyInView","click .csui-condensed-header-toggle-container":"onClickCondensedHeaderToggle"},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.call(this,e),this._toolbarVisible=!1},"onRender":function(){this.delegateEvents()},"onToolbarActivity":function(e,t){this._toolbarVisible=e,this.options.showCondensedHeaderToggle&&(this.ui.condensedHeaderToggleButton.attr("tabindex",e?"0":"-1"),t?(this.ui.condensedHeaderToggleIcon.addClass("icon-rotate180"),this.ui.condensedHeaderToggleButton.attr("aria-label",r.hideCondensedHeaderTooltip),this.ui.condensedHeaderToggleButton.attr("title",r.hideCondensedHeaderTooltip)):(this.ui.condensedHeaderToggleIcon.removeClass("icon-rotate180"),this.ui.condensedHeaderToggleButton.attr("aria-label",r.showCondensedHeaderTooltip),this.ui.condensedHeaderToggleButton.attr("title",r.showCondensedHeaderTooltip)))},"onClickCondensedHeaderToggle":function(e){this.trigger("toggle:condensed:header"),this.ui.condensedHeaderToggleButton.focus()},"currentlyFocusedElement":function(){return this._toolbarVisible?this.ui.condensedHeaderToggleButton:t()},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||(e.preventDefault(),e.stopPropagation(),t(e.target).click())}});return e.extend(l.prototype,s),l}),csui.define("hbs!csui/controls/table.rowselection.toolbar/impl/table.rowselection.toolbar",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-toolbar-region"></div>\r\n<div class="csui-right-toolbar-region"></div>\r\n'}});return i.registerPartial("csui_controls_table.rowselection.toolbar_impl_table.rowselection.toolbar",s),s}),csui.define("css!csui/controls/table.rowselection.toolbar/impl/table.rowselection.toolbar",[],function(){}),csui.define("csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/toolbar/toolitems.filtered.model","csui/controls/toolbar/toolbar.command.controller","csui/controls/toolbar/toolbar.view","csui/controls/toolbar/delayed.toolbar.view","csui/controls/table.rowselection.toolbar/impl/right.toolbar.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/global.alert/global.alert.mixin","hbs!csui/controls/table.rowselection.toolbar/impl/table.rowselection.toolbar","css!csui/controls/table.rowselection.toolbar/impl/table.rowselection.toolbar"],function(e,t,i,s,n,o,r,l,a,c,u,d,h){"use strict";var p=s.LayoutView.extend({"template":h,"className":"csui-table-rowselection-toolbar-view","regions":{"toolbarRegion":".csui-toolbar-region","rightToolbarRegion":".csui-right-toolbar-region"},"events":{"keydown":"onKey"},"behaviors":{"TabableRegion":{"behaviorClass":u}},"currentlyFocusedElement":function(){return e(this._focusableElements[this._focusedToolbarItemIndex])},"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.apply(this,arguments),this._focusedToolbarItemIndex=0},"initialize":function(e){var i={"nodes":e.selectedChildren,"context":e.context,"collection":e.collection,"container":e.collection.node};this._commandController=e.toolbarCommandController||new r({"commands":e.commands}),this._filteredToolItemsCollection=new o(e.toolItemFactory,{"status":i,"commands":this._commandController.commands,"delayedActions":e.collection.delayedActions,"mask":e.toolbarItemsMask});var s=t.extend({"originatingView":e.originatingView,"collection":this._filteredToolItemsCollection,"toolbarName":"tableHeader"},e.toolItemFactory.options,{"role":"menu"});e.collection.delayedActions?this._toolbarView=new a(s):this._toolbarView=new l(s),this.listenTo(this._toolbarView,"childview:toolitem:action",this._toolbarItemClicked),this.listenTo(this._toolbarView,"render render:lazy:actions",function(){this._updateCounts(),this._focusableElements.length&&(this._focusedToolbarItemIndex=0,this._moveTabindexToFocusedElement())}),this._rightToolbarView=new c(e),this.listenTo(this._rightToolbarView,"toggle:condensed:header",function(){this.trigger("toggle:condensed:header")}),this.listenTo(this,"toolbar:activity",function(e,t){this._rightToolbarView.triggerMethod("toolbar:activity",e,t)}),this.listenTo(this._commandController,"before:execute:command",function(e){this._toolbarView.trigger("before:execute:command",e)}),this.listenTo(this._commandController,"after:execute:command",function(e){this._toolbarView.trigger("after:execute:command",e)}),this.listenTo(this,"render",function(){this.toolbarRegion.show(this._toolbarView),this.rightToolbarRegion.show(this._rightToolbarView)}),this.listenTo(this,"dom:refresh",function(){this._toolbarView.triggerMethod("dom:refresh"),this._rightToolbarView.triggerMethod("dom:refresh")})},"_toolbarItemClicked":function(e,t){var i={"context":this.options.context,"nodes":this.options.selectedChildren,"container":this.options.collection.node,"collection":this.options.collection,"originatingView":this.options.originatingView,"toolItemView":e};this._commandController.toolitemClicked(t.toolItem,i)},"onKey":function(e){switch(e.keyCode){case 37:this._updateCounts(),this._focusedToolbarItemIndex>0?--this._focusedToolbarItemIndex>=this._visibleToolitemsCount&&(this._focusedToolbarItemIndex=this._visibleToolitemsCount-1):this._focusedToolbarItemIndex=0,this._moveTabindexToFocusedElement(),this._moveFocus(),e.preventDefault(),e.stopPropagation();break;case 39:this._updateCounts(),this._focusedToolbarItemIndex<this._visibleToolitemsCount-1?this._focusedToolbarItemIndex++:this._focusedToolbarItemIndex=this._visibleToolitemsCount-1,this._moveTabindexToFocusedElement(),this._moveFocus(),e.preventDefault(),e.stopPropagation()}},"_updateCounts":function(){this._focusableElements=n.findFocusables(this._toolbarView.el),this._visibleToolitemsCount=this._toolbarView.getVisibleToolitemsCount()},"_moveTabindexToFocusedElement":function(){for(var e=0;e<this._focusableElements.length;e++)e===this._focusedToolbarItemIndex?this._focusableElements[e].setAttribute("tabindex","0"):this._focusableElements[e].setAttribute("tabindex","-1")},"_moveFocus":function(){this.trigger("changed:focus"),this._toolbarView&&this._toolbarView.setFocusByIndex(this._focusedToolbarItemIndex)}});return t.extend(p.prototype,d),p}),csui.define("css!csui/behaviors/table.rowselection.toolbar/impl/table.rowselection.toolbar",[],function(){}),csui.define("csui/behaviors/table.rowselection.toolbar/table.rowselection.toolbar.behavior",["csui/lib/underscore","csui/lib/marionette","csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view","csui/lib/jquery.redraw","css!csui/behaviors/table.rowselection.toolbar/impl/table.rowselection.toolbar"],function(e,t,i){"use strict";function s(t,i,s){if(null!=t){var n=t[i];return e.isFunction(n)?t[i].call(s):n}}var n=/\baccessibleTable\b(?:=([^&]*)?)?/i.exec(location.search);return n=n&&"false"!==n[1],t.Behavior.extend({"initialize":function(){this.listenTo(this.view,{"before:render":this.setToolbar,"render":this.renderToolbar})},"setToolbar":function(){if(this.toolbarRegion=this.view[s(this.options,"toolbarRegionName",this.view)]||this.view.toolbarRegion,this.toolbarRegion&&this.view.tableView){var t=s(this.options,"visibleClassName",this.view)||"csui-rowselection-toolbar-visible",o=s(this.options,"toolbarViewOptions",this.view);this.toolbarView=new i(e.extend({"toolItemFactory":this.view.options.toolbarItems.tableHeaderToolbar,"toolbarItemsMask":this.view.options.toolbarItemsMasks.toolbars.tableHeaderToolbar,"toolbarCommandController":this.view.commandController,"commands":this.view.defaultActionController.commands,"selectedChildren":this.view.tableView.selectedChildren,"container":this.view.collection.node,"context":this.view.options.context,"originatingView":this.view,"collection":this.view.collection},o)),this.listenTo(this.view.tableView.selectedChildren,"reset",function(){var e=this.toolbarRegion.$el;this.view.tableView.selectedChildren.length>0?e.hasClass(t)||(n?e.removeClass("binf-hidden").addClass("csui-no-animation").addClass(t):e.removeClass("binf-hidden").redraw().addClass(t)):e.hasClass(t)&&(n?e.addClass("binf-hidden").addClass("csui-no-animation").removeClass(t):e.one("transitionend",function(){e.addClass("binf-hidden")}).removeClass(t)),this.toolbarView&&this.toolbarView.triggerMethod("dom:refresh")})}},"renderToolbar":function(){this.toolbarRegion&&this.toolbarView&&(this.toolbarRegion.show(this.toolbarView),this.toolbarRegion.$el.addClass("binf-hidden"))}})}),csui.define("csui/controls/dialog/impl/footer.view",["csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior"],function(e,t){var i=e.ItemView.extend({"tagName":"button","className":"binf-btn","template":!1,"triggers":{"click":"click"},"behaviors":{"TabableRegion":{"behaviorClass":t}},"constructor":function(t){e.View.prototype.constructor.apply(this,arguments)},"isTabable":function(){return this.$el.is(":not(:disabled)")&&this.$el.is(":not(:hidden)")},"currentlyFocusedElement":function(){return-1===this.$el.prop("tabindex")&&this.$el.prop("tabindex",0),this.$el},"onRender":function(){var e=this.$el,t=this.model.attributes;e.text(t.label),e.addClass(t.default?"binf-btn-primary cs-add-button":"binf-btn-default"),t.toolTip&&e.attr("title",t.toolTip),t.separate&&e.addClass("cs-separate"),this.updateButton(t)},"updateButton":function(e){var t=this.$el;e||(e={}),void 0!==e.hidden&&(e.hidden?t.addClass("binf-hidden"):t.removeClass("binf-hidden")),void 0!==e.disabled&&t.prop("disabled",e.disabled)}});return e.CollectionView.extend({"childView":i,"constructor":function(t){e.CollectionView.prototype.constructor.apply(this,arguments)},"onDomRefresh":function(){this.children.each(function(e){e.trigger("dom:refresh")})},"getButtons":function(){return this.children.toArray()},"updateButton":function(e,t){var s=this.collection.get(e);s?this.children.findByModel(s).updateButton(t):i.updateButton(this.$('[data-cs-id="'+e+'"]'),t)}})}),csui.define("hbs!csui/controls/dialog/impl/dialog.header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return(null!=(n=t.if.call(e,null!=e?e.actionIconLeft:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.iconLeft:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:"")+'    <h2 class="tile-title binf-modal-title csui-heading">'+this.escapeExpression((o=null!=(o=t.title||(null!=e?e.title:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+'</h2>\r\n  </div>\r\n\r\n    <div class="cs-header-control"></div>\r\n\r\n    <div class="cs-close" title="'+this.escapeExpression((o=null!=(o=t.dialogCloseButtonTooltip||(null!=e?e.dialogCloseButtonTooltip:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"dialogCloseButtonTooltip","hash":{}}):o))+'"\r\n         tabindex="0" aria-label="'+this.escapeExpression((o=null!=(o=t.dialogCloseAria||(null!=e?e.dialogCloseAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"dialogCloseAria","hash":{}}):o))+'" role="button">\r\n      <div class="icon circular '+this.escapeExpression((o=null!=(o=t.iconRight||(null!=e?e.iconRight:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"iconRight","hash":{}}):o))+'"></div>\r\n    </div>\r\n\r\n'},"2":function(e,t,i,s){var n;return'    <span class="tile-type-action-icon cs-icon-left '+this.escapeExpression((n=null!=(n=t.actionIconLeft||(null!=e?e.actionIconLeft:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"actionIconLeft","hash":{}}):n))+'" tabindex="0"></span>\r\n'},"4":function(e,t,i,s){var n;return'    <span class="tile-type-icon cs-icon-left '+this.escapeExpression((n=null!=(n=t.iconLeft||(null!=e?e.iconLeft:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"iconLeft","hash":{}}):n))+'"></span>\r\n    <div class="tile-title">\r\n'},"6":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.imageLeftUrl:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:""},"7":function(e,t,i,s){var n;return'        <div class="tile-type-image '+this.escapeExpression((n=null!=(n=t.imageLeftClass||(null!=e?e.imageLeftClass:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"imageLeftClass","hash":{}}):n))+'">\r\n          <span class="tile-type-icon tile-type-icon-img">\r\n           <img src="'+this.escapeExpression((n=null!=(n=t.imageLeftUrl||(null!=e?e.imageLeftUrl:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"imageLeftUrl","hash":{}}):n))+'" alt="" aria-hidden="true">\r\n          </span>\r\n        </div>\r\n      <div class="tile-title">\r\n'},"9":function(e,t,i,s){return'      <div class="tile-title cs-text-only">\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.expandedHeader:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return i.registerPartial("csui_controls_dialog_impl_dialog.header",s),s}),csui.define("csui/controls/dialog/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/dialog/impl/nls/root/lang",{"dialogCloseButtonTooltip":"Close","dialogCloseAria":"Close dialog"}),csui.define("css!csui/controls/dialog/impl/dialog",[],function(){}),csui.define("csui/controls/dialog/impl/header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/controls/dialog/impl/dialog.header","i18n!csui/controls/dialog/impl/nls/lang","css!csui/controls/dialog/impl/dialog"],function(e,t,i,s,n,o){return i.ItemView.extend({"template":n,"behaviors":{"TabableRegion":{"behaviorClass":s}},"ui":{"headerControl":".cs-header-control"},"events":{"keydown":"onKeyInView"},"templateHelpers":function(){return{"iconLeft":this.options.iconLeft,"actionIconLeft":this.options.actionIconLeft,"imageLeftUrl":this.options.imageLeftUrl,"imageLeftClass":this.options.imageLeftClass,"title":this.options.title,"iconRight":this.options.iconRight||"cs-icon-cross","expandedHeader":this.options.expandedHeader,"dialogCloseButtonTooltip":o.dialogCloseButtonTooltip,"dialogCloseAria":o.dialogCloseAria}},"constructor":function(e){i.View.prototype.constructor.apply(this,arguments)},"isTabable":function(){return this.$("*[tabindex]").length>0},"currentlyFocusedElement":function(e){var i=this.$("*[tabindex]");return i.length&&i.prop("tabindex",0),e&&e.shiftKey?t(i[i.length-1]):t(i[0])&&t(i[0]).focus()},"onLastTabElement":function(e,t){return e&&t.target===this.$("*[tabindex]")[0]},"onKeyInView":function(e){var i=e.keyCode;13!==i&&32!==i||t(e.target).click()},"onRender":function(){var t=this.options.headers||[];t.length&&e.each(t,function(e){var t=this._renderHeader(e);this.$el.append(t)},this);var i=this.options.headerControl;i&&(this.ui.headerControl.append(i.$el),i.render(),i.trigger("dom:refresh")),this.options.actionIconLeft&&this._adjustTitleCSS()},"onDomRefresh":function(){var e=this.options.headerControl;e&&(e.triggerMethod("dom:refresh"),e.triggerMethod("after:show"))},"_renderHeader":function(e){var i=t('<div class="modal-header-item"></div>').text(e.label);return e.class&&i.addClass(e.class),i},"_adjustTitleCSS":function(e){this.$el.find("div.tile-title").addClass("tile-action-icon-tittle")}})}),csui.define("hbs!csui/controls/dialog/impl/dialog",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'      <div class="binf-modal-body cs-dialog cs-dialog-bodymessage">'+this.escapeExpression((n=null!=(n=t.bodyMessage||(null!=e?e.bodyMessage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"bodyMessage","hash":{}}):n))+"</div>\r\n"},"3":function(e,t,i,s){return'      <div class="binf-modal-body"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="binf-modal-dialog '+this.escapeExpression((o=null!=(o=t.binfDialogSizeClassName||(null!=e?e.binfDialogSizeClassName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"binfDialogSizeClassName","hash":{}}):o))+'" role="dialog" aria-hidden="false">\r\n  <div class="binf-modal-content" >\r\n    <div class="tile-header binf-modal-header"></div>\r\n'+(null!=(n=t.if.call(e,null!=e?e.bodyMessage:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'    <div class="binf-modal-footer binf-hidden"></div>\r\n  </div>\r\n</div>\r\n'}});return i.registerPartial("csui_controls_dialog_impl_dialog",s),s}),csui.define("csui/controls/dialog/dialog.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabables.behavior","csui/controls/dialog/impl/footer.view","csui/controls/dialog/impl/header.view","hbs!csui/controls/dialog/impl/dialog","csui/utils/non-emptying.region/non-emptying.region","csui/utils/log","i18n","css!csui/controls/dialog/impl/dialog","csui/lib/binf/js/binf"],function(e,t,i,s,n,o,r,l,a,c,u,d,h){d=d(e.id);var p=n.LayoutView.extend({"className":function(){var e="cs-dialog binf-modal binf-fade";return this.options.className&&(e+=" "+t.result(this.options,"className")),e},"attributes":{"tabindex":"-1","aria-hidden":"true"},"template":c,"behaviors":{"TabablesBehavior":{"behaviorClass":r,"recursiveNavigation":!0,"containTabFocus":!0}},"regions":{"body":".binf-modal-body","header":".binf-modal-header","footer":".binf-modal-footer"},"ui":{"header":".binf-modal-header","footer":".binf-modal-footer","body":".binf-modal-body"},"events":{"hide.binf.modal":"onHiding","hidden.binf.modal":"onHidden","click .cs-close":"onClickClose","shown.binf.modal":"onShown","keyup":"onKeyInView","setCurrentTabFocus":"setCurrentTabFocus","tabNextRegion":"tabNextRegion","click .tile-type-action-icon":"onClickActionIcon"},"templateHelpers":function(){return{"binfDialogSizeClassName":this.options.largeSize?"binf-modal-lg":this.options.midSize?"binf-modal-md":"","bodyMessage":this.options.bodyMessage}},"constructor":function(){n.LayoutView.prototype.constructor.apply(this,arguments),this.listenToOnce(this,"before:hide",r.popTabableHandler),this.propagateEventsToRegions(),this.options.headerControl},"onKeyInView":function(e){27!==e.keyCode||e.isDefaultPrevented()||this.destroy()},"setCurrentTabFocus":function(){this.focusOnLastRegion=!0,this.$el.focus()},"tabNextRegion":function(){this.trigger("changed:focus")},"show":function(){var e=i.fn.binf_modal.getDefaultContainer();return new u({"el":e}).show(this),this},"onRender":function(){this.$el.addClass(p.prototype.className.call(this)).attr({"tabindex":0,"aria-label":this.options.dialogTxtAria||this.options.title||""}),this._renderHeader(),this.options.view&&this.body.show(this.options.view),this._renderFooter()},"onShow":function(){i(window).scrollTop(0),this.$el.binf_modal({"backdrop":"static","keyboard":!1,"paddingWhenOverflowing":!1})},"kill":function(){return p.__super__.destroy.apply(this,arguments),this._scrollToBegin(),!0},"destroy":function(){return this.$el.is(":visible")?this.$el.binf_modal("hide"):p.__super__.destroy.apply(this,arguments),this._scrollToBegin(),this},"updateButton":function(e,t){var i=this.footerView;if(!i.updateButton)throw new Error("Dialog footer does not support button updating.");i.updateButton(e,t)},"showView":function(e){this.body.show(e),e.triggerMethod("after:show")},"onShown":function(){this.options.view&&this.options.view.triggerMethod&&(this.options.view.triggerMethod("dom:refresh"),this.options.view.triggerMethod("after:show")),this.headerView&&this.headerView.triggerMethod&&(this.headerView.triggerMethod("dom:refresh"),this.headerView.triggerMethod("after:show")),this.footerView&&this.footerView.triggerMethod&&(this.footerView.triggerMethod("dom:refresh"),this.footerView.triggerMethod("after:show"))},"onHiding":function(){this.triggerMethod("before:hide")},"onHidden":function(){this.triggerMethod("hide"),this.destroy()},"onClickClose":function(e){e.preventDefault(),e.stopPropagation(),this.destroy()},"onClickActionIcon":function(e){this.options.view.trigger("click:actionIcon")},
"onClickButton":function(e){var t=e.model.attributes;t.click&&t.click({"dialog":this,"button":this.$el,"buttonAttributes":t}),t.close&&this.destroy()},"_scrollToBegin":function(){if(!0===h.settings.rtl){var e=i("body").width();i("body").scrollLeft(e)}else i("body").scrollLeft(0)},"_renderHeader":function(){var e=this.headerView=this.options.headerView,t=void 0!==this.options.standardHeader?this.options.standardHeader:!this.options.template;if(e)this.header.show(e);else{var i={"iconLeft":this.options.iconLeft,"actionIconLeft":this.options.actionIconLeft,"imageLeftUrl":this.options.imageLeftUrl,"imageLeftClass":this.options.imageLeftClass,"title":this.options.title,"iconRight":this.options.iconRight||"cs-icon-cross","headers":this.options.headers,"headerControl":this.options.headerControl,"expandedHeader":t,"el":this.ui.header[0]};e=this.headerView=new a(i),e.render(),this.header.attachView(e),this.headerView.trigger("dom:refresh")}},"_renderFooter":function(){var e=this.footerView=this.options.footerView;if(e)this.ui.footer.removeClass("binf-hidden"),this.footer.show(e);else{var t=this.options.buttons||[];t.length&&this.ui.footer.removeClass("binf-hidden"),e=this.footerView=new l({"collection":new s.Collection(t),"el":this.ui.footer[0]}),this.listenTo(e,"childview:click",this.onClickButton),e.render(),this.footer.attachView(e)}}});return t.extend(p.prototype,o),p}),csui.define("csui/controls/conflict.resolver/impl/conflict.dialog/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/conflict.resolver/impl/conflict.dialog/impl/nls/root/lang",{"conflictCount":"{0} Conflicts","oneConflict":"1 Conflict","upload":"Upload","cancel":"Cancel","inputPlaceHolder":"Enter filename","nameConflict":"This file already exists.","nameConflictVersionAria":"A file {0} already exists. Add a new version","nameConflictRenameAria":"A file {0} already exists. Rename","nameConflictSkipAria":"A file {0} already exists. Skip","rename":"Rename","addVersion":"Add version","skip":"Skip","conflict":"Conflict","cancelUpload":"Cancel Upload","renamed":"Renamed","undo":"Undo","undoAria":"File {0} has state {1}. Undo","retry":"Retry","serverError":"File(s) not uploaded due to server error."}),csui.define("hbs!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/conflict.item",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'          <div class="csui-msg" title="'+this.escapeExpression((n=null!=(n=t["conflict-error-msg"]||(null!=e?e["conflict-error-msg"]:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"conflict-error-msg","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t["conflict-error-msg"]||(null!=e?e["conflict-error-msg"]:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"conflict-error-msg","hash":{}}):n))+"</div>\r\n"},"3":function(e,t,i,s){var n,o;return(null!=(n=t.unless.call(e,null!=e?e.excludeAddVersion:e,{"name":"unless","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?n:"")+'    <button type="button" class="binf-btn btn-rename conflict-field '+this.escapeExpression((o=null!=(o=t.multiRowClass||(null!=e?e.multiRowClass:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"multiRowClass","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.renameAria||(null!=e?e.renameAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"renameAria","hash":{}}):o))+'" tabindex="0"\r\n            title="'+this.escapeExpression((o=null!=(o=t.rename||(null!=e?e.rename:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"rename","hash":{}}):o))+'" data-cs-id="rename">'+this.escapeExpression((o=null!=(o=t.rename||(null!=e?e.rename:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"rename","hash":{}}):o))+"</button>\r\n"},"4":function(e,t,i,s){var n;return'      <button type="button" class="binf-btn btn-version conflict-field" aria-label="'+this.escapeExpression((n=null!=(n=t.versionAria||(null!=e?e.versionAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"versionAria","hash":{}}):n))+'" tabindex="0" title="'+this.escapeExpression((n=null!=(n=t.version||(null!=e?e.version:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"version","hash":{}}):n))+'"\r\n            data-cs-id="version">'+this.escapeExpression((n=null!=(n=t.version||(null!=e?e.version:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"version","hash":{}}):n))+"</button>\r\n"},"6":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.noServerError:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?n:""},"7":function(e,t,i,s){var n;return'      <button type="button" class="binf-btn btn-undo '+this.escapeExpression((n=null!=(n=t.multiRowClass||(null!=e?e.multiRowClass:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"multiRowClass","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.undoAria||(null!=e?e.undoAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"undoAria","hash":{}}):n))+'" tabindex="0" title="'+this.escapeExpression((n=null!=(n=t.undo||(null!=e?e.undo:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"undo","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.undo||(null!=e?e.undo:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"undo","hash":{}}):n))+"</button>\r\n"},"9":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.multiConflicts:e,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?n:""},"10":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.statusNotSkip:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:""},"11":function(e,t,i,s){var n;return'        <span class="cs-icon circle_delete conflict-field" tabindex="0" title="'+this.escapeExpression((n=null!=(n=t.skip||(null!=e?e.skip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"skip","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.skipAria||(null!=e?e.skipAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"skipAria","hash":{}}):n))+'" role="button"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'\r\n<span class="csui-icon csui-status-icon '+this.escapeExpression((o=null!=(o=t["status-icon"]||(null!=e?e["status-icon"]:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"status-icon","hash":{}}):o))+' " aria-hidden="true"></span>\r\n\r\n\r\n      <div class="csui-icon '+this.escapeExpression((o=null!=(o=t["file-icon"]||(null!=e?e["file-icon"]:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"file-icon","hash":{}}):o))+'" aria-hidden="true"></div>\r\n\r\n\r\n      <div class="csui-description">\r\n        <div class="csui-name">\r\n          <span class="folder-name conflict-field '+this.escapeExpression((o=null!=(o=t["status-ok"]||(null!=e?e["status-ok"]:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"status-ok","hash":{}}):o))+'" title="'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'</span>\r\n          <input class="binf-form-control cs-input rename-field binf-hidden" placeholder="'+this.escapeExpression((o=null!=(o=t.inputPlaceHolder||(null!=e?e.inputPlaceHolder:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"inputPlaceHolder","hash":{}}):o))+'" tabindex="-1">\r\n          <span class="csui-undo edit-cancel inline-edit-icon  rename-field binf-hidden" tabindex="-1" title="'+this.escapeExpression((o=null!=(o=t.cancel||(null!=e?e.cancel:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"cancel","hash":{}}):o))+'"></span>\r\n        </div>\r\n'+(null!=(n=t.if.call(e,null!=e?e.conflict:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'      </div>\r\n\r\n    <div class="csui-status conflict-field '+this.escapeExpression((o=null!=(o=t["status-ok"]||(null!=e?e["status-ok"]:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"status-ok","hash":{}}):o))+'" title="'+this.escapeExpression((o=null!=(o=t.status||(null!=e?e.status:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"status","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.status||(null!=e?e.status:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"status","hash":{}}):o))+'</div>\r\n\r\n\r\n\r\n<div class="csui-button-container" style="'+this.escapeExpression((o=null!=(o=t.resolvedStyle||(null!=e?e.resolvedStyle:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"resolvedStyle","hash":{}}):o))+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.conflict:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(6,s,0)}))?n:"")+"\r\n\r\n"+(null!=(n=t.if.call(e,null!=e?e.noServerError:e,{"name":"if","hash":{},"fn":this.program(9,s,0),"inverse":this.noop}))?n:"")+'\r\n\r\n<div class=\'csui-internal-placeholder rename-field binf-hidden\'>\r\n  <div class="csui-progress-container binf-hidden">\r\n    <div class="loader">\r\n      <div class="inner-border"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n</div>\r\n'}});return i.registerPartial("csui_controls_conflict.resolver_impl_conflict.dialog_impl_conflict.item_conflict.item",s),s}),csui.define("css!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/conflict.item",[],function(){}),csui.define("css!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/progress.wheel",[],function(){}),csui.define("csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/conflict.item.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/nodesprites","csui/models/namequery","i18n!csui/controls/conflict.resolver/impl/conflict.dialog/impl/nls/lang","csui/controls/progressblocker/blocker","csui/utils/base","csui/utils/log","hbs!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/conflict.item","css!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/conflict.item","css!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/progress.wheel","css!csui/controls/globalmessage/globalmessage_icons"],function(e,t,i,s,n,o,r,l,a,c){return i.ItemView.extend({"constructor":function(s){if(i.ItemView.call(this,s),this._onDynamicPlacment=e.bind(this._setDynamicPlacement,this),t(window).bind("resize.app",this._onDynamicPlacment),!this.model.get("newName")){var n=this.model.get("name");this.model.set("newName",n)}},"ui":{"inputField":"input","fileDescription":".csui-description","versionBtn":".btn-version","renameBtn":".btn-rename","cancelIcon":".circle_delete","progressWheel":".csui-progress-container","errorMessage":".csui-msg","statusText":".csui-status","cancelEdit":".edit-cancel","conflictFields":".conflict-field","renameFields":".rename-field"},"triggers":{"click @ui.versionBtn":"click:version","mouseleave":"hide:cancel","click @ui.cancelEdit":"cancel:input"},"events":{"click @ui.renameBtn":"onRename","focusout @ui.renameFields":"_queryName","click @ui.cancelIcon":"onCancelUpload","keydown @ui.cancelIcon":"onCancelUpload","click .btn-undo":"undo","mouseenter":"onHover","focus *[tabindex]":"onFocus","keydown":"onKeyInView"},"tagName":"div","className":"binf-list-group-item","template":c,"templateHelpers":function(){var t=this.options.multiConflicts&&"skip"!==this.model.status?"":"no-cancel-icon",i=this.model.get("newName");return{"file-icon":this.getMimeTypeIcon(),"name":i,"conflict-error-msg":o.nameConflict,"conflict":!this.model.status,"status":this.getStatus(),"excludeAddVersion":this.model.excludeAddVersion||!1===this.model.get("versioned"),"version":o.addVersion,"versionAria":e.str.sformat(o.nameConflictVersionAria,i),"rename":o.rename,"renameAria":e.str.sformat(o.nameConflictRenameAria,i),"skip":o.skip,"skipAria":e.str.sformat(o.nameConflictSkipAria,i),"multiConflicts":this.options.multiConflicts,"multiRowClass":t,"undo":o.undo,"undoAria":e.str.sformat(o.undoAria,i,this.getStatus()),"status-ok":this.getResolveStatus(),"status-icon":this.getStatusIcon(),"cancel":o.cancel,"inputPlaceHolder":o.inputPlaceHolder,"statusNotSkip":"skip"!==this.model.status,"noServerError":"serverError"!==this.model.status,"resolvedStyle":this.resolvedStyle}},"onKeyInView":function(e){var i=e.keyCode,s=t(e.target),n=!0;switch(i){case 9:s.hasClass("cs-input")&&(this.ui.cancelEdit.focus(),n=!1),s.hasClass("edit-cancel")&&(this.ui.inputField.focus(),n=!1);break;case 27:s.hasClass("cs-input")&&(this.onCancelInput(),this.$el.trigger("setCurrentTabFocus"),n=!1);break;case 32:case 13:s.hasClass("edit-cancel")&&this.onCancelInput(),s.hasClass("cs-input")&&13===i&&(this._queryName(),n=!1)}return n},"onFocus":function(e){this.trigger("item:focus",e.target)},"getStatus":function(){switch(this.model.status){case"renamed":return o.renamed;case"skip":return o.skip;case"version":return o.addVersion;case"serverError":return o.serverError}return o.conflict},"getStatusIcon":function(){var e="csui-icon-notification-warning";switch(this.model.status){case"version":case"renamed":case"skip":e="csui-icon-notification-success";break;case"serverError":e="category_delete"}return e},"getMimeTypeIcon":function(){var e;return e=void 0===this.model.get("mime_type")&&void 0!==this.model.get("file")?this.model.get("file").type:null!==this.model.get("mime_type")?this.model.get("mime_type"):this.model.get("type"),this.model.set("mime_type",e),s.findClassByNode(this.model)},"getResolveStatus":function(){var e="";switch(this.model.status){case"version":case"renamed":case"skip":e="ok";break;case"serverError":e="error"}return e},"onDestroy":function(){t(window).unbind("resize.app",this._onDynamicPlacment)},"onClickVersion":function(e){this.model.status="version",this.model.set("newVersion",!0),this.setResolveStatus(!0),this.render()},"onRename":function(e){e.preventDefault(),e.stopPropagation();var t=this.model.get("newName");this.ui.inputField.val(t),this.ui.conflictFields.addClass("binf-hidden"),this.ui.renameFields.removeClass("binf-hidden"),this.ui.inputField.focus(),this.ui.fileDescription.addClass("edit-mode"),this.$el.addClass("edit-mode"),this.$el.find(".csui-status-icon").addClass("edit-mode")},"onCancelInput":function(){this.render()},"onCancelUpload":function(e){void 0!==e.keyCode&&32!==e.keyCode&&13!==e.keyCode||(e.stopPropagation(),e.preventDefault(),this.options.removeItemList[this.model.get("id")]=this.model,this.previousState=this.model.status,this.model.status="skip",this.setResolveStatus(!0),this.render())},"setResolveStatus":function(e){this._resolved&&!e&&this.trigger("resolved",!1),!this._resolved&&e&&this.trigger("resolved",!0),this._resolved=e},"onHover":function(){this.resolvedStyle||(this.resolvedStyle="width:"+t(".csui-button-container").width()+"px;"),this.ui.cancelIcon.addClass("binf-show")},"onHideCancel":function(){this.ui.cancelIcon.removeClass("binf-show")},"onRender":function(){this.model.get("first")&&this.$el.addClass("no-border"),this._setDynamicPlacement()},"undo":function(e){e.preventDefault(),e.stopPropagation();var t=this.model.get("id");this.model.status=this.previousState,this.previousState?(delete this.options.removeItemList[t],this.previousState=void 0):(this.oldName&&this.model.set("newName",this.oldName),this.oldId&&this.model.set("id",this.oldId),this.oldName=this.Id=void 0,this.model.set("newVersion",void 0),delete this.options.removeItemList[t],this.model.status=void 0,this.setResolveStatus(!1)),this.render()},"_queryName":function(){var e=this.ui.inputField.val(),t=this.model.get("newName");e=e&&e.trim(),e&&e!==t?(this.oldName=t,this.oldId=this.model.get("id"),this.model.set("id",void 0),this.model.set("newName",e),this.ui.progressWheel.removeClass("binf-hidden"),this._runNameQuery([{"name":e}])):this.onCancelInput()},"_runNameQuery":function(e){var t=this;new n({"containerId":this.options.parentId},{"connector":this.options.connector}).queryNames(e).done(function(e,i){i&&i.length>0?t._resetConflictStatus(i):t._setRenameStatus()}).fail(function(e){t.ui.progressWheel.addClass("binf-hidden"),t._processServerError(e)})},"_processServerError":function(e){this.options.removeItemList[this.model.get("id")]=this.model,this.model.status="serverError",this.$el.removeClass("edit-mode"),this._setErrorMsg(e),this.setResolveStatus(!0),this.render()},"_setErrorMsg":function(e){var t=(o.serverError,"Conflict.Item.View: Server returned error during name query");e&&(t=new l.RequestErrorMessage(e)),a.error(t)&&console.error(a.last)},"_setRenameStatus":function(){this.model.status="renamed",this.$el.removeClass("edit-mode"),this.setResolveStatus(!0),this.render()},"_resetConflictStatus":function(e){this.model.set("id",e[0].id),this.render()},"_setDynamicPlacement":function(){t(window).width()-176<600?(this.$el.addClass("sm"),this.ui.statusText.addClass("sm"),this.ui.fileDescription.addClass("sm")):(this.$el.removeClass("sm"),this.ui.statusText.removeClass("sm"),this.ui.fileDescription.removeClass("sm"))}})}),csui.define("csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.list.navigation",["csui/lib/jquery","csui/behaviors/keyboard.navigation/tabable.region.behavior"],function(e,t){"use strict";return{"currentlyFocusedElement":function(e){e="object"==typeof e?e.shiftKey:e;var t=this.$("button[tabindex=-1]");return t.length&&(t.prop("tabindex",0),this.$(".circle_delete").prop("tabindex",0)),e?this.$("[tabindex]:visible").last():this.$("[tabindex]:visible").first()},"onKeyInView":function(t){var i=t.keyCode,s=e(t.target),n=!1;switch(i){case 39:case 37:if(s.hasClass("cs-input"))return!0;this.navigateLeftRight(i);break;case 38:case 40:this.navigateUpDown(i);break;default:n=!0}return n},"navigateUpDown":function(t){var i,s,n,o,r=this.focusedElement,l=r.hasClass("btn-version")?".btn-version":r.hasClass("btn-rename")||r.hasClass("btn-undo")?".btn-rename, .btn-undo":".circle_delete",a=this.collection.length;if(38===t&&this.activeChildIndex>0){for(s=this.activeChildIndex-1;s>=0;s--)if(n=this.children.findByIndex(s),o=n.$(l),o.length>0){i=s;break}}else if(40===t&&this.activeChildIndex<a-1)for(s=this.activeChildIndex+1;s<a;s++)if(n=this.children.findByIndex(s),o=n.$(l),o.length>0){i=s;break}void 0!==i&&(this.$(".csui-focus").removeClass("csui-focus"),e(this.children.findByIndex(i).$(l)).focus())},"navigateLeftRight":function(t){var i,s=this.activeChildView.$("[tabindex=0]"),n=this._getActiveIndex(s);void 0!==n&&(37===t&&n>0?i=n-1:39===t&&n<s.length-1&&(i=n+1),void 0!==i&&e(s[i]).focus())},"onLastTabElement":function(i){var s=void 0===this.activeElementIndex?0:this.activeElementIndex,n=(this.children.findByIndex(s),this.$("[tabindex=0]")),o=n.length-1;if(n.length){var r=i?n[0]:n[o];return this.$(".csui-focus").removeClass("csui-focus"),e(r).hasClass(t.accessibilityActiveElementClass)}return!0},"setItemFocus":function(i,s){this.activeChildView=i,this.$(".csui-focus").removeClass("csui-focus"),i.$el.addClass("csui-focus"),this.focusedElement&&this.focusedElement.removeClass(t.accessibilityActiveElementClass),this.focusedElement=e(s),this.focusedElement.addClass(t.accessibilityActiveElementClass),this.activeChildIndex=i.model.index},"clearTabFocus":function(){}}}),csui.define("csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.list.view",["csui/lib/underscore","csui/lib/jquery","csui/utils/base","csui/controls/list/simplelist.view","csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/conflict.item.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.list.navigation"],function(e,t,i,s,n,o,r){var l=s.extend({"childView":n,"childEvents":{"resolved":"trackResolved","item:focus":"setItemFocus"},"events":{"keydown":"onKeyInView","mouseenter":"clearTabFocus"},"behaviors":{"TabableRegionBehavior":{"behaviorClass":o}},"constructor":function(i){i||(i={}),s.prototype.constructor.apply(this,arguments),this.multiList=i.numConflicts>1,this.removeItemList=[],this.listenToOnce(this,"mouseenter",this.onUpdateScroll),this._onSetContaintListHeight=e.bind(this._setContainerListHeight,this),t(window).bind("resize.app",this._onSetContaintListHeight)},"childViewOptions":function(){return{"multiConflicts":this.multiList,"connector":this.options.connector,"parentId":this.options.parentId,"removeItemList":this.options.removeItemList}},"onDomRefresh":function(){this._setContainerListHeight()},"onUpdateScroll":function(){this.triggerMethod("update:scrollbar",this)},"onDestroy":function(){t(window).unbind("resize.app",this._onSetContaintListHeight)},"trackResolved":function(){var e=arguments[1];this.options.trackResolved(e)},"_setContainerListHeight":function(){var e=.9*t(window).height()-100-60-130+"px";this.$el.find(".cs-content").css("max-height",e)},"_getActiveIndex":function(e){for(var i=e.length-1,s=0;s<=i;s++)if(t(e[s]).hasClass(o.accessibilityActiveElementClass))return s}});return e.extend(l.prototype,r),l}),csui.define("css!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.dialog",[],function(){}),csui.define("csui/controls/conflict.resolver/impl/conflict.dialog/conflict.dialog",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/controls/dialog/dialog.view","i18n!csui/controls/conflict.resolver/impl/conflict.dialog/impl/nls/lang","csui/utils/log","csui/controls/list/simplelist.view","csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.item/conflict.item.view","csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.list.view","css!csui/controls/conflict.resolver/impl/conflict.dialog/impl/conflict.dialog"],function(e,t,i,s,n,o,r,l,a){"use strict";function c(i){this.options=i||{},this.deferred=t.Deferred(),this.removeItemList={},this._resolveCount=this.options.conflictFiles.length,this.deferred.then(e.bind(this.destroy,this),e.bind(this.destroy,this))}return e.extend(c.prototype,i.Events,{"destroy":function(){this._view.destroy(),this._view.off(),this._dialog.destroy()},"show":function(){var e=this.options.conflictFiles;return e[0].first=!0,this._view=this._getListView(e),this._dialog=this._createDialog(e),this._view.$el.hover(function(){t(".cs-content").trigger("scroll")}),this.deferred},"_createDialog":function(t){var i=this.options,o=this,r=t.length>1?n.conflictCount:n.oneConflict,l=e.str.sformat(r,t.length),a=new s({"standardHeader":!1,"view":this._view,"className":"csui-conflict-dialog csui-individual","attributes":{"data-backdrop":"static"},"headers":[{"id":"h1","label":this.options.h1Label,"class":"csui-numUploads"},{"id":"h2","label":l,"class":"csui-numConflicts"}],"buttons":[{"id":"upload","label":i.actionBtnLabel,"toolTip":i.actionBtnLabel,"disabled":!0,"click":function(){a.destroy(),o._resolutionComplete()}},{"id":"cancel","label":n.cancel,"toolTip":n.cancel,"click":function(){a.destroy(),o.cancel()}}],"dialogTxtAria":this.options.h1Label+". "+l});return a.on("hide",function(){a.off(),this.cancel()},this),a.show(),a},"_getListView":function(e){var t=this;return new a({"data":{"items":e},"numConflicts":e.length,"removeItemList":this.removeItemList,"connector":this.options.connector,"parentId":this.options.parentId,"trackResolved":function(e){t.trackResolved(e)}})},"cancel":function(){return this.deferred.reject(),!0},"trackResolved":function(i){var s=t(".csui-conflict-dialog.csui-individual .csui-numConflicts");i?0==--this._resolveCount&&this._dialog.updateButton("upload",{"disabled":!1}):(this._resolveCount++,this._dialog.updateButton("upload",{"disabled":!0}));var o=this._resolveCount>1||0===this._resolveCount?n.conflictCount:n.oneConflict;return s.text(e.str.sformat(o,this._resolveCount)),!0},"_resolutionComplete":function(){return this.deferred.resolve(this._view.collection.models,this.removeItemList),!0}}),c.version="1.0",c}),csui.define("hbs!csui/controls/conflict.resolver/impl/collection.conflicts/collection.conflicts",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<span id="csui-collection-conflicts-title"\r\n      class="csui-collection-conflicts-title">'+this.escapeExpression((n=null!=(n=t.conflictsItemsTitle||(null!=e?e.conflictsItemsTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"conflictsItemsTitle","hash":{}}):n))+'</span>\r\n<ul id="csui-collection-conflict-items" class="csui-collection-conflict-items"></ul>\r\n'}});return i.registerPartial("csui_controls_conflict.resolver_impl_collection.conflicts_collection.conflicts",s),s}),csui.define("hbs!csui/controls/conflict.resolver/impl/collection.conflicts/collection.conflict.item",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<span class="csui-type-icon '+this.escapeExpression((n=null!=(n=t.icon||(null!=e?e.icon:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"icon","hash":{}}):n))+'" /><span class="item-name">'+this.escapeExpression((n=null!=(n=t.conflictsItemsName||(null!=e?e.conflictsItemsName:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"conflictsItemsName","hash":{}}):n))+"</span>\r\n"}});return i.registerPartial("csui_controls_conflict.resolver_impl_collection.conflicts_collection.conflict.item",s),s}),csui.define("csui/controls/conflict.resolver/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/conflict.resolver/impl/nls/root/lang",{"batchMessage":"These files already exist. How do you want to proceed?","skipConflicts":"Skip conflicts","resolveIndividual":"Resolve individually","conflictCount":"{0} Conflicts","upload":"Upload","cancel":"Cancel","addVersion":"Add version","conflictsItemsHeader":"Listed items will not be added"}),csui.define("css!csui/controls/conflict.resolver/impl/collection.conflicts/conflicts.dialog",[],function(){}),csui.define("csui/controls/conflict.resolver/impl/collection.conflicts/collection.conflicts.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","hbs!csui/controls/conflict.resolver/impl/collection.conflicts/collection.conflicts","hbs!csui/controls/conflict.resolver/impl/collection.conflicts/collection.conflict.item","csui/controls/node-type.icon/node-type.icon.view","i18n!csui/controls/conflict.resolver/impl/nls/lang","csui/controls/tile/behaviors/perfect.scrolling.behavior","css!csui/controls/conflict.resolver/impl/collection.conflicts/conflicts.dialog"],function(e,t,i,s,n,o,r,l){"use strict";var a=i.ItemView.extend({"tagName":"li","template":n,"className":"csui-conflict-item","templateHelpers":function(){return{"conflictsItemsName":this.model.get("name")}},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.call(this,e)},"onRender":function(){this._nodeIconView=new o({"el":this.$(".csui-type-icon").get(0),"node":this.model.node}),this._nodeIconView.render()}});return i.CompositeView.extend({"template":s,"className":"csui-conflicts-items-data","childView":a,"childViewContainer":"#csui-collection-conflict-items","ui":{"conflictItems":"#csui-collection-conflict-items"},"templateHelpers":function(){return{"conflictsItemsTitle":r.conflictsItemsHeader}},"behaviors":{"PerfectScrolling":{"behaviorClass":l,"contentParent":"ul.csui-collection-conflict-items","suppressScrollX":!0,"scrollYMarginOffset":15}},"constructor":function(s){s||(s={}),this.collection=s.collection||{},i.CompositeView.prototype.constructor.apply(this,arguments),this._onSetContaintListHeight=e.bind(this._setContainerListHeight,this),t(window).bind("resize.app",this._onSetContaintListHeight)},"onDomRefresh":function(){this._setContainerListHeight()},"_setContainerListHeight":function(){var e=.9*t(window).height()-100-60-112+"px";t(".csui-collection-conflict-items").css("max-height",e)},"onDestroy":function(){t(window).unbind("resize.app",this._onSetContaintListHeight)}})}),csui.define("css!csui/controls/conflict.resolver/impl/conflict.resolver",[],function(){}),csui.define("csui/controls/conflict.resolver/conflict.resolver",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/controls/dialog/dialog.view","i18n!csui/controls/conflict.resolver/impl/nls/lang","csui/utils/log","csui/controls/conflict.resolver/impl/conflict.dialog/conflict.dialog","csui/models/namequery","csui/utils/base","csui/models/fileuploads","css!csui/controls/conflict.resolver/impl/conflict.resolver"],function(e,t,i,s,n,o,r,l,a,c){"use strict";function u(i){this.options=i||{},this.deferred=t.Deferred(),this.container=i.container,this.actionBtnLabel=i.actionBtnLabel||n.upload,this.excludeAddVersion=i.excludeAddVersion||!1,this.files=i.files instanceof c?i.files:new c(i.files),this.deferred.then(e.bind(this.destroy,this),e.bind(this.destroy,this))}return e.extend(u.prototype,{"destroy":function(){this._dialog&&this._dialog.destroy()},"run":function(t){var i=this;return e.extend(this.options,t),this.queryNames(this.files).done(function(e,t){i._resolveConflicts(e,t)}).fail(function(e){var t=i.getMsgResponse(e);i.deferred.reject(new Error(t))}),this.deferred.promise()},"queryNames":function(e){var i=t.Deferred();return new l({"containerId":this.container.get("id")},{"connector":this.container.connector}).queryNames(e).done(function(e,t){i.resolve(e,t)}).fail(function(e){var t=new a.Error(e);i.reject(t)}),i},"getMsgResponse":function(e){var t=n.fileNameQueryFailed;return e&&(t=new a.RequestErrorMessage(e),t=t.message),t},"showBatchResolve":function(e){var i=t.Deferred(),s=n.batchMessage,o=[{"id":"versions","label":n.addVersion,"toolTip":n.addVersion,"click":function(e){i.resolve("versions",e.dialog)}},{"id":"skip","label":n.skipConflicts,"toolTip":n.skipConflicts,"click":function(e){i.resolve("skip",e.dialog)}},{"id":"individual","label":n.resolveIndividual,"toolTip":n.resolveIndividual,"click":function(e){i.resolve("individual",e.dialog)}}];return this.excludeAddVersion&&o.shift(),this._createDialog("csui-conflict-dialog csui-batch",e,o,s),i},"showIndividualResolve":function(t){var i,s=this;return e.each(t,function(e){e.excludeAddVersion=s.excludeAddVersion}),i=this._conflictDialog=new r({"parentId":this.container.get("id"),"connector":this.container.connector,"totalNumFiles":this.options.files.length,"conflictFiles":t,"actionBtnLabel":this.actionBtnLabel,"h1Label":this.options.h1Label}),i.show().done(function(e,t){s._removeDeletedFiles(t),s._returnFiles()}).fail(function(){s.deferred.reject({"userAction":"cancelResolveNamingConflicts"})}),i},"_createDialog":function(t,i,o,r,l){var a=e.str.sformat(n.conflictCount,i.length),c=this.options.h1Label+". "+a+". "+r,u=this._dialog=new s({"bodyMessage":r,"standardHeader":!1,"view":l,"className":t,"attributes":{"data-backdrop":"static"},"headers":[{"id":"h1","label":this.options.h1Label,"class":"csui-numUploads"},{"id":"h2","label":a,"class":"csui-numConflicts"}],"buttons":o,"dialogTxtAria":c});return u.listenTo(u,"hide",e.bind(this.deferred.reject,this)),u.show(),u},"_resolveConflicts":function(e,t){var i=this;return this.nonConflictFiles=e,t&&t.length>0?t.length>1?this.showBatchResolve(t).then(function(e,s){switch(s.kill(),e){case"versions":i._addVersions(t),i._returnFiles();break;case"individual":i.showIndividualResolve(t);break;case"skip":i._removeConnflicts(t),i._returnFiles()}}):this.showIndividualResolve(t):this.deferred.resolve(this.options.files,t.length>0),!0},"_returnFiles":function(){if(this.options.files.length&&this.options.files instanceof c)this.deferred.resolve(this.files);else if(this.files.length){var t=[];e.each(this.files.models,function(e){t.push(e.attributes)}),this.deferred.resolve(t)}else this.deferred.reject()},"_removeConnflicts":function(t){var i=this.files;e.each(t,function(e){i.remove(e)})},"_addVersions":function(t){
e.each(t,function(e){e.set("newVersion",!0)})},"_removeDeletedFiles":function(t){e.each(t,function(e){this.files.remove(e)},this)},"_getArrayOfFileNames":function(t){var i=[];return e.each(t,function(e){var t=e.newName||e.name;i.push({"name":t})}),i}}),u.version="1.0",u}),csui.define("csui/controls/draganddrop/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/draganddrop/impl/nls/root/lang",{"dropMessage":"Drop your file(s) into {0}.","dropNotPermitted":"No files can be dropped here.","dropInvalid":"Only files can be dropped here.","noFiles":"No files were dropped.","addTypeDenied":"Cannot add documents to {0}."}),csui.define("csui/controls/fileupload/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/fileupload/impl/nls/root/lang",{"uploadCounts":"Uploading {0} files","uploadCount":"Uploading 1 file","OneFileSuccessfullyUploaded":"{0} file was successfully uploaded.","AllFilesSuccessfullyUploaded":"{0} files were successfully uploaded.","over500Items":"Cannot add more than 500 items.","invalidFileList":"Invalid file list","fileNameQueryFailed":"File name query failed - reason unknown.","MessageVersionAdded":"Version added","pageLeavingWarning":"If you leave the page now, pending files will not be uploaded."}),csui.define("csui/controls/fileupload/impl/fileupload.collection",["require","module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/log","i18n!csui/controls/fileupload/impl/nls/lang","csui/controls/fileupload/impl/upload.controller","csui/models/fileuploads","csui/controls/globalmessage/globalmessage","csui/controls/conflict.resolver/conflict.resolver","csui/dialogs/modal.alert/modal.alert","csui/utils/page.leaving.blocker"],function(e,t,i,s,n,o,r,l,a,c,u,d,h){"use strict";var p=n.Model.extend({"defaults":{"parentCollection":null,"container":null},"constructor":function(e,t){e||(e={}),n.Model.prototype.constructor.call(this,e,t);var i=this.container=this.get("container"),s=this.get("parentCollection");this.uploadFiles=new a,this.controller=new l({"container":i}),s&&(this.originalCollectionUrl=s.url(),this.listenTo(s,"reset",this._stopCollectionUpdate),this.listenTo(s.node,"request",this._stopCollectionUpdate)),this._uploadCounts={"failed":0,"success":0,"complete":0}},"close":function(){return this.onDestroy(),this.trigger("destroy"),!0},"onDestroy":function(){return this.uploadView&&this.uploadView.destroy(),!0},"onUploadFileAdded":function(e){e.promise().done(s.bind(this.onFileUploadProcessed,this)).fail(s.bind(this.onFileUploadFailed,this))},"addFilesToUpload":function(e,t){var i=this;if(this._validateFileList(e)){var n=this.setBlocker();return this.addFilesToUploadCollection(e,t),this.resolveNamingConflicts(t).then(s.bind(this.checkAndHandleRequiredMetadata,this,t)).then(s.bind(this.addToUpload,this)).fail(function(e){e&&(e.error?c.showMessage("error",e.error.message):e.userAction&&"cancelAddOneItemWithRequiredMetadata"===e.userAction?i.trigger("metadata:cancelled"):e.userAction&&"closeMetadataActionView"===e.userAction?i.trigger("metadata:closed"):e.userAction&&"cancelResolveNamingConflicts"===e.userAction&&i.trigger("resolve:naming:conflicts:cancelled"))}).always(function(){n&&n.unblockActions(),i.close()}),!0}return this.close(),!1},"addFilesToUploadCollection":function(e,t){s.each(e,function(e){var i=e,s=i.container||t&&t.container||this.container,n=t&&t.collection||this.get("parentCollection");i.file&&(e=i.file);var o=i.newName||e.newName;this.uploadFiles.add({"file":e,"newName":o,"name":o||e.name,"extended_data":i.data||{},"collection":n,"subType":this.get("addableType")},{"container":s,"connector":s.connector,"enforcedRequiredAttrs":!0})},this)},"setBlocker":function(){var e=this.get("originatingView");return e&&e.blockActions||(e=void 0),e&&e.blockActions(),e},"resolveNamingConflicts":function(e){var t=this.uploadFiles,i=1===t.length?r.uploadCount:r.uploadCounts;return new u({"h1Label":s.str.sformat(i,t.length),"container":e&&e.container||this.container,"files":t}).run()},"_validateFileList":function(e){if(!e||0===e.length)return o.debug("No upload files selected")&&console.log(o.last),!1;var t=e[0];return!!(t.name||t.file&&t.file.name||t.get&&t.get("name"))||(c.showMessage("error",r.invalidFileList),!1)},"checkAndHandleRequiredMetadata":function(e,t){var s=this,n=i.Deferred();return csui.require(["csui/widgets/metadata/metadata.add.document.controller"],function(i){(new i).addItemsRequiredMetadata(t,{"container":e&&e.container||s.container,"addableType":144,"context":s.get("context")}).then(function(){return t}).done(n.resolve).fail(n.reject)},function(e){o.warn("Failed to load MetadataAddDocumentController. {0}",e)&&console.warn(o.last),n.reject(e)}),n.promise()},"addToUpload":function(e){if(e&&e.length>0){var t;s.each(e.models,function(e){if(!e.get("id")||e.get("newName")||e.get("newVersion")){var i=e.get("newName")||e.get("file").name;if(e.set("mime_type",e.get("file").type),o.debug("Object was added - {0}",i)&&console.log(o.last),!t){t=!0;var s=this.get("pageLeavingWarning")||r.pageLeavingWarning;h.enable(s)}this.controller.scheduleFileForUpload(e),this.onUploadFileAdded(e)}else o.debug("Object was skipped - {0}",e.name)},this)}else o.debug("No files were upload. All have naming conflict")&&console.log(o.last);this.showProgress(e)},"onFileUploadProcessed":function(e){if(!this.stopParentUpdate){var t=e.get("collection"),s=this.get("parentCollection");if(t||(t=s),t!==s||s&&s.url()==this.originalCollectionUrl){!e.get("newVersion")&&(e.node.isLocallyCreated=!0,t.unshift(e.node),i(".csui-new-item").closest("tbody").scrollTop(0))}}this._increaseUploadCount("success")},"onFileUploadFailed":function(e,t){this._increaseUploadCount("failed")},"showProgress":function(e){this.uploadView&&this.uploadView.destroy();var t={"originatingView":this.get("originatingView")};c.showFileUploadProgress(e,t)},"_stopCollectionUpdate":function(){this.stopParentUpdate=!1},"_increaseUploadCount":function(e){var t=this.uploadFiles.length,i=this._uploadCounts;if("failed"===e?i.failed++:i.success++,++i.complete===t&&(h.disable(),0===i.failed)){c.hideFileUploadProgress();var n=1===t?r.OneFileSuccessfullyUploaded:r.AllFilesSuccessfullyUploaded;c.showMessage("success",s.str.sformat(n,t))}this.close()}});return n.Collection.extend({"model":p})}),csui.define("csui/controls/fileupload/fileupload",["module","csui/lib/underscore","csui/lib/backbone","csui/controls/fileupload/impl/fileupload.collection"],function(e,t,i,s){"use strict";return{"newUpload":function(e,i){e||(e={}),i||(i={}),t.extend(i,{"parentCollection":e.collection,"container":e.container,"originatingView":e.originatingView,"context":e.context||i&&i.context}),this.collection||(this.collection=new s);var n=this.collection.add(i);return n.listenToOnce(n,"destroy",function(){this.collection.remove(n)},this),n}}}),csui.define("hbs!csui/controls/draganddrop/impl/draganddrop",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'\r\n  <span class="csui-messageBox">'+this.escapeExpression((n=null!=(n=t.message||(null!=e?e.message:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"message","hash":{}}):n))+"</span>\r\n"}});return i.registerPartial("csui_controls_draganddrop_impl_draganddrop",s),s}),csui.define("css!csui/controls/draganddrop/impl/draganddrop",[],function(){}),csui.define("csui/controls/draganddrop/draganddrop.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","csui/utils/log","i18n!csui/controls/draganddrop/impl/nls/lang","csui/controls/globalmessage/globalmessage","csui/controls/fileupload/fileupload","hbs!csui/controls/draganddrop/impl/draganddrop","css!csui/controls/draganddrop/impl/draganddrop","csui/lib/jquery.when.all"],function(e,t,i,s,n,o,r,l,a,c){var u=i.defaults({},e.config(),{"detectLeaveDelay":100});return s.ItemView.extend({"template":c,"className":"csui-dropMessage","ui":{"message":".csui-messageBox"},"templateHelpers":function(){return{"message":this._getDropPossibleMessage()}},"constructor":function(e){s.ItemView.prototype.constructor.call(this,e),this.collection=e.collection,this.container=e.container,this.addableTypes=e.addableTypes,this.wantDragAndDrop=!0,this.visible=!1,this.listenTo(this.options.container,"change:name",this._restMessage)},"setDragParentView":function(e,s){return this.parentView=e,this._parentEl=i.isString(s)&&e.$(s)||void 0!==s.length&&s||s&&t(s)||e.$el,this.render(),this._parentEl.append(this.el),this.shouldDragAndDrop()&&(this.disable(),this._setDragEvents()),!0},"onDestroy":function(){this.shouldDragAndDrop()&&this._parentEl&&this._parentEl.off("dragover",this.dragOver).off("dragleave",this.dragLeave).off("drop",this.dragDrop)},"_setDragEvents":function(){this.dragOver=i.bind(this.onOverView,this),this.dragLeave=i.bind(this.onLeaveView,this),this.dragDrop=i.bind(this.onDropView,this),this._parentEl.on("dragover",this.dragOver).on("dragleave",this.dragLeave).on("drop",this.dragDrop)},"getSupportedSubType":function(){return{"type":144,"type_name":"Document"}},"enable":function(e){if(this.visible||(!1!==e&&this.trigger("drag:over"),this.$el.show(),this.visible=!0),this.canAdd()){var t=this.getSupportedSubType();this.options.addableType=t.type,this.options.addableTypeName=t.type_name}},"disable":function(){this.$el.hide(),this.trigger("drag:leave"),this.visible=!1},"shouldDragAndDrop":function(){var e=!1,t=document.createElement("div");return window.File&&window.FileReader&&window.FileList&&window.Blob&&("draggable"in t||"ondragstart"in t&&"ondrop"in t)&&(e=!0),e&&this.wantDragAndDrop},"canAdd":function(){return!this.addableTypes||!!this.addableTypes.get(144)},"onOverView":function(e){e.preventDefault(),e.stopPropagation(),this.leaveViewTimeout?(clearTimeout(this.leaveViewTimeout),this.leaveViewTimeout=void 0):this.enable(!1);var t=e.originalEvent&&e.originalEvent.dataTransfer,s=t.items,n=s&&s.length&&i.all(s,function(e){return"file"===e.kind}),o=t&&t.types,l=o&&o.length&&i.any(o,function(e){return"Files"===e}),a=s&&n||l,c=r.dropInvalid;this.canAdd()||(a=!1,c=r.dropNotPermitted),a?(this.$el.hasClass("csui-disabled")&&(this._restMessage(),this.$el.removeClass("csui-disabled")),this.trigger("drag:over",this,{"disabled":!1})):(this.$el.hasClass("csui-disabled")||(this.ui.message.text(c),this.$el.addClass("csui-disabled")),this.trigger("drag:over",this,{"disabled":!0}))},"onLeaveView":function(e){e.preventDefault(),e.stopPropagation(),this.leaveViewTimeout||(this.leaveViewTimeout=setTimeout(i.bind(function(){this.leaveViewTimeout=void 0,this.disable()},this),u.detectLeaveDelay))},"onDropView":function(e){e.preventDefault(),e.stopPropagation();var t=this,s=e.originalEvent&&e.originalEvent.dataTransfer||{"files":e.originalEvent&&e.originalEvent.target&&e.originalEvent.target.files||[]};this._selectFiles(s).always(function(e){if(e=i.reject(e,function(e){return e instanceof Error}),e.length)if(t.canAdd()){var s=a.newUpload(i.extend({"originatingView":t.parentView},i.clone(t.options)),t.options);s.addFilesToUpload(e,{"collection":t.collection})}else{var n=t.container.get("name");l.showMessage("error",i.str.sformat(r.addTypeDenied,n))}else l.showMessage("error",r.noFiles)}),this.disable()},"_selectFiles":function(e){function s(e){var i,s=new FileReader,n=t.Deferred();return s.addEventListener("load",function(){n.resolve(e),i=!0,s.abort()}),s.addEventListener("error",function(){if(!i){var t=new Error("No file");t.file=e,n.reject(t)}}),s.readAsArrayBuffer(e),n.promise()}var n=!1,o=!1,r=e.items,l=r&&r.length&&i.chain(r).map(function(e){var t=e.webkitGetAsEntry&&e.webkitGetAsEntry();if(t&&t.isFile)return n=!0,e.getAsFile();o=!0}).compact().value()||e.files;if(n){var a=o?"reject":"resolve";return t.Deferred()[a](l).promise()}return l=e.files,l?t.whenAll.apply(t,i.map(l,s)).then(function(e){return e},function(e){return t.Deferred().reject(e).promise()}):t.Deferred().reject([]).promise()},"_restMessage":function(){this._isRendered&&this.ui.message.text(this._getDropPossibleMessage())},"_getDropPossibleMessage":function(){var e=this.options.container.get("name"),t="";return e&&(t=i.str.sformat(r.dropMessage,e)),t}})}),csui.define("csui/controls/fileupload/impl/addversion.controller",["csui/lib/underscore","csui/lib/jquery","i18n!csui/controls/fileupload/impl/nls/lang","csui/controls/fileupload/impl/upload.controller","csui/models/fileupload","csui/controls/globalmessage/globalmessage","csui/models/fileuploads"],function(e,t,i,s,n,o,r){"use strict";function l(e){this.view=e.view,this.selectedNode=e.selectedNode,this.uploadController=new s}return e.extend(l.prototype,{"uploadFile":function(t){this._blockActions();var s=new n({"file":t},{"node":this.selectedNode}),l=new r([s]);return this.uploadController.scheduleFileForUpload(s),o.showFileUploadProgress(l),s.promise().always(e.bind(this._unblockActions,this)).done(function(e){o.hideFileUploadProgress(),o.showMessage("success",i.MessageVersionAdded)})},"_blockActions":function(){this.view&&this.view.blockActions&&this.view.blockActions()},"_unblockActions":function(){this.view&&this.view.unblockActions&&this.view.unblockActions()}}),l}),csui.define("csui/controls/pagination/impl/keyevent.navigation",["csui/lib/underscore","csui/lib/jquery","csui/utils/base"],function(e,t,i){"use strict";return{"isTabable":function(){if(i.isVisibleInWindowViewport(this.ui.pageSizeMenu)&&i.isVisibleInWindowViewport(this.ui.navPagingMenu))return!0},"currentlyFocusedElement":function(){return this.getActiveChild()},"accActivateTabableRegion":function(){this.activateChild(!0)},"onKeyInView":function(e){var t=e.keyCode;this.getActiveChild();switch(this.activeChild||(this.activeChild=this.ui.dropDownMenu),t){case 32:case 13:if(this.activeChild===this.ui.dropDownMenu)return!0;this.executeAction(this.activeChild);break;case 39:var i=this._getNextActiveChild();this.setNextActiveChild(i);break;case 37:var s=this._getPrevActiveChild();this.setNextActiveChild(s);break;case 38:if(this.activeChild===this.ui.dropDownMenu)return!0;this._pageUp();break;case 33:this._pageUp();break;case 40:if(this.activeChild===this.ui.dropDownMenu)return!0;this._pageDown();break;case 34:this._pageDown();break;case 36:this._activateHomeElem();break;case 35:this._activateEndElem()}},"executeAction":function(e){if(e){var t=e.attr("data-pageid"),i=e.attr("data-slidepage");if(i){var s=parseInt(i,10);this.slidePageMenu(s),this.activeChild=this.ui.navPagingMenu.find("a").first(),this.activateChild(!0,this.activeChild)}else if(t){var n=parseInt(t,10);this.changePage(n),this.activeChild.removeClass("csui-acc-focusable-active")}}},"activateChild":function(e,t){t||(t=this.getActiveChild()),e?(t.addClass("csui-acc-focusable-active"),t.focus()):t.removeClass("csui-acc-focusable-active")},"setActiveChild":function(e){this.activeChild=e},"getActiveChild":function(){return this.activeChild||(this.activeChild=this.ui.dropDownMenu),this.activeChild},"setNextActiveChild":function(e){e!==this.activeChild&&(this.activateChild(!1,this.activeChild),this.activateChild(!0,e),this.activeChild=e)},"resetActiveChild":function(){var e=this.activeChild;if(this.activateChild(!1),this.activeChild=null,e){var t=e.attr("data-pageid"),i=e.attr("data-slidepage");if(t)this.activeChild=this._updatedChildPosition(t,e);else if(i&&this.numSlideMenus>1){var s=e.parent().prev();s=s.length>0?s.find("a"):e.parent().next().find("a"),t=s.attr("data-pageid"),this.activeChild=this._updatedChildPosition(t,s)}}this.activeChild||(this.activeChild=this.ui.dropDownMenu)},"_updatedChildPosition":function(i,s){if(i=parseInt(i,10),this.totalCount>this.pageSize){var n=this.numPages-1;i=i>n?n:i;var o=Math.floor(i/this.pageTabsPerMenu);return o>0&&this._initializePageTabMenu(!0,!0,o),i+="",s=e.find(this.ui.navPagingMenu.find("a"),function(e){return t(e).attr("data-pageid")===i}),t(s)}return null},"_getPrevActiveChild":function(){var e=this.ui.dropDownMenu,t=this.activeChild;if(t===this.ui.dropDownMenu)e=this.ui.navPagingMenu.find("a").last();else{var i=t.attr("data-pageid"),s=t.attr("data-slidepage");if(i||s){var n=t.parent().prev().find("a");n.length>0&&(e=n)}}return e},"_getNextActiveChild":function(){var e=this.ui.dropDownMenu,t=this.activeChild;if(t===this.ui.dropDownMenu)e=this.ui.navPagingMenu.find("a").first();else{var i=t.attr("data-pageid"),s=t.attr("data-slidepage");if(i||s){var n=t.parent().next().find("a");n.length>0&&(e=n)}}return e},"_activateHomeElem":function(){this.activeChild=this.ui.dropDownMenu,this.activateChild(!0,this.activeChild)},"_activateEndElem":function(){this.activeChild=this._getLastElem(),this.activateChild(!0,this.activeChild)},"_getLastElem":function(){return this.ui.navPagingMenu.find("a").last()},"_pageUp":function(){var e=this.ui.navPagingMenu.find("a").last();this._page(e)},"_page":function(e){e.attr("data-slidepage")&&(this.activateChild(!1,this.activeChild),this.activeChild=e,this.executeAction(this.activeChild))},"_pageDown":function(){var e=this.ui.navPagingMenu.find("a").first();this._page(e)}}}),csui.define("csui/controls/pagination/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/pagination/nls/root/localized.strings",{"PageNavBarAboutItems":"About {0} items"}),csui.define("csui/controls/pagination/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/pagination/impl/nls/root/localized.strings",{"PageNavBarTotalItems":"{0} items","PageNavBarSingleItem":"1 item","PageNavBarItemsPerPage":"{0} per page","PageNavBarShowAll":"Show all","PageNTotalsAria":"Showing page {0} of {1}, {2} items overall","ShowPageNAria":"Show page {0}","PreviousPagesAria":"Show previous pages","NextPagesAria":"Show next pages","SinglePageTotalsAria":"Showing {0} items","PageSizeMenuAria":"Select page size, currently {0}","PageSizeChoiceAria":"Pagination, show {0} per page","PaginationLandmarkAria":"Pagination"}),csui.define("hbs!csui/controls/pagination/impl/nodespagination",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-total-container-items">'+this.escapeExpression((n=null!=(n=t.totalItems||(null!=e?e.totalItems:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"totalItems","hash":{}}):n))+'</div>\r\n<div class="binf-nav expanded-pager pager-filter csui-pagesize-menu">\r\n  <div class="binf-dropdown csui-dropdown">\r\n    <a href="" class="binf-dropdown-toggle"  data-binf-toggle="dropdown" role="button" aria-expanded="false" tabindex="0" aria-label="'+this.escapeExpression((n=null!=(n=t.pageSizeMenuAria||(null!=e?e.pageSizeMenuAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"pageSizeMenuAria","hash":{}}):n))+'">\r\n      <div class="csui-pageSize">'+this.escapeExpression((n=null!=(n=t.itemsPerPage||(null!=e?e.itemsPerPage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"itemsPerPage","hash":{}}):n))+'</div>\r\n      <div class="csui-icon icon-expandArrowDown"></div>\r\n    </a>\r\n    <ul class="binf-dropdown-menu binf-dropdown-menu-right csui-dropdown-list" role="menu">\r\n    </ul>\r\n  </div>\r\n</div>\r\n\r\n<div class="csui-pagination">\r\n  <div class="csui-paging-navbar">\r\n    <ul class="binf-hidden">\r\n      <li class="csui-overflow"></li>\r\n    </ul>\r\n  </div>\r\n</div>\r\n'}});return i.registerPartial("csui_controls_pagination_impl_nodespagination",s),s}),csui.define("css!csui/controls/pagination/impl/nodespagination",[],function(){}),csui.define("csui/controls/pagination/nodespagination.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/pagination/impl/keyevent.navigation","csui/controls/mixins/global.alert/global.alert.mixin","i18n!csui/controls/pagination/nls/localized.strings","i18n!csui/controls/pagination/impl/nls/localized.strings","hbs!csui/controls/pagination/impl/nodespagination","css!csui/controls/pagination/impl/nodespagination"],function(e,t,i,s,n,o,r,l,a,c){"use strict";var u=i.ItemView.extend({"template":c,"className":"csui-pager","ui":{"totalCount":"> .csui-total-container-items","pageSizeMenu":"> .csui-pagesize-menu","dropDownMenu":"> .csui-pagesize-menu > .csui-dropdown > .binf-dropdown-toggle","dropDownList":"> .csui-pagesize-menu .csui-dropdown-list","navPagingMenu":"> .csui-pagination > .csui-paging-navbar","dropDownListItem":"> .csui-pagesize-menu ul.csui-dropdown-list a"},"templateHelpers":function(){var e=this._getTotalCount(),i=this.pageSize&&this.pageSize>0?this.pageSize:30;return this.pageTotalAria=e<=i?t.str.sformat(a.SinglePageTotalsAria,e):t.str.sformat(a.PageNTotalsAria,this.currentPageNum,1+Math.floor(e/i),e),this.nextPagesAria=a.NextPagesAria,this.previousPagesAria=a.PreviousPagesAria,{"totalItems":this._getTotalDisplayCount(),"itemsPerPage":t.str.sformat(a.PageNavBarItemsPerPage,this.pageSize),"pageSizeMenuAria":t.str.sformat(a.PageSizeMenuAria,this.pageSize)}},"events":{"keyup @ui.dropDownListItem":"resetPageSizeKeyUp","click .csui-pagesize-menu ul.csui-dropdown-list a":"resetPageSize","click .csui-paging-navbar > ul > li:not(.csui-overflow) > a":"onChangePage","click .csui-pagination  li.csui-overflow > a":"onSlidePageMenu","keydown":"onKeyInView"},"behaviors":{"TabableRegion":{"behaviorClass":n}},"constructor":function(s){s||(s={}),s.pageSize||(s.pageSize=30),i.ItemView.prototype.constructor.call(this,s),this.addPaging=!0,this.currentPageNum=1,this.ddList=this.defaultDDList=s.defaultDDList||[30,50,100],this.skipCollectionRequest=!1,this.skipPaginationUpdateRequest=!!s.skipPaginationUpdateRequest,this.pageSize=this.selectedPageSize=this.options.pageSize,this.rendered=!1,this.pageTotalAriaLast=void 0,this.pageTotalTimeoutHandle=void 0,this.collection&&(this.collection.setLimit(0,this.options.pageSize,!1),this.listenTo(this.collection,"reset",this.collectionChange),this.listenTo(this.collection,"add",this._maintainPageSize),this.listenTo(this.collection,"remove",this._maintainPageSize),this.collection.node&&this.listenTo(this.collection.node,"change:id",this.nodeChange)),this.onWinRefresh=t.bind(this.windowRefresh,this),e(window).bind("resize.app",this.onWinRefresh),this.prepareForGlobalAlert()},"onDestroy":function(){e(window).unbind("resize.app",this.onWinRefresh)},"windowRefresh":function(){this._isRendered&&(this._initializePageTabMenu(!1,!0),this.resetActiveChild())},"collectionChange":function(){var e=this.$el.find(".csui-paging-navbar ul");this.totalCount=0,e.empty(),e.remove(),"setPageSize"!==this.lastAction&&this._reCalculatePageSizes(),this.lastAction="",this.render()},"nodeChange":function(){this.pageSize=this.selectedPageSize=this.options.pageSize,this.totalCount=0,this.resetRenderFlags(),this.resetCollection(0,this.pageSize,!1),this._isRendered&&this.setActiveChild(this.ui.dropDownMenu)},"resetRenderFlags":function(){this.addPaging=!0},"onChangePage":function(t){t.preventDefault(),t.stopPropagation();var i=e(t.currentTarget),s=parseInt(i.attr("data-pageid"),10);this.changePage(s),this.setActiveChild(i)},"changePage":function(e){var t=this.pageSize;this.currentPageNum=e+1;var i=e*t;this.collection.pagination=this.addPaging,this.collection.trigger("new:page"),this.resetCollection(i,t,!0),this.templateHelpers()},"resetCollection":function(e,t,i){this.collection.setLimit(e,t,i)},"resetPageSizeKeyUp":function(e){return 32===e.keyCode&&this.resetPageSize(e),!0},"resetPageSize":function(t){t.preventDefault(),t.stopPropagation(),this.collection.pagination=this.addPaging;var i=parseInt(e(t.currentTarget).attr("data-pagesize"),10);this.setPageSize(i,!0)},"setPageSize":function(e,t){this.pageSize=this.selectedPageSize=e,this.skipCollectionRequest||!t?this.skipCollectionRequest=!1:(this.rendered=!1,this.resetCollection(0,e,t)),this.lastAction="setPageSize",this.currentPageNum=1},"_setPageTotalAria":function(){this.pageTotalAria!=this.pageTotalAriaLast&&(this.$el.parent().children(".binf-sr-only").html(this.pageTotalAria),this.pageTotalAriaLast=this.pageTotalAria,this.pageTotalTimeoutHandle=void 0)},"onRender":function(){var e=this.collection,t=this.$el.parent().children(".binf-sr-only");t&&t.length||this.$el.before('<div class="binf-sr-only" aria-live="polite"></div>'),this._validCollection(e)?(this.pageSize=this.pageSize>this.options.pageSize&&this.pageSize>this.totalCount?this.totalCount:this.pageSize,this.rendered=!0,this.$el.removeClass("binf-hidden"),this._initializeDDList(),this.pageTotalTimeoutHandle&&clearTimeout(this.pageTotalTimeoutHandle),this.pageTotalTimeoutHandle=setTimeout(this._setPageTotalAria.bind(this),1200)):(this.$el.addClass("binf-hidden"),this.pageTotalTimeoutHandle||(this.pageTotalTimeoutHandle=setTimeout(this._setPageTotalAria.bind(this),2400))),this.trigger("render:complete")},"onDomRefresh":function(){if(this._validCollection(this.collection)&&this.rendered){var e=this.totalCount;e>this.options.pageSize?(this._setPageSizeMenu(),e>this.pageSize&&this._initializePageTabMenu(!0,!0)):this._showTotalOnly(),this.resetActiveChild()}},"hidePaging":function(){return this.$el.find(".csui-pagination").addClass("binf-hidden"),!0},"onSlidePageMenu":function(t){t.preventDefault(),t.stopPropagation();var i=parseInt(e(t.currentTarget).attr("data-slidepage"),10);this.slidePageMenu(i)},"slidePageMenu":function(e){var t=this.$el;this._initializePageTabMenu(!0,!0,e),t.find(".csui-pages-"+e).addClass("csui-slide")},"getDDList":function(e){for(var t=this.defaultDDList,i=t.length,s=[],n=0;n<i;n++){if(t[n]>=e){s.push(e);break}s.push(t[n])}return s},"_getOverflowIconWidth":function(){if(!this.overFlowIcon||0===this.overFlowIcon){var e=this.$el.find(".csui-paging-navbar > ul > li.csui-overflow");this.overFlowIcon=parseInt(e.css("width"),10)}return this.overFlowIcon},"_getPageTabMinWidth":function(){if(!this.pageTabMinWidth||0===this.pageTabMinWidth){var e=this.$el.find(".csui-paging-navbar > ul > li");this.pageTabMinWidth=parseInt(e.css("min-width"),10),e=null}return this.pageTabMinWidth=64,this.pageTabMinWidth},"_initializeDDList":function(){this.ddList=this.getDDList(this.totalCount)},"_validCollection":function(e){var t=!1,i=this.totalCount;if(e){var n=this._getTotalCount(e);this.totalCount=i&&i<n?i:n,n&&n>0&&(t=!0)}else s.error("Pagination won't be rendered (collection is not set)")&&console.error(s.last);return t},"_showTotalOnly":function(){this.$el.parent().removeAttr("role"),this.$el.find(".csui-pagesize-menu").addClass("binf-hidden"),this.$el.find(".csui-pagination").addClass("binf-hidden"),this.$el.find(".csui-total-container-items").addClass("csui-pagination-top-bottom-padding"),this.triggerMethod("tabable:not",this)},"_getTotalDisplayCount":function(){var e=this.collection,i=this._getTotalCount(),s="";return i>0&&(s=1===i?a.PageNavBarSingleItem:i===e.skipCount+e.length?a.PageNavBarTotalItems:l.PageNavBarAboutItems,s=t.str.sformat(s,i)),s},"_setPageSizeMenu":function(){var e=this.totalCount;e>this.options.pageSize&&(this.ddList.length>1?(this._addPageSizeOptions(e),this.ui.pageSizeMenu.removeClass("binf-hidden")):this.ui.pageSizeMenu.addClass("binf-hidden"))},"_addPageSizeOptions":function(e){var i="",s=[],n=this.ddList,o=this.pageSize;this.ui.dropDownList[0].innerHTML="";for(var r=n.length-1;r>=0;r--){var l=n[r],c=l===e?a.PageNavBarShowAll:t.str.sformat(a.PageNavBarItemsPerPage,l),u=t.str.sformat(a.PageSizeChoiceAria,l),d=l===o?"csui-select":"",h=l===o?' aria-current="true" ':"",p='<li role="menuitem"><a href="#" class="'+d+'" data-pagesize='+l+h+' aria-label="'+u+'"><span class="csui-pagination-checked icon-listview-checkmark"></span>'+c+"</a></li>";s.push(p),i+=p}return this.ui.dropDownList.append(i),!0},"_initializePageTabMenu":function(e,t,i){this.$el.parent().attr("role","navigation").attr("aria-label",a.PaginationLandmarkAria);var s=this._getPageTabMinWidth(),n=this._getOverflowIconWidth();this._setPageTabMenu(s,n,e,t,i)},"_setPageTabMenu":function(e,t,i,s,n){var o=this.numPages=Math.ceil(this.totalCount/this.pageSize),r=this._getPageTabsPerSlideMenu(e,t,o);this.numSlideMenus=Math.ceil(o/r),(i||r!==this.pageTabsPerMenu)&&(this.pageTabsPerMenu=r,s&&this.ui.navPagingMenu.html(""),this._addSideMenu(this.numSlideMenus,r,o,s,n))},"_getPageTabsPerSlideMenu":function(e,t,i){var s=this.ui.navPagingMenu.width(),n=Math.floor(s/e);return n<i&&(n=Math.floor((s-t)/e),(n=2*n<i?n-1:n)<=0&&(n=1)),n},"_addSideMenu":function(t,i,s,n,o){var r=this.ui.navPagingMenu,l=this.collection.skipCount,a=this.totalCount,c=this.pageSize,u=l>a?s-1:l/c;o=null==o?Math.floor(u/i):o;var d=o*i,h="",p=e('<ul class="binf-nav expanded-pager pager-tabs csui-pages csui-pages-'+o+'"></ul>');o>0&&(h+='<li class="csui-overflow"><a href="#" tabindex="-1" class="csui-overflow-left" data-slidePage="'+(o-1)+'" aria-label="'+this.previousPagesAria+'" title="'+this.previousPagesAria+'"><span class="csui-icon goto_previous_page"></span></a></li>'),h+=this._addPageTabs(d,u,i,s),n&&p.addClass("csui-active"),o<t-1&&(h+='<li class="csui-overflow"><a href="#" tabindex="-1" class="csui-overflow-right" data-slidePage="'+(o+1)+'" aria-label="'+this.nextPagesAria+'" title="'+this.nextPagesAria+'"><span class="csui-icon goto_next_page"></span></a></li>'),o===t-1?this.$el.find(".csui-pagination").find(".csui-paging-navbar").addClass("csui-last-slidePage"):this.$el.find(".csui-pagination").find(".csui-paging-navbar").removeClass("csui-last-slidePage"),p.append(h),r.html(p)},"_addPageTabs":function(e,i,s,n){for(var o=e+s>=n?n:e+s,r="",l=e;l<o;l++){var c=l+1;r+='<li><a href="#" tabindex="-1" class="',l===i&&(r+='csui-activePage" aria-current="page');var u=t.str.sformat(a.ShowPageNAria,c);r+='" data-pageid="'+l+'" aria-label="'+u+'" title="'+u+'"><span>'+c+"</span></a></li>"}return r},"_reCalculatePageSizes":function(){this._calculateSelectPageSize(),this._reCalculatePageSize()},"_calculateSelectPageSize":function(){var e=this.selectedPageSize,i=this._getTotalCount(),s=this.defaultDDList;this.selectedPageSize=t.indexOf(s,e)>-1?e:e>=i?i:t.find(s,function(t){return e<t})},"_reCalculatePageSize":function(){var e=this.options.pageSize,t=this._getTotalCount();this.pageSize=0===t?e:this.selectedPageSize>t?t:this.selectedPageSize},"_maintainPageSize":function(e,t,i){return e.get("csuiIsSelected")&&e.set("csuiIsSelected",!1),this._updateTotalCount(i),this.resetRenderFlags(),this._initializeDDList(!1),!this.skipPaginationUpdateRequest&&this.collection.models.length>this.selectedPageSize?(this.stopListening(this.collection,"remove"),this.collection.pop(),this.listenTo(this.collection,"remove",this._maintainPageSize)):this.skipPaginationUpdateRequest&&this.collection.allModels&&this.collection.allModels.length===this.collection.skipCount&&(this.collection.skipCount=this.collection.skipCount-this.collection.topCount),this.skipCollectionRequest=!0,this._reCalculatePageSizes(),this.render(),!0},"_getTotalCount":function(e){var t=0;return e||(e=this.collection),e&&(t=e.filteredCount,null==t&&(t=e.totalCount),null==t&&(t=e.length)),t},"_updateTotalCount":function(e){var t=e.add?1:-1;this.totalCount+=t,null!=this.collection.filteredCount&&(this.collection.filteredCount+=t),null!=this.collection.totalCount&&(this.collection.totalCount+=t)}});return t.extend(u.prototype,o),t.extend(u.prototype,r),u}),csui.define("hbs!csui/controls/tableactionbar/impl/tableactionbar",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<ul class="tile-nav binf-nav binf-nav-pills" role="menu"></ul>\r\n'}});return i.registerPartial("csui_controls_tableactionbar_impl_tableactionbar",s),s}),csui.define("hbs!csui/controls/tableactionbar/impl/lazy.loading.template",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){
return'<li role="menuitem" class="csui-loading-parent-wrapper binf-disabled csui-disbaled">\r\n  <span class="csui-loading-dots-wrapper">\r\n    <span class="csui-loading-dot"></span>\r\n    <span class="csui-loading-dot"></span>\r\n    <span class="csui-loading-dot"></span>\r\n  </span>\r\n</li>'}});return i.registerPartial("csui_controls_tableactionbar_impl_lazy.loading.template",s),s}),csui.define("css!csui/controls/tableactionbar/impl/tableactionbar",[],function(){}),csui.define("csui/controls/tableactionbar/tableactionbar.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","i18n","csui/controls/toolbar/toolitem.model","csui/controls/toolbar/toolitem.view","csui/controls/toolbar/toolbar.view","csui/models/nodes","csui/controls/toolbar/toolitems.filtered.model","csui/controls/toolbar/toolbar.state.behavior","csui/utils/commandhelper","csui/utils/commands","hbs!csui/controls/tableactionbar/impl/tableactionbar","hbs!csui/controls/tableactionbar/impl/lazy.loading.template","csui/controls/tile/behaviors/perfect.scrolling.behavior","css!csui/controls/tableactionbar/impl/tableactionbar"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b,g,v){"use strict";var w=n.CompositeView.extend({"className":"csui-table-actionbar","template":b,"childView":c,"childViewContainer":"ul","behaviors":{"ToolbarState":{"behaviorClass":p}},"constructor":function(e){this.container=e.container,this.containerCollection=e.containerCollection,this.originatingView=e.originatingView,this.commandExecutionOptions=e.commandExecutionOptions,e.status||(e.status={});var s=t.defaults(e.status,{"nodes":new d([e.model]),"container":this.container,"context":this.originatingView.context});this.commands=e.commands||f,e.collection=new h(e.collection,{"status":s,"commands":this.commands,"delayedActions":e.delayedActions,"mask":e.toolItemsMask}),n.CompositeView.prototype.constructor.apply(this,arguments),this.model.nonPromotedActionCommands&&this.model.nonPromotedActionCommands.length&&e.collection.length<=1&&this.actionState.set("state","loading"),e.el&&i(e.el).addClass(t.result(this,"className"))},"isEmpty":function(e){return this.collection.length<=1},"onBeforeDestroy":function(){this.originatingView=null,this.collection.stopListening()},"onBeforeRenderCollection":function(){this.destroyChildren(),this.$childViewContainer&&this.$childViewContainer.empty()},"onRenderCollection":function(){this._adjusted=!1,r.isVisibleInWindowViewport(this.$el)&&this._layoutButtons()},"onRender":function(){this.options.inlineBarStyle&&this.$el.addClass(this.options.inlineBarStyle),this._isBlocked&&this.$el.addClass("binf-disabled")},"onShow":function(){this._layoutButtons()},"_layoutButtons":function(){var e=this.options.delayedActions;if(!e||!e.fetching&&!e.error){if(this._adjusted)return!0;this._adjusting=!0;var i=this.model,s=!!i&&!!i.get("csuiLazyActionsRetrieved"),n=!!i.isLocallyCreated,o=t.sortBy(this.children.toArray(),"cid");o=o.filter(function(e){return e instanceof c}),this.actionbarOptions={"toolItemCounter":0,"cntItemsFit":0,"index":0,"dropDownMenuEl":void 0,"separatorView":void 0},this.enabledNonPomotedCommands=!1!==i.collection.enableNonPromotedCommands||i.collection.enableNonPromotedCommands,o.length>1?(this.firstOffsetY=this.children.first().$el.offset().top,t.each(o,t.bind(function(e,t){this.actionbarOptions.index=t,this._wrapToolItemView(e)},this)),i&&!s&&i.nonPromotedActionCommands&&this.enabledNonPomotedCommands&&i.nonPromotedActionCommands.length&&!n?this.$childViewContainer.find(".binf-dropdown").length?this.$childViewContainer.find(".binf-dropdown ul").append(g):(this.actionbarOptions.toolItemCounter===this.options.maxItemsShown&&this.$childViewContainer.find("li:last").length>0&&this.$childViewContainer.find("li:last").addClass("csui-actionbar-hide-child"),this.$childViewContainer.append(g),this._renderLazyActions().always(t.bind(function(){this._checkInlineActionBarShouldAlive()},this))):this._checkInlineActionBarShouldAlive()):i&&!s&&i.nonPromotedActionCommands&&i.nonPromotedActionCommands.length&&!n&&this.enabledNonPomotedCommands?this._renderLazyActions().always(t.bind(function(){this._checkInlineActionBarShouldAlive()},this)):this._checkInlineActionBarShouldAlive(),this._adjusting=!1,this._adjusted=!0}},"_checkInlineActionBarShouldAlive":function(){this.actionbarOptions.cntItemsFit<2&&1!==this.options.maxItemsShown&&this.destroy()},"_wrapToolItemView":function(e){if(e instanceof c){var t=e.model.isSeparator();if(t||this.actionbarOptions.toolItemCounter++,this.actionbarOptions.dropDownMenuEl)t&&this.actionbarOptions.index+1===this.children.length||(e.renderTextOnly(),e.$el.attr("role","menuitem"),this.actionbarOptions.dropDownMenuEl.append(e.$el));else if(t)this.actionbarOptions.separatorView=e;else{var i=e.$el.offset().top;i!==this.firstOffsetY||this.actionbarOptions.toolItemCounter>this.options.maxItemsShown?this.actionbarOptions.prevToolItemView?(this.actionbarOptions.prevToolItemView.$el.attr("role","menuitem"),this.actionbarOptions.dropDownMenuEl=this._wrapWithDropDown(this.actionbarOptions.prevToolItemView,e,this.actionbarOptions.separatorView)):this.actionbarOptions.dropDownMenuEl=this._wrapWithDropDown(e.$el,e):this.actionbarOptions.cntItemsFit++,this.actionbarOptions.prevToolItemView=e}}},"_renderLazyActions":function(){var e=this,s=this.model,n=i.Deferred();return!!s&&s.setEnabledLazyActionCommands(!0).done(t.bind(function(){var i=new h(e.options.collection.unfilteredModels,{"status":e.options.status,"commands":e.commands,"delayedActions":e.model.delayedActions,"mask":e.options.toolItemsMask}),s=e.$childViewContainer.find(".csui-loading-parent-wrapper");s.length?s.animate("width: 0",300,function(){e.$childViewContainer.find(".csui-actionbar-hide-child").removeClass("csui-actionbar-hide-child"),s.addClass("binf-hidden"),e.actionbarOptions.toolItemCounter<e.options.maxItemsShown&&s.addClass("binf-maxtoolitems-not-reached"),e.collection.models.length!==i.models.length&&t.filter(i.models,function(t){if(!0===e.isDestroyed||e._isDestroyed)e.children=void 0;else{var i=t.get("signature");if(!e.collection.find({"signature":i})){e.actionbarOptions.index++;var s=e.addChild(t,c,e.actionbarOptions.index);e._wrapToolItemView(s)}}}),n.resolve()}):(!0===e.isDestroyed||e._isDestroyed?e.children=void 0:e.collection.refilter(),n.resolve())}),e).fail(function(){e.$childViewContainer.find(".csui-loading-parent-wrapper").remove(),e.$childViewContainer.find(".csui-actionbar-hide-child").removeClass("csui-actionbar-hide-child"),n.reject()}),n.promise()},"_wrapWithDropDown":function(e,s,n){e.renderTextOnly(),e.$el.wrap('<li class="binf-dropdown"><ul class="binf-dropdown-menu" role="menu"></ul></li>');var o=this._makeDropDown();this.$el.find("li.binf-dropdown").prepend(o);var a=this.$el.find("li.binf-dropdown > a.binf-dropdown-toggle");a.bind("binf.dropdown.before.show",t.bind(function(){i(this.nextElementSibling).addClass("binf-invisible");var e=this.model,t=!!e.get("csuiLazyActionsRetrieved"),s=!!e.isLocallyCreated;e&&!t&&e.nonPromotedActionCommands&&e.nonPromotedActionCommands.length&&!s&&this.enabledNonPomotedCommands&&this._renderLazyActions()},this));var c=s._parent;c.listenTo(c,"destroy",function(){i(".csui-zero-zindex").removeClass("csui-zero-zindex")});var u=this;a.bind("binf.dropdown.after.show",function(){var e=i(this).closest(".csui-perfect-scrolling").length>0?".csui-perfect-scrolling":".csui-normal-scrolling",t=i(this).closest(e),s=i(this).nextAll(".binf-dropdown-menu");r.autoAlignDropDowns(i(this),s,!0,s,r.isIE11());var n={};if(t.width()<s.offset().left+s.width()&&(n.left=s[0].offsetLeft+i(this).outerWidth()-s.width()),l.settings.rtl&&s.siblings(".binf-dropdown-toggle").offset().left-t.offset().left<s.width()&&(n.right="auto",r.isIE11()?n.left=s.siblings(".binf-dropdown-toggle").offset().left:n.left=s.siblings(".binf-dropdown-toggle").offset().left-t.offset().left),"auto"===s.prop("style").top){if(n.maxHeight=Math.floor(window.innerHeight-(window.innerHeight-s.closest(".binf-dropdown").offset().top))-5,u.model.get("csuiDelayedActionsRetrieved")&&!u.model.get("csuiLazyActionsRetrieved")&&u.model.nonPromotedActionCommands&&u.model.nonPromotedActionCommands.length&&u.enabledNonPomotedCommands){var o=s.closest(".binf-dropdown"),a=i(o).find(".csui-loading-parent-wrapper");a.length&&a.remove(),o.addClass("csui-actionbar-hide-child"),s.closest(".csui-table-actionbar .binf-nav").append(g)}i("#breadcrumb-wrap").length>0&&(i("#breadcrumb-wrap").addClass("csui-zero-zindex"),i(".csui-navbar.binf-navbar.binf-navbar-default").addClass("csui-zero-zindex"),i(".csui-search-tool-container").length>0&&i(".csui-search-tool-container").addClass("csui-zero-zindex"))}else n.maxHeight=Math.floor(window.innerHeight-s.closest(".binf-dropdown").offset().top)-s.closest(".binf-dropdown").height()-5,i("#breadcrumb-wrap").length>0&&(i("#breadcrumb-wrap").removeClass("csui-zero-zindex"),i(".csui-navbar.binf-navbar.binf-navbar-default").removeClass("csui-zero-zindex"),i(".csui-search-tool-container").length>0&&i(".csui-search-tool-container").removeClass("csui-zero-zindex"));s.css(n);var c;u.usePerfectScrollbar()?(s.addClass("csui-perfect-scrolling"),s.perfectScrollbar({"suppressScrollX":!0,"includePadding":!0}),c=s.closest(".binf-dropdown").closest(".csui-perfect-scrolling.ps-container")):c=s.closest(".binf-dropdown").scrollParent(),c.bind("scroll.csui.inline.actions",function(e){!s.is(":hidden")&&s.binf_dropdown("toggle"),i(e.target).unbind("scroll.csui.inline.actions")})});var d=this.$el.find("li.binf-dropdown>ul.binf-dropdown-menu");return n&&(n.renderTextOnly(),d.append(n.$el)),s.renderTextOnly(),s.$el.attr("role","menuitem"),d.append(s.$el),d},"_makeDropDown":function(){var e='<a role="button" href="#" tabindex="-1" class="binf-dropdown-toggle" data-binf-toggle="dropdown" aria-expanded="false"';return this.options.dropDownText?e+=' title="'+this.options.dropDownText+'" aria-label="'+this.options.dropDownText+'">':e+=">",this.options.dropDownIcon?e+='<span class="'+this.options.dropDownIcon+'"></span>':this.options.dropDownText&&(e+=this.options.dropDownText),e+="</a>"},"_setBlocked":function(){var e=this;this._blockedTimer=setTimeout(function(){!1===e._isBlocked&&e.$el.removeClass("binf-disabled"),e._blockedTimer=void 0},500),this._isBlocked=!0,this.$el.addClass("binf-disabled")},"_setUnblocked":function(){this._isBlocked=!1,this._blockedTimer||this.$el.removeClass("binf-disabled")},"onChildviewToolitemAction":function(e,i){var n=this,o=i.toolItem.get("signature"),r=this.commands.findWhere({"signature":o}),l=t.defaults(this.options.status,{"nodes":new d([this.model]),"container":this.container,"originatingView":this.originatingView,"context":this.originatingView.context});l.collection=this.containerCollection,l.data=i.toolItem.get("commandData")||{};var a={"status":l,"commandSignature":o};this.trigger("before:execute:command",a),this._setBlocked(),s.trigger("closeToggleAction");var c=r.execute(l,this.commandExecutionOptions);m.handleExecutionResults(c,{"command":r,"suppressSuccessMessage":l.suppressSuccessMessage,"suppressFailMessage":l.suppressFailMessage,"customError":this.options.customError}).done(function(e){r.allowCollectionRefetch&&n.options.originatingView.collection.totalCount>n.options.originatingView.collection.topCount&&n.options.originatingView.collection.fetch()}).always(function(){n._setUnblocked(),n.trigger("after:execute:command",a)})},"usePerfectScrollbar":function(){return v.usePerfectScrollbar()}});return w.version="1.0",w}),csui.define("hbs!csui/controls/item.title/impl/name/name",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-item-name-readonly title csui-acc-focusable" title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" role="button"\r\n     aria-expanded="false">\r\n  <h2 class="csui-item-name-block">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</h2>\r\n</div>\r\n<div class="csui-item-name-edit title-edit-div">\r\n  <input class="title-input" placeholder="'+this.escapeExpression((n=null!=(n=t.placeholderName||(null!=e?e.placeholderName:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"placeholderName","hash":{}}):n))+'" type="text" value="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'"\r\n         title="'+this.escapeExpression((n=null!=(n=t.edit_name_tooltip||(null!=e?e.edit_name_tooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"edit_name_tooltip","hash":{}}):n))+'">\r\n  <span class="csui-undo edit-cancel inline-edit-icon" title="'+this.escapeExpression((n=null!=(n=t.cancel_edit_name_tooltip||(null!=e?e.cancel_edit_name_tooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cancel_edit_name_tooltip","hash":{}}):n))+'"></span>\r\n  <div class="csui-item-name-error title-error binf-text-danger" title=""></div>\r\n</div>'}});return i.registerPartial("csui_controls_item.title_impl_name_name",s),s}),csui.define("csui/controls/item.title/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/item.title/impl/nls/root/localized.strings",{"editNameTooltip":"Edit Name","cancelEditNameTooltip":"Cancel Name edit","placeHolderName":"Enter name","showMore":"Show more","showMoreAria":"Show more commands"}),csui.define("css!csui/controls/item.title/impl/name/name",[],function(){}),csui.define("csui/controls/item.title/impl/name/name.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","hbs!csui/controls/item.title/impl/name/name","i18n!csui/controls/item.title/impl/nls/localized.strings","csui/utils/commandhelper","csui/behaviors/item.name/item.name.behavior","csui/utils/contexts/factories/ancestors","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","css!csui/controls/item.title/impl/name/name"],function(e,t,i,s,n,o,r,l,a,c,u){var d=s.ItemView.extend({"className":"csui-item-name","template":o,"templateHelpers":function(){return{"name":this.model.get("name"),"edit_name_tooltip":r.editNameTooltip,"cancel_edit_name_tooltip":r.cancelEditNameTooltip,"placeholderName":r.placeHolderName}},"ui":{"name":".csui-item-name-readonly","nameReadonly":".csui-item-name-readonly","nameEdit":".csui-item-name-edit","nameEditDiv":".csui-item-name-edit","nameInput":".csui-item-name-edit>input","inputName":".csui-item-name-edit>input","nameEditCancelIcon":".csui-item-name-edit>.edit-cancel","titleError":".csui-item-name-error"},"modelEvents":{"change":"render"},"events":{"keydown":"onKeyInView"},"behaviors":{"ItemName":{"behaviorClass":a}},"constructor":function(e){e||(e={}),s.ItemView.prototype.constructor.call(this,e)},"onRender":function(){this.editing=!1,this.ui.nameEdit.addClass("binf-hidden")},"_validateAndSave":function(){var e=this.model.get("name"),t=this.getInputBoxValue();if(t=t.trim(),e!==t){if(!0===this.validate(t)){var i=this;this.setInputBoxValue(t),this.setValue(t),i._blockActions();var s={"name":t},o=this.options.context,r=i.options.model;r.save(s,{"wait":!0,"patch":!0,"silent":!!s.name}).then(function(){r.fetch().done(function(e){o&&o.trigger("current:folder:changed",r),i._unblockActions(),i.options.originatingView.unblockActions()}).fail(function(e){i._unblockActions();var t=i._getErrorMessageFromResponse(e);n.error("Saving failed. ",t)&&console.error(t)}),i._toggleEditMode(!1)}).fail(function(t){i._unblockActions();var s=i._getErrorMessageFromResponse(t);i.setValue(e),i._toggleEditMode(!0),i.showInlineError(s)})}}else this.clearInlineError(),this._toggleEditMode(!1)},"_blockActions":function(){var e=this.options.originatingView;e&&e.blockActions&&e.blockActions()},"_unblockActions":function(){var e=this.options.originatingView;e&&e.unblockActions&&e.unblockActions()},"onKeyInView":function(e){return this.ItemNameBehavior.onKeyInView(e)},"_toggleEditMode":function(e){this.ItemNameBehavior._toggleEditMode(e)},"onClickName":function(e){return this.ItemNameBehavior.onClickName(e)},"getValue":function(){return this.ItemNameBehavior.getValue()},"setValue":function(e){return this.ItemNameBehavior.setValue(e)},"getInputBoxValue":function(){return this.ItemNameBehavior.getInputBoxValue()},"setInputBoxValue":function(e){return this.ItemNameBehavior.setInputBoxValue(e)},"validate":function(e){return this.ItemNameBehavior.validate(e)},"setEditModeFocus":function(){return this.ItemNameBehavior.setEditModeFocus()},"showInlineError":function(e){return this.ItemNameBehavior.showInlineError(e)},"clearInlineError":function(){return this.ItemNameBehavior.clearInlineError()},"_getErrorMessageFromResponse":function(e){return this.ItemNameBehavior._getErrorMessageFromResponse(e)}});return t.extend(d.prototype,u),d}),csui.define("hbs!csui/controls/item.title/impl/dropdown.menu/dropdown.menu",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <div class="binf-dropdown">\r\n    <button id="'+this.escapeExpression((n=null!=(n=t.btnId||(null!=e?e.btnId:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"btnId","hash":{}}):n))+'" type="button" class="binf-btn binf-dropdown-toggle csui-acc-focusable"\r\n            data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="false"\r\n            aria-label="'+this.escapeExpression((n=null!=(n=t.showMoreAria||(null!=e?e.showMoreAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"showMoreAria","hash":{}}):n))+'">\r\n      <span class="csui-button-icon icon-expandArrowDown" title="'+this.escapeExpression((n=null!=(n=t.showMoreTooltip||(null!=e?e.showMoreTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"showMoreTooltip","hash":{}}):n))+'">\r\n      </span>\r\n    </button>\r\n    <ul class="binf-dropdown-menu" role="menu"></ul>\r\n  </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.hasCommands:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return i.registerPartial("csui_controls_item.title_impl_dropdown.menu_dropdown.menu",s),s}),csui.define("css!csui/controls/item.title/impl/dropdown.menu/dropdown.menu",[],function(){}),csui.define("csui/controls/item.title/impl/dropdown.menu/dropdown.menu.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/toolbar/toolitem.model","csui/controls/toolbar/toolitem.view","csui/models/nodes","csui/controls/toolbar/toolitems.filtered.model","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/behaviors/dropdown.menu/dropdown.menu.behavior","csui/utils/commands","hbs!csui/controls/item.title/impl/dropdown.menu/dropdown.menu","i18n!csui/controls/item.title/impl/nls/localized.strings","css!csui/controls/item.title/impl/dropdown.menu/dropdown.menu"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p){"use strict";return n.CompositeView.extend({"className":"csui-item-title-dropdown-menu","template":h,"templateHelpers":function(){return{"hasCommands":!!this.collection.length,"btnId":i.uniqueId("dropdownMenuButton"),"showMoreTooltip":p.showMore,"showMoreAria":p.showMoreAria}},"childView":r,"childViewContainer":"ul.binf-dropdown-menu","childViewOptions":function(e){return{"role":"menuitem"}},"ui":{"dropdownToggle":".binf-dropdown-toggle"},"behaviors":{"TabableRegionBehavior":{"behaviorClass":c},"DropdownMenuBehavior":{"behaviorClass":u}},"constructor":function(e){e.collection=new a(e.toolItems,{"status":this._createCommandStatus(e),"commands":this.commands,"mask":e.toolItemsMask}),e.reorderOnSort=!0,n.CompositeView.prototype.constructor.apply(this,arguments),i.defaults(this.options,e.toolItems.options),this.commands=e.commands||d,e.el&&t(e.el).addClass(i.result(this,"className")),this.listenTo(this,"childview:toolitem:action",this._triggerMenuItemAction).listenTo(this.model,"sync",this.render).listenTo(this,"close:menu",this._closeToggle).listenTo(s,"closeToggleAction",this._closeToggle).listenTo(this.model,"change",this.render)},"_createCommandStatus":function(e){return{"nodes":new l([e.model]),"container":e.model,"context":e.context}},"_updateCollectionStatus":function(){var e=this._createCommandStatus(this.options);this.options.collection.setStatus(e)},"onBeforeRender":function(){this._updateCollectionStatus()},"onRender":function(){this.ui.dropdownToggle.binf_dropdown(),this.delegateEvents()},"currentlyFocusedElement":function(){return t(this.ui.dropdownToggle)},"_closeToggle":function(){this.ui.dropdownToggle.parent().hasClass("binf-open")&&this.ui.dropdownToggle.binf_dropdown("toggle"),this.ui.dropdownToggle.attr("aria-expanded","false")},"_triggerMenuItemAction":function(e,t){this.ui.dropdownToggle.binf_dropdown("toggle");var s=t.toolItem.get("signature"),n=this.commands.findWhere({"signature":s});if("Rename"===s)setTimeout(i.bind(function(){this.trigger("rename",this)},this),200);else{var o={"context":this.options.context,"nodes":new l([this.model]),"container":this.model,"originatingView":this.options.originatingView};n&&n.enabled(o)&&n.execute(o)}}})}),csui.define("hbs!csui/controls/item.title/impl/item.title",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-item-title-icon"></div>\r\n<div class="csui-item-title-name"></div>\r\n<div class="csui-item-title-menu" role="menuitem"></div>\r\n'}});return i.registerPartial("csui_controls_item.title_impl_item.title",s),s}),csui.define("css!csui/controls/item.title/impl/item.title",[],function(){}),csui.define("csui/controls/item.title/item.title.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/controls/node-type.icon/node-type.icon.view","csui/controls/item.title/impl/name/name.view","csui/controls/item.title/impl/dropdown.menu/dropdown.menu.view","hbs!csui/controls/item.title/impl/item.title","css!csui/controls/item.title/impl/item.title"],function(e,t,i,s,n,o,r,l,a){"use strict";return s.LayoutView.extend({"className":"csui-item-title","template":a,"ui":{"icon":".csui-item-title-icon","name":".csui-item-title-name","menu":".csui-item-title-menu"},"regions":{"iconRegion":"@ui.icon","nameRegion":"@ui.name","menuRegion":"@ui.menu"},"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.call(this,e)},"initialize":function(){this.iconView=new o({"node":this.options.model}),this.nameView=new r({"context":this.options.context,"model":this.options.model,"originatingView":this.options.originatingView}),this.menuView=new l({"context":this.options.context,"model":this.options.model,"originatingView":this.options.originatingView,"toolItems":this.options.toolItems,"toolItemsMask":this.options.toolItemsMask,"commands":this.options.commands}),this.listenTo(this.menuView,"rename",function(){this.nameView._toggleEditMode.call(this.nameView,!0)}),this.listenTo(this.nameView,"changed:editmode",function(e){e?this.ui.menu.addClass("binf-hidden"):this.ui.menu.removeClass("binf-hidden")})},"onRender":function(){this.iconRegion.show(this.iconView),this.nameRegion.show(this.nameView),this.menuRegion.show(this.menuView)},"onShow":function(){t.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.triggerMethod("show")})},"onAfterShow":function(){t.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.triggerMethod("after:show")})},"closeMenu":function(){this.menuView&&this.menuView.trigger("close:menu")}})}),csui.define("csui/controls/table/table.columns",["csui/lib/backbone"],function(e){var t=e.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),i=e.Collection.extend({"model":t,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new i(this.map(function(e){return e.attributes}))}});return new i([{"key":"type","sequence":2,"permanentColumn":!0},{"key":"name","sequence":3,"permanentColumn":!0,"isNaming":!0},{"key":"reserved","sequence":4,"title":"State","noTitleInHeader":!0},{"key":"wnd_comments","sequence":900,"noTitleInHeader":!0,"permanentColumn":!0},{"key":"favorite","sequence":910,"noTitleInHeader":!0,"permanentColumn":!0}])}),csui.define("csui/lib/jquery.dataTables/js/jquery.dataTables",["csui/lib/jquery"],function(e){return function(t,i,s){!function(n){"use strict";e&&!e.fn.dataTable&&function(e){function n(t){var i,s,o="a aa ai ao as b fn i m o s ",r={};e.each(t,function(e,l){(i=e.match(/^([^A-Z]+?)([A-Z])/))&&-1!==o.indexOf(i[1]+" ")&&(s=e.replace(i[0],i[2].toLowerCase()),r[s]=e,"o"===i[1]&&n(t[e]))}),t._hungarianMap=r}function o(t,i,r){t._hungarianMap||n(t);var l;e.each(i,function(n,a){(l=t._hungarianMap[n])===s||!r&&i[l]!==s||("o"===l.charAt(0)?(i[l]||(i[l]={}),e.extend(!0,i[l],i[n]),o(t[l],i[l],r)):i[l]=i[n])})}function r(e){var t=Ke.defaults.oLanguage,i=e.sZeroRecords;!e.sEmptyTable&&i&&"No data available in table"===t.sEmptyTable&&Ne(e,e,"sZeroRecords","sEmptyTable"),!e.sLoadingRecords&&i&&"Loading..."===t.sLoadingRecords&&Ne(e,e,"sZeroRecords","sLoadingRecords"),e.sInfoThousands&&(e.sThousands=e.sInfoThousands);var s=e.sDecimal;s&&Ge(s)}function l(e){vt(e,"ordering","bSort"),vt(e,"orderMulti","bSortMulti"),vt(e,"orderClasses","bSortClasses"),vt(e,"orderCellsTop","bSortCellsTop"),vt(e,"order","aaSorting"),vt(e,"orderFixed","aaSortingFixed"),vt(e,"paging","bPaginate"),vt(e,"pagingType","sPaginationType"),vt(e,"pageLength","iDisplayLength"),vt(e,"searching","bFilter");var t=e.aoSearchCols;if(t)for(var i=0,s=t.length;i<s;i++)t[i]&&o(Ke.models.oSearch,t[i])}function a(e){vt(e,"orderable","bSortable"),vt(e,"orderData","aDataSort"),vt(e,"orderSequence","asSorting"),vt(e,"orderDataType","sortDataType")}function c(t){var i=t.oBrowser,s=e("<div/>").css({"position":"absolute","top":0,"left":0,"height":1,"width":1,"overflow":"hidden"}).append(e("<div/>").css({"position":"absolute","top":1,"left":1,"width":100,"overflow":"scroll"}).append(e('<div class="test"/>').css({"width":"100%","height":10}))).appendTo("body"),n=s.find(".test");i.bScrollOversize=100===n[0].offsetWidth,i.bScrollbarLeft=1!==n.offset().left,s.remove()}function u(e,t,i,n,o,r){var l,a=n,c=!1;for(i!==s&&(l=i,c=!0);a!==o;)e.hasOwnProperty(a)&&(l=c?t(l,e[a],a,e):e[a],c=!0,a+=r);return l}function d(t,s){var n=Ke.defaults.column,o=t.aoColumns.length,r=e.extend({},Ke.models.oColumn,n,{"nTh":s||i.createElement("th"),"sTitle":n.sTitle?n.sTitle:s?s.innerHTML:"","aDataSort":n.aDataSort?n.aDataSort:[o],"mData":n.mData?n.mData:o,"idx":o});t.aoColumns.push(r);var l=t.aoPreSearchCols;l[o]=e.extend({},Ke.models.oSearch,l[o]),h(t,o,null)}function h(t,i,n){var r=t.aoColumns[i],l=t.oClasses,c=e(r.nTh);if(!r.sWidthOrig){r.sWidthOrig=c.attr("width")||null;var u=(c.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);u&&(r.sWidthOrig=u[1])}n!==s&&null!==n&&(a(n),o(Ke.defaults.column,n),n.mDataProp===s||n.mData||(n.mData=n.mDataProp),n.sType&&(r._sManualType=n.sType),n.className&&!n.sClass&&(n.sClass=n.className),e.extend(r,n),Ne(r,n,"sWidth","sWidthOrig"),"number"==typeof n.iDataSort&&(r.aDataSort=[n.iDataSort]),Ne(r,n,"aDataSort"));var d=r.mData,h=k(d),p=r.mRender?k(r.mRender):null,m=function(e){return"string"==typeof e&&-1!==e.indexOf("@")};r._bAttrSrc=e.isPlainObject(d)&&(m(d.sort)||m(d.type)||m(d.filter)),r.fnGetData=function(e,t,i){var n=h(e,t,s,i);return p&&t?p(n,t,e,i):n},r.fnSetData=function(e,t,i){return V(d)(e,t,i)},"number"!=typeof d&&(t._rowReadObject=!0),t.oFeatures.bSort||(r.bSortable=!1,c.addClass(l.sSortableNone));var f=-1!==e.inArray("asc",r.asSorting),b=-1!==e.inArray("desc",r.asSorting);r.bSortable&&(f||b)?f&&!b?(r.sSortingClass=l.sSortableAsc,r.sSortingClassJUI=l.sSortJUIAscAllowed):!f&&b?(r.sSortingClass=l.sSortableDesc,r.sSortingClassJUI=l.sSortJUIDescAllowed):(r.sSortingClass=l.sSortable,r.sSortingClassJUI=l.sSortJUI):(r.sSortingClass=l.sSortableNone,r.sSortingClassJUI="")}function p(e){if(!1!==e.oFeatures.bAutoWidth){var t=e.aoColumns;ve(e);for(var i=0,s=t.length;i<s;i++)t[i].nTh.style.width=t[i].sWidth}var n=e.oScroll;""===n.sY&&""===n.sX||be(e),He(e,null,"column-sizing",[e])}function m(e,t){var i=g(e,"bVisible");return"number"==typeof i[t]?i[t]:null}function f(t,i){var s=g(t,"bVisible"),n=e.inArray(i,s);return-1!==n?n:null}function b(e){return g(e,"bVisible").length}function g(t,i){var s=[];return e.map(t.aoColumns,function(e,t){e[i]&&s.push(t)}),s}function v(e){var t,i,n,o,r,l,a,c,u,d=e.aoColumns,h=e.aoData,p=Ke.ext.type.detect;for(t=0,i=d.length;t<i;t++)if(a=d[t],u=[],!a.sType&&a._sManualType)a.sType=a._sManualType;else if(!a.sType){for(n=0,o=p.length;n<o;n++){for(r=0,l=h.length;r<l&&(u[r]===s&&(u[r]=x(e,r,t,"type")),(c=p[n](u[r],e))||n===p.length-1)&&"html"!==c;r++);if(c){a.sType=c;break}}a.sType||(a.sType="string")}}function w(t,i,n,o){var r,l,a,c,u,h,p,m=t.aoColumns;if(i)for(r=i.length-1;r>=0;r--){p=i[r];var f=p.targets!==s?p.targets:p.aTargets;for(e.isArray(f)||(f=[f]),a=0,c=f.length;a<c;a++)if("number"==typeof f[a]&&f[a]>=0){for(;m.length<=f[a];)d(t);o(f[a],p)}else if("number"==typeof f[a]&&f[a]<0)o(m.length+f[a],p);else if("string"==typeof f[a])for(u=0,h=m.length;u<h;u++)("_all"==f[a]||e(m[u].nTh).hasClass(f[a]))&&o(u,p)}if(n)for(r=0,l=n.length;r<l;r++)o(r,n[r])}function y(t,i,s,n){var o=t.aoData.length,r=e.extend(!0,{},Ke.models.oRow,{"src":s?"dom":"data"});r._aData=i,t.aoData.push(r);for(var l=t.aoColumns,a=0,c=l.length;a<c;a++)s&&S(t,o,a,x(t,o,a)),l[a].sType=null;return t.aiDisplayMaster.push(o),!s&&t.oFeatures.bDeferRender||P(t,o,s,n),o}function _(t,i){var s;return i instanceof e||(i=e(i)),i.map(function(e,i){return s=F(t,i),y(t,s.data,i,s.cells)})}function C(e,t){return t._DT_RowIndex!==s?t._DT_RowIndex:null}function T(t,i,s){return e.inArray(s,t.aoData[i].anCells)}function x(e,t,i,n){var o=e.iDraw,r=e.aoColumns[i],l=e.aoData[t]._aData,a=r.sDefaultContent,c=r.fnGetData(l,n,{"settings":e,"row":t,"col":i});if(c===s)return e.iDrawError!=o&&null===a&&(Be(e,0,"Requested unknown parameter "+("function"==typeof r.mData?"{function}":"'"+r.mData+"'")+" for row "+t,4),e.iDrawError=o),a;if(c!==l&&null!==c||null===a){if("function"==typeof c)return c.call(l)}else c=a;return null===c&&"display"==n?"":c}function S(e,t,i,s){var n=e.aoColumns[i],o=e.aoData[t]._aData;n.fnSetData(o,s,{"settings":e,"row":t,"col":i})}function I(t){return e.map(t.match(/(\\.|[^\.])+/g),function(e){return e.replace(/\\./g,".")})}function k(t){if(e.isPlainObject(t)){var i={};return e.each(t,function(e,t){t&&(i[e]=k(t))}),function(e,t,n,o){var r=i[t]||i._;return r!==s?r(e,t,n,o):e}}if(null===t)return function(e){return e};if("function"==typeof t)return function(e,i,s,n){return t(e,i,s,n)};if("string"!=typeof t||-1===t.indexOf(".")&&-1===t.indexOf("[")&&-1===t.indexOf("("))return function(e,i){return e[t]};var n=function(e,t,i){var o,r,l,a;if(""!==i)for(var c=I(i),u=0,d=c.length;u<d;u++){if(o=c[u].match(wt),r=c[u].match(yt),o){c[u]=c[u].replace(wt,""),""!==c[u]&&(e=e[c[u]]),l=[],c.splice(0,u+1),a=c.join(".");for(var h=0,p=e.length;h<p;h++)l.push(n(e[h],t,a));var m=o[0].substring(1,o[0].length-1);e=""===m?l:l.join(m);break}if(r)c[u]=c[u].replace(yt,""),e=e[c[u]]();else{if(null===e||e[c[u]]===s)return s;e=e[c[u]]}}return e};return function(e,i){return n(e,i,t)}}function V(t){if(e.isPlainObject(t))return V(t._);if(null===t)return function(){};if("function"==typeof t)return function(e,i,s){t(e,"set",i,s)};if("string"!=typeof t||-1===t.indexOf(".")&&-1===t.indexOf("[")&&-1===t.indexOf("("))return function(e,i){e[t]=i};var i=function(e,t,n){for(var o,r,l,a,c,u=I(n),d=u[u.length-1],h=0,p=u.length-1;h<p;h++){if(r=u[h].match(wt),l=u[h].match(yt),r){
u[h]=u[h].replace(wt,""),e[u[h]]=[],o=u.slice(),o.splice(0,h+1),c=o.join(".");for(var m=0,f=t.length;m<f;m++)a={},i(a,t[m],c),e[u[h]].push(a);return}l&&(u[h]=u[h].replace(yt,""),e=e[u[h]](t)),null!==e[u[h]]&&e[u[h]]!==s||(e[u[h]]={}),e=e[u[h]]}d.match(yt)?e=e[d.replace(yt,"")](t):e[d.replace(wt,"")]=t};return function(e,s){return i(e,s,t)}}function A(e){return ht(e.aoData,"_aData")}function E(e){e.aoData.length=0,e.aiDisplayMaster.length=0,e.aiDisplay.length=0}function M(e,t,i){for(var n=-1,o=0,r=e.length;o<r;o++)e[o]==t?n=o:e[o]>t&&e[o]--;-1!=n&&i===s&&e.splice(n,1)}function D(e,t,i,n){var o,r,l=e.aoData[t],a=function(i,s){for(;i.childNodes.length;)i.removeChild(i.firstChild);i.innerHTML=x(e,t,s,"display")};if("dom"!==i&&(i&&"auto"!==i||"dom"!==l.src)){var c=l.anCells;if(c)if(n!==s)a(c[n],n);else for(o=0,r=c.length;o<r;o++)a(c[o],o)}else l._aData=F(e,l,n,n===s?s:l._aData).data;l._aSortData=null,l._aFilterData=null;var u=e.aoColumns;if(n!==s)u[n].sType=null;else{for(o=0,r=u.length;o<r;o++)u[o].sType=null;R(l)}}function F(t,i,n,o){var r,l,a,c=[],u=i.firstChild,d=0,h=t.aoColumns,p=t._rowReadObject;o=o||p?{}:[];var m=function(e,t){if("string"==typeof e){var i=e.indexOf("@");if(-1!==i){var s=e.substring(i+1);V(e)(o,t.getAttribute(s))}}},f=function(t){if(n===s||n===d)if(l=h[d],a=e.trim(t.innerHTML),l&&l._bAttrSrc){var i=V(l.mData._);i(o,a),m(l.mData.sort,t),m(l.mData.type,t),m(l.mData.filter,t)}else p?(l._setter||(l._setter=V(l.mData)),l._setter(o,a)):o[d]=a;d++};if(u)for(;u;)r=u.nodeName.toUpperCase(),"TD"!=r&&"TH"!=r||(f(u),c.push(u)),u=u.nextSibling;else{c=i.anCells;for(var b=0,g=c.length;b<g;b++)f(c[b])}return{"data":o,"cells":c}}function P(e,t,s,n){var o,r,l,a,c,u=e.aoData[t],d=u._aData,h=[];if(null===u.nTr){for(o=s||i.createElement("tr"),u.nTr=o,u.anCells=h,o._DT_RowIndex=t,R(u),a=0,c=e.aoColumns.length;a<c;a++)l=e.aoColumns[a],r=s?n[a]:i.createElement(l.sCellType),h.push(r),s&&!l.mRender&&l.mData===a||(r.innerHTML=x(e,t,a,"display")),l.sClass&&(r.className+=" "+l.sClass),l.bVisible&&!s?o.appendChild(r):!l.bVisible&&s&&r.parentNode.removeChild(r),l.fnCreatedCell&&l.fnCreatedCell.call(e.oInstance,r,x(e,t,a),d,t,a);He(e,"aoRowCreatedCallback",null,[o,d,t])}}function R(t){var i=t.nTr,s=t._aData;if(i){if(s.DT_RowId&&(i.id=s.DT_RowId),s.DT_RowClass){var n=s.DT_RowClass.split(" ");t.__rowc=t.__rowc?gt(t.__rowc.concat(n)):n,e(i).removeClass(t.__rowc.join(" ")).addClass(s.DT_RowClass)}s.DT_RowData&&e(i).data(s.DT_RowData)}}function B(t){var i,s,n,o,r,l=t.nTHead,a=t.nTFoot,c=0===e("th, td",l).length,u=t.oClasses,d=t.aoColumns;for(c&&(o=e("<tr/>").appendTo(l)),i=0,s=d.length;i<s;i++)r=d[i],n=e(r.nTh).addClass(r.sClass),c&&n.appendTo(o),t.oFeatures.bSort&&(n.addClass(r.sSortingClass),!1!==r.bSortable&&(n.attr("tabindex",t.iTabIndex).attr("aria-controls",t.sTableId),Ee(t,r.nTh,i))),r.sTitle!=n.html()&&n.html(r.sTitle),Ue(t,"header")(t,n,r,u);if(c&&H(t.aoHeader,l),e(l).find(">tr>th, >tr>td").addClass(u.sHeaderTH),e(a).find(">tr>th, >tr>td").addClass(u.sFooterTH),null!==a){var h=t.aoFooter[0];for(i=0,s=h.length;i<s;i++)r=d[i],r.nTf=h[i].cell,r.sClass&&e(r.nTf).addClass(r.sClass)}}function N(t,i,n){var o,r,l,a,c,u,d,h,p,m=[],f=[],b=t.aoColumns.length;if(i){for(n===s&&(n=!1),o=0,r=i.length;o<r;o++){for(m[o]=i[o].slice(),m[o].nTr=i[o].nTr,l=b-1;l>=0;l--)t.aoColumns[l].bVisible||n||m[o].splice(l,1);f.push([])}for(o=0,r=m.length;o<r;o++){if(d=m[o].nTr)for(;u=d.firstChild;)d.removeChild(u);for(l=0,a=m[o].length;l<a;l++)if(h=1,p=1,f[o][l]===s){for(d.appendChild(m[o][l].cell),f[o][l]=1;m[o+h]!==s&&m[o][l].cell==m[o+h][l].cell;)f[o+h][l]=1,h++;for(;m[o][l+p]!==s&&m[o][l].cell==m[o][l+p].cell;){for(c=0;c<h;c++)f[o+c][l+p]=1;p++}var g=e(m[o][l].cell);1!==h&&g.attr("rowspan",h),1!==p&&g.attr("colspan",p)}}}}function L(t){var i=He(t,"aoPreDrawCallback","preDraw",[t]);if(-1!==e.inArray(!1,i))return void me(t,!1);var n=[],o=0,r=t.asStripeClasses,l=r.length,a=(t.aoOpenRows.length,t.oLanguage),c=t.iInitDisplayStart,u="ssp"==je(t),d=t.aiDisplay;t.bDrawing=!0,c!==s&&-1!==c&&(t._iDisplayStart=u?c:c>=t.fnRecordsDisplay()?0:c,t.iInitDisplayStart=-1);var h=t._iDisplayStart,p=t.fnDisplayEnd();if(t.bDeferLoading)t.bDeferLoading=!1,t.iDraw++,me(t,!1);else if(u){if(!t.bDestroying&&!j(t))return}else t.iDraw++;if(0!==d.length)for(var m=u?0:h,f=u?t.aoData.length:p,g=m;g<f;g++){var v=d[g],w=t.aoData[v];null===w.nTr&&P(t,v);var y=w.nTr;if(0!==l){var _=r[o%l];w._sRowStripe!=_&&(e(y).removeClass(w._sRowStripe).addClass(_),w._sRowStripe=_)}He(t,"aoRowCallback",null,[y,w._aData,o,g]),n.push(y),o++}else{var C=a.sZeroRecords;1==t.iDraw&&"ajax"==je(t)?C=a.sLoadingRecords:a.sEmptyTable&&0===t.fnRecordsTotal()&&(C=a.sEmptyTable),n[0]=e("<tr/>",{"class":l?r[0]:""}).append(e("<td />",{"style":"vertical-align: top;","colSpan":b(t),"class":t.oClasses.sRowEmpty}).html(C))[0]}He(t,"aoHeaderCallback","header",[e(t.nTHead).children("tr")[0],A(t),h,p,d]),He(t,"aoFooterCallback","footer",[e(t.nTFoot).children("tr")[0],A(t),h,p,d]);var T=e(t.nTBody);T.children().detach(),T.append(e(n)),He(t,"aoDrawCallback","draw",[t]),t.bSorted=!1,t.bFiltered=!1,t.bDrawing=!1}function O(e,t){var i=e.oFeatures,s=i.bSort,n=i.bFilter;s&&ke(e),n?J(e,e.oPreviousSearch):e.aiDisplay=e.aiDisplayMaster.slice(),!0!==t&&(e._iDisplayStart=0),e._drawHold=t,L(e),e._drawHold=!1}function $(t){var i=t.oClasses,s=e(t.nTable),n=e("<div/>").insertBefore(s),o=t.oFeatures,r=e("<div/>",{"id":t.sTableId+"_wrapper","class":i.sWrapper+(t.nTFoot?"":" "+i.sNoFooter)});t.nHolding=n[0],t.nTableWrapper=r[0],t.nTableReinsertBefore=t.nTable.nextSibling;for(var l,a,c,u,d,h,p=t.sDom.split(""),m=0;m<p.length;m++){if(l=null,"<"==(a=p[m])){if(c=e("<div/>")[0],"'"==(u=p[m+1])||'"'==u){for(d="",h=2;p[m+h]!=u;)d+=p[m+h],h++;if("H"==d?d=i.sJUIHeader:"F"==d&&(d=i.sJUIFooter),-1!=d.indexOf(".")){var f=d.split(".");c.id=f[0].substr(1,f[0].length-1),c.className=f[1]}else"#"==d.charAt(0)?c.id=d.substr(1,d.length-1):c.className=d;m+=h}r.append(c),r=e(c)}else if(">"==a)r=r.parent();else if("l"==a&&o.bPaginate&&o.bLengthChange)l=ue(t);else if("f"==a&&o.bFilter)l=K(t);else if("r"==a&&o.bProcessing)l=pe(t);else if("t"==a)l=fe(t);else if("i"==a&&o.bInfo)l=ne(t);else if("p"==a&&o.bPaginate)l=de(t);else if(0!==Ke.ext.feature.length)for(var b=Ke.ext.feature,g=0,v=b.length;g<v;g++)if(a==b[g].cFeature){l=b[g].fnInit(t);break}if(l){var w=t.aanFeatures;w[a]||(w[a]=[]),w[a].push(l),r.append(l)}}n.replaceWith(r)}function H(t,i){var s,n,o,r,l,a,c,u,d,h,p,m=e(i).children("tr");for(t.splice(0,t.length),o=0,a=m.length;o<a;o++)t.push([]);for(o=0,a=m.length;o<a;o++)for(s=m[o],u=0,n=s.firstChild;n;){if("TD"==n.nodeName.toUpperCase()||"TH"==n.nodeName.toUpperCase())for(d=1*n.getAttribute("colspan"),h=1*n.getAttribute("rowspan"),d=d&&0!==d&&1!==d?d:1,h=h&&0!==h&&1!==h?h:1,c=function(e,t,i){for(var s=e[t];s[i];)i++;return i}(t,o,u),p=1===d,l=0;l<d;l++)for(r=0;r<h;r++)t[o+r][c+l]={"cell":n,"unique":p},t[o+r].nTr=s;n=n.nextSibling}}function z(e,t,i){var s=[];i||(i=e.aoHeader,t&&(i=[],H(i,t)));for(var n=0,o=i.length;n<o;n++)for(var r=0,l=i[n].length;r<l;r++)!i[n][r].unique||s[r]&&e.bSortCellsTop||(s[r]=i[n][r].cell);return s}function U(t,i,s){if(He(t,"aoServerParams","serverParams",[i]),i&&e.isArray(i)){var n={},o=/(.*?)\[\]$/;e.each(i,function(e,t){var i=t.name.match(o);if(i){var s=i[0];n[s]||(n[s]=[]),n[s].push(t.value)}else n[t.name]=t.value}),i=n}var r,l=t.ajax,a=t.oInstance;if(e.isPlainObject(l)&&l.data){r=l.data;var c=e.isFunction(r)?r(i):r;i=e.isFunction(r)&&c?c:e.extend(!0,i,c),delete l.data}var u={"data":i,"success":function(e){var i=e.error||e.sError;i&&t.oApi._fnLog(t,0,i),t.json=e,He(t,null,"xhr",[t,e]),s(e)},"dataType":"json","cache":!1,"type":t.sServerMethod,"error":function(e,i,s){var n=t.oApi._fnLog;"parsererror"==i?n(t,0,"Invalid JSON response",1):4===e.readyState&&n(t,0,"Ajax error",7),me(t,!1)}};t.oAjaxData=i,He(t,null,"preXhr",[t,i]),t.fnServerData?t.fnServerData.call(a,t.sAjaxSource,e.map(i,function(e,t){return{"name":t,"value":e}}),s,t):t.sAjaxSource||"string"==typeof l?t.jqXHR=e.ajax(e.extend(u,{"url":l||t.sAjaxSource})):e.isFunction(l)?t.jqXHR=l.call(a,i,s,t):(t.jqXHR=e.ajax(e.extend(u,l)),l.data=r)}function j(e){return!e.bAjaxDataGet||(e.iDraw++,me(e,!0),U(e,q(e),function(t){G(e,t)}),!1)}function q(t){var i,s,n,o,r=t.aoColumns,l=r.length,a=t.oFeatures,c=t.oPreviousSearch,u=t.aoPreSearchCols,d=[],h=Ie(t),p=t._iDisplayStart,m=!1!==a.bPaginate?t._iDisplayLength:-1,f=function(e,t){d.push({"name":e,"value":t})};f("sEcho",t.iDraw),f("iColumns",l),f("sColumns",ht(r,"sName").join(",")),f("iDisplayStart",p),f("iDisplayLength",m);var b={"draw":t.iDraw,"columns":[],"order":[],"start":p,"length":m,"search":{"value":c.sSearch,"regex":c.bRegex}};for(i=0;i<l;i++)n=r[i],o=u[i],s="function"==typeof n.mData?"function":n.mData,b.columns.push({"data":s,"name":n.sName,"searchable":n.bSearchable,"orderable":n.bSortable,"search":{"value":o.sSearch,"regex":o.bRegex}}),f("mDataProp_"+i,s),a.bFilter&&(f("sSearch_"+i,o.sSearch),f("bRegex_"+i,o.bRegex),f("bSearchable_"+i,n.bSearchable)),a.bSort&&f("bSortable_"+i,n.bSortable);a.bFilter&&(f("sSearch",c.sSearch),f("bRegex",c.bRegex)),a.bSort&&(e.each(h,function(e,t){b.order.push({"column":t.col,"dir":t.dir}),f("iSortCol_"+e,t.col),f("sSortDir_"+e,t.dir)}),f("iSortingCols",h.length));var g=Ke.ext.legacy.ajax;return null===g?t.sAjaxSource?d:b:g?d:b}function G(e,t){var i=function(e,i){return t[e]!==s?t[e]:t[i]},n=i("sEcho","draw"),o=i("iTotalRecords","recordsTotal"),r=i("iTotalDisplayRecords","recordsFiltered");if(n){if(1*n<e.iDraw)return;e.iDraw=1*n}E(e),e._iRecordsTotal=parseInt(o,10),e._iRecordsDisplay=parseInt(r,10);for(var l=W(e,t),a=0,c=l.length;a<c;a++)y(e,l[a]);e.aiDisplay=e.aiDisplayMaster.slice(),e.bAjaxDataGet=!1,L(e),e._bInitComplete||ae(e,t),e.bAjaxDataGet=!0,me(e,!1)}function W(t,i){var n=e.isPlainObject(t.ajax)&&t.ajax.dataSrc!==s?t.ajax.dataSrc:t.sAjaxDataProp;return"data"===n?i.aaData||i[n]:""!==n?k(n)(i):i}function K(t){var s=t.oClasses,n=t.sTableId,o=t.oLanguage,r=t.oPreviousSearch,l=t.aanFeatures,a='<input type="search" class="'+s.sFilterInput+'"/>',c=o.sSearch;c=c.match(/_INPUT_/)?c.replace("_INPUT_",a):c+a;var u=e("<div/>",{"id":l.f?null:n+"_filter","class":s.sFilter}).append(e("<label/>").append(c)),d=function(){var e=(l.f,this.value?this.value:"");e!=r.sSearch&&(J(t,{"sSearch":e,"bRegex":r.bRegex,"bSmart":r.bSmart,"bCaseInsensitive":r.bCaseInsensitive}),t._iDisplayStart=0,L(t))},h=null!==t.searchDelay?t.searchDelay:"ssp"===je(t)?400:0,p=e("input",u).val(r.sSearch).attr("placeholder",o.sSearchPlaceholder).bind("keyup.DT search.DT input.DT paste.DT cut.DT",h?we(d,h):d).bind("keypress.DT",function(e){if(13==e.keyCode)return!1}).attr("aria-controls",n);return e(t.nTable).on("search.dt.DT",function(e,s){if(t===s)try{p[0]!==i.activeElement&&p.val(r.sSearch)}catch(e){}}),u[0]}function J(e,t,i){var n=e.oPreviousSearch,o=e.aoPreSearchCols,r=function(e){n.sSearch=e.sSearch,n.bRegex=e.bRegex,n.bSmart=e.bSmart,n.bCaseInsensitive=e.bCaseInsensitive},l=function(e){return e.bEscapeRegex!==s?!e.bEscapeRegex:e.bRegex};if(v(e),"ssp"!=je(e)){Z(e,t.sSearch,i,l(t),t.bSmart,t.bCaseInsensitive),r(t);for(var a=0;a<o.length;a++)Q(e,o[a].sSearch,a,l(o[a]),o[a].bSmart,o[a].bCaseInsensitive);X(e)}else r(t);e.bFiltered=!0,He(e,null,"search",[e])}function X(e){for(var t,i,s=Ke.ext.search,n=e.aiDisplay,o=0,r=s.length;o<r;o++){for(var l=[],a=0,c=n.length;a<c;a++)i=n[a],t=e.aoData[i],s[o](e,t._aFilterData,i,t._aData,a)&&l.push(i);n.length=0,n.push.apply(n,l)}}function Q(e,t,i,s,n,o){if(""!==t)for(var r,l=e.aiDisplay,a=Y(t,s,n,o),c=l.length-1;c>=0;c--)r=e.aoData[l[c]]._aFilterData[i],a.test(r)||l.splice(c,1)}function Z(e,t,i,s,n,o){var r,l,a,c=Y(t,s,n,o),u=e.oPreviousSearch.sSearch,d=e.aiDisplayMaster;if(0!==Ke.ext.search.length&&(i=!0),l=te(e),t.length<=0)e.aiDisplay=d.slice();else for((l||i||u.length>t.length||0!==t.indexOf(u)||e.bSorted)&&(e.aiDisplay=d.slice()),r=e.aiDisplay,a=r.length-1;a>=0;a--)c.test(e.aoData[r[a]]._sFilterRow)||r.splice(a,1)}function Y(t,i,s,n){if(t=i?t:ee(t),s){t="^(?=.*?"+e.map(t.match(/"[^"]+"|[^ ]+/g)||"",function(e){if('"'===e.charAt(0)){var t=e.match(/^"(.*)"$/);e=t?t[1]:e}return e.replace('"',"")}).join(")(?=.*?")+").*$"}return new RegExp(t,n?"i":"")}function ee(e){return e.replace(nt,"\\$1")}function te(e){var t,i,s,n,o,r,l,a,c=e.aoColumns,u=Ke.ext.type.search,d=!1;for(i=0,n=e.aoData.length;i<n;i++)if(a=e.aoData[i],!a._aFilterData){for(r=[],s=0,o=c.length;s<o;s++)t=c[s],t.bSearchable?(l=x(e,i,s,"filter"),u[t.sType]&&(l=u[t.sType](l)),null===l&&(l=""),"string"!=typeof l&&l.toString&&(l=l.toString())):l="",l.indexOf&&-1!==l.indexOf("&")&&(_t.innerHTML=l,l=Ct?_t.textContent:_t.innerText),l.replace&&(l=l.replace(/[\r\n]/g,"")),r.push(l);a._aFilterData=r,a._sFilterRow=r.join("  "),d=!0}return d}function ie(e){return{"search":e.sSearch,"smart":e.bSmart,"regex":e.bRegex,"caseInsensitive":e.bCaseInsensitive}}function se(e){return{"sSearch":e.search,"bSmart":e.smart,"bRegex":e.regex,"bCaseInsensitive":e.caseInsensitive}}function ne(t){var i=t.sTableId,s=t.aanFeatures.i,n=e("<div/>",{"class":t.oClasses.sInfo,"id":s?null:i+"_info"});return s||(t.aoDrawCallback.push({"fn":oe,"sName":"information"}),n.attr("role","status").attr("aria-live","polite"),e(t.nTable).attr("aria-describedby",i+"_info")),n[0]}function oe(t){var i=t.aanFeatures.i;if(0!==i.length){var s=t.oLanguage,n=t._iDisplayStart+1,o=t.fnDisplayEnd(),r=t.fnRecordsTotal(),l=t.fnRecordsDisplay(),a=l?s.sInfo:s.sInfoEmpty;l!==r&&(a+=" "+s.sInfoFiltered),a+=s.sInfoPostFix,a=re(t,a);var c=s.fnInfoCallback;null!==c&&(a=c.call(t.oInstance,t,n,o,r,l,a)),e(i).html(a)}}function re(e,t){var i=e.fnFormatNumber,s=e._iDisplayStart+1,n=e._iDisplayLength,o=e.fnRecordsDisplay(),r=-1===n;return t.replace(/_START_/g,i.call(e,s)).replace(/_END_/g,i.call(e,e.fnDisplayEnd())).replace(/_MAX_/g,i.call(e,e.fnRecordsTotal())).replace(/_TOTAL_/g,i.call(e,o)).replace(/_PAGE_/g,i.call(e,r?1:Math.ceil(s/n))).replace(/_PAGES_/g,i.call(e,r?1:Math.ceil(o/n)))}function le(e){var t,i,s,n=e.iInitDisplayStart,o=e.aoColumns,r=e.oFeatures;if(!e.bInitialised)return void setTimeout(function(){le(e)},200);for($(e),B(e),N(e,e.aoHeader),N(e,e.aoFooter),me(e,!0),r.bAutoWidth&&ve(e),t=0,i=o.length;t<i;t++)s=o[t],s.sWidth&&(s.nTh.style.width=xe(s.sWidth));O(e);var l=je(e);"ssp"!=l&&("ajax"==l?U(e,[],function(i){var s=W(e,i);for(t=0;t<s.length;t++)y(e,s[t]);e.iInitDisplayStart=n,O(e),me(e,!1),ae(e,i)},e):(me(e,!1),ae(e)))}function ae(e,t){e._bInitComplete=!0,t&&p(e),He(e,"aoInitComplete","init",[e,t])}function ce(e,t){var i=parseInt(t,10);e._iDisplayLength=i,ze(e),He(e,null,"length",[e,i])}function ue(t){for(var i=t.oClasses,s=t.sTableId,n=t.aLengthMenu,o=e.isArray(n[0]),r=o?n[0]:n,l=o?n[1]:n,a=e("<select/>",{"name":s+"_length","aria-controls":s,"class":i.sLengthSelect}),c=0,u=r.length;c<u;c++)a[0][c]=new Option(l[c],r[c]);var d=e("<div><label/></div>").addClass(i.sLength);return t.aanFeatures.l||(d[0].id=s+"_length"),d.children().append(t.oLanguage.sLengthMenu.replace("_MENU_",a[0].outerHTML)),e("select",d).val(t._iDisplayLength).bind("change.DT",function(i){ce(t,e(this).val()),L(t)}),e(t.nTable).bind("length.dt.DT",function(i,s,n){t===s&&e("select",d).val(n)}),d[0]}function de(t){var i=t.sPaginationType,s=Ke.ext.pager[i],n="function"==typeof s,o=function(e){L(e)},r=e("<div/>").addClass(t.oClasses.sPaging+i)[0],l=t.aanFeatures;return n||s.fnInit(t,r,o),l.p||(r.id=t.sTableId+"_paginate",t.aoDrawCallback.push({"fn":function(e){if(n){var t,i,r=e._iDisplayStart,a=e._iDisplayLength,c=e.fnRecordsDisplay(),u=-1===a,d=u?0:Math.ceil(r/a),h=u?1:Math.ceil(c/a),p=s(d,h);for(t=0,i=l.p.length;t<i;t++)Ue(e,"pageButton")(e,l.p[t],t,p,d,h)}else s.fnUpdate(e,o)},"sName":"pagination"})),r}function he(e,t,i){var s=e._iDisplayStart,n=e._iDisplayLength,o=e.fnRecordsDisplay();0===o||-1===n?s=0:"number"==typeof t?(s=t*n)>o&&(s=0):"first"==t?s=0:"previous"==t?(s=n>=0?s-n:0)<0&&(s=0):"next"==t?s+n<o&&(s+=n):"last"==t?s=Math.floor((o-1)/n)*n:Be(e,0,"Unknown paging action: "+t,5);var r=e._iDisplayStart!==s;return e._iDisplayStart=s,r&&(He(e,null,"page",[e]),i&&L(e)),r}function pe(t){return e("<div/>",{"id":t.aanFeatures.r?null:t.sTableId+"_processing","class":t.oClasses.sProcessing}).html(t.oLanguage.sProcessing).insertBefore(t.nTable)[0]}function me(t,i){t.oFeatures.bProcessing&&e(t.aanFeatures.r).css("display",i?"block":"none"),He(t,null,"processing",[t,i])}function fe(t){var i=e(t.nTable),s=t.oScroll;if(""===s.sX&&""===s.sY)return t.nTable;var n=s.sX,o=s.sY,r=t.oClasses,l=i.children("caption"),a=l.length?l[0]._captionSide:null,c=e(i[0].cloneNode(!1)),u=e(i[0].cloneNode(!1)),d=i.children("tfoot"),h="<div/>",p=function(e){return e?xe(e):null};s.sX&&"100%"===i.attr("width")&&i.removeAttr("width"),d.length||(d=null);var m=e(h,{"class":r.sScrollWrapper}).append(e(h,{"class":r.sScrollHead}).css({"overflow":"hidden","position":"relative","border":0,"width":n?p(n):"100%"}).append(e(h,{"class":r.sScrollHeadInner}).css({"box-sizing":"content-box","width":s.sXInner||"100%"}).append(c.removeAttr("id").css("margin-left",0).append("top"===a?l:null).append(i.children("thead"))))).append(e(h,{"class":r.sScrollBody}).css({"overflow":"auto","height":p(o),"width":p(n)}).append(i));d&&m.append(e(h,{"class":r.sScrollFoot}).css({"overflow":"hidden","border":0,"width":n?p(n):"100%"}).append(e(h,{"class":r.sScrollFootInner}).append(u.removeAttr("id").css("margin-left",0).append("bottom"===a?l:null).append(i.children("tfoot")))));var f=m.children(),b=f[0],g=f[1],v=d?f[2]:null;return n&&e(g).scroll(function(e){var t=this.scrollLeft;b.scrollLeft=t,d&&(v.scrollLeft=t)}),t.nScrollHead=b,t.nScrollBody=g,t.nScrollFoot=v,t.aoDrawCallback.push({"fn":be,"sName":"scrolling"}),m[0]}function be(t){var i,s,n,o,r,l,a,c,u,d=t.oScroll,h=d.sX,p=d.sXInner,f=d.sY,b=d.iBarWidth,g=e(t.nScrollHead),v=g[0].style,w=g.children("div"),y=w[0].style,_=w.children("table"),C=t.nScrollBody,T=e(C),x=C.style,S=e(t.nScrollFoot),I=S.children("div"),k=I.children("table"),V=e(t.nTHead),A=e(t.nTable),E=A[0],M=E.style,D=t.nTFoot?e(t.nTFoot):null,F=t.oBrowser,P=F.bScrollOversize,R=[],B=[],N=[],L=function(e){var t=e.style;t.paddingTop="0",t.paddingBottom="0",t.borderTopWidth="0",t.borderBottomWidth="0",t.height=0};if(A.children("thead, tfoot").remove(),r=V.clone().prependTo(A),i=V.find("tr"),n=r.find("tr"),r.find("th, td").removeAttr("tabindex"),D&&(l=D.clone().prependTo(A),s=D.find("tr"),o=l.find("tr")),h||(x.width="100%",g[0].style.width="100%"),e.each(z(t,r),function(e,i){a=m(t,e),i.style.width=t.aoColumns[a].sWidth}),D&&ge(function(e){e.style.width=""},o),d.bCollapse&&""!==f&&(x.height=T[0].offsetHeight+V[0].offsetHeight+"px"),u=A.outerWidth(),""===h?(M.width="100%",P&&(A.find("tbody").height()>C.offsetHeight||"scroll"==T.css("overflow-y"))&&(M.width=xe(A.outerWidth()-b))):""!==p?M.width=xe(p):u==T.width()&&T.height()<A.height()?(M.width=xe(u-b),A.outerWidth()>u-b&&(M.width=xe(u))):M.width=xe(u),u=A.outerWidth(),ge(L,n),ge(function(t){N.push(t.innerHTML),R.push(xe(e(t).css("width")))},n),ge(function(e,t){e.style.width=R[t]},i),e(n).height(0),D&&(ge(L,o),ge(function(t){B.push(xe(e(t).css("width")))},o),ge(function(e,t){e.style.width=B[t]},s),e(o).height(0)),ge(function(e,t){e.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+N[t]+"</div>",e.style.width=R[t]},n),D&&ge(function(e,t){e.innerHTML="",e.style.width=B[t]},o),A.outerWidth()<u?(c=C.scrollHeight>C.offsetHeight||"scroll"==T.css("overflow-y")?u+b:u,P&&(C.scrollHeight>C.offsetHeight||"scroll"==T.css("overflow-y"))&&(M.width=xe(c-b)),""!==h&&""===p||Be(t,1,"Possible column misalignment",6)):c="100%",x.width=xe(c),v.width=xe(c),D&&(t.nScrollFoot.style.width=xe(c)),f||P&&(x.height=xe(E.offsetHeight+b)),f&&d.bCollapse){x.height=xe(f);var O=h&&E.offsetWidth>C.offsetWidth?b:0;E.offsetHeight<C.offsetHeight&&(x.height=xe(E.offsetHeight+O))}var $=A.outerWidth();_[0].style.width=xe($),y.width=xe($);var H=A.height()>C.clientHeight||"scroll"==T.css("overflow-y"),U="padding"+(F.bScrollbarLeft?"Left":"Right");y[U]=H?b+"px":"0px",D&&(k[0].style.width=xe($),I[0].style.width=xe($),I[0].style[U]=H?b+"px":"0px"),T.scroll(),!t.bSorted&&!t.bFiltered||t._drawHold||(C.scrollTop=0)}function ge(e,t,i){for(var s,n,o=0,r=0,l=t.length;r<l;){for(s=t[r].firstChild,n=i?i[r].firstChild:null;s;)1===s.nodeType&&(i?e(s,n,o):e(s,o),o++),s=s.nextSibling,n=i?n.nextSibling:null;r++}}function ve(i){var s,n,o,r,l,a=i.nTable,c=i.aoColumns,u=i.oScroll,d=u.sY,h=u.sX,m=u.sXInner,f=c.length,v=g(i,"bVisible"),w=e("th",i.nTHead),y=a.getAttribute("width"),_=a.parentNode,C=!1;for(s=0;s<v.length;s++)n=c[v[s]],null!==n.sWidth&&(n.sWidth=ye(n.sWidthOrig,_),C=!0);if(C||h||d||f!=b(i)||f!=w.length){var T=e(a).clone().empty().css("visibility","hidden").removeAttr("id").append(e(i.nTHead).clone(!1)).append(e(i.nTFoot).clone(!1)).append(e("<tbody><tr/></tbody>"));T.find("tfoot th, tfoot td").css("width","");var x=T.find("tbody tr");for(w=z(i,T.find("thead")[0]),s=0;s<v.length;s++)n=c[v[s]],w[s].style.width=null!==n.sWidthOrig&&""!==n.sWidthOrig?xe(n.sWidthOrig):"";if(i.aoData.length)for(s=0;s<v.length;s++)o=v[s],n=c[o],e(Ce(i,o)).clone(!1).append(n.sContentPadding).appendTo(x);if(T.appendTo(_),h&&m?T.width(m):h?(T.css("width","auto"),T.width()<_.offsetWidth&&T.width(_.offsetWidth)):d?T.width(_.offsetWidth):y&&T.width(y),_e(i,T[0]),h){var S=0;for(s=0;s<v.length;s++)n=c[v[s]],l=e(w[s]).outerWidth(),S+=null===n.sWidthOrig?l:parseInt(n.sWidth,10)+l-e(w[s]).width();T.width(xe(S)),a.style.width=xe(S)}for(s=0;s<v.length;s++)n=c[v[s]],(r=e(w[s]).width())&&(n.sWidth=xe(r));a.style.width=xe(T.css("width")),T.remove()}else for(s=0;s<f;s++)c[s].sWidth=xe(w.eq(s).width());y&&(a.style.width=xe(y)),!y&&!h||i._reszEvt||(e(t).bind("resize.DT-"+i.sInstance,we(function(){p(i)})),i._reszEvt=!0)}function we(e,t){var i,n,o=t!==s?t:200;return function(){var t=this,r=+new Date,l=arguments;i&&r<i+o?(clearTimeout(n),n=setTimeout(function(){i=s,e.apply(t,l)},o)):i?(i=r,e.apply(t,l)):i=r}}function ye(t,s){if(!t)return 0;var n=e("<div/>").css("width",xe(t)).appendTo(s||i.body),o=n[0].offsetWidth;return n.remove(),o}function _e(t,i){var s=t.oScroll;if(s.sX||s.sY){var n=s.sX?0:s.iBarWidth;i.style.width=xe(e(i).outerWidth()-n)}}function Ce(t,i){var s=Te(t,i);if(s<0)return null;var n=t.aoData[s];return n.nTr?n.anCells[i]:e("<td/>").html(x(t,s,i,"display"))[0]}function Te(e,t){for(var i,s=-1,n=-1,o=0,r=e.aoData.length;o<r;o++)i=x(e,o,t,"display")+"",i=i.replace(Tt,""),i.length>s&&(s=i.length,n=o);return n}function xe(e){return null===e?"0px":"number"==typeof e?e<0?"0px":e+"px":e.match(/\d$/)?e+"px":e}function Se(){if(!Ke.__scrollbarWidth){var t=e("<p/>").css({"width":"100%","height":200,"padding":0})[0],i=e("<div/>").css({"position":"absolute","top":0,"left":0,"width":200,"height":150,"padding":0,"overflow":"hidden","visibility":"hidden"}).append(t).appendTo("body"),s=t.offsetWidth;i.css("overflow","scroll");var n=t.offsetWidth;s===n&&(n=i[0].clientWidth),i.remove(),Ke.__scrollbarWidth=s-n}return Ke.__scrollbarWidth}function Ie(t){var i,n,o,r,l,a,c,u=[],d=t.aoColumns,h=t.aaSortingFixed,p=e.isPlainObject(h),m=[],f=function(t){t.length&&!e.isArray(t[0])?m.push(t):m.push.apply(m,t)};for(e.isArray(h)&&f(h),p&&h.pre&&f(h.pre),f(t.aaSorting),p&&h.post&&f(h.post),i=0;i<m.length;i++)for(c=m[i][0],r=d[c].aDataSort,n=0,o=r.length;n<o;n++)l=r[n],a=d[l].sType||"string",m[i]._idx===s&&(m[i]._idx=e.inArray(m[i][1],d[l].asSorting)),u.push({"src":c,"col":l,"dir":m[i][1],"index":m[i]._idx,"type":a,"formatter":Ke.ext.type.order[a+"-pre"]});return u}function ke(e){var t,i,s,n,o,r=[],l=Ke.ext.type.order,a=e.aoData,c=(e.aoColumns,0),u=e.aiDisplayMaster;for(v(e),o=Ie(e),t=0,i=o.length;t<i;t++)n=o[t],n.formatter&&c++,De(e,n.col);if("ssp"!=je(e)&&0!==o.length){for(t=0,s=u.length;t<s;t++)r[u[t]]=t;c===o.length?u.sort(function(e,t){var i,s,n,l,c,u=o.length,d=a[e]._aSortData,h=a[t]._aSortData;for(n=0;n<u;n++)if(c=o[n],i=d[c.col],s=h[c.col],0!==(l=i<s?-1:i>s?1:0))return"asc"===c.dir?l:-l;return i=r[e],s=r[t],i<s?-1:i>s?1:0}):u.sort(function(e,t){var i,s,n,c,u,d,h=o.length,p=a[e]._aSortData,m=a[t]._aSortData;for(n=0;n<h;n++)if(u=o[n],i=p[u.col],s=m[u.col],d=l[u.type+"-"+u.dir]||l["string-"+u.dir],0!==(c=d(i,s)))return c;return i=r[e],s=r[t],i<s?-1:i>s?1:0})}e.bSorted=!0}function Ve(e){for(var t,i,s=e.aoColumns,n=Ie(e),o=e.oLanguage.oAria,r=0,l=s.length;r<l;r++){var a=s[r],c=a.asSorting,u=a.sTitle.replace(/<.*?>/g,""),d=a.nTh;d.removeAttribute("aria-sort"),a.bSortable?(n.length>0&&n[0].col==r?(d.setAttribute("aria-sort","asc"==n[0].dir?"ascending":"descending"),i=c[n[0].index+1]||c[0]):i=c[0],t=u+("asc"===i?o.sSortAscending:o.sSortDescending)):t=u,d.setAttribute("aria-label",t)}}function Ae(t,i,n,o){var r,l=t.aoColumns[i],a=t.aaSorting,c=l.asSorting,u=function(t,i){var n=t._idx;return n===s&&(n=e.inArray(t[1],c)),n+1<c.length?n+1:i?null:0};if("number"==typeof a[0]&&(a=t.aaSorting=[a]),n&&t.oFeatures.bSortMulti){var d=e.inArray(i,ht(a,"0"));-1!==d?(r=u(a[d],!0),null===r?a.splice(d,1):(a[d][1]=c[r],a[d]._idx=r)):(a.push([i,c[0],0]),a[a.length-1]._idx=0)}else a.length&&a[0][0]==i?(r=u(a[0]),a.length=1,a[0][1]=c[r],a[0]._idx=r):(a.length=0,a.push([i,c[0]]),a[0]._idx=0);O(t),"function"==typeof o&&o(t)}function Ee(e,t,i,s){var n=e.aoColumns[i];Oe(t,{},function(t){!1!==n.bSortable&&(e.oFeatures.bProcessing?(me(e,!0),setTimeout(function(){Ae(e,i,t.shiftKey,s),"ssp"!==je(e)&&me(e,!1)},0)):Ae(e,i,t.shiftKey,s))})}function Me(t){var i,s,n,o=t.aLastSort,r=t.oClasses.sSortColumn,l=Ie(t),a=t.oFeatures;if(a.bSort&&a.bSortClasses){for(i=0,s=o.length;i<s;i++)n=o[i].src,e(ht(t.aoData,"anCells",n)).removeClass(r+(i<2?i+1:3));for(i=0,s=l.length;i<s;i++)n=l[i].src,e(ht(t.aoData,"anCells",n)).addClass(r+(i<2?i+1:3))}t.aLastSort=l}function De(e,t){var i,s=e.aoColumns[t],n=Ke.ext.order[s.sSortDataType];n&&(i=n.call(e.oInstance,e,t,f(e,t)));for(var o,r,l=Ke.ext.type.order[s.sType+"-pre"],a=0,c=e.aoData.length;a<c;a++)o=e.aoData[a],o._aSortData||(o._aSortData=[]),o._aSortData[t]&&!n||(r=n?i[a]:x(e,a,t,"sort"),o._aSortData[t]=l?l(r):r)}function Fe(t){if(t.oFeatures.bStateSave&&!t.bDestroying){var i={"time":+new Date,"start":t._iDisplayStart,"length":t._iDisplayLength,"order":e.extend(!0,[],t.aaSorting),"search":ie(t.oPreviousSearch),"columns":e.map(t.aoColumns,function(e,i){return{"visible":e.bVisible,"search":ie(t.aoPreSearchCols[i])}})};He(t,"aoStateSaveParams","stateSaveParams",[t,i]),t.oSavedState=i,t.fnStateSaveCallback.call(t.oInstance,t,i)}}function Pe(t,i){var s,n,o=t.aoColumns;if(t.oFeatures.bStateSave){var r=t.fnStateLoadCallback.call(t.oInstance,t);if(r&&r.time){var l=He(t,"aoStateLoadParams","stateLoadParams",[t,r]);if(-1===e.inArray(!1,l)){var a=t.iStateDuration;if(!(a>0&&r.time<+new Date-1e3*a)&&o.length===r.columns.length){for(t.oLoadedState=e.extend(!0,{},r),t._iDisplayStart=r.start,t.iInitDisplayStart=r.start,t._iDisplayLength=r.length,t.aaSorting=[],e.each(r.order,function(e,i){t.aaSorting.push(i[0]>=o.length?[0,i[1]]:i)}),e.extend(t.oPreviousSearch,se(r.search)),s=0,n=r.columns.length;s<n;s++){var c=r.columns[s];o[s].bVisible=c.visible,e.extend(t.aoPreSearchCols[s],se(c.search))}He(t,"aoStateLoaded","stateLoaded",[t,r])}}}}}function Re(t){var i=Ke.settings,s=e.inArray(t,ht(i,"nTable"));return-1!==s?i[s]:null}function Be(e,i,s,n){if(s="DataTables warning: "+(null!==e?"table id="+e.sTableId+" - ":"")+s,n&&(s+=". For more information about this error, please see http://datatables.net/tn/"+n),i)t.console&&console.log&&console.log(s);else{var o=Ke.ext;if("alert"!=(o.sErrMode||o.errMode))throw new Error(s);alert(s)}}function Ne(t,i,n,o){if(e.isArray(n))return void e.each(n,function(s,n){e.isArray(n)?Ne(t,i,n[0],n[1]):Ne(t,i,n)});o===s&&(o=n),i[n]!==s&&(t[o]=i[n])}function Le(t,i,s){var n;for(var o in i)i.hasOwnProperty(o)&&(n=i[o],e.isPlainObject(n)?(e.isPlainObject(t[o])||(t[o]={}),e.extend(!0,t[o],n)):s&&"data"!==o&&"aaData"!==o&&e.isArray(n)?t[o]=n.slice():t[o]=n);return t}function Oe(t,i,s){e(t).bind("click.DT",i,function(e){t.blur(),s(e)}).bind("keypress.DT",i,function(e){13===e.which&&(e.preventDefault(),s(e))}).bind("selectstart.DT",function(){return!1})}function $e(e,t,i,s){i&&e[t].push({"fn":i,"sName":s})}function He(t,i,s,n){var o=[];return i&&(o=e.map(t[i].slice().reverse(),function(e,i){return e.fn.apply(t.oInstance,n)})),null!==s&&e(t.nTable).trigger(s+".dt",n),o}function ze(e){var t=e._iDisplayStart,i=e.fnDisplayEnd(),s=e._iDisplayLength;t>=i&&(t=i-s),t-=t%s,(-1===s||t<0)&&(t=0),e._iDisplayStart=t}function Ue(t,i){var s=t.renderer,n=Ke.ext.renderer[i];return e.isPlainObject(s)&&s[i]?n[s[i]]||n._:"string"==typeof s?n[s]||n._:n._}function je(e){return e.oFeatures.bServerSide?"ssp":e.ajax||e.sAjaxSource?"ajax":"dom"}function qe(e,t){var i=[],s=Ut.numbers_length,n=Math.floor(s/2);return t<=s?i=mt(0,t):e<=n?(i=mt(0,s-2),i.push("ellipsis"),i.push(t-1)):e>=t-1-n?(i=mt(t-(s-2),t),i.splice(0,0,"ellipsis"),i.splice(0,0,0)):(i=mt(e-1,e+2),i.push("ellipsis"),i.push(t-1),i.splice(0,0,"ellipsis"),i.splice(0,0,0)),i.DT_el="span",i}function Ge(t){e.each({"num":function(e){return jt(e,t)},"num-fmt":function(e){return jt(e,t,ot)},"html-num":function(e){return jt(e,t,tt)},"html-num-fmt":function(e){return jt(e,t,tt,ot)}},function(e,i){Je.type.order[e+t+"-pre"]=i,e.match(/^html\-/)&&(Je.type.search[e+t]=Je.type.search.html)})}function We(e){return function(){var t=[Re(this[Ke.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return Ke.ext.internal[e].apply(this,t)}}var Ke,Je,Xe,Qe,Ze,Ye={},et=/[\r\n]/g,tt=/<.*?>/g,it=/^[\w\+\-]/,st=/[\w\+\-]$/,nt=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"].join("|\\")+")","g"),ot=/[',$\xa3\u20ac\xa5%\u2009\u202F]/g,rt=function(e){return!e||!0===e||"-"===e},lt=function(e){var t=parseInt(e,10);return!isNaN(t)&&isFinite(e)?t:null},at=function(e,t){return Ye[t]||(Ye[t]=new RegExp(ee(t),"g")),"string"==typeof e&&"."!==t?e.replace(/\./g,"").replace(Ye[t],"."):e},ct=function(e,t,i){var s="string"==typeof e;return t&&s&&(e=at(e,t)),i&&s&&(e=e.replace(ot,"")),rt(e)||!isNaN(parseFloat(e))&&isFinite(e)},ut=function(e){return rt(e)||"string"==typeof e},dt=function(e,t,i){return!!rt(e)||(ut(e)?!!ct(bt(e),t,i)||null:null)},ht=function(e,t,i){var n=[],o=0,r=e.length;if(i!==s)for(;o<r;o++)e[o]&&e[o][t]&&n.push(e[o][t][i]);else for(;o<r;o++)e[o]&&n.push(e[o][t]);return n},pt=function(e,t,i,n){var o=[],r=0,l=t.length;if(n!==s)for(;r<l;r++)e[t[r]][i]&&o.push(e[t[r]][i][n]);else for(;r<l;r++)o.push(e[t[r]][i]);return o},mt=function(e,t){var i,n=[];t===s?(t=0,i=e):(i=t,t=e);for(var o=t;o<i;o++)n.push(o);return n},ft=function(e){for(var t=[],i=0,s=e.length;i<s;i++)e[i]&&t.push(e[i]);return t},bt=function(e){return e.replace(tt,"")},gt=function(e){var t,i,s,n=[],o=e.length,r=0;e:for(i=0;i<o;i++){for(t=e[i],s=0;s<r;s++)if(n[s]===t)continue e;n.push(t),r++}return n},vt=function(e,t,i){e[t]!==s&&(e[i]=e[t])},wt=/\[.*?\]$/,yt=/\(\)$/,_t=e("<div>")[0],Ct=_t.textContent!==s,Tt=/<.*?>/g;Ke=function(t){this.$=function(e,t){return this.api(!0).$(e,t)},this._=function(e,t){return this.api(!0).rows(e,t).data()},this.api=function(e){return new Xe(e?Re(this[Je.iApiIndex]):this)},this.fnAddData=function(t,i){var n=this.api(!0),o=e.isArray(t)&&(e.isArray(t[0])||e.isPlainObject(t[0]))?n.rows.add(t):n.row.add(t);return(i===s||i)&&n.draw(),o.flatten().toArray()},this.fnAdjustColumnSizing=function(e){var t=this.api(!0).columns.adjust(),i=t.settings()[0],n=i.oScroll;e===s||e?t.draw(!1):""===n.sX&&""===n.sY||be(i)},this.fnClearTable=function(e){var t=this.api(!0).clear();(e===s||e)&&t.draw()},this.fnClose=function(e){this.api(!0).row(e).child.hide()},this.fnDeleteRow=function(e,t,i){var n=this.api(!0),o=n.rows(e),r=o.settings()[0],l=r.aoData[o[0][0]];return o.remove(),t&&t.call(this,r,l),(i===s||i)&&n.draw(),l},this.fnDestroy=function(e){this.api(!0).destroy(e)},this.fnDraw=function(e){this.api(!0).draw(!e)},this.fnFilter=function(e,t,i,n,o,r){var l=this.api(!0);null===t||t===s?l.search(e,i,n,r):l.column(t).search(e,i,n,r),l.draw()},this.fnGetData=function(e,t){
var i=this.api(!0);if(e!==s){var n=e.nodeName?e.nodeName.toLowerCase():"";return t!==s||"td"==n||"th"==n?i.cell(e,t).data():i.row(e).data()||null}return i.data().toArray()},this.fnGetNodes=function(e){var t=this.api(!0);return e!==s?t.row(e).node():t.rows().nodes().flatten().toArray()},this.fnGetPosition=function(e){var t=this.api(!0),i=e.nodeName.toUpperCase();if("TR"==i)return t.row(e).index();if("TD"==i||"TH"==i){var s=t.cell(e).index();return[s.row,s.columnVisible,s.column]}return null},this.fnIsOpen=function(e){return this.api(!0).row(e).child.isShown()},this.fnOpen=function(e,t,i){return this.api(!0).row(e).child(t,i).show().child()[0]},this.fnPageChange=function(e,t){var i=this.api(!0).page(e);(t===s||t)&&i.draw(!1)},this.fnSetColumnVis=function(e,t,i){var n=this.api(!0).column(e).visible(t);(i===s||i)&&n.columns.adjust().draw()},this.fnSettings=function(){return Re(this[Je.iApiIndex])},this.fnSort=function(e){this.api(!0).order(e).draw()},this.fnSortListener=function(e,t,i){this.api(!0).order.listener(e,t,i)},this.fnUpdate=function(e,t,i,n,o){var r=this.api(!0);return i===s||null===i?r.row(t).data(e):r.cell(t,i).data(e),(o===s||o)&&r.columns.adjust(),(n===s||n)&&r.draw(),0},this.fnVersionCheck=Je.fnVersionCheck;var i=this,n=t===s,u=this.length;n&&(t={}),this.oApi=this.internal=Je.internal;for(var p in Ke.ext.internal)p&&(this[p]=We(p));return this.each(function(){var p,m={},f=u>1?Le(m,t,!0):t,b=0,g=this.getAttribute("id"),v=!1,C=Ke.defaults;if("table"!=this.nodeName.toLowerCase())return void Be(null,0,"Non-table node initialisation ("+this.nodeName+")",2);l(C),a(C.column),o(C,C,!0),o(C.column,C.column,!0),o(C,f);var T=Ke.settings;for(b=0,p=T.length;b<p;b++){if(T[b].nTable==this){var x=f.bRetrieve!==s?f.bRetrieve:C.bRetrieve,S=f.bDestroy!==s?f.bDestroy:C.bDestroy;if(n||x)return T[b].oInstance;if(S){T[b].oInstance.fnDestroy();break}return void Be(T[b],0,"Cannot reinitialise DataTable",3)}if(T[b].sTableId==this.id){T.splice(b,1);break}}null!==g&&""!==g||(g="DataTables_Table_"+Ke.ext._unique++,this.id=g);var I=e.extend(!0,{},Ke.models.oSettings,{"nTable":this,"oApi":i.internal,"oInit":f,"sDestroyWidth":e(this)[0].style.width,"sInstance":g,"sTableId":g});T.push(I),I.oInstance=1===i.length?i:e(this).dataTable(),l(f),f.oLanguage&&r(f.oLanguage),f.aLengthMenu&&!f.iDisplayLength&&(f.iDisplayLength=e.isArray(f.aLengthMenu[0])?f.aLengthMenu[0][0]:f.aLengthMenu[0]),f=Le(e.extend(!0,{},C),f),Ne(I.oFeatures,f,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]),Ne(I,f,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]),Ne(I.oScroll,f,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),Ne(I.oLanguage,f,"fnInfoCallback"),$e(I,"aoDrawCallback",f.fnDrawCallback,"user"),$e(I,"aoServerParams",f.fnServerParams,"user"),$e(I,"aoStateSaveParams",f.fnStateSaveParams,"user"),$e(I,"aoStateLoadParams",f.fnStateLoadParams,"user"),$e(I,"aoStateLoaded",f.fnStateLoaded,"user"),$e(I,"aoRowCallback",f.fnRowCallback,"user"),$e(I,"aoRowCreatedCallback",f.fnCreatedRow,"user"),$e(I,"aoHeaderCallback",f.fnHeaderCallback,"user"),$e(I,"aoFooterCallback",f.fnFooterCallback,"user"),$e(I,"aoInitComplete",f.fnInitComplete,"user"),$e(I,"aoPreDrawCallback",f.fnPreDrawCallback,"user");var k=I.oClasses;if(f.bJQueryUI?(e.extend(k,Ke.ext.oJUIClasses,f.oClasses),f.sDom===C.sDom&&"lfrtip"===C.sDom&&(I.sDom='<"H"lfr>t<"F"ip>'),I.renderer?e.isPlainObject(I.renderer)&&!I.renderer.header&&(I.renderer.header="jqueryui"):I.renderer="jqueryui"):e.extend(k,Ke.ext.classes,f.oClasses),e(this).addClass(k.sTable),""===I.oScroll.sX&&""===I.oScroll.sY||(I.oScroll.iBarWidth=Se()),!0===I.oScroll.sX&&(I.oScroll.sX="100%"),I.iInitDisplayStart===s&&(I.iInitDisplayStart=f.iDisplayStart,I._iDisplayStart=f.iDisplayStart),null!==f.iDeferLoading){I.bDeferLoading=!0;var V=e.isArray(f.iDeferLoading);I._iRecordsDisplay=V?f.iDeferLoading[0]:f.iDeferLoading,I._iRecordsTotal=V?f.iDeferLoading[1]:f.iDeferLoading}var A=I.oLanguage;e.extend(!0,A,f.oLanguage),""!==A.sUrl&&(e.ajax({"dataType":"json","url":A.sUrl,"success":function(t){r(t),o(C.oLanguage,t),e.extend(!0,A,t),le(I)},"error":function(){le(I)}}),v=!0),null===f.asStripeClasses&&(I.asStripeClasses=[k.sStripeOdd,k.sStripeEven]);var E=I.asStripeClasses,M=e("tbody tr:eq(0)",this);-1!==e.inArray(!0,e.map(E,function(e,t){return M.hasClass(e)}))&&(e("tbody tr",this).removeClass(E.join(" ")),I.asDestroyStripes=E.slice());var D,P=[],R=this.getElementsByTagName("thead");if(0!==R.length&&(H(I.aoHeader,R[0]),P=z(I)),null===f.aoColumns)for(D=[],b=0,p=P.length;b<p;b++)D.push(null);else D=f.aoColumns;for(b=0,p=D.length;b<p;b++)d(I,P?P[b]:null);if(w(I,f.aoColumnDefs,D,function(e,t){h(I,e,t)}),M.length){var B=function(e,t){return e.getAttribute("data-"+t)?t:null};e.each(F(I,M[0]).cells,function(e,t){var i=I.aoColumns[e];if(i.mData===e){var n=B(t,"sort")||B(t,"order"),o=B(t,"filter")||B(t,"search");null===n&&null===o||(i.mData={"_":e+".display","sort":null!==n?e+".@data-"+n:s,"type":null!==n?e+".@data-"+n:s,"filter":null!==o?e+".@data-"+o:s},h(I,e))}})}var N=I.oFeatures;if(f.bStateSave&&(N.bStateSave=!0,Pe(I,f),$e(I,"aoDrawCallback",Fe,"state_save")),f.aaSorting===s){var L=I.aaSorting;for(b=0,p=L.length;b<p;b++)L[b][1]=I.aoColumns[b].asSorting[0]}Me(I),N.bSort&&$e(I,"aoDrawCallback",function(){if(I.bSorted){var t=Ie(I),i={};e.each(t,function(e,t){i[t.src]=t.dir}),He(I,null,"order",[I,t,i]),Ve(I)}}),$e(I,"aoDrawCallback",function(){(I.bSorted||"ssp"===je(I)||N.bDeferRender)&&Me(I)},"sc"),c(I);var O=e(this).children("caption").each(function(){this._captionSide=e(this).css("caption-side")}),$=e(this).children("thead");0===$.length&&($=e("<thead/>").appendTo(this)),I.nTHead=$[0];var U=e(this).children("tbody");0===U.length&&(U=e("<tbody/>").appendTo(this)),I.nTBody=U[0];var j=e(this).children("tfoot");if(0===j.length&&O.length>0&&(""!==I.oScroll.sX||""!==I.oScroll.sY)&&(j=e("<tfoot/>").appendTo(this)),0===j.length||0===j.children().length?e(this).addClass(k.sNoFooter):j.length>0&&(I.nTFoot=j[0],H(I.aoFooter,I.nTFoot)),f.aaData)for(b=0;b<f.aaData.length;b++)y(I,f.aaData[b]);else(I.bDeferLoading||"dom"==je(I))&&_(I,e(I.nTBody).children("tr"));I.aiDisplay=I.aiDisplayMaster.slice(),I.bInitialised=!0,!1===v&&le(I)}),i=null,this};var xt=[],St=Array.prototype,It=function(t){var i,s,n=Ke.settings,o=e.map(n,function(e,t){return e.nTable});return t?t.nTable&&t.oApi?[t]:t.nodeName&&"table"===t.nodeName.toLowerCase()?(i=e.inArray(t,o),-1!==i?[n[i]]:null):t&&"function"==typeof t.settings?t.settings().toArray():("string"==typeof t?s=e(t):t instanceof e&&(s=t),s?s.map(function(t){return i=e.inArray(this,o),-1!==i?n[i]:null}).toArray():void 0):[]};Xe=function(t,i){if(!this instanceof Xe)throw"DT API must be constructed as a new object";var s=[],n=function(e){var t=It(e);t&&s.push.apply(s,t)};if(e.isArray(t))for(var o=0,r=t.length;o<r;o++)n(t[o]);else n(t);this.context=gt(s),i&&this.push.apply(this,i.toArray?i.toArray():i),this.selector={"rows":null,"cols":null,"opts":null},Xe.extend(this,this,xt)},Ke.Api=Xe,Xe.prototype={"concat":St.concat,"context":[],"each":function(e){for(var t=0,i=this.length;t<i;t++)e.call(this,this[t],t,this);return this},"eq":function(e){var t=this.context;return t.length>e?new Xe(t[e],this[e]):null},"filter":function(e){var t=[];if(St.filter)t=St.filter.call(this,e,this);else for(var i=0,s=this.length;i<s;i++)e.call(this,this[i],i,this)&&t.push(this[i]);return new Xe(this.context,t)},"flatten":function(){var e=[];return new Xe(this.context,e.concat.apply(e,this.toArray()))},"join":St.join,"indexOf":St.indexOf||function(e,t){for(var i=t||0,s=this.length;i<s;i++)if(this[i]===e)return i;return-1},"iterator":function(e,t,i,n){var o,r,l,a,c,u,d,h,p=[],m=this.context,f=this.selector;for("string"==typeof e&&(n=i,i=t,t=e,e=!1),r=0,l=m.length;r<l;r++){var b=new Xe(m[r]);if("table"===t)(o=i.call(b,m[r],r))!==s&&p.push(o);else if("columns"===t||"rows"===t)(o=i.call(b,m[r],this[r],r))!==s&&p.push(o);else if("column"===t||"column-rows"===t||"row"===t||"cell"===t)for(d=this[r],"column-rows"===t&&(u=Dt(m[r],f.opts)),a=0,c=d.length;a<c;a++)h=d[a],(o="cell"===t?i.call(b,m[r],h.row,h.column,r,a):i.call(b,m[r],h,r,a,u))!==s&&p.push(o)}if(p.length||n){var g=new Xe(m,e?p.concat.apply([],p):p),v=g.selector;return v.rows=f.rows,v.cols=f.cols,v.opts=f.opts,g}return this},"lastIndexOf":St.lastIndexOf||function(e,t){return this.indexOf.apply(this.toArray.reverse(),arguments)},"length":0,"map":function(e){var t=[];if(St.map)t=St.map.call(this,e,this);else for(var i=0,s=this.length;i<s;i++)t.push(e.call(this,this[i],i));return new Xe(this.context,t)},"pluck":function(e){return this.map(function(t){return t[e]})},"pop":St.pop,"push":St.push,"reduce":St.reduce||function(e,t){return u(this,e,t,0,this.length,1)},"reduceRight":St.reduceRight||function(e,t){return u(this,e,t,this.length-1,-1,-1)},"reverse":St.reverse,"selector":null,"shift":St.shift,"sort":St.sort,"splice":St.splice,"toArray":function(){return St.slice.call(this)},"to$":function(){return e(this)},"toJQuery":function(){return e(this)},"unique":function(){return new Xe(this.context,gt(this))},"unshift":St.unshift},Xe.extend=function(t,i,s){if(i&&(i instanceof Xe||i.__dt_wrapper)){var n,o,r;for(n=0,o=s.length;n<o;n++)r=s[n],i[r.name]="function"==typeof r.val?function(e,t,i){return function(){var s=t.apply(e,arguments);return Xe.extend(s,s,i.methodExt),s}}(t,r.val,r):e.isPlainObject(r.val)?{}:r.val,i[r.name].__dt_wrapper=!0,Xe.extend(t,i[r.name],r.propExt)}},Xe.register=Qe=function(t,i){if(e.isArray(t))for(var s=0,n=t.length;s<n;s++)Xe.register(t[s],i);else{var o,r,l,a,c=t.split("."),u=xt;for(o=0,r=c.length;o<r;o++){a=-1!==c[o].indexOf("()"),l=a?c[o].replace("()",""):c[o];var d=function(e,t){for(var i=0,s=e.length;i<s;i++)if(e[i].name===t)return e[i];return null}(u,l);d||(d={"name":l,"val":{},"methodExt":[],"propExt":[]},u.push(d)),o===r-1?d.val=i:u=a?d.methodExt:d.propExt}}},Xe.registerPlural=Ze=function(t,i,n){Xe.register(t,n),Xe.register(i,function(){var t=n.apply(this,arguments);return t===this?this:t instanceof Xe?t.length?e.isArray(t[0])?new Xe(t.context,t[0]):t[0]:s:t})};var kt=function(t,i){if("number"==typeof t)return[i[t]];var s=e.map(i,function(e,t){return e.nTable});return e(s).filter(t).map(function(t){var n=e.inArray(this,s);return i[n]}).toArray()};Qe("tables()",function(e){return e?new Xe(kt(e,this.context)):this}),Qe("table()",function(e){var t=this.tables(e),i=t.context;return i.length?new Xe(i[0]):t}),Ze("tables().nodes()","table().node()",function(){return this.iterator("table",function(e){return e.nTable},1)}),Ze("tables().body()","table().body()",function(){return this.iterator("table",function(e){return e.nTBody},1)}),Ze("tables().header()","table().header()",function(){return this.iterator("table",function(e){return e.nTHead},1)}),Ze("tables().footer()","table().footer()",function(){return this.iterator("table",function(e){return e.nTFoot},1)}),Ze("tables().containers()","table().container()",function(){return this.iterator("table",function(e){return e.nTableWrapper},1)}),Qe("draw()",function(e){return this.iterator("table",function(t){O(t,!1===e)})}),Qe("page()",function(e){return e===s?this.page.info().page:this.iterator("table",function(t){he(t,e)})}),Qe("page.info()",function(e){if(0===this.context.length)return s;var t=this.context[0],i=t._iDisplayStart,n=t._iDisplayLength,o=t.fnRecordsDisplay(),r=-1===n;return{"page":r?0:Math.floor(i/n),"pages":r?1:Math.ceil(o/n),"start":i,"end":t.fnDisplayEnd(),"length":n,"recordsTotal":t.fnRecordsTotal(),"recordsDisplay":o}}),Qe("page.len()",function(e){return e===s?0!==this.context.length?this.context[0]._iDisplayLength:s:this.iterator("table",function(t){ce(t,e)})});var Vt=function(e,t,i){if("ssp"==je(e)?O(e,t):(me(e,!0),U(e,[],function(i){E(e);for(var s=W(e,i),n=0,o=s.length;n<o;n++)y(e,s[n]);O(e,t),me(e,!1)})),i){var s=new Xe(e);s.one("draw",function(){i(s.ajax.json())})}};Qe("ajax.json()",function(){var e=this.context;if(e.length>0)return e[0].json}),Qe("ajax.params()",function(){var e=this.context;if(e.length>0)return e[0].oAjaxData}),Qe("ajax.reload()",function(e,t){return this.iterator("table",function(i){Vt(i,!1===t,e)})}),Qe("ajax.url()",function(t){var i=this.context;return t===s?0===i.length?s:(i=i[0],i.ajax?e.isPlainObject(i.ajax)?i.ajax.url:i.ajax:i.sAjaxSource):this.iterator("table",function(i){e.isPlainObject(i.ajax)?i.ajax.url=t:i.ajax=t})}),Qe("ajax.url().load()",function(e,t){return this.iterator("table",function(i){Vt(i,!1===t,e)})});var At=function(t,i){var n,o,r,l,a,c,u=[],d=typeof t;for(t&&"string"!==d&&"function"!==d&&t.length!==s||(t=[t]),r=0,l=t.length;r<l;r++)for(o=t[r]&&t[r].split?t[r].split(","):[t[r]],a=0,c=o.length;a<c;a++)(n=i("string"==typeof o[a]?e.trim(o[a]):o[a]))&&n.length&&u.push.apply(u,n);return u},Et=function(e){return e||(e={}),e.filter&&!e.search&&(e.search=e.filter),{"search":e.search||"none","order":e.order||"current","page":e.page||"all"}},Mt=function(e){for(var t=0,i=e.length;t<i;t++)if(e[t].length>0)return e[0]=e[t],e.length=1,e.context=[e.context[t]],e;return e.length=0,e},Dt=function(t,i){var s,n,o,r=[],l=t.aiDisplay,a=t.aiDisplayMaster,c=i.search,u=i.order,d=i.page;if("ssp"==je(t))return"removed"===c?[]:mt(0,a.length);if("current"==d)for(s=t._iDisplayStart,n=t.fnDisplayEnd();s<n;s++)r.push(l[s]);else if("current"==u||"applied"==u)r="none"==c?a.slice():"applied"==c?l.slice():e.map(a,function(t,i){return-1===e.inArray(t,l)?t:null});else if("index"==u||"original"==u)for(s=0,n=t.aoData.length;s<n;s++)"none"==c?r.push(s):(-1===(o=e.inArray(s,l))&&"removed"==c||o>=0&&"applied"==c)&&r.push(s);return r},Ft=function(t,i,s){return At(i,function(i){var n=lt(i);if(null!==n&&!s)return[n];var o=Dt(t,s);if(null!==n&&-1!==e.inArray(n,o))return[n];if(!i)return o;if("function"==typeof i)return e.map(o,function(e){var s=t.aoData[e];return i(e,s._aData,s.nTr)?e:null});var r=ft(pt(t.aoData,o,"nTr"));return i.nodeName&&-1!==e.inArray(i,r)?[i._DT_RowIndex]:e(r).filter(i).map(function(){return this._DT_RowIndex}).toArray()})};Qe("rows()",function(t,i){t===s?t="":e.isPlainObject(t)&&(i=t,t=""),i=Et(i);var n=this.iterator("table",function(e){return Ft(e,t,i)},1);return n.selector.rows=t,n.selector.opts=i,n}),Qe("rows().nodes()",function(){return this.iterator("row",function(e,t){return e.aoData[t].nTr||s},1)}),Qe("rows().data()",function(){return this.iterator(!0,"rows",function(e,t){return pt(e.aoData,t,"_aData")},1)}),Ze("rows().cache()","row().cache()",function(e){return this.iterator("row",function(t,i){var s=t.aoData[i];return"search"===e?s._aFilterData:s._aSortData},1)}),Ze("rows().invalidate()","row().invalidate()",function(e){return this.iterator("row",function(t,i){D(t,i,e)})}),Ze("rows().indexes()","row().index()",function(){return this.iterator("row",function(e,t){return t},1)}),Ze("rows().remove()","row().remove()",function(){var t=this;return this.iterator("row",function(i,s,n){var o=i.aoData;o.splice(s,1);for(var r=0,l=o.length;r<l;r++)null!==o[r].nTr&&(o[r].nTr._DT_RowIndex=r);e.inArray(s,i.aiDisplay);M(i.aiDisplayMaster,s),M(i.aiDisplay,s),M(t[n],s,!1),ze(i)})}),Qe("rows.add()",function(e){var t=this.iterator("table",function(t){var i,s,n,o=[];for(s=0,n=e.length;s<n;s++)i=e[s],i.nodeName&&"TR"===i.nodeName.toUpperCase()?o.push(_(t,i)[0]):o.push(y(t,i));return o},1),i=this.rows(-1);return i.pop(),i.push.apply(i,t.toArray()),i}),Qe("row()",function(e,t){return Mt(this.rows(e,t))}),Qe("row().data()",function(e){var t=this.context;return e===s?t.length&&this.length?t[0].aoData[this[0]]._aData:s:(t[0].aoData[this[0]]._aData=e,D(t[0],this[0],"data"),this)}),Qe("row().node()",function(){var e=this.context;return e.length&&this.length?e[0].aoData[this[0]].nTr||null:null}),Qe("row.add()",function(t){t instanceof e&&t.length&&(t=t[0]);var i=this.iterator("table",function(e){return t.nodeName&&"TR"===t.nodeName.toUpperCase()?_(e,t)[0]:y(e,t)});return this.row(i[0])});var Pt=function(t,i,s,n){var o=[],r=function(i,s){if(i.nodeName&&"tr"===i.nodeName.toLowerCase())o.push(i);else{var n=e("<tr><td/></tr>").addClass(s);e("td",n).addClass(s).html(i)[0].colSpan=b(t),o.push(n[0])}};if(e.isArray(s)||s instanceof e)for(var l=0,a=s.length;l<a;l++)r(s[l],n);else r(s,n);i._details&&i._details.remove(),i._details=e(o),i._detailsShow&&i._details.insertAfter(i.nTr)},Rt=function(e,t){var i=e.context;if(i.length){var n=i[0].aoData[t!==s?t:e[0]];n._details&&(n._details.remove(),n._detailsShow=s,n._details=s)}},Bt=function(e,t){var i=e.context;if(i.length&&e.length){var s=i[0].aoData[e[0]];s._details&&(s._detailsShow=t,t?s._details.insertAfter(s.nTr):s._details.detach(),Nt(i[0]))}},Nt=function(e){var t=new Xe(e),i=e.aoData;t.off("draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details"),ht(i,"_details").length>0&&(t.on("draw.dt.DT_details",function(s,n){e===n&&t.rows({"page":"current"}).eq(0).each(function(e){var t=i[e];t._detailsShow&&t._details.insertAfter(t.nTr)})}),t.on("column-visibility.dt.DT_details",function(t,s,n,o){if(e===s)for(var r,l=b(s),a=0,c=i.length;a<c;a++)r=i[a],r._details&&r._details.children("td[colspan]").attr("colspan",l)}),t.on("destroy.dt.DT_details",function(s,n){if(e===n)for(var o=0,r=i.length;o<r;o++)i[o]._details&&Rt(t,o)}))};Qe("row().child()",function(e,t){var i=this.context;return e===s?i.length&&this.length?i[0].aoData[this[0]]._details:s:(!0===e?this.child.show():!1===e?Rt(this):i.length&&this.length&&Pt(i[0],i[0].aoData[this[0]],e,t),this)}),Qe(["row().child.show()","row().child().show()"],function(e){return Bt(this,!0),this}),Qe(["row().child.hide()","row().child().hide()"],function(){return Bt(this,!1),this}),Qe(["row().child.remove()","row().child().remove()"],function(){return Rt(this),this}),Qe("row().child.isShown()",function(){var e=this.context;return!(!e.length||!this.length)&&(e[0].aoData[this[0]]._detailsShow||!1)});var Lt=/^(.+):(name|visIdx|visible)$/,Ot=function(e,t,i,s,n){for(var o=[],r=0,l=n.length;r<l;r++)o.push(x(e,n[r],t));return o},$t=function(t,i,s){var n=t.aoColumns,o=ht(n,"sName"),r=ht(n,"nTh");return At(i,function(i){var l=lt(i);if(""===i)return mt(n.length);if(null!==l)return[l>=0?l:n.length+l];if("function"==typeof i){var a=Dt(t,s);return e.map(n,function(e,s){return i(s,Ot(t,s,0,0,a),r[s])?s:null})}var c="string"==typeof i?i.match(Lt):"";if(!c)return e(r).filter(i).map(function(){return e.inArray(this,r)}).toArray();switch(c[2]){case"visIdx":case"visible":var u=parseInt(c[1],10);if(u<0){var d=e.map(n,function(e,t){return e.bVisible?t:null});return[d[d.length+u]]}return[m(t,u)];case"name":return e.map(o,function(e,t){return e===c[1]?t:null})}})},Ht=function(t,i,n,o){var r,l,a,c,u=t.aoColumns,d=u[i],h=t.aoData;if(n===s)return d.bVisible;if(d.bVisible!==n){if(n){var m=e.inArray(!0,ht(u,"bVisible"),i+1);for(l=0,a=h.length;l<a;l++)c=h[l].nTr,r=h[l].anCells,c&&c.insertBefore(r[i],r[m]||null)}else e(ht(t.aoData,"anCells",i)).detach();d.bVisible=n,N(t,t.aoHeader),N(t,t.aoFooter),(o===s||o)&&(p(t),(t.oScroll.sX||t.oScroll.sY)&&be(t)),He(t,null,"column-visibility",[t,i,n]),Fe(t)}};Qe("columns()",function(t,i){t===s?t="":e.isPlainObject(t)&&(i=t,t=""),i=Et(i);var n=this.iterator("table",function(e){return $t(e,t,i)},1);return n.selector.cols=t,n.selector.opts=i,n}),Ze("columns().header()","column().header()",function(e,t){return this.iterator("column",function(e,t){return e.aoColumns[t].nTh},1)}),Ze("columns().footer()","column().footer()",function(e,t){return this.iterator("column",function(e,t){return e.aoColumns[t].nTf},1)}),Ze("columns().data()","column().data()",function(){return this.iterator("column-rows",Ot,1)}),Ze("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(e,t){return e.aoColumns[t].mData},1)}),Ze("columns().cache()","column().cache()",function(e){return this.iterator("column-rows",function(t,i,s,n,o){return pt(t.aoData,o,"search"===e?"_aFilterData":"_aSortData",i)},1)}),Ze("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(e,t,i,s,n){return pt(e.aoData,n,"anCells",t)},1)}),Ze("columns().visible()","column().visible()",function(e,t){return this.iterator("column",function(i,n){if(e===s)return i.aoColumns[n].bVisible;Ht(i,n,e,t)})}),Ze("columns().indexes()","column().index()",function(e){return this.iterator("column",function(t,i){return"visible"===e?f(t,i):i},1)}),Qe("columns.adjust()",function(){return this.iterator("table",function(e){p(e)},1)}),Qe("column.index()",function(e,t){if(0!==this.context.length){var i=this.context[0];if("fromVisible"===e||"toData"===e)return m(i,t);if("fromData"===e||"toVisible"===e)return f(i,t)}}),Qe("column()",function(e,t){return Mt(this.columns(e,t))});var zt=function(t,i,n){var o,r,l,a,c,u,d,h=t.aoData,p=Dt(t,n),m=ft(pt(h,p,"anCells")),f=e([].concat.apply([],m)),b=t.aoColumns.length;return At(i,function(i){var n="function"==typeof i;if(null===i||i===s||n){for(r=[],l=0,a=p.length;l<a;l++)for(o=p[l],c=0;c<b;c++)u={"row":o,"column":c},n?(d=t.aoData[o],i(u,x(t,o,c),d.anCells[c])&&r.push(u)):r.push(u);return r}return e.isPlainObject(i)?[i]:f.filter(i).map(function(t,i){return o=i.parentNode._DT_RowIndex,{"row":o,"column":e.inArray(i,h[o].anCells)}}).toArray()})};Qe("cells()",function(t,i,n){if(e.isPlainObject(t)&&(typeof t.row!==s?(n=i,i=null):(n=t,t=null)),e.isPlainObject(i)&&(n=i,i=null),null===i||i===s)return this.iterator("table",function(e){return zt(e,t,Et(n))});var o,r,l,a,c,u=this.columns(i,n),d=this.rows(t,n),h=this.iterator("table",function(e,t){for(o=[],r=0,l=d[t].length;r<l;r++)for(a=0,c=u[t].length;a<c;a++)o.push({"row":d[t][r],"column":u[t][a]});return o},1);return e.extend(h.selector,{"cols":i,"rows":t,"opts":n}),h}),Ze("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(e,t,i){var n=e.aoData[t].anCells;return n?n[i]:s},1)}),Qe("cells().data()",function(){return this.iterator("cell",function(e,t,i){return x(e,t,i)},1)}),Ze("cells().cache()","cell().cache()",function(e){return e="search"===e?"_aFilterData":"_aSortData",this.iterator("cell",function(t,i,s){return t.aoData[i][e][s]},1)}),Ze("cells().render()","cell().render()",function(e){return this.iterator("cell",function(t,i,s){return x(t,i,s,e)},1)}),Ze("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(e,t,i){return{"row":t,"column":i,"columnVisible":f(e,i)}},1)}),Ze("cells().invalidate()","cell().invalidate()",function(e){return this.iterator("cell",function(t,i,s){D(t,i,e,s)})}),Qe("cell()",function(e,t,i){return Mt(this.cells(e,t,i))}),Qe("cell().data()",function(e){var t=this.context,i=this[0];return e===s?t.length&&i.length?x(t[0],i[0].row,i[0].column):s:(S(t[0],i[0].row,i[0].column,e),D(t[0],i[0].row,"data",i[0].column),this)}),Qe("order()",function(t,i){var n=this.context;return t===s?0!==n.length?n[0].aaSorting:s:("number"==typeof t?t=[[t,i]]:e.isArray(t[0])||(t=Array.prototype.slice.call(arguments)),this.iterator("table",function(e){e.aaSorting=t.slice()}))}),Qe("order.listener()",function(e,t,i){return this.iterator("table",function(s){Ee(s,e,t,i)})}),Qe(["columns().order()","column().order()"],function(t){var i=this;return this.iterator("table",function(s,n){var o=[];e.each(i[n],function(e,i){o.push([i,t])}),s.aaSorting=o})}),Qe("search()",function(t,i,n,o){var r=this.context;return t===s?0!==r.length?r[0].oPreviousSearch.sSearch:s:this.iterator("table",function(s){s.oFeatures.bFilter&&J(s,e.extend({},s.oPreviousSearch,{"sSearch":t+"","bRegex":null!==i&&i,"bSmart":null===n||n,"bCaseInsensitive":null===o||o}),1)})}),Ze("columns().search()","column().search()",function(t,i,n,o){return this.iterator("column",function(r,l){var a=r.aoPreSearchCols;if(t===s)return a[l].sSearch;r.oFeatures.bFilter&&(e.extend(a[l],{"sSearch":t+"","bRegex":null!==i&&i,"bSmart":null===n||n,"bCaseInsensitive":null===o||o}),J(r,r.oPreviousSearch,1))})}),Qe("state()",function(){return this.context.length?this.context[0].oSavedState:null}),Qe("state.clear()",function(){return this.iterator("table",function(e){e.fnStateSaveCallback.call(e.oInstance,e,{})})}),Qe("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),Qe("state.save()",function(){return this.iterator("table",function(e){Fe(e)})}),Ke.versionCheck=Ke.fnVersionCheck=function(e){for(var t,i,s=Ke.version.split("."),n=e.split("."),o=0,r=n.length;o<r;o++)if(t=parseInt(s[o],10)||0,i=parseInt(n[o],10)||0,t!==i)return t>i;return!0},Ke.isDataTable=Ke.fnIsDataTable=function(t){var i=e(t).get(0),s=!1;return e.each(Ke.settings,function(e,t){t.nTable!==i&&t.nScrollHead!==i&&t.nScrollFoot!==i||(s=!0)}),s},Ke.tables=Ke.fnTables=function(t){return e.map(Ke.settings,function(i){if(!t||t&&e(i.nTable).is(":visible"))return i.nTable})},Ke.util={"throttle":we,"escapeRegex":ee},Ke.camelToHungarian=o,Qe("$()",function(t,i){var s=this.rows(i).nodes(),n=e(s);return e([].concat(n.filter(t).toArray(),n.find(t).toArray()))}),e.each(["on","one","off"],function(t,i){Qe(i+"()",function(){var t=Array.prototype.slice.call(arguments);t[0].match(/\.dt\b/)||(t[0]+=".dt");var s=e(this.tables().nodes());return s[i].apply(s,t),this})}),Qe("clear()",function(){return this.iterator("table",function(e){E(e)})}),Qe("settings()",function(){return new Xe(this.context,this.context)}),Qe("data()",function(){return this.iterator("table",function(e){return ht(e.aoData,"_aData")}).flatten()}),Qe("destroy()",function(i){return i=i||!1,this.iterator("table",function(s){var n,o=s.nTableWrapper.parentNode,r=s.oClasses,l=s.nTable,a=s.nTBody,c=s.nTHead,u=s.nTFoot,d=e(l),h=e(a),p=e(s.nTableWrapper),m=e.map(s.aoData,function(e){return e.nTr});s.bDestroying=!0,He(s,"aoDestroyCallback","destroy",[s]),i||new Xe(s).columns().visible(!0),p.unbind(".DT").find(":not(tbody *)").unbind(".DT"),e(t).unbind(".DT-"+s.sInstance),l!=c.parentNode&&(d.children("thead").detach(),d.append(c)),u&&l!=u.parentNode&&(d.children("tfoot").detach(),d.append(u)),d.detach(),p.detach(),s.aaSorting=[],s.aaSortingFixed=[],Me(s),e(m).removeClass(s.asStripeClasses.join(" ")),e("th, td",c).removeClass(r.sSortable+" "+r.sSortableAsc+" "+r.sSortableDesc+" "+r.sSortableNone),s.bJUI&&(e("th span."+r.sSortIcon+", td span."+r.sSortIcon,c).detach(),e("th, td",c).each(function(){var t=e("div."+r.sSortJUIWrapper,this);e(this).append(t.contents()),t.detach()})),!i&&o&&o.insertBefore(l,s.nTableReinsertBefore),h.children().detach(),h.append(m),d.css("width",s.sDestroyWidth).removeClass(r.sTable),(n=s.asDestroyStripes.length)&&h.children().each(function(t){e(this).addClass(s.asDestroyStripes[t%n])});var f=e.inArray(s,Ke.settings);-1!==f&&Ke.settings.splice(f,1)})}),Ke.version="1.10.4",Ke.settings=[],Ke.models={},Ke.models.oSearch={"bCaseInsensitive":!0,"sSearch":"","bRegex":!1,"bSmart":!0},Ke.models.oRow={"nTr":null,"anCells":null,"_aData":[],"_aSortData":null,"_aFilterData":null,"_sFilterRow":null,"_sRowStripe":"","src":null},Ke.models.oColumn={"idx":null,"aDataSort":null,"asSorting":null,"bSearchable":null,"bSortable":null,"bVisible":null,"_sManualType":null,"_bAttrSrc":!1,"fnCreatedCell":null,"fnGetData":null,"fnSetData":null,"mData":null,"mRender":null,"nTh":null,"nTf":null,"sClass":null,"sContentPadding":null,"sDefaultContent":null,"sName":null,"sSortDataType":"std","sSortingClass":null,"sSortingClassJUI":null,"sTitle":null,"sType":null,"sWidth":null,"sWidthOrig":null},Ke.defaults={"aaData":null,"aaSorting":[[0,"asc"]],"aaSortingFixed":[],"ajax":null,"aLengthMenu":[10,25,50,100],"aoColumns":null,"aoColumnDefs":null,"aoSearchCols":[],"asStripeClasses":null,"bAutoWidth":!0,"bDeferRender":!1,"bDestroy":!1,"bFilter":!0,"bInfo":!0,"bJQueryUI":!1,"bLengthChange":!0,"bPaginate":!0,"bProcessing":!1,"bRetrieve":!1,"bScrollCollapse":!1,"bServerSide":!1,"bSort":!0,"bSortMulti":!0,"bSortCellsTop":!1,"bSortClasses":!0,"bStateSave":!1,"fnCreatedRow":null,"fnDrawCallback":null,"fnFooterCallback":null,"fnFormatNumber":function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},"fnHeaderCallback":null,"fnInfoCallback":null,"fnInitComplete":null,"fnPreDrawCallback":null,"fnRowCallback":null,"fnServerData":null,"fnServerParams":null,"fnStateLoadCallback":function(e){try{return JSON.parse((-1===e.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+e.sInstance+"_"+location.pathname))}catch(e){}},"fnStateLoadParams":null,"fnStateLoaded":null,"fnStateSaveCallback":function(e,t){try{(-1===e.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+e.sInstance+"_"+location.pathname,JSON.stringify(t))}catch(e){}},"fnStateSaveParams":null,"iStateDuration":7200,"iDeferLoading":null,"iDisplayLength":10,"iDisplayStart":0,"iTabIndex":0,"oClasses":{},"oLanguage":{"oAria":{"sSortAscending":": activate to sort column ascending","sSortDescending":": activate to sort column descending"},"oPaginate":{"sFirst":"First","sLast":"Last","sNext":"Next","sPrevious":"Previous"},"sEmptyTable":"No data available in table","sInfo":"Showing _START_ to _END_ of _TOTAL_ entries","sInfoEmpty":"Showing 0 to 0 of 0 entries","sInfoFiltered":"(filtered from _MAX_ total entries)","sInfoPostFix":"","sDecimal":"","sThousands":",","sLengthMenu":"Show _MENU_ entries","sLoadingRecords":"Loading...","sProcessing":"Processing...","sSearch":"Search:","sSearchPlaceholder":"","sUrl":"","sZeroRecords":"No matching records found"},"oSearch":e.extend({},Ke.models.oSearch),"sAjaxDataProp":"data","sAjaxSource":null,"sDom":"lfrtip","searchDelay":null,"sPaginationType":"simple_numbers","sScrollX":"","sScrollXInner":"","sScrollY":"","sServerMethod":"GET","renderer":null},n(Ke.defaults),Ke.defaults.column={"aDataSort":null,"iDataSort":-1,"asSorting":["asc","desc"],"bSearchable":!0,"bSortable":!0,"bVisible":!0,"fnCreatedCell":null,"mData":null,"mRender":null,"sCellType":"td","sClass":"","sContentPadding":"","sDefaultContent":null,"sName":"","sSortDataType":"std","sTitle":null,"sType":null,"sWidth":null},n(Ke.defaults.column),Ke.models.oSettings={"oFeatures":{"bAutoWidth":null,"bDeferRender":null,"bFilter":null,"bInfo":null,"bLengthChange":null,"bPaginate":null,"bProcessing":null,"bServerSide":null,"bSort":null,"bSortMulti":null,"bSortClasses":null,"bStateSave":null},"oScroll":{"bCollapse":null,"iBarWidth":0,"sX":null,"sXInner":null,"sY":null},"oLanguage":{"fnInfoCallback":null},"oBrowser":{"bScrollOversize":!1,"bScrollbarLeft":!1},"ajax":null,"aanFeatures":[],"aoData":[],"aiDisplay":[],"aiDisplayMaster":[],"aoColumns":[],"aoHeader":[],"aoFooter":[],"oPreviousSearch":{},"aoPreSearchCols":[],"aaSorting":null,"aaSortingFixed":[],"asStripeClasses":null,"asDestroyStripes":[],"sDestroyWidth":0,"aoRowCallback":[],"aoHeaderCallback":[],"aoFooterCallback":[],"aoDrawCallback":[],"aoRowCreatedCallback":[],"aoPreDrawCallback":[],"aoInitComplete":[],"aoStateSaveParams":[],"aoStateLoadParams":[],"aoStateLoaded":[],"sTableId":"","nTable":null,"nTHead":null,"nTFoot":null,"nTBody":null,"nTableWrapper":null,"bDeferLoading":!1,"bInitialised":!1,"aoOpenRows":[],"sDom":null,"searchDelay":null,"sPaginationType":"two_button","iStateDuration":0,"aoStateSave":[],"aoStateLoad":[],"oSavedState":null,"oLoadedState":null,"sAjaxSource":null,"sAjaxDataProp":null,"bAjaxDataGet":!0,"jqXHR":null,"json":s,"oAjaxData":s,"fnServerData":null,"aoServerParams":[],"sServerMethod":null,"fnFormatNumber":null,"aLengthMenu":null,"iDraw":0,"bDrawing":!1,"iDrawError":-1,"_iDisplayLength":10,"_iDisplayStart":0,"_iRecordsTotal":0,"_iRecordsDisplay":0,"bJUI":null,"oClasses":{},"bFiltered":!1,"bSorted":!1,"bSortCellsTop":null,"oInit":null,
"aoDestroyCallback":[],"fnRecordsTotal":function(){return"ssp"==je(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},"fnRecordsDisplay":function(){return"ssp"==je(this)?1*this._iRecordsDisplay:this.aiDisplay.length},"fnDisplayEnd":function(){var e=this._iDisplayLength,t=this._iDisplayStart,i=t+e,s=this.aiDisplay.length,n=this.oFeatures,o=n.bPaginate;return n.bServerSide?!1===o||-1===e?t+s:Math.min(t+e,this._iRecordsDisplay):!o||i>s||-1===e?s:i},"oInstance":null,"sInstance":null,"iTabIndex":0,"nScrollHead":null,"nScrollFoot":null,"aLastSort":[],"oPlugins":{}},Ke.ext=Je={"classes":{},"errMode":"alert","feature":[],"search":[],"internal":{},"legacy":{"ajax":null},"pager":{},"renderer":{"pageButton":{},"header":{}},"order":{},"type":{"detect":[],"search":{},"order":{}},"_unique":0,"fnVersionCheck":Ke.fnVersionCheck,"iApiIndex":0,"oJUIClasses":{},"sVersion":Ke.version},e.extend(Je,{"afnFiltering":Je.search,"aTypes":Je.type.detect,"ofnSearch":Je.type.search,"oSort":Je.type.order,"afnSortData":Je.order,"aoFeatures":Je.feature,"oApi":Je.internal,"oStdClasses":Je.classes,"oPagination":Je.pager}),e.extend(Ke.ext.classes,{"sTable":"dataTable","sNoFooter":"no-footer","sPageButton":"paginate_button","sPageButtonActive":"current","sPageButtonDisabled":"disabled","sStripeOdd":"odd","sStripeEven":"even","sRowEmpty":"dataTables_empty","sWrapper":"dataTables_wrapper","sFilter":"dataTables_filter","sInfo":"dataTables_info","sPaging":"dataTables_paginate paging_","sLength":"dataTables_length","sProcessing":"dataTables_processing","sSortAsc":"sorting_asc","sSortDesc":"sorting_desc","sSortable":"sorting","sSortableAsc":"sorting_asc_disabled","sSortableDesc":"sorting_desc_disabled","sSortableNone":"sorting_disabled","sSortColumn":"sorting_","sFilterInput":"","sLengthSelect":"","sScrollWrapper":"dataTables_scroll","sScrollHead":"dataTables_scrollHead","sScrollHeadInner":"dataTables_scrollHeadInner","sScrollBody":"dataTables_scrollBody","sScrollFoot":"dataTables_scrollFoot","sScrollFootInner":"dataTables_scrollFootInner","sHeaderTH":"","sFooterTH":"","sSortJUIAsc":"","sSortJUIDesc":"","sSortJUI":"","sSortJUIAscAllowed":"","sSortJUIDescAllowed":"","sSortJUIWrapper":"","sSortIcon":"","sJUIHeader":"","sJUIFooter":""}),function(){var t="";t="";var i=t+"ui-state-default",s=t+"css_right ui-icon ui-icon-",n=t+"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";e.extend(Ke.ext.oJUIClasses,Ke.ext.classes,{"sPageButton":"fg-button ui-button "+i,"sPageButtonActive":"ui-state-disabled","sPageButtonDisabled":"ui-state-disabled","sPaging":"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_","sSortAsc":i+" sorting_asc","sSortDesc":i+" sorting_desc","sSortable":i+" sorting","sSortableAsc":i+" sorting_asc_disabled","sSortableDesc":i+" sorting_desc_disabled","sSortableNone":i+" sorting_disabled","sSortJUIAsc":s+"triangle-1-n","sSortJUIDesc":s+"triangle-1-s","sSortJUI":s+"carat-2-n-s","sSortJUIAscAllowed":s+"carat-1-n","sSortJUIDescAllowed":s+"carat-1-s","sSortJUIWrapper":"DataTables_sort_wrapper","sSortIcon":"DataTables_sort_icon","sScrollHead":"dataTables_scrollHead "+i,"sScrollFoot":"dataTables_scrollFoot "+i,"sHeaderTH":i,"sFooterTH":i,"sJUIHeader":n+" ui-corner-tl ui-corner-tr","sJUIFooter":n+" ui-corner-bl ui-corner-br"})}();var Ut=Ke.ext.pager;e.extend(Ut,{"simple":function(e,t){return["previous","next"]},"full":function(e,t){return["first","previous","next","last"]},"simple_numbers":function(e,t){return["previous",qe(e,t),"next"]},"full_numbers":function(e,t){return["first","previous",qe(e,t),"next","last"]},"_numbers":qe,"numbers_length":7}),e.extend(!0,Ke.ext.renderer,{"pageButton":{"_":function(t,s,n,o,r,l){var a,c,u=t.oClasses,d=t.oLanguage.oPaginate,h=0,p=function(i,s){var o,m,f,b,g=function(e){he(t,e.data.action,!0)};for(o=0,m=s.length;o<m;o++)if(b=s[o],e.isArray(b)){var v=e("<"+(b.DT_el||"div")+"/>").appendTo(i);p(v,b)}else{switch(a="",c="",b){case"ellipsis":i.append("<span>&hellip;</span>");break;case"first":a=d.sFirst,c=b+(r>0?"":" "+u.sPageButtonDisabled);break;case"previous":a=d.sPrevious,c=b+(r>0?"":" "+u.sPageButtonDisabled);break;case"next":a=d.sNext,c=b+(r<l-1?"":" "+u.sPageButtonDisabled);break;case"last":a=d.sLast,c=b+(r<l-1?"":" "+u.sPageButtonDisabled);break;default:a=b+1,c=r===b?u.sPageButtonActive:""}a&&(f=e("<a>",{"class":u.sPageButton+" "+c,"aria-controls":t.sTableId,"data-dt-idx":h,"tabindex":t.iTabIndex,"id":0===n&&"string"==typeof b?t.sTableId+"_"+b:null}).html(a).appendTo(i),Oe(f,{"action":b},g),h++)}};try{var m=e(i.activeElement).data("dt-idx");p(e(s).empty(),o),null!==m&&e(s).find("[data-dt-idx="+m+"]").focus()}catch(e){}}}}),e.extend(Ke.ext.type.detect,[function(e,t){var i=t.oLanguage.sDecimal;return ct(e,i)?"num"+i:null},function(e,t){if(e&&!(e instanceof Date)&&(!it.test(e)||!st.test(e)))return null;var i=Date.parse(e);return null!==i&&!isNaN(i)||rt(e)?"date":null},function(e,t){var i=t.oLanguage.sDecimal;return ct(e,i,!0)?"num-fmt"+i:null},function(e,t){var i=t.oLanguage.sDecimal;return dt(e,i)?"html-num"+i:null},function(e,t){var i=t.oLanguage.sDecimal;return dt(e,i,!0)?"html-num-fmt"+i:null},function(e,t){return rt(e)||"string"==typeof e&&-1!==e.indexOf("<")?"html":null}]),e.extend(Ke.ext.type.search,{"html":function(e){return rt(e)?e:"string"==typeof e?e.replace(et," ").replace(tt,""):""},"string":function(e){return rt(e)?e:"string"==typeof e?e.replace(et," "):e}});var jt=function(e,t,i,s){return 0===e||e&&"-"!==e?(t&&(e=at(e,t)),e.replace&&(i&&(e=e.replace(i,"")),s&&(e=e.replace(s,""))),1*e):-1/0};e.extend(Je.type.order,{"date-pre":function(e){return Date.parse(e)||0},"html-pre":function(e){return rt(e)?"":e.replace?e.replace(/<.*?>/g,"").toLowerCase():e+""},"string-pre":function(e){return rt(e)?"":"string"==typeof e?e.toLowerCase():e.toString?e.toString():""},"string-asc":function(e,t){return e<t?-1:e>t?1:0},"string-desc":function(e,t){return e<t?1:e>t?-1:0}}),Ge(""),e.extend(!0,Ke.ext.renderer,{"header":{"_":function(t,i,s,n){e(t.nTable).on("order.dt.DT",function(e,o,r,l){if(t===o){var a=s.idx;i.removeClass(s.sSortingClass+" "+n.sSortAsc+" "+n.sSortDesc).addClass("asc"==l[a]?n.sSortAsc:"desc"==l[a]?n.sSortDesc:s.sSortingClass)}})},"jqueryui":function(t,i,s,n){e("<div/>").addClass(n.sSortJUIWrapper).append(i.contents()).append(e("<span/>").addClass(n.sSortIcon+" "+s.sSortingClassJUI)).appendTo(i),e(t.nTable).on("order.dt.DT",function(e,o,r,l){if(t===o){var a=s.idx;i.removeClass(n.sSortAsc+" "+n.sSortDesc).addClass("asc"==l[a]?n.sSortAsc:"desc"==l[a]?n.sSortDesc:s.sSortingClass),i.find("span."+n.sSortIcon).removeClass(n.sSortJUIAsc+" "+n.sSortJUIDesc+" "+n.sSortJUI+" "+n.sSortJUIAscAllowed+" "+n.sSortJUIDescAllowed).addClass("asc"==l[a]?n.sSortJUIAsc:"desc"==l[a]?n.sSortJUIDesc:s.sSortingClassJUI)}})}}}),Ke.render={"number":function(e,t,i,s){return{"display":function(n){var o=n<0?"-":"";n=Math.abs(parseFloat(n));var r=parseInt(n,10),l=i?t+(n-r).toFixed(i).substring(2):"";return o+(s||"")+r.toString().replace(/\B(?=(\d{3})+(?!\d))/g,e)+l}}}},e.extend(Ke.ext.internal,{"_fnExternApiFunc":We,"_fnBuildAjax":U,"_fnAjaxUpdate":j,"_fnAjaxParameters":q,"_fnAjaxUpdateDraw":G,"_fnAjaxDataSrc":W,"_fnAddColumn":d,"_fnColumnOptions":h,"_fnAdjustColumnSizing":p,"_fnVisibleToColumnIndex":m,"_fnColumnIndexToVisible":f,"_fnVisbleColumns":b,"_fnGetColumns":g,"_fnColumnTypes":v,"_fnApplyColumnDefs":w,"_fnHungarianMap":n,"_fnCamelToHungarian":o,"_fnLanguageCompat":r,"_fnBrowserDetect":c,"_fnAddData":y,"_fnAddTr":_,"_fnNodeToDataIndex":C,"_fnNodeToColumnIndex":T,"_fnGetCellData":x,"_fnSetCellData":S,"_fnSplitObjNotation":I,"_fnGetObjectDataFn":k,"_fnSetObjectDataFn":V,"_fnGetDataMaster":A,"_fnClearTable":E,"_fnDeleteIndex":M,"_fnInvalidate":D,"_fnGetRowElements":F,"_fnCreateTr":P,"_fnBuildHead":B,"_fnDrawHead":N,"_fnDraw":L,"_fnReDraw":O,"_fnAddOptionsHtml":$,"_fnDetectHeader":H,"_fnGetUniqueThs":z,"_fnFeatureHtmlFilter":K,"_fnFilterComplete":J,"_fnFilterCustom":X,"_fnFilterColumn":Q,"_fnFilter":Z,"_fnFilterCreateSearch":Y,"_fnEscapeRegex":ee,"_fnFilterData":te,"_fnFeatureHtmlInfo":ne,"_fnUpdateInfo":oe,"_fnInfoMacros":re,"_fnInitialise":le,"_fnInitComplete":ae,"_fnLengthChange":ce,"_fnFeatureHtmlLength":ue,"_fnFeatureHtmlPaginate":de,"_fnPageChange":he,"_fnFeatureHtmlProcessing":pe,"_fnProcessingDisplay":me,"_fnFeatureHtmlTable":fe,"_fnScrollDraw":be,"_fnApplyToChildren":ge,"_fnCalculateColumnWidths":ve,"_fnThrottle":we,"_fnConvertToWidth":ye,"_fnScrollingWidthAdjust":_e,"_fnGetWidestNode":Ce,"_fnGetMaxLenString":Te,"_fnStringToCss":xe,"_fnScrollBarWidth":Se,"_fnSortFlatten":Ie,"_fnSort":ke,"_fnSortAria":Ve,"_fnSortListener":Ae,"_fnSortAttachListener":Ee,"_fnSortingClasses":Me,"_fnSortData":De,"_fnSaveState":Fe,"_fnLoadState":Pe,"_fnSettingsFromNode":Re,"_fnLog":Be,"_fnMap":Ne,"_fnBindAction":Oe,"_fnCallbackReg":$e,"_fnCallbackFire":He,"_fnLengthOverflow":ze,"_fnRenderer":Ue,"_fnDataSource":je,"_fnRowAttributes":R,"_fnCalculateEnd":function(){}}),e.fn.dataTable=Ke,e.fn.dataTableSettings=Ke.settings,e.fn.dataTableExt=Ke.ext,e.fn.DataTable=function(t){return e(this).dataTable(t).api()},e.each(Ke,function(t,i){e.fn.DataTable[t]=i}),e.fn.dataTable}(e)}()}(window,document),e.fn.dataTable}),csui.define("csui/lib/jquery.dataTables.bootstrap/js/dataTables.bootstrap",["csui/lib/jquery","csui/lib/jquery.dataTables/js/jquery.dataTables","csui/lib/binf/js/binf"],function(e,t){return function(i,s,n){!function(i){"use strict";e&&"bootstrap"!=t.defaults.renderer&&function(e,t){e.extend(!0,t.defaults,{"dom":"<'binf-row'<'binf-col-sm-6'l><'binf-col-sm-6'f>><'binf-row'<'binf-col-sm-12'tr>><'binf-row'<'binf-col-sm-6'i><'binf-col-sm-6'p>>","renderer":"bootstrap"}),e.extend(t.ext.classes,{"sWrapper":"dataTables_wrapper binf-form-inline dt-bootstrap","sFilterInput":"binf-form-control binf-input-sm","sLengthSelect":"binf-form-control binf-input-sm"}),t.ext.renderer.pageButton.bootstrap=function(i,s,n,o,r,l){var a,c,u=new t.Api(i),d=i.oClasses,h=i.oLanguage.oPaginate,p=function(t,s){var o,m,f,b,g=function(t){t.preventDefault(),e(t.currentTarget).hasClass("binf-disabled")||u.page(t.data.action).draw(!1)};for(o=0,m=s.length;o<m;o++)if(b=s[o],e.isArray(b))p(t,b);else{switch(a="",c="",b){case"ellipsis":a="&hellip;",c=" binf-disabled";break;case"first":a=h.sFirst,c=b+(r>0?"":" binf-disabled");break;case"previous":a=h.sPrevious,c=b+(r>0?"":" binf-disabled");break;case"next":a=h.sNext,c=b+(r<l-1?"":" binf-disabled");break;case"last":a=h.sLast,c=b+(r<l-1?"":" binf-disabled");break;default:a=b+1,c=r===b?" binf-active":""}a&&(f=e("<li>",{"class":d.sPageButton+" "+c,"aria-controls":i.sTableId,"tabindex":i.iTabIndex,"id":0===n&&"string"==typeof b?i.sTableId+"_"+b:null}).append(e("<a>",{"href":"#"}).html(a)).appendTo(t),i.oApi._fnBindAction(f,{"action":b},g))}};p(e(s).empty().html('<ul class="binf-pagination"/>').children("ul"),o)},t.TableTools&&(e.extend(!0,t.TableTools.classes,{"container":"DTTT binf-btn-group","buttons":{"normal":"binf-btn binf-btn-default","disabled":"binf-disabled"},"collection":{"container":"DTTT_dropdown binf-dropdown-menu","buttons":{"normal":"","disabled":"disabled"}},"print":{"info":"DTTT_print_info"},"select":{"row":"binf-active"}}),e.extend(!0,t.TableTools.DEFAULTS.oTags,{"collection":{"container":"ul","button":"li","liner":"a"}})),e.fn.dataTable}(e,t)}()}(window,document),e.fn.dataTable}),csui.define("csui/lib/jquery.dataTables.tableTools/js/dataTables.tableTools",["csui/lib/jquery","csui/lib/jquery.dataTables/js/jquery.dataTables"],function(e){var t;return function(i,s,n){e&&!e.fn.dataTable.TableTools&&function(n,o){var r={"version":"1.0.4-TableTools2","clients":{},"moviePath":"","nextId":1,"$":function(e){return"string"==typeof e&&(e=s.getElementById(e)),e.addClass||(e.hide=function(){this.style.display="none"},e.show=function(){this.style.display=""},e.addClass=function(e){this.removeClass(e),this.className+=" "+e},e.removeClass=function(e){this.className=this.className.replace(new RegExp("\\s*"+e+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},e.hasClass=function(e){return!!this.className.match(new RegExp("\\s*"+e+"\\s*"))}),e},"setMoviePath":function(e){this.moviePath=e},"dispatch":function(e,t,i){var s=this.clients[e];s&&s.receiveEvent(t,i)},"register":function(e,t){this.clients[e]=t},"getDOMObjectPosition":function(e){var t={"left":0,"top":0,"width":e.width?e.width:e.offsetWidth,"height":e.height?e.height:e.offsetHeight};for(""!==e.style.width&&(t.width=e.style.width.replace("px","")),""!==e.style.height&&(t.height=e.style.height.replace("px",""));e;)t.left+=e.offsetLeft,t.top+=e.offsetTop,e=e.offsetParent;return t},"Client":function(e){this.handlers={},this.id=r.nextId++,this.movieId="ZeroClipboard_TableToolsMovie_"+this.id,r.register(this.id,this),e&&this.glue(e)}};r.Client.prototype={"id":0,"ready":!1,"movie":null,"clipText":"","fileName":"","action":"copy","handCursorEnabled":!0,"cssEffects":!0,"handlers":null,"sized":!1,"glue":function(e,t){this.domElement=r.$(e);var i=99;this.domElement.style.zIndex&&(i=parseInt(this.domElement.style.zIndex,10)+1);var n=r.getDOMObjectPosition(this.domElement);this.div=s.createElement("div");var o=this.div.style;o.position="absolute",o.left="0px",o.top="0px",o.width=n.width+"px",o.height=n.height+"px",o.zIndex=i,void 0!==t&&""!==t&&(this.div.title=t),0!==n.width&&0!==n.height&&(this.sized=!0),this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(n.width,n.height).replace(/&/g,"&amp;"))},"positionElement":function(){var e=r.getDOMObjectPosition(this.domElement),t=this.div.style;if(t.position="absolute",t.width=e.width+"px",t.height=e.height+"px",0!==e.width&&0!==e.height){this.sized=!0;var i=this.div.childNodes[0];i.width=e.width,i.height=e.height}},"getHTML":function(e,t){var i="",s="id="+this.id+"&width="+e+"&height="+t;if(navigator.userAgent.match(/MSIE/)){i+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+(location.href.match(/^https/i)?"https://":"http://")+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+e+'" height="'+t+'" id="'+this.movieId+'" align="middle"><param name="allowFullScreen" value="false" /><param name="movie" value="'+r.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+s+'"/><param name="wmode" value="transparent"/></object>'}else i+='<embed id="'+this.movieId+'" src="'+r.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+e+'" height="'+t+'" name="'+this.movieId+'" align="middle" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+s+'" wmode="transparent" />';return i},"hide":function(){this.div&&(this.div.style.left="-2000px")},"show":function(){this.reposition()},"destroy":function(){if(this.domElement&&this.div){this.hide(),this.div.innerHTML="";var e=s.getElementsByTagName("body")[0];try{e.removeChild(this.div)}catch(e){}this.domElement=null,this.div=null}},"reposition":function(e){if(e&&(this.domElement=r.$(e),this.domElement||this.hide()),this.domElement&&this.div){var t=r.getDOMObjectPosition(this.domElement),i=this.div.style;i.left=t.left+"px",i.top=t.top+"px"}},"clearText":function(){this.clipText="",this.ready&&this.movie.clearText()},"appendText":function(e){this.clipText+=e,this.ready&&this.movie.appendText(e)},"setText":function(e){this.clipText=e,this.ready&&this.movie.setText(e)},"setCharSet":function(e){this.charSet=e,this.ready&&this.movie.setCharSet(e)},"setBomInc":function(e){this.incBom=e,this.ready&&this.movie.setBomInc(e)},"setFileName":function(e){this.fileName=e,this.ready&&this.movie.setFileName(e)},"setAction":function(e){this.action=e,this.ready&&this.movie.setAction(e)},"addEventListener":function(e,t){e=e.toString().toLowerCase().replace(/^on/,""),this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},"setHandCursor":function(e){this.handCursorEnabled=e,this.ready&&this.movie.setHandCursor(e)},"setCSSEffects":function(e){this.cssEffects=!!e},"receiveEvent":function(e,t){var n;switch(e=e.toString().toLowerCase().replace(/^on/,"")){case"load":if(this.movie=s.getElementById(this.movieId),!this.movie)return n=this,void setTimeout(function(){n.receiveEvent("load",null)},1);if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/))return n=this,setTimeout(function(){n.receiveEvent("load",null)},100),void(this.ready=!0);this.ready=!0,this.movie.clearText(),this.movie.appendText(this.clipText),this.movie.setFileName(this.fileName),this.movie.setAction(this.action),this.movie.setCharSet(this.charSet),this.movie.setBomInc(this.incBom),this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("binf-active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("binf-active")&&(this.domElement.removeClass("binf-active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("binf-active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("binf-active"),this.recoverActive=!1)}if(this.handlers[e])for(var o=0,r=this.handlers[e].length;o<r;o++){var l=this.handlers[e][o];"function"==typeof l?l(this,t):"object"==typeof l&&2==l.length?l[0][l[1]](this,t):"string"==typeof l&&i[l](this,t)}}},i.ZeroClipboard_TableTools=r,function(e,i,s){t=function(i,s){!this instanceof t&&alert("Warning: TableTools must be initialised with the keyword 'new'");var n=e.fn.dataTable.Api?new e.fn.dataTable.Api(i).settings()[0]:i.fnSettings();return this.s={"that":this,"dt":n,"print":{"saveStart":-1,"saveLength":-1,"saveScroll":-1,"funcEnd":function(){}},"buttonCounter":0,"select":{"type":"","selected":[],"preRowSelect":null,"postSelected":null,"postDeselected":null,"all":!1,"selectedClass":""},"custom":{},"swfPath":"","buttonSet":[],"master":!1,"tags":{}},this.dom={"container":null,"table":null,"print":{"hidden":[],"message":null},"collection":{"collection":null,"background":null}},this.classes=e.extend(!0,{},t.classes),this.s.dt.bJUI&&e.extend(!0,this.classes,t.classes_themeroller),this.fnSettings=function(){return this.s},void 0===s&&(s={}),t._aInstances.push(this),this._fnConstruct(s),this},t.prototype={"fnGetSelected":function(e){var t,i,s=[],n=this.s.dt.aoData,o=this.s.dt.aiDisplay;if(e)for(t=0,i=o.length;t<i;t++)n[o[t]]._DTTT_selected&&s.push(n[o[t]].nTr);else for(t=0,i=n.length;t<i;t++)n[t]._DTTT_selected&&s.push(n[t].nTr);return s},"fnGetSelectedData":function(){var e,t,i=[],s=this.s.dt.aoData;for(e=0,t=s.length;e<t;e++)s[e]._DTTT_selected&&i.push(this.s.dt.oInstance.fnGetData(e));return i},"fnGetSelectedIndexes":function(e){var t,i,s=[],n=this.s.dt.aoData,o=this.s.dt.aiDisplay;if(e)for(t=0,i=o.length;t<i;t++)n[o[t]]._DTTT_selected&&s.push(o[t]);else for(t=0,i=n.length;t<i;t++)n[t]._DTTT_selected&&s.push(t);return s},"fnIsSelected":function(e){var t=this.s.dt.oInstance.fnGetPosition(e);return!0===this.s.dt.aoData[t]._DTTT_selected},"fnSelectAll":function(e){this._fnRowSelect(e?this.s.dt.aiDisplay:this.s.dt.aoData)},"fnSelectNone":function(e){this._fnRowDeselect(this.fnGetSelectedIndexes(e))},"fnSelect":function(e){"single"==this.s.select.type?(this.fnSelectNone(),this._fnRowSelect(e)):this._fnRowSelect(e)},"fnDeselect":function(e){this._fnRowDeselect(e)},"fnGetTitle":function(e){var t="";if(void 0!==e.sTitle&&""!==e.sTitle)t=e.sTitle;else{var i=s.getElementsByTagName("title");i.length>0&&(t=i[0].innerHTML)}return"\xa1".toString().length<4?t.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""):t.replace(/[^a-zA-Z0-9_\.,\-_ !\(\)]/g,"")},"fnCalcColRatios":function(e){var t,i,s=this.s.dt.aoColumns,n=this._fnColumnTargets(e.mColumns),o=[],r=0,l=0;for(t=0,i=n.length;t<i;t++)n[t]&&(r=s[t].nTh.offsetWidth,l+=r,o.push(r));for(t=0,i=o.length;t<i;t++)o[t]=o[t]/l;return o.join("\t")},"fnGetTableData":function(e){if(this.s.dt)return this._fnGetDataTablesData(e)},"fnSetText":function(e,t){this._fnFlashSetText(e,t)},"fnResizeButtons":function(){for(var e in r.clients)if(e){var t=r.clients[e];void 0!==t.domElement&&t.domElement.parentNode&&t.positionElement()}},"fnResizeRequired":function(){for(var e in r.clients)if(e){var t=r.clients[e];if(void 0!==t.domElement&&t.domElement.parentNode==this.dom.container&&!1===t.sized)return!0}return!1},"fnPrint":function(e,t){void 0===t&&(t={}),void 0===e||e?this._fnPrintStart(t):this._fnPrintEnd()},"fnInfo":function(t,i){var s=e("<div/>").addClass(this.classes.print.info).html(t).appendTo("body");setTimeout(function(){s.fadeOut("normal",function(){s.remove()})},i)},"fnContainer":function(){return this.dom.container},"_fnConstruct":function(i){var n=this;this._fnCustomiseSettings(i),this.dom.container=s.createElement(this.s.tags.container),this.dom.container.className=this.classes.container,"none"!=this.s.select.type&&this._fnRowSelectConfig(),this._fnButtonDefinations(this.s.buttonSet,this.dom.container),this.s.dt.aoDestroyCallback.push({"sName":"TableTools","fn":function(){e(n.s.dt.nTBody).off("click.DTTT_Select","tr"),e(n.dom.container).empty();var i=e.inArray(n,t._aInstances);-1!==i&&t._aInstances.splice(i,1)}})},"_fnCustomiseSettings":function(i){void 0===this.s.dt._TableToolsInit&&(this.s.master=!0,this.s.dt._TableToolsInit=!0),this.dom.table=this.s.dt.nTable,this.s.custom=e.extend({},t.DEFAULTS,i),this.s.swfPath=this.s.custom.sSwfPath,void 0!==r&&(r.moviePath=this.s.swfPath),this.s.select.type=this.s.custom.sRowSelect,this.s.select.preRowSelect=this.s.custom.fnPreRowSelect,this.s.select.postSelected=this.s.custom.fnRowSelected,this.s.select.postDeselected=this.s.custom.fnRowDeselected,this.s.custom.sSelectedClass&&(this.classes.select.row=this.s.custom.sSelectedClass),this.s.tags=this.s.custom.oTags,this.s.buttonSet=this.s.custom.aButtons},"_fnButtonDefinations":function(i,s){for(var n,o=0,r=i.length;o<r;o++){if("string"==typeof i[o]){if(void 0===t.BUTTONS[i[o]]){alert("TableTools: Warning - unknown button type: "+i[o]);continue}n=e.extend({},t.BUTTONS[i[o]],!0)}else{if(void 0===t.BUTTONS[i[o].sExtends]){alert("TableTools: Warning - unknown button type: "+i[o].sExtends);continue}var l=e.extend({},t.BUTTONS[i[o].sExtends],!0);n=e.extend(l,i[o],!0)}var a=this._fnCreateButton(n,e(s).hasClass(this.classes.collection.container));a&&s.appendChild(a)}},"_fnCreateButton":function(t,i){var s=this._fnButtonBase(t,i);if(t.sAction.match(/flash/)){if(!this._fnHasFlash())return!1;this._fnFlashConfig(s,t)}else"text"==t.sAction?this._fnTextConfig(s,t):"div"==t.sAction?this._fnTextConfig(s,t):"collection"==t.sAction&&(this._fnTextConfig(s,t),this._fnCollectionConfig(s,t));return-1!==this.s.dt.iTabIndex&&e(s).attr("tabindex",this.s.dt.iTabIndex).attr("aria-controls",this.s.dt.sTableId).on("keyup.DTTT",function(t){13===t.keyCode&&(t.stopPropagation(),e(this).trigger("click"))}).on("mousedown.DTTT",function(e){t.sAction.match(/flash/)||e.preventDefault()}),s},"_fnButtonBase":function(e,t){var i,n,o;t?(i=e.sTag&&"default"!==e.sTag?e.sTag:this.s.tags.collection.button,n=e.sLinerTag&&"default"!==e.sLinerTag?e.sLiner:this.s.tags.collection.liner,o=this.classes.collection.buttons.normal):(i=e.sTag&&"default"!==e.sTag?e.sTag:this.s.tags.button,n=e.sLinerTag&&"default"!==e.sLinerTag?e.sLiner:this.s.tags.liner,o=this.classes.buttons.normal);var r=s.createElement(i),l=s.createElement(n),a=this._fnGetMasterSettings();return r.className=o+" "+e.sButtonClass,r.setAttribute("id","ToolTables_"+this.s.dt.sInstance+"_"+a.buttonCounter),r.appendChild(l),l.innerHTML=e.sButtonText,a.buttonCounter++,r},"_fnGetMasterSettings":function(){if(this.s.master)return this.s;for(var e=t._aInstances,i=0,s=e.length;i<s;i++)if(this.dom.table==e[i].s.dt.nTable)return e[i].s},"_fnCollectionConfig":function(e,t){var i=s.createElement(this.s.tags.collection.container);i.style.display="none",i.className=this.classes.collection.container,t._collection=i,s.body.appendChild(i),this._fnButtonDefinations(t.aButtons,i)},"_fnCollectionShow":function(t,n){var o=this,r=e(t).offset(),l=n._collection,a=r.left,c=r.top+e(t).outerHeight(),u=e(i).height(),d=e(s).height(),h=e(i).width(),p=e(s).width();l.style.position="absolute",l.style.left=a+"px",l.style.top=c+"px",l.style.display="block",e(l).css("opacity",0);var m=s.createElement("div");m.style.position="absolute",m.style.left="0px",m.style.top="0px",m.style.height=(u>d?u:d)+"px",m.style.width=(h>p?h:p)+"px",m.className=this.classes.collection.background,e(m).css("opacity",0),s.body.appendChild(m),s.body.appendChild(l);var f=e(l).outerWidth(),b=e(l).outerHeight();a+f>p&&(l.style.left=p-f+"px"),c+b>d&&(l.style.top=c-b-e(t).outerHeight()+"px"),this.dom.collection.collection=l,this.dom.collection.background=m,setTimeout(function(){e(l).animate({"opacity":1},500),e(m).animate({"opacity":.25},500)},10),this.fnResizeButtons(),e(m).click(function(){o._fnCollectionHide.call(o,null,null)})},"_fnCollectionHide":function(t,i){null!==i&&"collection"==i.sExtends||null!==this.dom.collection.collection&&(e(this.dom.collection.collection).animate({"opacity":0},500,function(e){this.style.display="none"}),e(this.dom.collection.background).animate({"opacity":0},500,function(e){this.parentNode.removeChild(this)}),this.dom.collection.collection=null,this.dom.collection.background=null)},"_fnRowSelectConfig":function(){if(this.s.master){var t=this,i=this.s.dt;this.s.dt.aoOpenRows;e(i.nTable).addClass(this.classes.select.table),"os"===this.s.select.type&&(e(i.nTBody).on("mousedown.DTTT_Select","tr",function(t){t.shiftKey&&e(i.nTBody).css("-moz-user-select","none").one("selectstart.DTTT_Select","tr",function(){return!1})}),e(i.nTBody).on("mouseup.DTTT_Select","tr",function(t){e(i.nTBody).css("-moz-user-select","")})),e(i.nTBody).on("click.DTTT_Select",this.s.custom.sRowSelector,function(s){var n="tr"===this.nodeName.toLowerCase()?this:e(this).parents("tr")[0],o=t.s.select,r=t.s.dt.oInstance.fnGetPosition(n);if(n.parentNode==i.nTBody&&null!==i.oInstance.fnGetData(n)){if("os"==o.type)if(s.ctrlKey||s.metaKey)t.fnIsSelected(n)?t._fnRowDeselect(n,s):t._fnRowSelect(n,s);else if(s.shiftKey){var l=t.s.dt.aiDisplay.slice(),a=e.inArray(o.lastRow,l),c=e.inArray(r,l);if(0===t.fnGetSelected().length||-1===a)l.splice(e.inArray(r,l)+1,l.length);else{if(a>c){var u=c;c=a,a=u}l.splice(c+1,l.length),l.splice(0,a)}t.fnIsSelected(n)?(l.splice(e.inArray(r,l),1),t._fnRowDeselect(l,s)):t._fnRowSelect(l,s)}else t.fnIsSelected(n)&&1===t.fnGetSelected().length?t._fnRowDeselect(n,s):(t.fnSelectNone(),t._fnRowSelect(n,s));else t.fnIsSelected(n)?t._fnRowDeselect(n,s):"single"==o.type?(t.fnSelectNone(),t._fnRowSelect(n,s)):"multi"==o.type&&t._fnRowSelect(n,s);o.lastRow=r}}),i.oApi._fnCallbackReg(i,"aoRowCreatedCallback",function(s,n,o){i.aoData[o]._DTTT_selected&&e(s).addClass(t.classes.select.row)},"TableTools-SelectAll")}},"_fnRowSelect":function(i,s){var n,o,r=this,l=this._fnSelectData(i),a=(0===l.length||l[0].nTr,[]);for(n=0,o=l.length;n<o;n++)l[n].nTr&&a.push(l[n].nTr);if(null===this.s.select.preRowSelect||this.s.select.preRowSelect.call(this,s,a,!0)){for(n=0,o=l.length;n<o;n++)l[n]._DTTT_selected=!0,l[n].nTr&&e(l[n].nTr).addClass(r.classes.select.row);null!==this.s.select.postSelected&&this.s.select.postSelected.call(this,a),t._fnEventDispatch(this,"select",a,!0)}},"_fnRowDeselect":function(i,s){var n,o,r=this,l=this._fnSelectData(i),a=(0===l.length||l[0].nTr,[]);for(n=0,o=l.length;n<o;n++)l[n].nTr&&a.push(l[n].nTr);if(null===this.s.select.preRowSelect||this.s.select.preRowSelect.call(this,s,a,!1)){for(n=0,o=l.length;n<o;n++)l[n]._DTTT_selected=!1,l[n].nTr&&e(l[n].nTr).removeClass(r.classes.select.row);null!==this.s.select.postDeselected&&this.s.select.postDeselected.call(this,a),t._fnEventDispatch(this,"select",a,!1)}},"_fnSelectData":function(e){var t,i,s,n=[];if(e.nodeName)t=this.s.dt.oInstance.fnGetPosition(e),n.push(this.s.dt.aoData[t]);else{if(void 0!==e.length){for(i=0,s=e.length;i<s;i++)e[i].nodeName?(t=this.s.dt.oInstance.fnGetPosition(e[i]),n.push(this.s.dt.aoData[t])):"number"==typeof e[i]?n.push(this.s.dt.aoData[e[i]]):n.push(e[i]);return n}n.push(e)}return n},"_fnTextConfig":function(i,s){var n=this;null!==s.fnInit&&s.fnInit.call(this,i,s),""!==s.sToolTip&&(i.title=s.sToolTip),e(i).hover(function(){null!==s.fnMouseover&&s.fnMouseover.call(this,i,s,null)},function(){null!==s.fnMouseout&&s.fnMouseout.call(this,i,s,null)}),null!==s.fnSelect&&t._fnEventListen(this,"select",function(e){s.fnSelect.call(n,i,s,e)}),e(i).click(function(e){null!==s.fnClick&&s.fnClick.call(n,i,s,null,e),null!==s.fnComplete&&s.fnComplete.call(n,i,s,null,null),n._fnCollectionHide(i,s)})},"_fnHasFlash":function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(e){if(navigator.mimeTypes&&void 0!==navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1},"_fnFlashConfig":function(e,t){var i=this,s=new r.Client;null!==t.fnInit&&t.fnInit.call(this,e,t),s.setHandCursor(!0),"flash_save"==t.sAction?(s.setAction("save"),s.setCharSet("utf16le"==t.sCharSet?"UTF16LE":"UTF8"),s.setBomInc(t.bBomInc),s.setFileName(t.sFileName.replace("*",this.fnGetTitle(t)))):"flash_pdf"==t.sAction?(s.setAction("pdf"),s.setFileName(t.sFileName.replace("*",this.fnGetTitle(t)))):s.setAction("copy"),s.addEventListener("mouseOver",function(n){null!==t.fnMouseover&&t.fnMouseover.call(i,e,t,s)}),s.addEventListener("mouseOut",function(n){null!==t.fnMouseout&&t.fnMouseout.call(i,e,t,s)}),s.addEventListener("mouseDown",function(n){null!==t.fnClick&&t.fnClick.call(i,e,t,s)}),s.addEventListener("complete",function(n,o){null!==t.fnComplete&&t.fnComplete.call(i,e,t,s,o),i._fnCollectionHide(e,t)}),this._fnFlashGlue(s,e,t.sToolTip)},"_fnFlashGlue":function(e,t,i){var n=this,o=t.getAttribute("id");s.getElementById(o)?e.glue(t,i):setTimeout(function(){n._fnFlashGlue(e,t,i)},100)},"_fnFlashSetText":function(e,t){var i=this._fnChunkData(t,8192);e.clearText();for(var s=0,n=i.length;s<n;s++)e.appendText(i[s])},"_fnColumnTargets":function(t){var i,s,n=[],o=this.s.dt,r=o.aoColumns,l=r.length;if("function"==typeof t){var a=t.call(this,o);for(i=0,s=l;i<s;i++)n.push(-1!==e.inArray(i,a))}else if("object"==typeof t){for(i=0,s=l;i<s;i++)n.push(!1);for(i=0,s=t.length;i<s;i++)n[t[i]]=!0}else if("visible"==t)for(i=0,s=l;i<s;i++)n.push(!!r[i].bVisible);else if("hidden"==t)for(i=0,s=l;i<s;i++)n.push(!r[i].bVisible);else if("sortable"==t)for(i=0,s=l;i<s;i++)n.push(!!r[i].bSortable);else for(i=0,s=l;i<s;i++)n.push(!0);return n},"_fnNewline":function(e){return"auto"==e.sNewLine?navigator.userAgent.match(/Windows/)?"\r\n":"\n":e.sNewLine},"_fnGetDataTablesData":function(t){var i,s,n,r,l,a,c,u=[],d="",h=this.s.dt,p=new RegExp(t.sFieldBoundary,"g"),m=this._fnColumnTargets(t.mColumns),f=void 0!==t.bSelectedOnly&&t.bSelectedOnly;if(t.bHeader){for(l=[],i=0,s=h.aoColumns.length;i<s;i++)m[i]&&(d=h.aoColumns[i].sTitle.replace(/\n/g," ").replace(/<.*?>/g,"").replace(/^\s+|\s+$/g,""),d=this._fnHtmlDecode(d),l.push(this._fnBoundData(d,t.sFieldBoundary,p)));u.push(l.join(t.sFieldSeperator))}f=!0;var b,g=this.fnGetSelectedIndexes();for(f="none"!==this.s.select.type&&f&&0!==g.length,b=f?g:o.Api?new o.Api(h).rows(t.oSelectorOpts).indexes().flatten().toArray():h.oInstance.$("tr",t.oSelectorOpts).map(function(e,t){return h.oInstance.fnGetPosition(t)}).get(),n=0,r=b.length;n<r;n++){for(c=h.aoData[b[n]].nTr,l=[],i=0,s=h.aoColumns.length;i<s;i++)if(m[i]){var v=h.oApi._fnGetCellData(h,b[n],i,"display");t.fnCellRender?d=t.fnCellRender(v,i,c,b[n])+"":"string"==typeof v?(d=v.replace(/\n/g," "),d=d.replace(/<img.*?\s+alt\s*=\s*(?:"([^"]+)"|'([^']+)'|([^\s>]+)).*?>/gi,"$1$2$3"),d=d.replace(/<.*?>/g,"")):d=v+"",d=d.replace(/^\s+/,"").replace(/\s+$/,""),d=this._fnHtmlDecode(d),
l.push(this._fnBoundData(d,t.sFieldBoundary,p))}u.push(l.join(t.sFieldSeperator)),t.bOpenRows&&(a=e.grep(h.aoOpenRows,function(e){return e.nParent===c}),1===a.length&&(d=this._fnBoundData(e("td",a[0].nTr).html(),t.sFieldBoundary,p),u.push(d)))}if(t.bFooter&&null!==h.nTFoot){for(l=[],i=0,s=h.aoColumns.length;i<s;i++)m[i]&&null!==h.aoColumns[i].nTf&&(d=h.aoColumns[i].nTf.innerHTML.replace(/\n/g," ").replace(/<.*?>/g,""),d=this._fnHtmlDecode(d),l.push(this._fnBoundData(d,t.sFieldBoundary,p)));u.push(l.join(t.sFieldSeperator))}return u.join(this._fnNewline(t))},"_fnBoundData":function(e,t,i){return""===t?e:t+e.replace(i,t+t)+t},"_fnChunkData":function(e,t){for(var i=[],s=e.length,n=0;n<s;n+=t)n+t<s?i.push(e.substring(n,n+t)):i.push(e.substring(n,s));return i},"_fnHtmlDecode":function(e){if(-1===e.indexOf("&"))return e;var t=s.createElement("div");return e.replace(/&([^\s]*?);/g,function(e,i){return"#"===e.substr(1,1)?String.fromCharCode(Number(i.substr(1))):(t.innerHTML=e,t.childNodes[0].nodeValue)})},"_fnPrintStart":function(t){var n=this,o=this.s.dt;this._fnPrintHideNodes(o.nTable),this.s.print.saveStart=o._iDisplayStart,this.s.print.saveLength=o._iDisplayLength,t.bShowAll&&(o._iDisplayStart=0,o._iDisplayLength=-1,o.oApi._fnCalculateEnd&&o.oApi._fnCalculateEnd(o),o.oApi._fnDraw(o)),""===o.oScroll.sX&&""===o.oScroll.sY||(this._fnPrintScrollStart(o),e(this.s.dt.nTable).bind("draw.DTTT_Print",function(){n._fnPrintScrollStart(o)}));var r=o.aanFeatures;for(var l in r)if("i"!=l&&"t"!=l&&1==l.length)for(var a=0,c=r[l].length;a<c;a++)this.dom.print.hidden.push({"node":r[l][a],"display":"block"}),r[l][a].style.display="none";e(s.body).addClass(this.classes.print.body),""!==t.sInfo&&this.fnInfo(t.sInfo,3e3),t.sMessage&&e("<div/>").addClass(this.classes.print.message).html(t.sMessage).prependTo("body"),this.s.print.saveScroll=e(i).scrollTop(),i.scrollTo(0,0),e(s).bind("keydown.DTTT",function(e){27==e.keyCode&&(e.preventDefault(),n._fnPrintEnd.call(n,e))})},"_fnPrintEnd":function(t){var n=this.s.dt,o=this.s.print;this.dom.print;this._fnPrintShowNodes(),""===n.oScroll.sX&&""===n.oScroll.sY||(e(this.s.dt.nTable).unbind("draw.DTTT_Print"),this._fnPrintScrollEnd()),i.scrollTo(0,o.saveScroll),e("div."+this.classes.print.message).remove(),e(s.body).removeClass("DTTT_Print"),n._iDisplayStart=o.saveStart,n._iDisplayLength=o.saveLength,n.oApi._fnCalculateEnd&&n.oApi._fnCalculateEnd(n),n.oApi._fnDraw(n),e(s).unbind("keydown.DTTT")},"_fnPrintScrollStart":function(){var t,i,s=this.s.dt,n=s.nScrollHead.getElementsByTagName("div")[0],o=(n.getElementsByTagName("table")[0],s.nTable.parentNode);t=s.nTable.getElementsByTagName("thead"),t.length>0&&s.nTable.removeChild(t[0]),null!==s.nTFoot&&(i=s.nTable.getElementsByTagName("tfoot"),i.length>0&&s.nTable.removeChild(i[0])),t=s.nTHead.cloneNode(!0),s.nTable.insertBefore(t,s.nTable.childNodes[0]),null!==s.nTFoot&&(i=s.nTFoot.cloneNode(!0),s.nTable.insertBefore(i,s.nTable.childNodes[1])),""!==s.oScroll.sX&&(s.nTable.style.width=e(s.nTable).outerWidth()+"px",o.style.width=e(s.nTable).outerWidth()+"px",o.style.overflow="visible"),""!==s.oScroll.sY&&(o.style.height=e(s.nTable).outerHeight()+"px",o.style.overflow="visible")},"_fnPrintScrollEnd":function(){var e=this.s.dt,t=e.nTable.parentNode;""!==e.oScroll.sX&&(t.style.width=e.oApi._fnStringToCss(e.oScroll.sX),t.style.overflow="auto"),""!==e.oScroll.sY&&(t.style.height=e.oApi._fnStringToCss(e.oScroll.sY),t.style.overflow="auto")},"_fnPrintShowNodes":function(){for(var e=this.dom.print.hidden,t=0,i=e.length;t<i;t++)e[t].node.style.display=e[t].display;e.splice(0,e.length)},"_fnPrintHideNodes":function(t){for(var i=this.dom.print.hidden,s=t.parentNode,n=s.childNodes,o=0,r=n.length;o<r;o++)if(n[o]!=t&&1==n[o].nodeType){var l=e(n[o]).css("display");"none"!=l&&(i.push({"node":n[o],"display":l}),n[o].style.display="none")}"BODY"!=s.nodeName.toUpperCase()&&this._fnPrintHideNodes(s)}},t._aInstances=[],t._aListeners=[],t.fnGetMasters=function(){for(var e=[],i=0,s=t._aInstances.length;i<s;i++)t._aInstances[i].s.master&&e.push(t._aInstances[i]);return e},t.fnGetInstance=function(e){"object"!=typeof e&&(e=s.getElementById(e));for(var i=0,n=t._aInstances.length;i<n;i++)if(t._aInstances[i].s.master&&t._aInstances[i].dom.table==e)return t._aInstances[i];return null},t._fnEventListen=function(e,i,s){t._aListeners.push({"that":e,"type":i,"fn":s})},t._fnEventDispatch=function(e,i,s,n){for(var o=t._aListeners,r=0,l=o.length;r<l;r++)e.dom.table==o[r].that.dom.table&&o[r].type==i&&o[r].fn(s,n)},t.buttonBase={"sAction":"text","sTag":"default","sLinerTag":"default","sButtonClass":"DTTT_button_text","sButtonText":"Button text","sTitle":"","sToolTip":"","sCharSet":"utf8","bBomInc":!1,"sFileName":"*.csv","sFieldBoundary":"","sFieldSeperator":"\t","sNewLine":"auto","mColumns":"all","bHeader":!0,"bFooter":!0,"bOpenRows":!1,"bSelectedOnly":!1,"oSelectorOpts":void 0,"fnMouseover":null,"fnMouseout":null,"fnClick":null,"fnSelect":null,"fnComplete":null,"fnInit":null,"fnCellRender":null},t.BUTTONS={"csv":e.extend({},t.buttonBase,{"sAction":"flash_save","sButtonClass":"DTTT_button_csv","sButtonText":"CSV","sFieldBoundary":'"',"sFieldSeperator":",","fnClick":function(e,t,i){this.fnSetText(i,this.fnGetTableData(t))}}),"xls":e.extend({},t.buttonBase,{"sAction":"flash_save","sCharSet":"utf16le","bBomInc":!0,"sButtonClass":"DTTT_button_xls","sButtonText":"Excel","fnClick":function(e,t,i){this.fnSetText(i,this.fnGetTableData(t))}}),"copy":e.extend({},t.buttonBase,{"sAction":"flash_copy","sButtonClass":"DTTT_button_copy","sButtonText":"Copy","fnClick":function(e,t,i){this.fnSetText(i,this.fnGetTableData(t))},"fnComplete":function(e,t,i,s){var n=s.split("\n").length;t.bHeader&&n--,null!==this.s.dt.nTFoot&&t.bFooter&&n--;var o=1==n?"":"s";this.fnInfo("<h6>Table copied</h6><p>Copied "+n+" row"+o+" to the clipboard.</p>",1500)}}),"pdf":e.extend({},t.buttonBase,{"sAction":"flash_pdf","sNewLine":"\n","sFileName":"*.pdf","sButtonClass":"DTTT_button_pdf","sButtonText":"PDF","sPdfOrientation":"portrait","sPdfSize":"A4","sPdfMessage":"","fnClick":function(e,t,i){this.fnSetText(i,"title:"+this.fnGetTitle(t)+"\nmessage:"+t.sPdfMessage+"\ncolWidth:"+this.fnCalcColRatios(t)+"\norientation:"+t.sPdfOrientation+"\nsize:"+t.sPdfSize+"\n--/TableToolsOpts--\n"+this.fnGetTableData(t))}}),"print":e.extend({},t.buttonBase,{"sInfo":"<h6>Print view</h6><p>Please use your browser's print function to print this table. Press escape when finished.</p>","sMessage":null,"bShowAll":!0,"sToolTip":"View print view","sButtonClass":"DTTT_button_print","sButtonText":"Print","fnClick":function(e,t){this.fnPrint(!0,t)}}),"text":e.extend({},t.buttonBase),"select":e.extend({},t.buttonBase,{"sButtonText":"Select button","fnSelect":function(t,i){0!==this.fnGetSelected().length?e(t).removeClass(this.classes.buttons.disabled):e(t).addClass(this.classes.buttons.disabled)},"fnInit":function(t,i){e(t).addClass(this.classes.buttons.disabled)}}),"select_single":e.extend({},t.buttonBase,{"sButtonText":"Select button","fnSelect":function(t,i){1==this.fnGetSelected().length?e(t).removeClass(this.classes.buttons.disabled):e(t).addClass(this.classes.buttons.disabled)},"fnInit":function(t,i){e(t).addClass(this.classes.buttons.disabled)}}),"select_all":e.extend({},t.buttonBase,{"sButtonText":"Select all","fnClick":function(e,t){this.fnSelectAll()},"fnSelect":function(t,i){this.fnGetSelected().length==this.s.dt.fnRecordsDisplay()?e(t).addClass(this.classes.buttons.disabled):e(t).removeClass(this.classes.buttons.disabled)}}),"select_none":e.extend({},t.buttonBase,{"sButtonText":"Deselect all","fnClick":function(e,t){this.fnSelectNone()},"fnSelect":function(t,i){0!==this.fnGetSelected().length?e(t).removeClass(this.classes.buttons.disabled):e(t).addClass(this.classes.buttons.disabled)},"fnInit":function(t,i){e(t).addClass(this.classes.buttons.disabled)}}),"ajax":e.extend({},t.buttonBase,{"sAjaxUrl":"/xhr.php","sButtonText":"Ajax button","fnClick":function(t,i){var s=this.fnGetTableData(i);e.ajax({"url":i.sAjaxUrl,"data":[{"name":"tableData","value":s}],"success":i.fnAjaxComplete,"dataType":"json","type":"POST","cache":!1,"error":function(){alert("Error detected when sending table data to server")}})},"fnAjaxComplete":function(e){alert("Ajax complete")}}),"div":e.extend({},t.buttonBase,{"sAction":"div","sTag":"div","sButtonClass":"DTTT_nonbutton","sButtonText":"Text button"}),"collection":e.extend({},t.buttonBase,{"sAction":"collection","sButtonClass":"DTTT_button_collection","sButtonText":"Collection","fnClick":function(e,t){this._fnCollectionShow(e,t)}})},t.buttons=t.BUTTONS,t.classes={"container":"DTTT_container","buttons":{"normal":"DTTT_button","disabled":"DTTT_disabled"},"collection":{"container":"DTTT_collection","background":"DTTT_collection_background","buttons":{"normal":"DTTT_button","disabled":"DTTT_disabled"}},"select":{"table":"DTTT_selectable","row":"DTTT_selected selected"},"print":{"body":"DTTT_Print","info":"DTTT_print_info","message":"DTTT_PrintMessage"}},t.classes_themeroller={"container":"DTTT_container ui-buttonset ui-buttonset-multi","buttons":{"normal":"DTTT_button ui-button ui-state-default"},"collection":{"container":"DTTT_collection ui-buttonset ui-buttonset-multi"}},t.DEFAULTS={"sSwfPath":"../swf/copy_csv_xls_pdf.swf","sRowSelect":"none","sRowSelector":"tr","sSelectedClass":null,"fnPreRowSelect":null,"fnRowSelected":null,"fnRowDeselected":null,"aButtons":["copy","csv","xls","pdf","print"],"oTags":{"container":"div","button":"a","liner":"span","collection":{"container":"div","button":"a","liner":"span"}}},t.defaults=t.DEFAULTS,t.prototype.CLASS="TableTools",t.version="2.2.3",e.fn.dataTable.Api&&e.fn.dataTable.Api.register("tabletools()",function(){var e=null;return this.context.length>0&&(e=t.fnGetInstance(this.context[0].nTable)),e}),"function"==typeof e.fn.dataTable&&"function"==typeof e.fn.dataTableExt.fnVersionCheck&&e.fn.dataTableExt.fnVersionCheck("1.9.0")?e.fn.dataTableExt.aoFeatures.push({"fnInit":function(e){var i=e.oInit,s=i?i.tableTools||i.oTableTools||{}:{};return new t(e.oInstance,s).dom.container},"cFeature":"T","sFeature":"TableTools"}):alert("Warning: TableTools requires DataTables 1.9.0 or newer - www.datatables.net/download"),e.fn.DataTable.TableTools=t}(e,i,s),"function"==typeof n.fn.dataTable&&"function"==typeof n.fn.dataTableExt.fnVersionCheck&&n.fn.dataTableExt.fnVersionCheck("1.9.0")?n.fn.dataTableExt.aoFeatures.push({"fnInit":function(e){var i=void 0!==e.oInit.oTableTools?e.oInit.oTableTools:{},s=new t(e.oInstance,i);return t._aInstances.push(s),s.dom.container},"cFeature":"T","sFeature":"TableTools"}):alert("Warning: TableTools 2 requires DataTables 1.9.0 or newer - www.datatables.net/download"),n.fn.dataTable.TableTools=t,n.fn.DataTable.TableTools=t}(e,e.fn.dataTable)}(window,document),e.fn.dataTable.TableTools}),csui.define("csui/controls/table/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/impl/nls/root/lang",{"searchPlaceholder":"Search {0}","searchByNamePlaceholder":"Search by name","searchIconTooltip":"Search by {0}","searchClearIconTooltip":"Clear","collapseSearch":"Close search","selectAll":"Select all items","selectAllAria":"Select all items","selectItem":"Select {0}","selectItemAria":"Select {0}. When selected an action bar of options can be reached per shift-tab","selectedItemActionBarAria":"Action bar of selected items","nameAria":"{0}","nameNoOpenAria":"{0}. Can not be opened.","NodeTableNoItems":"No results found.","NodeTableLoadingItems":"Loading...","NodeTableProcessingItems":"","NodeTablePageInfo":"Showing _START_ to _END_ of _TOTAL_ items","NodeTableEmptyPageInfo":"Showing 0 items","NodeTableFilteredPageInfo":"(filtered from _MAX_ total items)","NodeTablePageInfoSuffix":"","NodeTablePageThousandsSeparator":",","NodeTablePagingFirst":"First","NodeTablePagingLast":"Last","NodeTablePagingPrevious":"Previous","NodeTablePagingNext":"Next","NodeTablePageSizeSelector":"Show _MENU_ items","NodeTablePageFilterLabel":"Filter by:","NodeTableSortAscending":": Click to sort ascending","NodeTableSortDescending":": Click to sort descending","NodeTableSortByAria":"{0}: Click to sort by {0}","backButtonTooltip":"Go back","typeAndNameAria":"{0} {1}","tableApplicationAria":"Table","descriptionColumnTitle":"Description","cellNoTexAria":"No text"}),csui.define("csui/utils/focusable",["csui/lib/ally"],function(e){"use strict";function t(t,i){var s=i?i.querySelector(t):t;return e.query.focusable({"context":s,"includeContext":!1,"strategy":"quick"})}function i(t){return e.is.focusable(t)}return{"findFocusables":t,"isFocusable":i}}),csui.define("csui/controls/table/cells/cell.registry",["csui/lib/underscore"],function(e){function t(){this._columnKeys={},this._columnOtherKeys={},this._dataTypes={}}return e.extend(t.prototype,{"hasCellViewByOtherKey":function(e){return!!this._columnOtherKeys[e]},"getCellView":function(e){if("type"!==e.get("column_type_identifier")){var t=e.get("column_key"),i=t&&this._columnKeys[t];if(i)return i}var s=e.get("type");return s&&this._dataTypes[s.toString()]},"registerByColumnKey":function(t,i){if(!e.isString(t)||!t)throw new Error("Column key must be a non-empty string");this._registerCellView(this._columnKeys,t,i)},"registerByOtherColumnKey":function(t,i){if(!e.isString(t)||!t)throw new Error("Column key must be a non-empty string");this._registerCellView(this._columnOtherKeys,t,i)},"registerByDataType":function(t,i){if(!e.isNumber(t)||!t)throw new Error("Data type must be a non-zero number");this._registerCellView(this._dataTypes,t.toString(),i)},"_registerCellView":function(e,t,i){if("function"!=typeof i)throw new Error("Column handler must be a function object");e[t]=i}}),new t}),csui.define("csui/controls/table/cells/cell/cell.view",["module","csui/lib/underscore","csui/lib/marionette","csui/utils/focusable"],function(e,t,i,s){"use strict";var n=t.extend({"multiValueSeparator":", "},e.config());return i.View.extend({"tagName":"td","constructor":function(e){i.View.prototype.constructor.apply(this,arguments),this.listenTo(this,"before:render",this._detachClickHandler).listenTo(this,"before:destroy",this._detachClickHandler)},"render":function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderContent(),this.bindUIElements(),this._attachClickHandler(),this.triggerMethod("render",this),this},"_renderContent":function(){var e=t.result(this,"className");e&&this.$el.addClass(e);var i=this.options.column;if(i){var s=i.name;this.$el.attr("data-csui-attribute",s),this.model.get("addEmptyAttribute")&&!this.model.get(s)&&void 0!==this.model.get(s)&&this.el.setAttribute("data-csui-empty-cell",!0)}this.renderValue(),this._ensureAriaLabel()},"_ensureAriaLabel":function(){if(!1!==this.needsAriaLabel){if(void 0===this.needsAriaLabel){if(1===s.findFocusables(this.el).length)return}var e=this.getAriaLabel();e&&this.$el.attr("aria-label",e)}},"_attachClickHandler":function(){var e=this;this.$el.on("click."+this.cid,function(t){e.triggerMethod("clicked:cell",t)})},"_detachClickHandler":function(){this.$el.off("click."+this.cid)},"renderValue":function(){var e=this.getValueText();this.$el.text(e),this.$el.attr("title",e)},"getValueText":function(){var e=this.options.column;if(e){var t=e.name,i=this.model,s=i.get(t+"_formatted");return null!==s&&void 0!==s||null!==(s=i.get(t))&&void 0!==s||(s=""),this.getSingleOrMultipleValueText(s)}return""},"getAriaLabel":function(){return this.getValueText()},"getSingleOrMultipleValueText":function(e,t){return t=this._validateFormater(t),Array.isArray(e)?this.concatenateTextValues(e,t):t(e)},"concatenateTextValues":function(e,t){return t=this._validateFormater(t),e.map(t).join(n.multiValueSeparator)},"_validateFormater":function(e){return e||function(e){return e}}},{"hasFixedWidth":!1,"columnClassName":"","getValue":function(e,t){var i=e.get(t.name);if(Array.isArray(i))for(var s=0;s<i.length;s++)if(void 0!==i[s]&&null!==i[s]){i=i[s];break}return void 0!==i?i:null}})}),csui.define("hbs!csui/controls/table/cells/templated/value",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<span title="'+this.escapeExpression((n=null!=(n=t.value||(null!=e?e.value:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.formattedValue||(null!=e?e.formattedValue:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"formattedValue","hash":{}}):n))+"</span>\r\n"}});return i.registerPartial("csui_controls_table_cells_templated_value",s),s}),csui.define("csui/controls/table/cells/templated/templated.view",["csui/controls/table/cells/cell/cell.view","hbs!csui/controls/table/cells/templated/value"],function(e,t){"use strict";return e.extend({"template":t,"renderValue":function(){var e=this.getValueData(),t=e?this.template(e):"";this.$el.html(t)},"getValueData":function(){function e(e){return e}function t(e){return r||(null===e&&(e=""),e)}var i=this.model,s=this.options.column,n=s.name,o=i.get(n),r=i.get(n+"_formatted");return this.getSingleOrMultipleValueData(o,e,t)},"getSingleOrMultipleValueData":function(e,t,i){var s,n;return Array.isArray(e)?(s=this.concatenateTextValues(e,t),n=this.concatenateTextValues(e,i)):(s=t(e),n=i(e)),{"value":s,"formattedValue":n}}})}),csui.define("hbs!csui/controls/table/cells/text/impl/text",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'    <div class="csui-table-cell-text" aria-label="'+this.escapeExpression((n=null!=(n=t.value||(null!=e?e.value:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'">&nbsp;</div>\r\n'},"3":function(e,t,i,s){var n;return'    <div class="csui-table-cell-text" title="'+this.escapeExpression((n=null!=(n=t.value||(null!=e?e.value:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.value||(null!=e?e.value:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+"</div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.isEmpty:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:""}});return i.registerPartial("csui_controls_table_cells_text_impl_text",s),s}),csui.define("css!csui/controls/table/cells/text/impl/text",[],function(){}),csui.define("csui/controls/table/cells/text/text.view",["csui/controls/table/cells/templated/templated.view","i18n!csui/controls/table/impl/nls/lang","hbs!csui/controls/table/cells/text/impl/text","css!csui/controls/table/cells/text/impl/text"],function(e,t,i){return e.extend({"className":"csui-truncate","template":i,"renderValue":function(){var e=this.getValueText(),i=void 0===e||0===e.length;i&&(e=t.cellNoTexAria);var s=this.template({"value":e,"isEmpty":i});this.$el.html(s)}})}),csui.define("hbs!csui/controls/table/cells/name/impl/name",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.inactive:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(4,s,0)}))?n:""},"2":function(e,t,i,s){var n;return'    <div class="csui-table-cell-name-div">\r\n      <div class="csui-table-cell-name-justify-div">\r\n        <p class="csui-table-cell-name-value csui-table-cell-no-default-action"\r\n           title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.nameNoOpenAria||(null!=e?e.nameNoOpenAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"nameNoOpenAria","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</p>\r\n      </div>\r\n      <div class="csui-table-cell-name-appendix"></div>\r\n    </div>\r\n'},"4":function(e,t,i,s){var n;return'    <div class="csui-table-cell-name-div">\r\n      <a href="'+this.escapeExpression((n=null!=(n=t.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultActionUrl","hash":{}}):n))+'"\r\n         class="csui-table-cell-name-value csui-table-cell-default-action csui-table-cell-name-justify-div"\r\n         title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.nameAria||(null!=e?e.nameAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"nameAria","hash":{}}):n))+'">\r\n        <span class="csui-table-cell-name-link-text">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n      </a>\r\n      <div class="csui-table-cell-name-appendix"></div>\r\n    </div>\r\n'},"6":function(e,t,i,s){var n;return'  <div class="csui-table-cell-name-div">\r\n    <div class="csui-table-cell-name-justify-div">\r\n      <p class="csui-table-cell-name-value csui-table-cell-no-default-action"\r\n         title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.nameNoOpenAria||(null!=e?e.nameNoOpenAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"nameNoOpenAria","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</p>\r\n    </div>\r\n    <div class="csui-table-cell-name-appendix"></div>\r\n  </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.defaultAction:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(6,s,0)}))?n:""}});return i.registerPartial("csui_controls_table_cells_name_impl_name",s),s}),csui.define("css!csui/controls/table/cells/name/impl/name",[],function(){}),csui.define("csui/controls/table/cells/name/name.view",["csui/lib/underscore","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/base","csui/utils/node.links/node.links","hbs!csui/controls/table/cells/name/impl/name","i18n!csui/controls/table/impl/nls/lang","css!csui/controls/table/cells/name/impl/name"],function(e,t,i,s,n,o,r){"use strict";return t.extend({"template":o,"className":"csui-truncate","constructor":function(e){t.prototype.constructor.apply(this,arguments),this.listenTo(this,"before:render",function(){this.needsAriaLabel=!(this.options.column.defaultAction&&!this.model.get("inactive"))})},"getValueData":function(){var t=this.options.column,i=this.model,s=i.get(t.name),o=n.getUrl(i);return{"defaultAction":t.defaultAction,"defaultActionUrl":o,"contextualMenu":t.contextualMenu,"name":s,"nameAria":e.str.sformat(r.nameAria,s),"nameNoOpenAria":e.str.sformat(r.nameNoOpenAria,s),"inactive":i.get("inactive")}}},{"widthFactor":1.5,"columnClassName":"csui-table-cell-name","permanentColumn":!0})}),csui.define("css!csui/controls/table/cells/date/impl/date",[],function(){}),csui.define("csui/controls/table/cells/date/date.view",["csui/lib/underscore","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/base","css!csui/controls/table/cells/date/impl/date"],function(e,t,i,s){"use strict";var n=t.extend({"className":"csui-nowrap","needsAriaLabel":!0,"formatFunction":s.formatExactDateTime,"constructor":function(e){t.prototype.constructor.apply(this,arguments)},"getValueData":function(){function e(e){return i(e)}var t=this.model.get(this.options.column.name),i=this.formatFunction;return this.getSingleOrMultipleValueData(t,e,e)},"getValueText":function(){return this.getValueData().formattedValue}},{"flexibleWidth":!0,"columnClassName":"csui-table-cell-date","getValue":function(e,i){var n=t.getValue(e,i);return n&&s.parseDate(n)}});return i.registerByDataType(-7,n),n}),csui.define("csui/controls/table/cells/datetime/datetime.view",["csui/controls/table/cells/date/date.view","csui/controls/table/cells/cell.registry","csui/utils/base"],function(e,t,i){var s=e.extend({"formatFunction":i.formatDateTime});return t.registerByDataType(401,s),s}),csui.define("hbs!csui/controls/table/cells/duedate/duedate",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <span class="cellview_warning" title="'+this.escapeExpression((n=null!=(n=t.value||(null!=e?e.value:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.formattedValue||(null!=e?e.formattedValue:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"formattedValue","hash":{}}):n))+"</span>\r\n"},"3":function(e,t,i,s){var n;return'  <span title="'+this.escapeExpression((n=null!=(n=t.value||(null!=e?e.value:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.formattedValue||(null!=e?e.formattedValue:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"formattedValue","hash":{}}):n))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.pastDueDate:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:""}});return i.registerPartial("csui_controls_table_cells_duedate_duedate",s),s}),csui.define("csui/controls/table/cells/duedate/duedate.view",["csui/lib/underscore","csui/controls/table/cells/date/date.view","csui/controls/table/cells/cell.registry","csui/utils/base","hbs!csui/controls/table/cells/duedate/duedate"],function(e,t,i,s,n){var o=t.extend({"template":n,"formatFunction":s.formatDateTime,"getValueData":function(){var i=this.model.get(this.options.column.name);return e.extend(t.prototype.getValueData.call(this),{"pastDueDate":new Date(i)<new Date})}});return i.registerByColumnKey("date_due",o),o}),csui.define("csui/controls/table/cells/member/member.view",["csui/lib/underscore","csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/cell.registry","csui/utils/base"],function(e,t,i,s){"use strict";var n=t.extend({"className":"csui-truncate","needsAriaLabel":!0,"getValueText":function(){return n.getValue(this.model,this.options.column)}},{"getValue":function(t,i){var n=i.name,o=t.get(n+"_expand")||t.get(n)||"";return e.isObject(o)?s.formatMemberName(o):t.get(n+"_formatted")||o.toString()},"getModelExpand":function(e){return{"properties":[e.column.name]}}});return i.registerByDataType(14,n),i.registerByDataType(19,n),i.registerByColumnKey("owner_id",n),n}),csui.define("hbs!csui/controls/table/cells/node.state/impl/reservation/reservation",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return(null!=(n=t.if.call(e,null!=e?e.canUnreserve:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+'  <span class="icon '+this.escapeExpression((o=null!=(o=t.iconPrefix||(null!=e?e.iconPrefix:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"iconPrefix","hash":{}}):o))+"_"+(null!=(n=t.if.call(e,null!=e?e.isReservedByOther:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:"")+'"\r\n        title="'+this.escapeExpression((o=null!=(o=t.reservedTooltip||(null!=e?e.reservedTooltip:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"reservedTooltip","hash":{}}):o))+'"></span>\r\n'+(null!=(n=t.if.call(e,null!=e?e.canUnreserve:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?n:"")},"2":function(e,t,i,s){var n;return'    <button type="button" aria-label="'+this.escapeExpression((n=null!=(n=t.reservedAria||(null!=e?e.reservedAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"reservedAria","hash":{}}):n))+'">\r\n'},"4":function(e,t,i,s){return"other"},"6":function(e,t,i,s){return"self"},"8":function(e,t,i,s){return"    </button>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.isReserved:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return i.registerPartial("csui_controls_table_cells_node.state_impl_reservation_reservation",s),s}),csui.define("csui/controls/table/cells/node.state/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/node.state/nls/root/lang",{"reservedTooltip":"Reserved by {0}\r\n{1}","reservedAria":"Reserved by {0} at {1}, click to unreserve","reservedSharedCollaborationTooltip":"Shared for collaboration by {0}\r\n{1}","reservedSharedCollaborationAria":"Shared for collaboration by {0} at {1}, click to unshare","reserved_attribute_title":"Reserved","reserved_attribute_name":"reserved","reserved_shared_collaboration_attribute_title":"Shared for collaboration","reserved_shared_collaboration_attribute_name":"reserved_shared_collaboration"}),csui.define("css!csui/controls/table/cells/node.state/impl/reservation/reservation",[],function(){}),csui.define("csui/controls/table/cells/node.state/impl/reservation/reservation.view",["csui/lib/underscore","csui/lib/marionette","csui/utils/base","csui/utils/contexts/factories/user","csui/models/nodes","csui/utils/commands","csui/utils/commandhelper","hbs!csui/controls/table/cells/node.state/impl/reservation/reservation","i18n!csui/controls/table/cells/node.state/nls/lang","css!csui/controls/table/cells/node.state/impl/reservation/reservation"],function(e,t,i,s,n,o,r,l,a){"use strict";return t.ItemView.extend({"tagName":"li","className":"csui-node-state-reservation","template":l,"triggers":{"click button":"remove:reservation"},"constructor":function(){t.ItemView.prototype.constructor.apply(this,arguments);var e=this.options.context.getModel(s);this.userId=e.get("id"),this.unreserveCommand=o.get("UnreserveDoc"),this.revokeShareCommand=o.get("RevokeShare"),this.commandStatus={"nodes":new n([this.model]),"context":this.options.context};var i=this.model.actions;i&&this.listenTo(i,"update",function(){this._isDestroyed||this.render()})},"templateHelpers":function(){var t,s,n,o=this._getReservedStatus(),r=o.isReserved,l=o.isSharedCollaboration,c=o.reservedBy;if(r){var u=i.formatExactDate(this.model.get("reserved_date")),d=i.formatMemberName(c);l?(t=a.reservedSharedCollaborationTooltip,s=a.reservedSharedCollaborationAria):(t=a.reservedTooltip,s=a.reservedAria),t=e.str.sformat(t,d,u),s=e.str.sformat(s,d,u),n=l?"icon-shared_collaborate":"icon-reserved"}return this._reservedStatus={"isReserved":r,"isSharedCollaboration":l,"isReservedByOther":c&&this.userId!==c.id,"canUnreserve":o.canUnreserve,"reservedTooltip":t,"reservedAria":s,"iconPrefix":n},this._reservedStatus},"onRemoveReservation":function(e){if(this._reservedStatus.canUnreserve){var t=this._reservedStatus.isSharedCollaboration?this.revokeShareCommand:this.unreserveCommand,i=t.execute(this.commandStatus);r.handleExecutionResults(i,{"command":t,"suppressSuccessMessage":this.commandStatus.suppressSuccessMessage,"suppressFailMessage":this.commandStatus.suppressFailMessage})}},"_getReservedStatus":function(){var e=this.model.get("reserved"),t=this.model.get("reserved_shared_collaboration"),i=t?this.revokeShareCommand:this.unreserveCommand,s=this.model.get("reserved_user_id_expand");return s||(s=this.model.get("reserved_user_id"))&&"number"==typeof s&&(s={"id":s}),{"isReserved":e&&void 0!==s||t,"isSharedCollaboration":t,"reservedBy":s,"canUnreserve":i.enabled(this.commandStatus)}},"getAttributes":function(){var e,t,i=this.templateHelpers()
;return i.isSharedCollaboration?(e=a.reserved_shared_collaboration_attribute_title,t=a.reserved_shared_collaboration_attribute_name):(e=a.reserved_attribute_title,t=a.reserved_attribute_name),[{"label":e,"value":i.isReserved,"name":t,"tooltip":i.reservedTooltip,"aria":i.reservedAria}]}},{"enabled":function(e){var t=e.node,i=t.get("reserved"),s=t.get("reserved_shared_collaboration"),n=t.get("reserved_user_id");return i&&n||s},"getModelExpand":function(e){return{"properties":["reserved_user_id"]}}})}),csui.define("csui/controls/table/cells/node.state/node.state.icons",["csui/lib/underscore","csui/lib/backbone","csui/controls/table/cells/node.state/impl/reservation/reservation.view","csui-ext!csui/controls/table/cells/node.state/node.state.icons"],function(e,t,i,s){"use strict";var n=t.Model.extend({"defaults":{"sequence":100,"iconView":null,"iconViewOptions":null},"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments)}}),o=t.Collection.extend({"model":n,"comparator":"sequence","constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments)}}),r=new o;return s&&(s=e.flatten(s,!0),r.add(s)),r}),csui.define("csui/controls/table/cells/node.state/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/node.state/impl/nls/root/lang",{"stateListAria":"List of states","someStateIconsAria":"State available","noStateIconsAria":"No state","bool_value_true":"true","bool_value_false":"false"}),csui.define("css!csui/controls/table/cells/node.state/impl/node.state",[],function(){}),csui.define("csui/controls/table/cells/node.state/node.state.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/cell.registry","csui/controls/table/cells/node.state/node.state.icons","csui/models/mixins/v2.fields/v2.fields.mixin","i18n!csui/controls/table/cells/node.state/impl/nls/lang","css!csui/controls/table/cells/node.state/impl/node.state"],function(e,t,i,s,n,o,r,l,a,c,u){"use strict";var d=/\baccessibleTable\b(?:=([^&]*)?)?/i.exec(location.search);d=d&&"false"!==d[1],n=n(e.id);var h=s.CollectionView.extend({"tagName":"ul","attributes":{"aria-label":u.stateListAria},"getChildView":function(e){return e.get("iconView")},"childViewOptions":function(e){return t.extend({"context":this.options.context,"model":this.options.node,"tableView":this.options.tableView},e.get("iconViewOptions"))}}),p=r.extend({"needsAriaLabel":!0,"events":{"focus":"_disengageKeyTrap","keydown":"_handleKeys","keyup":"_trapKeys"},"constructor":function(e){r.prototype.constructor.apply(this,arguments),this.cellRegion=new s.Region({"el":this.el}),this.listenTo(this,"before:render",this._rememberFocus).listenTo(this,"before:render",this._disengageKeyTrap).listenTo(this,"before:render",this._destroyStateIcons).listenTo(this,"render",this._restoreFocus).listenTo(this,"before:destroy",this._disengageKeyTrap).listenTo(this,"before:destroy",this._destroyStateIcons)},"_destroyStateIcons":function(){this.cellRegion.empty()},"_getEnabledNodeStateIcons":function(){var e;return e=Object.getPrototypeOf(a),new e.constructor(a.filter(function(e){var t=e.get("iconView");return t&&(!t.enabled||t.enabled({"context":this.options.context,"node":this.model}))},this))},"renderValue":function(){var e=this._getEnabledNodeStateIcons();if(e.length){var t=new h({"context":this.options.context,"node":this.model,"tableView":this.options.tableView,"collection":e});this.cellRegion.show(t)}else this._renderEmpty()},"getAriaLabel":function(){return this.cellRegion.currentView?u.someStateIconsAria:u.noStateIconsAria},"getAttributes":function(){var e=this,i=[];return this._getEnabledNodeStateIcons().each(function(s){var n=s.get("iconView"),o=new n({"context":e.options.context,"model":e.model});t.isFunction(o.getAttributes)&&(i=i.concat(o.getAttributes()))}),t.each(i,function(e){t.isBoolean(e.value)&&(e.value=!0===e.value?u.bool_value_true:u.bool_value_false)}),i},"_renderEmpty":function(){d&&i("<span>",{"title":u.noStateIconsAria}).text(u.noStateIconsAria).appendTo(this.$el)},"_handleKeys":function(e){"Enter"===e.key?e.target===this.el&&(this._disengageKeyTrap(),this._engageKeyTrap()):this._hasEngagedKeyTrap()&&("Escape"===e.key?(this._disengageKeyTrap(),this.el.focus()):"ArrowLeft"===e.key?(e.preventDefault(),e.stopPropagation(),this._moveFocus(-1)):"ArrowRight"===e.key?(e.preventDefault(),e.stopPropagation(),this._moveFocus(1)):this._trapKeys(e))},"_trapKeys":function(e){!this._hasEngagedKeyTrap()||"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Tab"!==e.key||(e.preventDefault(),e.stopPropagation())},"_rememberFocus":function(){this._focusTrapped=this.el.contains(document.activeElement)&&this._hasEngagedKeyTrap()},"_restoreFocus":function(){this._focusTrapped&&this._engageKeyTrap()},"_engageKeyTrap":function(){var e=o.findFocusables(this.el);e.length&&(this._keysTrapped=!0,e[0].focus())},"_disengageKeyTrap":function(){this._hasEngagedKeyTrap()&&(this._keysTrapped=!1)},"_hasEngagedKeyTrap":function(){return this._keysTrapped},"_moveFocus":function(e){var t=o.findFocusables(this.el),i=t.length-1,s=t.index(document.activeElement)+e;s<0?s=i:s>i&&(s=0),s=t[s],s?s.focus():n.warn("Focusable elements were unexpectedly removed from {0} ({1}).",n.getObjectName(this),this.cid)&&console.warn(n.last)}},{"columnClassName":"csui-table-cell-node-state","flexibleWidth":!0,"getModelFields":function(e){return a.reduce(function(t,i){var s=i.get("iconView");if(s&&s.getModelFields){var n=s.getModelFields(e);n&&c.mergePropertyParameters(t,n)}return t},{})},"getModelExpand":function(e){return a.reduce(function(t,i){var s=i.get("iconView");if(s&&s.getModelExpand){var n=s.getModelExpand(e);n&&c.mergePropertyParameters(t,n)}return t},{})}});return l.registerByColumnKey("reserved",p),l.registerByOtherColumnKey("reserved_user_id",p),p}),csui.define("csui/controls/table/cells/parent/impl/parent.base.view",["csui/lib/underscore","csui/lib/marionette","csui/behaviors/default.action/default.action.behavior","csui/utils/defaultactionitems","csui/utils/commands"],function(e,t,i,s,n){"use strict";return t.ItemView.extend({"behaviors":{"DefaultAction":{"behaviorClass":i}},"constructor":function(e){t.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this,"cell:node:request",function(){if(this.model.actions.length>0)this.triggerMethod("execute:defaultAction",this.model);else{this.model.resetCommands(),this.model.setCommands(s.getAllCommandSignatures(n));var e=this;this.model.fetch().done(function(){e.triggerMethod("execute:defaultAction",e.model)})}})}})}),csui.define("hbs!csui/controls/table/cells/parent/impl/parent.with.icon",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<a href="'+this.escapeExpression((n=null!=(n=t.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultActionUrl","hash":{}}):n))+'" class="csui-parent-name" title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</a>\r\n"}});return i.registerPartial("csui_controls_table_cells_parent_impl_parent.with.icon",s),s}),csui.define("css!csui/controls/table/cells/parent/impl/parent.with.icon",[],function(){}),csui.define("csui/controls/table/cells/parent/impl/parent.with.icon.view",["csui/lib/underscore","csui/utils/node.links/node.links","csui/controls/node-type.icon/node-type.icon.view","csui/controls/table/cells/parent/impl/parent.base.view","hbs!csui/controls/table/cells/parent/impl/parent.with.icon","css!csui/controls/table/cells/parent/impl/parent.with.icon"],function(e,t,i,s,n){"use strict";return s.extend({"template":n,"className":"csui-parent-location","triggers":{"click a.csui-parent-name":"cell:node:request","click .cs-icon-group":"cell:node:request"},"templateHelpers":function(){return{"name":this.model.get("name"),"defaultActionUrl":t.getUrl(this.model)}},"constructor":function(e){s.prototype.constructor.apply(this,arguments),this.iconView=new i({"node":this.model})},"onRender":function(){this.iconView.render(),this.$el.prepend(this.iconView.$el)}})}),csui.define("csui/controls/table/cells/parent/impl/parent.with.text.view",["csui/lib/underscore","csui/utils/node.links/node.links","csui/controls/table/cells/parent/impl/parent.base.view"],function(e,t,i){"use strict";return i.extend({"tagName":"a","attributes":function(){return{"title":this.model.get("name"),"href":t.getUrl(this.model)}},"template":!1,"triggers":{"click":"cell:node:request"},"constructor":function(e){i.prototype.constructor.apply(this,arguments)},"onRender":function(){this.el.textContent=this.model.get("name")}})}),csui.define("csui/controls/table/cells/parent/parent.view",["csui/lib/underscore","csui/lib/marionette","csui/models/node/node.model","csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/cell.registry","csui/controls/table/cells/parent/impl/parent.with.icon.view","csui/controls/table/cells/parent/impl/parent.with.text.view"],function(e,t,i,s,n,o,r){"use strict";var l=s.extend({"events":{"keydown":"onKeyInView"},"constructor":function(e){s.prototype.constructor.apply(this,arguments);var n=this.model.get("parent_id_expand")||this.model.get("parent_id")||this.model.get("location_id_expand")||this.model.get("location_id");153===this.model.get("type")&&(n=this.model.get("workflow_id_expand")||this.model.get("workflow_id")),this.parentModel=new i(n,{"connector":this.model.connector}),this.parentIconView=new o({"model":this.parentModel,"context":this.options.context}),this.parentTextView=new r({"model":this.parentModel,"context":this.options.context}),this.contentRegion=new t.Region({"el":this.el})},"renderValue":function(){this.contentRegion.show(this.parentIconView)},"getValueText":function(){return this.parentModel.get("name")},"getContentView":function(){return this.parentIconView}},{"getModelExpand":function(e){return{"properties":["parent_id"]}}});return n.registerByColumnKey("parent_id",l),n.registerByColumnKey("location_id",l),l}),csui.define("csui/controls/table/cells/priority/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/priority/impl/nls/root/lang",{"priority_name_high":"High","priority_name_medium":"Medium","priority_name_low":"Low"}),csui.define("hbs!csui/controls/table/cells/priority/impl/priority",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'  <span class="icon icon-priorityHigh"></span>\r\n'},"3":function(e,t,i,s){return'  <span class="icon icon-priorityMedium"></span>\r\n'},"5":function(e,t,i,s){return'  <span class="icon icon-priorityLow"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return(null!=(n=t.if.call(e,null!=e?e.priority_high:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.priority_medium:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.priority_low:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+'<span title="'+this.escapeExpression((o=null!=(o=t.priority_name||(null!=e?e.priority_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"priority_name","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.priority_name||(null!=e?e.priority_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"priority_name","hash":{}}):o))+"</span>\r\n"}});return i.registerPartial("csui_controls_table_cells_priority_impl_priority",s),s}),csui.define("css!csui/controls/table/cells/priority/impl/priority",[],function(){}),csui.define("csui/controls/table/cells/priority/priority.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","i18n!csui/controls/table/cells/priority/impl/nls/lang","hbs!csui/controls/table/cells/priority/impl/priority","css!csui/controls/table/cells/priority/impl/priority"],function(e,t,i,s){"use strict";var n=e.extend({"template":s,"needsAriaLabel":!0,"getValueData":function(){var e=this._getPriorityObject();return{"priority":e.priority,"priority_name":e.priority_name,"priority_high":e.priority_high,"priority_medium":e.priority_medium,"priority_low":e.priority_low}},"getValueText":function(){return this._getPriorityObject().priority_name},"_getPriorityObject":function(){var e={};e.priority=this.model.get(this.options.column.name);var t,s=this.model.get(this.options.column.name+"_name");return e.priority_high=!1,e.priority_medium=!1,e.priority_low=!1,e.priority>50?(e.priority_high=!0,t=i.priority_name_high):50===e.priority?(e.priority_medium=!0,t=i.priority_name_medium):e.priority<50&&(e.priority_low=!0,t=i.priority_name_low),e.priority_name=t||s,e}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-priority"});return t.registerByColumnKey("priority",n),n}),csui.define("css!csui/controls/table/cells/select/impl/select.view",[],function(){}),csui.define("csui/controls/table/cells/select/select.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/checkbox/checkbox.view","csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/cell.registry","i18n!csui/controls/table/impl/nls/lang","css!csui/controls/table/cells/select/impl/select.view"],function(e,t,i,s,n,o,r,l){var a=o.extend({"constructor":function(e){a.__super__.constructor.apply(this,arguments)},"renderValue":function(){var t=this;this.$el.empty();var i=!0===this.model.get(a.isSelectedModelAttributeName),o=e.str.sformat(l.selectItem,this.model.get("name")),r=e.str.sformat(l.selectItemAria,this.model.get("name")),c=!1!==this.model.get("selectable");this.checkboxView=new n({"checked":i?"true":"false","disabled":!c,"ariaLabel":r,"title":o}),new s.Region({"el":this.el}).show(this.checkboxView);var u=this.checkboxView.model;this.listenTo(this.model,"change:"+a.isSelectedModelAttributeName,function(e,t,i){this.checkboxView.setChecked(t)}),this.checkboxView.listenTo(this.checkboxView,"clicked",function(e){e.cancel=!0;var i=u.get("checked");t.triggerMethod("clicked:checkbox",{"checked":i})})}},{"columnKey":"_select","hasFixedWidth":!0,"columnClassName":"csui-table-cell-_select","isSelectedModelAttributeName":"csuiIsSelected"});return r.registerByColumnKey(a.columnKey,a),a}),csui.define("hbs!csui/controls/table/cells/toggledetails/impl/toggledetails",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return'  <a class="expand-details-row-toggle" title="'+this.escapeExpression((o=null!=(o=t.expandToggleTooltip||(null!=e?e.expandToggleTooltip:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"expandToggleTooltip","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.expandToggleAria||(null!=e?e.expandToggleAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"expandToggleAria","hash":{}}):o))+'"\r\n     href="#csui-details-row-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" data-binf-toggle="collapse" aria-expanded="false"\r\n     aria-controls="csui-details-row-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.rowIsExpanded:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(4,s,0)}))?n:"")+"  </a>\r\n"},"2":function(e,t,i,s){return'      <span class="csui-button-icon icon-expandArrowUp"></span>\r\n'},"4":function(e,t,i,s){return'      <span class="csui-button-icon icon-expandArrowDown"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.hasMetadataRow:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return i.registerPartial("csui_controls_table_cells_toggledetails_impl_toggledetails",s),s}),csui.define("csui/controls/table/cells/toggledetails/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/toggledetails/impl/nls/root/lang",{"expandAllTooltip":"Show all","expandAllAria":"Show more details of all items","collapseAllTooltip":"Show less","collapseAllAria":"Show less details of all items","showMoreTooltip":"Show more","showMoreAria":"Show more details","showLessTooltip":"Show less","showLessAria":"Show less details"}),csui.define("css!csui/controls/table/cells/toggledetails/impl/toggledetails",[],function(){}),csui.define("csui/controls/table/cells/toggledetails/toggledetails.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","hbs!csui/controls/table/cells/toggledetails/impl/toggledetails","i18n!csui/controls/table/cells/toggledetails/impl/nls/lang","css!csui/controls/table/cells/toggledetails/impl/toggledetails","csui/lib/binf/js/binf"],function(e,t,i,s){"use strict";var n=e.extend({"template":i,"triggers":{"click a":"toggle"},"events":{"keydown":"onKeyInView"},"getValueData":function(){return{"hasMetadataRow":this.model.get("hasMetadataRow"),"id":this.model.cid,"rowIsExpanded":this.options.rowIsExpanded,"expandToggleTooltip":this.options.rowIsExpanded?s.showLessTooltip:s.showMoreTooltip,"expandToggleAria":this.options.rowIsExpanded?s.showLessAria:s.showMoreAria}},"onToggle":function(e){var t=this.$("a").attr("href"),i=this.$el.parent().parent().find("[id="+t.replace("#","")+"]"),s=this;i.hasClass("binf-collapse")&&(this.options.rowIsExpanded=!1,i.hasClass("binf-in")?i.binf_collapse("hide").on("hidden.binf.collapse",function(){s.trigger("toggle:detailsrow",{"model":s.model,"detailsRowIsExpanded":s.options.rowIsExpanded})}):(i.binf_collapse("show"),this.options.rowIsExpanded=!0),this.trigger("toggle:detailsrow",{"model":this.model,"detailsRowIsExpanded":this.options.rowIsExpanded}),this.render())}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-_toggledetails","rowIsExpandedModelAttributeName":"csui-toggledetails-rowIsExpanded","widthFactor":1/3});return t.registerByColumnKey("_toggledetails",n),n}),csui.define("csui/controls/table/cells/size/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/size/impl/nls/root/localized.strings",{"ColumnTitle":"Size","containerSize":{"formatForNone":"{0} items","formatForOne":"{0} item","formatForTwo":"{0} items","formatForFive":"{0} items"},"sizeUnavailable":"No size","sizeUnavailableAria":"Size unavailable for {0}"}),csui.define("css!csui/controls/table/cells/size/impl/size",[],function(){}),csui.define("csui/controls/table/cells/size/size.view",["csui/lib/underscore","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/base","i18n!csui/controls/table/cells/size/impl/nls/localized.strings","css!csui/controls/table/cells/size/impl/size"],function(e,t,i,s,n){"use strict";var o=/\baccessibleTable\b(?:=([^&]*)?)?/i.exec(location.search);o=o&&"false"!==o[1];var r=t.extend({"className":"csui-nowrap","needsAriaLabel":!0,"getValueData":function(){var e,i=this.model,r=this.options.column,l=r.name,a=i.get(l),c=i.get("type");if(null==a){if(!o)return t.prototype.getValueData.apply(this,arguments);a=e=n.sizeUnavailable}else if(i.get("container"))a=e=202!==c&&899!==c?s.formatMessage(a,n.containerSize):"",o&&!a&&(a=e=n.sizeUnavailable);else{if(144!==c&&749!==c&&736!==c&&30309!==c)return t.prototype.getValueData.apply(this,arguments);e=s.formatFriendlyFileSize(a),a=s.formatExactFileSize(a)}return{"value":a,"formattedValue":e}},"getValueText":function(){var e=this.getValueData();return e&&e.formattedValue||e.value},"getTooltipValueText":function(){var e=this.getValueData();return e&&e.value||this.getValueText()},"getAriaLabel":function(){var t=this.getValueData();return t&&t.value||e.str.sformat(n.sizeUnavailableAria,this.model.get("type_name"))}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-size"});return i.registerByColumnKey("size",r),i.registerByColumnKey("container_size",r),i.registerByColumnKey("file_size",r),r}),csui.define("hbs!csui/controls/table/cells/status/impl/status",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <span class="cellview_warning" title="'+this.escapeExpression((n=null!=(n=t.status_name||(null!=e?e.status_name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"status_name","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.status_name||(null!=e?e.status_name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"status_name","hash":{}}):n))+"</span>\r\n"},"3":function(e,t,i,s){var n;return'  <span title="'+this.escapeExpression((n=null!=(n=t.status_name||(null!=e?e.status_name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"status_name","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.status_name||(null!=e?e.status_name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"status_name","hash":{}}):n))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.status_late:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:""}});return i.registerPartial("csui_controls_table_cells_status_impl_status",s),s}),csui.define("csui/controls/table/cells/status/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/status/impl/nls/root/lang",{"status_name_206_0":"Pending","status_name_206_1":"In Progress","status_name_206_2":"Issue","status_name_206_3":"On Hold","status_name_153_1":"OK","status_name_153_2":"Halted","status_name_153_3":"Step Late","status_name_153_4":"Milestone Late","status_name_153_5":"Late","status_name_153_6":"Suspended","status_name_153_7":"Completed","status_name_153_8":"Stopped","status_name_153_9":"Archived","status_name_153_10":"Subwork Late"}),csui.define("css!csui/controls/table/cells/status/impl/status",[],function(){}),csui.define("csui/controls/table/cells/status/status.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","hbs!csui/controls/table/cells/status/impl/status","i18n!csui/controls/table/cells/status/impl/nls/lang","css!csui/controls/table/cells/status/impl/status"],function(e,t,i,s){"use strict";var n=e.extend({"template":i,"needsAriaLabel":!0,"getValueData":function(){var e=this._getStatusName(),t=this.model.get("type"),i=!1;return 153!==t||3!==status&&4!==status&&5!==status&&10!==status||(i=!0),{"status_name":e,"status_late":i}},"getValueText":function(){return this._getStatusName()},"_getStatusName":function(){var e=this.model.get("type"),t=this.model.get(this.options.column.name),i=s["status_name_"+e+"_"+t],n=this.model.get(this.options.column.name+"_name");return i||n}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-status"});return t.registerByColumnKey("status",n),n}),csui.define("hbs!csui/widgets/favorites/impl/favorite.star/favorite.add.form",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return"  <label for=\"grpSelectId\" class='favorite-group-label'>"+this.escapeExpression((n=null!=(n=t.group_label||(null!=e?e.group_label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"group_label","hash":{}}):n))+"</label>\r\n  <div class='favorite-groups-container'></div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div role="heading" aria-level="3" aria-label="Add favorite">\r\n<label for="'+this.escapeExpression((o=null!=(o=t.name_input_id||(null!=e?e.name_input_id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name_input_id","hash":{}}):o))+"\" class='favorite-name-label'>"+this.escapeExpression((o=null!=(o=t.name_label||(null!=e?e.name_label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name_label","hash":{}}):o))+'</label>\r\n<input id="'+this.escapeExpression((o=null!=(o=t.name_input_id||(null!=e?e.name_input_id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name_input_id","hash":{}}):o))+"\" class='favorite-name-input binf-form-control' type='text' placeholder='"+this.escapeExpression((o=null!=(o=t.name_place_holder||(null!=e?e.name_place_holder:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name_place_holder","hash":{}}):o))+"' value='"+this.escapeExpression((o=null!=(o=t.favorite_name||(null!=e?e.favorite_name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"favorite_name","hash":{}}):o))+"'>\r\n<div class='favorite-name-input-error-div'>\r\n  <span class='favorite-name-input-error'></span>\r\n</div>\r\n\r\n"+(null!=(n=t.if.call(e,null!=e?e.groups:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"\r\n<div class='favorite-buttons-container'>\r\n  <button title=\""+this.escapeExpression((o=null!=(o=t.add_button_label||(null!=e?e.add_button_label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"add_button_label","hash":{}}):o))+"\" class='add-btn binf-btn binf-btn-primary binf-btn-default'>"+this.escapeExpression((o=null!=(o=t.add_button_label||(null!=e?e.add_button_label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"add_button_label","hash":{}}):o))+'</button>\r\n  <button title="'+this.escapeExpression((o=null!=(o=t.cancel_button_label||(null!=e?e.cancel_button_label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"cancel_button_label","hash":{}}):o))+"\" class='cancel-btn binf-btn binf-btn-default'>"+this.escapeExpression((o=null!=(o=t.cancel_button_label||(null!=e?e.cancel_button_label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"cancel_button_label","hash":{}}):o))+"</button>\r\n</div>\r\n</div>\r\n"}});return i.registerPartial("csui_widgets_favorites_impl_favorite.star_favorite.add.form",s),s}),csui.define("hbs!csui/widgets/favorites/impl/favorite.star/favorite.add.form.group",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<a href="#" tabindex="-1">\r\n  <span class="favorite_group" title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</span>\r\n</a>\r\n"}});return i.registerPartial("csui_widgets_favorites_impl_favorite.star_favorite.add.form.group",s),s}),csui.define("hbs!csui/widgets/favorites/impl/favorite.star/favorite.add.form.groups",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<button id="grpSelectId" type="button" class="binf-btn binf-btn-default binf-dropdown-toggle"\r\n        data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\r\n  <span class="selected-group-label"></span>\r\n  <span class="cs-icon icon-caret-down"></span>\r\n</button>\r\n<div class="binf-dropdown-menu favorite-groups-dropdown-container" role="menu">\r\n  <ul class="favorite-groups-dropdown"></ul>\r\n</div>\r\n'}});return i.registerPartial("csui_widgets_favorites_impl_favorite.star_favorite.add.form.groups",s),s}),csui.define("csui/widgets/favorites/impl/favorite.star/favorite.add.form.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/dropdown.menu/dropdown.menu.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/utils/namedsessionstorage","hbs!csui/widgets/favorites/impl/favorite.star/favorite.add.form","hbs!csui/widgets/favorites/impl/favorite.star/favorite.add.form.group","hbs!csui/widgets/favorites/impl/favorite.star/favorite.add.form.groups","i18n!csui/widgets/favorites/impl/nls/lang"],function(e,t,i,s,n,o,r,l,a,c,u,d){var h=new l,p=s.ItemView.extend({"tagName":"li","attributes":function(){return{"role":"menuitem"}},"template":c,"triggers":{"click a":"click:item"},"constructor":function(e){s.ItemView.prototype.constructor.apply(this,arguments)}}),m=s.CompositeView.extend({"className":"favorite-groups-dropdown-container binf-dropdown","template":u,"behaviors":{"PerfectScrolling":{"behaviorClass":r,"contentParent":".favorite-groups-dropdown","suppressScrollX":!0},"DropdownMenuBehavior":{"behaviorClass":o}},"ui":{"toggle":">.binf-dropdown-toggle","selectedLabel":">.binf-btn >.selected-group-label","groupsScrollbarContainer":".favorite-groups-dropdown"},"events":{"shown.binf.dropdown":"onShownDropdown"},"childViewContainer":".favorite-groups-dropdown","childView":p,"childEvents":{"click:item":"onClickItem","render":"_onChildRender"},"_onChildRender":function(e){var t=e.$el;e.model.get("tab_id")===this.options.favModel.get("tab_id")&&t.addClass("binf-active")},"constructor":function(e){s.CompositeView.call(this,e)},"onRender":function(){var e=this.options.collection.findWhere({"tab_id":this.options.favModel.get("tab_id")}),t=e.get("name");this.ui.selectedLabel.text(t),this.ui.selectedLabel.attr("title",t),this.ui.toggle.attr("aria-label",d.addFavoriteGroupLabel+" - "+t),this.ui.toggle.binf_dropdown()},"onClickItem":function(e){this.$el.find("ul li").removeClass("binf-active"),e.$el.addClass("binf-active"),this.ui.toggle.binf_dropdown("toggle"),this.ui.toggle.focus();var t=e.model.get("tab_id");this.options.favModel.set("tab_id",t);var i=e.model.get("name");this.ui.selectedLabel.text(i),this.ui.selectedLabel.attr("title",i),this.ui.toggle.attr("aria-label",d.addFavoriteGroupLabel+" - "+i),h.set("csuiFavoriteTabID",t)},"_computeDropdownMenuMaxHeight":function(){var e=170,i=this.ui.groupsScrollbarContainer[0];if(!i.getBoundingClientRect)return e;var s=i.getBoundingClientRect();return e=t(window).height()-s.top-16},"onShownDropdown":function(){this.ui.groupsScrollbarContainer.css("max-height",this._computeDropdownMenuMaxHeight()),this.ui.toggle.attr("aria-expanded","true"),this.triggerMethod("dom:refresh")},"closeDropdownMenu":function(){this.$el.hasClass("binf-open")&&(this.ui.toggle.attr("aria-expanded","false"),this.ui.toggle.binf_dropdown("toggle",!1))}}),f=s.LayoutView.extend({"template":a,"templateHelpers":function(){return{"name_label":d.addFavoriteNameLabel,"name_place_holder":d.addFavoriteNamePlaceHolder,"name_input_id":e.uniqueId("nameInp"),"favorite_name":this.options.favModel.get("name"),"groups":this.showGroups,"group_label":d.addFavoriteGroupLabel,"add_button_label":d.addFavoriteAddButtonLabel,"cancel_button_label":d.addFavoriteCancelButtonLabel}},"regions":{"favGroupsRegion":".favorite-groups-container"},"triggers":{"click .add-btn":"click:add:button","click .cancel-btn":"click:cancel:button"},"ui":{"nameInput":".favorite-name-input","nameInputError":".favorite-name-input-error","addButton":".add-btn","cancelButton":".cancel-btn"},"events":{"click @ui.nameInput":"onClickNameInput","keyup":"onKeyupEvent","keyup @ui.nameInput":"onNameInputEvent","blur @ui.nameInput":"onNameInputEvent","keydown @ui.nameInput":"controlsOnKeydownEvent","keydown @ui.addButton":"controlsOnKeydownEvent","keydown @ui.cancelButton":"cancelButtonOnKeydownEvent"},"constructor":function(e){if(s.LayoutView.call(this,e),this.showGroups=!0,1===this.options.collection.length&&-1===this.options.collection.at(0).get("tab_id")&&(this.showGroups=!1),this.showGroups){this.groupsView=new m(e);var t=h.get("csuiFavoriteTabID");this.options.collection.findWhere({
"tab_id":t})||(t=-1,h.set("csuiFavoriteTabID",t)),t&&this.options.favModel&&this.options.favModel.set("tab_id",t)}this.propagateEventsToRegions()},"onRender":function(){this.showGroups&&(this.groupsView.render(),this.favGroupsRegion.show(this.groupsView)),this.validateNameInputAndSetAddButtonState(!0)},"currentlyFocusedElement":function(e){return this.ui.nameInput},"showInlineError":function(e){this.ui.nameInputError.attr("title",e),this.ui.nameInputError.text(e)},"clearInlineError":function(){this.ui.nameInputError.attr("title",""),this.ui.nameInputError.text("")},"validateNameInputAndSetAddButtonState":function(e){var t=!1,i=this.ui.nameInput.val();return i=i.trim(),i.length<1?t=!1:i.length>248?!0!==e&&this.showInlineError(d.nameErrorMaxLengthExceed):i.indexOf(":")>=0?!0!==e&&this.showInlineError(d.nameErrorContainSemiColon):(this.clearInlineError(),t=!0),t?(this.options.favModel.set("name",i),this.ui.addButton.prop("disabled",!1)):this.ui.addButton.prop("disabled",!0),t},"cancelButtonOnKeydownEvent":function(e){e&&13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.trigger("click:cancel:button"))},"controlsOnKeydownEvent":function(e){e&&13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.validateNameInputAndSetAddButtonState()&&this.trigger("click:add:button"))},"onKeyupEvent":function(e){e&&27===e.keyCode&&(e.preventDefault(),this.trigger("click:cancel:button"))},"onNameInputEvent":function(e){if(!e||27!==e.keyCode){this.validateNameInputAndSetAddButtonState()}},"onClickNameInput":function(e){e&&e.stopPropagation(),this.groupsView&&this.groupsView.closeDropdownMenu()}});return e.extend(f.prototype,n),f}),csui.define("hbs!csui/widgets/favorites/impl/favorite.star/favorite.star.view",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return"  <div class='csui-favorite-star-view-container csui-favorite-popover-container'>\r\n"+(null!=(n=t.if.call(e,null!=e?e.selected:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(7,s,0)}))?n:"")+"  </div>\r\n"},"2":function(e,t,i,s){var n,o;return'      <button type="button" class="csui-favorite-star selected csui-acc-focusable"\r\n              '+(null!=(n=t.if.call(e,null!=e?e.focusable:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)}))?n:"")+'\r\n               title="'+this.escapeExpression((o=null!=(o=t.removeFav||(null!=e?e.removeFav:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"removeFav","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.removeFav||(null!=e?e.removeFav:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"removeFav","hash":{}}):o))+'">\r\n        <span class="icon icon-socialFav"></span>\r\n      </button>\r\n'},"3":function(e,t,i,s){return'tabindex="0"'},"5":function(e,t,i,s){return'tabindex="-1"'},"7":function(e,t,i,s){var n,o;return'      <button type="button" class="csui-favorite-star csui-acc-focusable"\r\n              '+(null!=(n=t.if.call(e,null!=e?e.focusable:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)}))?n:"")+"\r\n              "+(null!=(n=t.unless.call(e,null!=e?e.showInFavoritesTable:e,{"name":"unless","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?n:"")+'\r\n               title="'+this.escapeExpression((o=null!=(o=t.addFav||(null!=e?e.addFav:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"addFav","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.addFav||(null!=e?e.addFav:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"addFav","hash":{}}):o))+'">\r\n        <span class="icon icon-socialFavOpen"></span>\r\n      </button>\r\n'},"8":function(e,t,i,s){return'aria-haspopup="dialog"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.enabled:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return i.registerPartial("csui_widgets_favorites_impl_favorite.star_favorite.star.view",s),s}),csui.define("css!csui/widgets/favorites/impl/favorite.star/favorite.star.view",[],function(){}),csui.define("csui/widgets/favorites/favorite.star.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/models/favorite.model","csui/dialogs/modal.alert/modal.alert","csui/utils/base","i18n","csui/controls/progressblocker/blocker","csui/utils/contexts/factories/favorite2groups","csui/widgets/favorites/impl/favorite.star/favorite.add.form.view","csui/controls/mixins/keyboard.navigation/modal.keyboard.navigation.mixin","hbs!csui/widgets/favorites/impl/favorite.star/favorite.star.view","i18n!csui/widgets/favorites/impl/nls/lang","css!csui/widgets/favorites/impl/favorite.star/favorite.star.view"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p){var m=s.ItemView.extend({"template":h,"templateHelpers":function(){return{"enabled":this.enabled(),"showInFavoritesTable":this.favTableOptions.isFavoritesTable,"focusable":this.options.focusable,"addFav":p.addFav,"removeFav":p.removeFav,"selected":this.favModel.get("selected")}},"events":{"keydown":"onKeyInView","click":"_onClickView","click button.csui-favorite-star":"_onClickStarButton","click button > span.icon-socialFav":"_clickRemoveFavoriteStar","click button > span.icon-socialFavOpen":"_clickAddFavoriteStar"},"constructor":function(i){i||(i={}),e.defaults(i,{"formPopoverPlacement":"left","popoverAtBodyElement":!1,"focusable":!0}),this.favTableOptions=i.favoritesTableOptions||{},s.ItemView.call(this,i),i&&i.blockingParentView&&a.delegate(this,i.blockingParentView),this.favGroupsCollection=i.context&&i.context.getCollection(c,{"detached":!0,"permanent":!0});var o=this.model&&this.model.connector,r={};this.model&&(r=e.extend(this._getModelDataForFavoriteModel(),{"selected":this.model.get("favorite")})),this.favModel=new n(r,{"connector":o}),this.listenTo(this.favModel,"change:selected",this.render),this.uniqueViewId="view"+e.uniqueId(),this.popoverContainerClassname="csui-favorite-popover-container "+this.uniqueViewId,this.popoverContainerSelector=".csui-favorite-popover-container."+this.uniqueViewId,t(window).bind("resize."+this.uniqueViewId,{"view":this},this._onWindowResize)},"onBeforeDestroy":function(){this.triggerMethod("close:add:favorite:form"),this.closePopover(),t(window).unbind("resize."+this.uniqueViewId,this._onWindowResize)},"enabled":function(){return!(!this.model||!this.options.context)},"onRender":function(){this._previousFocusElm&&t(this._previousFocusElm).hasClass("csui-favorite-star")&&(this.$el.find("button.csui-favorite-star").focus(),this._previousFocusElm=void 0),this._previousTitle=void 0,this.favGroupsCollection.ensureFetched(),this.delegateEvents()},"_onWindowResize":function(e){if(!r.isTouchBrowser()&&!r.isAppleMobile&&e&&e.data&&e.data.view){var t=e.data.view;t.showingForm&&t.closePopover()}},"_getPopoverParent":function(){return this.options.popoverAtBodyElement?t(this.popoverContainerSelector):this.$el},"_handleClickEvent":function(e){if(!t(e.target).closest(".binf-popover").length){var i;if(e&&e.data&&e.data.view){if(i=e.data.view,i.commandBlocked)return;t(document).off("click",i._handleClickEvent)}i&&i.closePopover(),i&&i._setBlocked()}},"_handleScrollEvent":function(e){if(!r.isTouchBrowser()&&!r.isAppleMobile&&!t(e.target).closest(".binf-popover").length){var i;e&&e.data&&e.data.view&&(i=e.data.view,t(document).off("scroll",i._handleScrollEvent)),i&&i.closePopover()}},"_getModelDataForFavoriteModel":function(){var e;return e=this.favTableOptions.isFavoritesTable&&this.favTableOptions.selectedGroup?this.favTableOptions.selectedGroup.get("tab_id"):this.model.get("favorite_tab_id")||-1,{"id":this.model.get("id"),"name":this.model.get("favorite_name")||this.model.get("name"),"tab_id":e}},"_onClickView":function(e){!this.enabled()||this.$el.find(e.target).length>0||this._onClickStarButton(e)},"_onClickStarButton":function(e){this.$el.find("span.icon-socialFav").length>0?this._clickRemoveFavoriteStar(e):this._clickAddFavoriteStar(e)},"_setBlocked":function(){this.commandBlocked=!0,setTimeout(e.bind(function(){this.commandBlocked=!1},this),500)},"_clickAddFavoriteStar":function(e){e&&e.preventDefault(),this.commandBlocked||(0===this._getPopoverParent().find(".binf-popover").length&&this._setBlocked(),this._capturePreviousFocusElement(),this.favModel.set(this._getModelDataForFavoriteModel()),this.favTableOptions.isFavoritesTable?(this._addFavoriteToClientSideCollection(!0),this.favGroupsCollection.trigger("bulk:update")):this._addFavoriteWithForm())},"_clickRemoveFavoriteStar":function(e){e&&e.preventDefault(),e&&e.stopPropagation(),this.commandBlocked||(this._setBlocked(),this._capturePreviousFocusElement(),this.favTableOptions.isFavoritesTable?(this._removeFavoriteFromClientSideCollection(!0),this.favGroupsCollection.trigger("bulk:update")):this._removeFavoriteFromServer())},"_clickAddButton":function(){this.commandBlocked||this._addFavoriteToServer().done(e.bind(function(){this._previousTitle=void 0,this.disengageModalKeyboardFocusOnClose(),this.closePopover(),this._restorePreviousFocusAfterClosingPopover()},this))},"_clickCancelButton":function(){this.closePopover()},"scrollCheckToClosePopover":function(){if(this._elTop){var e=this.$el.offset().top;(this._elTop&&this._elTop<e-15||this._elTop>e+15)&&this.closePopover()}},"_capturePreviousFocusElement":function(){this._previousFocusElm=document.activeElement},"_restorePreviousFocusAfterClosingPopover":function(){if(this._previousFocusElm){var e=t(this._previousFocusElm);e.hasClass("csui-favorite-star")?this.$el.find("button.csui-favorite-star").focus():e.focus(),this._previousFocusElm=void 0}},"closePopover":function(){if(this._getPopoverParent().find(".binf-popover").length>0){t(document).off("click",this._handleClickEvent),t(document).off("scroll",this._handleScrollEvent),this.disengageModalKeyboardFocusOnClose(),this.triggerMethod("close:add:favorite:form"),this.showingForm=!1,this.commandBlocked=!1,this._elTop=void 0;var i=t(this.$el.find(".csui-favorite-star")[0]);i.binf_popover("destroy"),this._previousTitle&&(i.attr("title",this._previousTitle),this._previousTitle=void 0),setTimeout(e.bind(function(){this.addForm&&this.addForm.destroy(),this.addForm=void 0,this.options.popoverAtBodyElement&&t(this.popoverContainerSelector).remove(),this._restorePreviousFocusAfterClosingPopover()},this),500)}},"_removeFavoriteFromClientSideCollection":function(e){var t=this;this.model.set("favorite",!1,{"silent":!0}),this.$el.trigger("favorite:change"),!0===e&&(this.listenToOnce(this.favGroupsCollection,"bulk:update:succeed",function(){t.stopListening(t.favGroupsCollection,"bulk:update:fail"),t.favModel.set("selected",!1)}),this.listenToOnce(this.favGroupsCollection,"bulk:update:fail",function(){t.stopListening(t.favGroupsCollection,"bulk:update:succeed"),this.model.set("favorite",!0,{"silent":!0})})),this.favGroupsCollection.each(function(e){e.favorites&&e.favorites.remove({"id":t.favModel.get("id")})})},"_removeFavoriteFromServer":function(){var e=this;this.blockActions(),this.favModel.removeFromFavorites().always(function(t){e.unblockActions()}).done(function(t){e._removeFavoriteFromClientSideCollection()}).fail(function(t){e._showErrorMessage(e.favModel,t)})},"_addFavoriteWithForm":function(){this._getPopoverParent().find(".binf-popover").length>0||this.favGroupsCollection.ensureFetched().always(e.bind(function(){this._showAddFavoriteForm()},this))},"_showAddFavoriteForm":function(){this.favModel.set(this._getModelDataForFavoriteModel()),this.addForm&&this.addForm.destroy(),this.addForm=new u({"context":this.options.context,"model":this.model,"favModel":this.favModel,"collection":this.favGroupsCollection}),this.addForm.render(),this.listenTo(this.addForm,"click:add:button",this._clickAddButton),this.listenTo(this.addForm,"click:cancel:button",this._clickCancelButton);var i=this.options.formPopoverPlacement;l&&l.settings.rtl&&(i="left"===i?"right":"left");var s={"html":!0,"content":this.addForm.el,"trigger":"manual","placement":i};if(this.options.popoverAtBodyElement){var n=t("body"),o=this.$el.closest(".binf-modal-body");o&&o.length>0&&(n=t(o[0])),n.append('<div class="binf-widgets '+this.popoverContainerClassname+'"></div>'),s=e.extend(s,{"container":this.popoverContainerSelector})}var a=t(this.$el.find(".csui-favorite-star")[0]);this._previousTitle=a.attr("title");var c=(a.offset().left+a.outerWidth())/t(window).width()*100;2===t(window).devicePixelRatio?(c<29&&!l.settings.rtl||c>70&&l.settings.rtl)&&(i="left"===i?"right":"left",s.placement=i):t(window).width()<1280?(c<44&&!l.settings.rtl||c>58&&l.settings.rtl)&&(i="left"===i?"right":"left",s.placement=i):(c<25&&!l.settings.rtl||c>80&&l.settings.rtl)&&(i="left"===i?"right":"left",s.placement=i),a.binf_popover(s).binf_popover("show");var d=this._getPopoverParent().find(".binf-popover");this.favGroupsCollection.length>1&&d.addClass("show-groups");var h=parseInt(d.css("top"),10)+52;d.css("top",h);var p=d.find(".binf-arrow");if(p.css("top",20),!0===this.options.popoverAtBodyElement)!0!==r.isVisibleInWindowViewportVertically(d)&&(h=parseInt(d.css("top"),10)-d.height()+45,d.css("top",h),p.css("top",d.height()-20));else if(this.options.checkVisible){var m=d.closest(".csui-perfect-scrolling");0===m.length&&(m=d.closest(".csui-normal-scrolling")),!0!==r.isElementVisibleInParent(d,m,90,90)&&(h=parseInt(d.css("top"),10)-d.height()+45,d.css("top",h),t(this.$el.find(".binf-arrow")[0]).css("top",d.height()-23))}var f=t(this.$el.find(".csui-favorite-star > .icon")[0]),b=f.offset().top+f.height()/2,g=p.offset().top+11,v=b-g;d.offset({"top":d.offset().top+v}),this.engageModalKeyboardFocusOnOpen(this.addForm.el);var w=e.uniqueId("popoverLabelId");d.find(">.binf-popover-title").attr("id",w),d.attr("role","dialog"),d.attr("aria-labelledby",w),a.on("shown.binf.popover",e.bind(function(e){this._elTop=this.$el.offset().top,this.addForm&&this.addForm.currentlyFocusedElement().focus(),t(document).on("click",{"view":this},this._handleClickEvent),this.options.popoverAtBodyElement&&t(document).on("scroll",{"view":this},this._handleScrollEvent),this.triggerMethod("show:add:favorite:form")},this)),this.showingForm=!0},"_addFavoriteToClientSideCollection":function(e){var t=this;this.model.set("favorite",!0,{"silent":!0}),this.$el.trigger("favorite:change",this.favModel),!0===e&&(this.listenToOnce(this.favGroupsCollection,"bulk:update:succeed",function(){t.stopListening(t.favGroupsCollection,"bulk:update:fail"),t.favModel.set("selected",!0)}),this.listenToOnce(this.favGroupsCollection,"bulk:update:fail",function(){t.stopListening(t.favGroupsCollection,"bulk:update:succeed"),this.model.set("favorite",!1,{"silent":!0})}));var i=this.favGroupsCollection.findWhere({"tab_id":this.favModel.get("tab_id")}),s=this.model.clone();s.set("favorite",!0),s.set("favorite_name",this.favModel.get("name")),s.set("favorite_tab_id",this.favModel.get("tab_id")),i.favorites.add(s)},"_addFavoriteToServer":function(){var e=t.Deferred(),i=this;return this.blockActions(),this.favModel.addToFavorites().always(function(e){i.unblockActions()}).done(function(t){i.model.setExpand("properties",["parent_id"]),i.model.fetch().always(function(){e.resolve(t),i._addFavoriteToClientSideCollection()})}).fail(function(t){e.reject(t),i._showErrorMessage(i.favModel,t)}),e.promise()},"_suspendPopoverBehaviors":function(){this._getPopoverParent().find(".binf-popover").length>0&&(this._focusElementBeforeErrorDialog=document.activeElement,t(document).off("click",this._handleClickEvent),this.disengageModalKeyboardFocusOnClose())},"_resumePopoverBehaviors":function(){this._getPopoverParent().find(".binf-popover").length>0&&(t(document).on("click",{"view":this},this._handleClickEvent),this.addForm&&this.engageModalKeyboardFocusOnOpen(this.addForm.el),this._focusElementBeforeErrorDialog&&t(this._focusElementBeforeErrorDialog).focus(),this._focusElementBeforeErrorDialog=void 0)},"_showErrorMessage":function(t,i){var s=new r.Error(i),n=p.updateFavoriteFailTitle,l=e.str.sformat(p.updateFavoriteFailMessage,t.get("id"),s.message);this._suspendPopoverBehaviors(),o.showError(l,n).always(e.bind(function(){this._resumePopoverBehaviors()},this))},"toggleFavorite":function(){this.model.get("favorite")?this._clickRemoveFavoriteStar():this._clickAddFavoriteStar()},"onKeyInView":function(e){if(32===e.keyCode||13===e.keyCode){if(this._getPopoverParent().find(".binf-popover").length>0)return void e.stopPropagation();e.preventDefault(),e.stopPropagation(),this.enabled()&&this.toggleFavorite()}},"blockActions":function(){},"unblockActions":function(){}});return d.mixin(m.prototype),m}),csui.define("css!csui/controls/table/cells/favorite/impl/favorite",[],function(){}),csui.define("csui/controls/table/cells/favorite/favorite.view",["csui/lib/underscore","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/widgets/favorites/favorite.star.view","css!csui/controls/table/cells/favorite/impl/favorite"],function(e,t,i,s){var n=t.extend({"getValueData":function(){return this.model.toJSON()},"constructor":function(e){t.prototype.constructor.apply(this,arguments)},"onBeforeDestroy":function(){this.triggerMethod("close:add:favorite:form"),this.favStarView&&(this.favStarView.destroy(),this.favStarView=void 0)},"onRender":function(){this.favStarView||(this.favStarView=new s(e.extend({"checkVisible":!0,"popoverAtBodyElement":!0,"focusable":!1},this.options))),this.listenTo(this.favStarView,"show:add:favorite:form",function(){this.triggerMethod("show:add:favorite:form")}),this.listenTo(this.favStarView,"close:add:favorite:form",function(){this.triggerMethod("close:add:favorite:form")}),this.favStarView.render(),this.$el.append(this.favStarView.el),this.listenTo(this.options.tableView,"scroll",function(){this.favStarView&&this.favStarView.scrollCheckToClosePopover()})}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-favorite"});return i.registerByColumnKey("favorite",n),n}),csui.define("csui/controls/table/cells/favorite/favorite.name.view",["csui/controls/table/cells/name/name.view","csui/controls/table/cells/cell.registry"],function(e,t){var i=e.extend({});return t.registerByColumnKey("favorite_name",i),i}),csui.define("hbs!csui/controls/table/cells/type.icon/impl/type.icon",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.inactive:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(4,s,0)}))?n:""},"2":function(e,t,i,s){return'    <div class="csui-table-cell-no-default-action"></div>\r\n'},"4":function(e,t,i,s){var n;return'    <a class="csui-table-cell-default-action" href="'+this.escapeExpression((n=null!=(n=t.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultActionUrl","hash":{}}):n))+'"\r\n       aria-label="'+this.escapeExpression((n=null!=(n=t.typeAndNameAria||(null!=e?e.typeAndNameAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"typeAndNameAria","hash":{}}):n))+'"></a>\r\n'},"6":function(e,t,i,s){return'  <div class="csui-table-cell-no-default-action"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.defaultAction:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(6,s,0)}))?n:""}});return i.registerPartial("csui_controls_table_cells_type.icon_impl_type.icon",s),s}),csui.define("css!csui/controls/table/cells/type.icon/impl/type.icon",[],function(){}),csui.define("csui/controls/table/cells/type.icon/type.icon.view",["csui/lib/underscore","csui/lib/marionette","csui/controls/table/cells/templated/templated.view","csui/controls/node-type.icon/node-type.icon.view","csui/controls/table/cells/cell.registry","csui/utils/node.links/node.links","hbs!csui/controls/table/cells/type.icon/impl/type.icon","i18n!csui/controls/table/impl/nls/lang","css!csui/controls/table/cells/type.icon/impl/type.icon"],function(e,t,i,s,n,o,r,l){"use strict";var a=i.extend({"events":{"keydown":"onKeyInView"},"template":r,"constructor":function(e){i.prototype.constructor.apply(this,arguments),this.needsAriaLabel=!this.options.column.defaultAction,this.listenTo(this,"render",this._createNodeTypeIcon).listenTo(this,"before:render",this._destroyNodeTypeIcon).listenTo(this,"before:destroy",this._destroyNodeTypeIcon)},"getValueData":function(){var t=this.model,i=o.getUrl(this.model),s=e.str.sformat(l.typeAndNameAria,t.get("type_name"),t.get("name"));return{"defaultAction":this.options.column.defaultAction,"defaultActionUrl":i,"typeAndNameAria":s,"inactive":t.get("inactive")}},"_createNodeTypeIcon":function(){var e=new s({"node":this.model});this.cellRegion=new t.Region({"el":this.$("> *")}),this.cellRegion.show(e)},"_destroyNodeTypeIcon":function(){this.cellRegion&&(this.cellRegion.empty(),this.cellRegion=null)},"getValueText":function(){return this.model.get("type_name")||""}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-type","getModelExpand":function(e){return{"versions.element(0)":["mime_type"]}}});return n.registerByColumnKey("type",a),a}),csui.define("csui/dialogs/members.picker/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/dialogs/members.picker/impl/nls/root/lang",{"ViewDenied":'Access denied, you do not have permission to view "{0}".',"cancelButtonLabel":"Cancel","dialogTitle":"View group membership","serverError":"Server request failed with error code {0}.","backButtonTooltip":"Go back","missingConnector":"Missing connector information!","emptyMembersText":"No results found.","UserPickerPlaceHolder":"Enter user or group","addButtonLabel":"Add","selectPermissionLevel":"Select permission level","nextButtonLabel":"Next","doneButtonLabel":"Done","groupSymbolAlt":"Group symbol","userSymbolAlt":"User symbol","disabledItemTypeNameAria":"Disabled: {0}: {1}","itemTypeNameAria":"{0}: {1}","AddUserOrGroup":"Add user or group","AddMember":"Add member","userSearchPlaceHolder":"Search for user","addAnotherNamePlaceHolder":"Add another user or group","removeSelectedUser":"Remove member","removeSelectedUserAria":"Remove {0} from selection list","singleUserText":"{0} added to the {1} group.","singleUserFailureText":"{0} failed to add to the {1} group.","SinglePassMoreThanOneFail":"{0} added to the {1} group and {2} members failed to added to the group.","onlyFailUsersText":"{0} members failed to add to the {1} group","onlyAllSuccessText":"{0} members Successfully added to the {1} group","onlyAllFailureText":"{0} members failed to add to the {1} group","manyUserText":"{0} members Successfully added, {1} members failed to add to the {2} group .","searchIconTitle":"Open user or group search box","searchIconAria":"Click or press enter to open user or group search box","openSearchBar":"Open search bar","closeSearchBar":"Close search bar"}),csui.define("hbs!csui/dialogs/members.picker/impl/member.list/list.item",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return""},"3":function(e,t,i,s){var n,o;return'  <a class="csui-item-standard csui-list-group-item" href="">\r\n    <span class="csui-icon csui-start-icon '+this.escapeExpression((o=null!=(o=t.selected||(null!=e?e.selected:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"selected","hash":{}}):o))+'"></span>\r\n'+(null!=(n=t.if.call(e,null!=e?e.isGroup:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:"")+'    <span title="'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'" class="csui-list-item-title">'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+"</span>\r\n  </a>\r\n"},"4":function(e,t,i,s){var n;return'      <span class="csui-user-default-picture-dlg csui-icon image_group_placeholder_permission"></span>\r\n      <span><img src="'+this.escapeExpression((n=null!=(n=t.imgSrc||(null!=e?e.imgSrc:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"imgSrc","hash":{}}):n))+'" alt="'+this.escapeExpression((n=null!=(n=t.imgAlt||(null!=e?e.imgAlt:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"imgAlt","hash":{}}):n))+'"\r\n                 class="binf-hidden csui-user-profile-picture-dlg csui-member-group-icon csui-icon" /></span>\r\n      <span class="csui-icon csui-end-icon icon-sidebar-expand24 binf-hidden"></span>\r\n'},"6":function(e,t,i,s){var n;return'      <span\r\n          class="csui-user-default-picture-dlg csui-icon image_user_placeholder">'+this.escapeExpression((n=null!=(n=t.initials||(null!=e?e.initials:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"initials","hash":{}}):n))+'</span>\r\n      <span><img src="'+this.escapeExpression((n=null!=(n=t.imgSrc||(null!=e?e.imgSrc:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"imgSrc","hash":{}}):n))+'" alt="'+this.escapeExpression((n=null!=(n=t.imgAlt||(null!=e?e.imgAlt:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"imgAlt","hash":{}}):n))+'"\r\n                 class="binf-hidden csui-user-profile-picture-dlg csui-member-group-icon csui-icon" /></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=e?e.totalcount:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+"\r\n"}});return i.registerPartial("csui_dialogs_members.picker_impl_member.list_list.item",s),s}),csui.define("hbs!csui/dialogs/node.picker/impl/search.list/search.location.item",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<span class="csui-type-location-icon" aria-hidden="true"></span><span title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'"\r\n                                                                      class="csui-list-item-title">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</span>\r\n"}});return i.registerPartial("csui_dialogs_node.picker_impl_search.list_search.location.item",s),s}),csui.define("css!csui/dialogs/members.picker/impl/members.picker",[],function(){}),csui.define("csui/dialogs/members.picker/impl/member.list/list.item.view",["csui/lib/underscore","csui/lib/jquery","csui/controls/listitem/listitemstandard.view","csui/utils/url","csui/utils/user.avatar.color","hbs!csui/dialogs/members.picker/impl/member.list/list.item","hbs!csui/dialogs/node.picker/impl/search.list/search.location.item","i18n!csui/dialogs/members.picker/impl/nls/lang","css!csui/dialogs/members.picker/impl/members.picker"],function(e,t,i,s,n,o,r,l){return i.extend({"template":o,"searchLocationTemplate":r,"templateHelpers":function(){return{"defaultProfilePictureClass":this._isGroup()?"image_group_placeholder_permission":"image_user_placeholder","imgAlt":this._isGroup()?l.groupSymbolAlt:l.userSymbolAlt,"totalcount":!this.options.model.collection.totalCount,"isGroup":!!this._isGroup(),"name":this.options.model.get("name_formatted"),"selected":this.selected?"icon-listview-checkmark":"","imgSrc":"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs="}},"tagName":"li","events":{"keydown":"onKeyInView"},"ui":{"link":".csui-list-group-item"},"onKeyInView":function(e){return 39!==e.keyCode&&32!==e.keyCode&&13!==e.keyCode||(this.$el.trigger("click"),this.$el.focus(),!1)},"_isUser":function(){return 0===this.options.model.get("type")},"_isGroup":function(){return 1===this.options.model.get("type")},"_isInActiveUser":function(){return this.options.model.get("type")<0},"constructor":function(e){i.apply(this,arguments),this.browsed=!1},"toggleSelect":function(){this.selected=!this.selected,this.render()},"toggleBrowse":function(){this.browsed=!this.browsed,this.render()},"assignedBrowseNSelect":function(){this.browsed=this.selected=!0,this.render()},"unassignBrowseNSelect":function(){this.isDestroyed||(this.browsed=this.selected=!1,this.render())},"isSelected":function(){return this.selected},"isBrowsed":function(){return this.browsed},"setValidity":function(e){this.valid=e},"onRender":function(){this.$el.addClass("cs-left-item-"+this.model.get("id")),this.$el.removeClass("select"),this.$el.removeClass("browse"),this.ui.link.removeAttr("aria-selected"),this.$el.attr("role","option");var t=e.str.sformat(l.itemTypeNameAria,this.model.get("type_name"),this.model.get("name"));this.valid||(t=e.str.sformat(l.disabledItemTypeNameAria,this.model.get("type_name"),this.model.get("name"))),this.$el.attr("aria-label",t),this.selected?(this._isGroup()&&this.$el.find("span").removeClass("binf-hidden"),this.$el.addClass("select"),this.$el.attr("aria-selected","true")):this.browsed&&(this.$el.addClass("browse"),this.$el.find("span.csui-end-icon").removeClass("binf-hidden")),this._isBrowsable(this.model)&&(this.ui.link.attr("aria-haspopup","true"),this.ui.link.attr("aria-expanded","false")),this._renderPhoto()},"_renderPhoto":function(){var t=this.model.get("photo_url"),i=n.getUserAvatarColor(this.options.model.attributes.data.properties);if(this.$el.find(".csui-user-default-picture-dlg.image_user_placeholder").css("background-color",i),this._isGroup()||null===t);else{var s=this;this._resolvePhoto(t).done(e.bind(function(e){var t=s.$el.find(".csui-user-profile-picture-dlg");s.$el.find(".csui-user-default-picture-dlg").addClass("binf-hidden"),s.url=URL.createObjectURL(e),t.removeClass("binf-hidden").attr("src",s.url)})).fail(function(){s.$el.find(".csui-user-profile-picture-dlg").attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=")})}},"_resolvePhoto":function(e){var i=this.options.model.connector,n=i.connection,o=new s(n.url).getCgiScript(),r=t.Deferred(),l=s.combine(o,e),a=i.extendAjaxOptions({"url":l,"dataType":"binary","connection":n});return t.ajax(a).done(function(e){r.resolve(e)}).fail(r.reject),r.promise()},"_isBrowsable":function(e){return e.get("container")&&!1!==e.get("perm_see_contents")}})}),csui.define("hbs!csui/dialogs/members.picker/impl/member.list/member.list",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="list-content">\r\n  <ul class="binf-list-group" role="listbox"></ul>\r\n  <div class="binf-search-location-group"></div>\r\n</div>'}});return i.registerPartial("csui_dialogs_members.picker_impl_member.list_member.list",s),s}),csui.define("hbs!csui/dialogs/members.picker/impl/member.list/empty.members.list",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return"<p class='csui-members-empty'> "+this.escapeExpression((n=null!=(n=t.emptyTableText||(null!=e?e.emptyTableText:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"emptyTableText","hash":{}}):n))+" </p>\r\n"}});return i.registerPartial("csui_dialogs_members.picker_impl_member.list_empty.members.list",s),s}),csui.define("css!csui/dialogs/members.picker/impl/member.list/member.list",[],function(){}),
csui.define("csui/dialogs/members.picker/impl/member.list/member.list.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/dialogs/members.picker/impl/member.list/list.item.view","csui/controls/progressblocker/blocker","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","hbs!csui/dialogs/members.picker/impl/member.list/member.list","hbs!csui/dialogs/members.picker/impl/member.list/empty.members.list","i18n!csui/dialogs/members.picker/impl/nls/lang","css!csui/dialogs/members.picker/impl/member.list/member.list"],function(e,t,i,s,n,o,r,l,a,c){"use strict";return i.CompositeView.extend({"className":"cs-list","template":l,"childViewContainer":".binf-list-group","childView":s,"childViewOptions":function(){return{"locationEle":this.ui.location}},"childEvents":{"click:item":"onItemClick","before:add:child":"onBeforeAddChild"},"ui":{"listParent":".list-content","list":".binf-list-group","location":".binf-search-location-group"},"events":{"keydown":"onKeyInView"},"onBeforeAddChild":function(e){var t=this.commandType.validateTarget(e.model);e.setValidity(t)},"onAddChild":function(t){var i=t.model.get("id");if(this.selectedItem&&this.selectedItem.model.get("id")===i&&(this.selectedItem=t,this.toggleSelectedChild(t)),this.commandType.validateMember(t.model)?t.$el.addClass("csui-acc-focusable"):t.$el.hide(),!this.commandType.isSelectable(t.model)&&!this._isBrowsable(t.model)){t.$el.addClass("csui-disabled");var s=e.str.sformat(c.disabledItemTypeNameAria,t.model.get("type_name"),t.model.get("name"));t.$el.attr("aria-label",s)}return this._isBrowsable(t.model)?(t.ui.link.attr("aria-haspopup","true"),t.ui.link.attr("aria-expanded","false")):(t.ui.link.removeAttr("aria-haspopup"),t.ui.link.removeAttr("aria-expanded")),this.browsedChild&&this.browsedChild.model.get("id")===i&&(this.browsedChild=t,this.toggleBrowsedChild(t)),!0},"collectionEvents":{"sync":"syncUpdate","reset":"rebuild"},"behaviors":{"PerfectScrolling":{"behaviorClass":r,"contentParent":"> .list-content","suppressScrollX":!0},"TabableRegion":{"behaviorClass":o}},"isTabable":function(){return this.children.find(function(e){var t=e.$el;return t.is(":visible")&&!t.is(":disabled")})},"currentlyFocusedElement":function(){var e=this.$el.find(".binf-list-group-item.csui-acc-focusable");if(e.length)return t(e[this.focusIndex])},"setFocus":function(){var e=this.$el.find(".binf-list-group-item.csui-acc-focusable");t(e[this.focusIndex]).focus()},"onKeyInView":function(e){var i=e.keyCode,s=this.$el.find(".binf-list-group-item.csui-acc-focusable");switch(i){case 38:case 40:38===i?this.focusIndex>0&&--this.focusIndex:this.focusIndex<s.length&&++this.focusIndex,this.trigger("changed:focus"),t(s[this.focusIndex]).focus()}},"constructor":function(s){s||(s={}),e.defaults(s,{"pageSize":30}),i.CompositeView.prototype.constructor.apply(this,arguments),this.jQuery=t,n.imbue(this),this.selectedItem=s.selection?s.selection:null,this.blockScroll=!0,this.notFetching=!0,this.init=!0,this.nextCollectionPage=e.bind(this.addNextCollectionPage,this),this.commandType=s.commandType,this.focusIndex=0,this.listenTo(this.collection,"sync",function(){if(this.ui.listParent.find("p.csui-members-empty").remove(),0===this.collection.length){this.ui.listParent.addClass("csui-members-empty");var e=a.call(this,{"emptyTableText":c.emptyMembersText});this.ui.listParent.append(e)}else this.ui.listParent.removeClass("csui-members-empty")}),this.listenTo(this.collection,"request",this.setBlocker),this.listenTo(this.collection,"reset",this.setBlocker),this.listenTo(this,"browse:complete",function(){this.notFetching=!0})},"syncUpdate":function(){this.nextTriggerSetting=this.options.pageSize/2,this.blockScroll=!0,this.notFetching=!0,this.init=!0,this.unblockActions()},"rebuild":function(){if(this.ui.listParent.find("p.csui-members-empty").remove(),0===this.collection.length){this.ui.listParent.addClass("csui-members-empty");var e=a.call(this,{"emptyTableText":c.emptyMembersText});this.ui.listParent.append(e)}else this.ui.listParent.removeClass("csui-members-empty");this.reset(),this.trigger("dom:refresh")},"reset":function(){this.init=!0;var e=this;this.scrollBar&&(this.scrollBar.scrollTop(0),this.collection.length||setTimeout(function(){e.triggerMethod("update:scrollbar",this)},0))},"stopBlocker":function(){return this.unblockActions(),!0},"setBlocker":function(){return this.blockScroll&&(this.blockScroll=!1,this.blockActions()),!0},"addNextCollectionPage":function(){var e=this.collection.length,t=this.ui.list.height()-this.ui.listParent.height(),i=this.ui.listParent.scrollTop()/t,s=(e-this.nextTriggerSetting)/e;e&&e<this.collection.totalCount&&i>=s&&(this.notFetching&&(this.notFetching=!1,this.collection.setSkip(e,!1),this.collection.fetch({"reset":!1,"remove":!1,"merge":!1})),i>.98&&this.init&&(this.setBlocker(),this.init=!1))},"onDomRefresh":function(){this.scrollBar||(this.scrollBar=this.ui.listParent,this.scrollBar.on("scroll",this.nextCollectionPage))},"onItemClick":function(e){e.$el.hasClass("csui-disabled")||this._processClickedItem(e)},"_processClickedItem":function(e){if(this.notFetching){this.notFetching=!1;this._isBrowsable(e.model)?this._browseSelection(e):this._targetSelection(e),e.$el.blur()}return this.$el.trigger("setCurrentTabFocus"),!0},"clearSelect":function(){var e=this;return this.selectedItem&&e.toggleSelectedChild(this.selectedItem),this.selectedItem=null,!0},"toggleSelectedChild":function(e){this.commandType.isSelectable(e.model)&&e.toggleSelect()},"toggleBrowsedChild":function(e){e&&e.toggleBrowse()},"_isBrowsable":function(e){return 1===e.get("type")},"_targetSelection":function(e){var t=e.model,i=(t.get("id"),e.isSelected()),s=t.get("type");this.clearSelect(),i||(this.selectedItem=e,this.toggleSelectedChild(e)),this.trigger("selection:change",{"type":s,"member":t,"add":!i}),this.notFetching=!0},"_browseSelection":function(e){var t=this.commandType.isSelectableType(e.model),i=this.commandType.isSelectable(e.model),s=this.commandType.browseAllowed(e.model),n=e.isBrowsed(),o=!1,r=e.model.attributes.type;n?(i&&this._targetSelection(e),this.notFetching=!0):(i?(this._browseNSelect(e),o=!0):((s||t)&&(this.clearSelect(),o=!0),this.toggleBrowsedChild(e)),s&&this.trigger("selection:change",{"member":e.model,"silent":!1,"add":o,"type":r}),this._browse(e,o))},"_browse":function(e,t){this.browsedChild&&this.browsedChild.toggleBrowse(),this.browsedChild=e,e.ui.link.attr("aria-expanded","true"),this.trigger("browse:select",{"member":e.model,"add":t})},"_browseNSelect":function(e){this.clearSelect(),this.selectedItem=e,e.assignedBrowseNSelect()}})}),csui.define("csui/behaviors/input/placeholder",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette"],function(e,t,i){"use strict";return i.Behavior.extend({"events":{"keydown @ui.inputField":"onKeyDown","keyup @ui.inputField":"onKeyUp","focus @ui.inputField":"onFocus"},"initialize":function(e,t){this.isEmpty=!0},"onKeyDown":function(){var e=this.view.ui.inputField.val(),t=this.view.ui.inputField.attr("placeholder");!0===this.isEmpty&&e===t&&this.view.ui.inputField.val("")},"onKeyUp":function(){var e=this.view.ui.inputField.val(),t=this.view.ui.inputField.attr("placeholder");0===e.length||e===t?(this.isEmpty=!0,this.view.ui.inputField.val(t),this.view.ui.inputField[0].setSelectionRange(0,0)):this.isEmpty=!1},"onFocus":function(){var e=this.view.ui.inputField.attr("placeholder");0===this.view.ui.inputField.val().length&&(this.isEmpty=!0,this.view.ui.inputField.val(e),this.view.ui.inputField[0].setSelectionRange(0,0))}})}),csui.define("hbs!csui/dialogs/members.picker/impl/select.view/impl/header/header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <div class="csui-search-item-left-panel">\r\n    <div class="csui-search-item-type">\r\n      <span class="csui-type-label"> '+this.escapeExpression((n=null!=(n=t.type||(null!=e?e.type:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"type","hash":{}}):n))+' </span>\r\n    </div>\r\n    <div class="csui-search-item">\r\n      <div class="csui-search-item-name">\r\n        '+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="csui-search-item-right-panel">\r\n    <div class="csui-search-item-location">\r\n      <div class="csui-search-toolbar-container">\r\n        '+this.escapeExpression((n=null!=(n=t.location||(null!=e?e.location:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"location","hash":{}}):n))+"\r\n      </div>\r\n    </div>\r\n  </div>\r\n"},"3":function(e,t,i,s){var n,o;return'  <div class="csui-targetbrowse-history">\r\n      <span class="csui-targetbrowse-arrow-back">\r\n        <span class="icon arrow_back cs-go-back" title="'+this.escapeExpression((o=null!=(o=t.backButtonTooltip||(null!=e?e.backButtonTooltip:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"backButtonTooltip","hash":{}}):o))+'" tabindex="0"\r\n              aria-label="'+this.escapeExpression((o=null!=(o=t.backButtonAria||(null!=e?e.backButtonAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"backButtonAria","hash":{}}):o))+'" data-cstabindex="-1" role="link"></span>\r\n      </span>\r\n  </div>\r\n  <div class="csui-folder-name">\r\n    <span class="folder-name" title="'+this.escapeExpression((o=null!=(o=t.title||(null!=e?e.title:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.title||(null!=e?e.title:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+"</span>\r\n"+(null!=(n=t.if.call(e,null!=e?e.allMembers:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?n:"")+'  </div>\r\n\r\n  <form class="cs-modal-filter">\r\n    <div class="binf-form-group">\r\n      <input class="binf-form-control cs-filter-input" placeholder="'+this.escapeExpression((o=null!=(o=t.search_placeholder||(null!=e?e.search_placeholder:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"search_placeholder","hash":{}}):o))+'"\r\n             tabindex="0" data-cstabindex="-1" aria-label="'+this.escapeExpression((o=null!=(o=t.search_placeholder||(null!=e?e.search_placeholder:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"search_placeholder","hash":{}}):o))+'">\r\n      <span class="binf-form-control-feedback cs-icon icon-formfield-clear" role="button"\r\n            aria-label="'+this.escapeExpression((o=null!=(o=t.clearSearchButtonAria||(null!=e?e.clearSearchButtonAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"clearSearchButtonAria","hash":{}}):o))+'" tabindex="0" data-cstabindex="-1"></span>\r\n      <button class="binf-btn csui-form-control-search" title="'+this.escapeExpression((o=null!=(o=t.collapseSearch||(null!=e?e.collapseSearch:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"collapseSearch","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.collapseSearch||(null!=e?e.collapseSearch:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"collapseSearch","hash":{}}):o))+'" aria-expanded="true" aria-haspopup="true"\r\n              tabindex="0" data-cstabindex="-1">\r\n      <span class="form-control-search cs-icon icon-sv-search-hide"></span>\r\n      </button>\r\n    </div>\r\n  </form>\r\n'},"4":function(e,t,i,s){var n;return'      <span class="cs-icon icon-sv-search csui-acc-focusable" tabindex="0" data-cstabindex="-1"\r\n            role="button" aria-expanded="false" title="'+this.escapeExpression((n=null!=(n=t.openSearchBar||(null!=e?e.openSearchBar:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"openSearchBar","hash":{}}):n))+'"\r\n            aria-label="'+this.escapeExpression((n=null!=(n=t.searchInButtonAria||(null!=e?e.searchInButtonAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"searchInButtonAria","hash":{}}):n))+'"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.searchView:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:""}});return i.registerPartial("csui_dialogs_members.picker_impl_select.view_impl_header_header",s),s}),csui.define("csui/dialogs/node.picker/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/dialogs/node.picker/impl/nls/root/lang",{"noSearchResultMessage":"No results found","PermissionDenied":"Permission denied","ViewDenied":'Access denied, you do not have permission to view "{0}".',"InsufficientContent":"Insufficient content to open the browse dialog","selectButtonLabel":"Select","cancelButtonLabel":"Cancel","copyButtonLabel":"Copy","moveButtonLabel":"Move","clearSearchButtonAria":"Clear Search","collapseSearch":"Clear and collapse search","saveFilterButtonLabel":"Save","placeHolderName":"Enter name","itemTypeNameAria":"{0}: {1}","disabledItemTypeNameAria":"Disabled: {0}: {1}","dialogTitle":"Select an object","dialogTitleForContainers":"Select a Container","dialogTitleForDocuments":"Select a Document","dialogTitleForCategories":"Select a Category","breadcrumbAria":"Breadcrumb in Dialog","serverError":"Server request failed with error code {0}.","backButtonTooltip":"Go back","backToFolderView":"Go back to Folder View","backToSearchAria":"Go back to Search View","Type":"Type","Name":"Name","Location":"Location","searchResults":"Search results","searchFoundAbout":"About {0} items","searchFoundZero":"No items","nameCannotContainColon":"Name cannot contain a colon","nameCannotBeEmpty":"This is a required field.","SelectOneItemMessage":"{0} item selected","SelectManyItemsMessage":"{0} items selected","noValue":"(no value)","nodePickerChoices":"Choices"}),csui.define("csui/dialogs/members.picker/impl/select.view/impl/header/header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/behaviors/input/placeholder","i18n!csui/controls/table/impl/nls/lang","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/models/member/member.model","csui/models/member/membercollection","hbs!csui/dialogs/members.picker/impl/select.view/impl/header/header","i18n!csui/dialogs/node.picker/impl/nls/lang","i18n!csui/dialogs/members.picker/impl/nls/root/lang"],function(e,t,i,s,n,o,r,l,a,c,u,d){return i.ItemView.extend({"template":c,"tagName":"div","templateHelpers":function(){return{"title":this.options.title||!!this.options&&!!this.options.container&&this.options.container.get("name"),"search_icon_tooltip":e.str.sformat(o.searchIconTooltip,this.options.columnTitle),"search_placeholder":o.searchByNamePlaceholder,"search_clear_icon_tooltip":o.searchClearIconTooltip,"backButtonTooltip":u.backButtonTooltip||o.backButtonTooltip,"type":u.Type,"name":u.Name,"location":u.Location,"searchView":this.options.searchView,"searchInButtonAria":e.str.sformat(o.searchPlaceholder,this.title),"clearSearchButtonAria":u.clearSearchButtonAria,"allMembers":!this.container.id&&!this.container.groupId,"openSearchBar":d.openSearchBar,"closeSearchBar":d.closeSearchBar,"collapseSearch":u.collapseSearch,"backButtonAria":o.backButtonTooltip}},"ui":{"searchBox":"> form.cs-modal-filter","openSearchIcon":"> .csui-folder-name .icon-sv-search","headerTitle":"> .csui-folder-name","searchInput":"> form .cs-filter-input","clearer":"> form .binf-form-control-feedback","tabElements":"> *[tabindex]","closeSearchButton":"> form .csui-form-control-search","backButton":".csui-targetbrowse-arrow-back"},"events":{"click .icon-sv-search":"searchClicked","click @ui.closeSearchButton":"searchClicked","paste @ui.searchInput":"contentPasted","change @ui.searchInput":"filterChanged","click @ui.clearer":"searchFieldClearerClicked","submit @ui.searchBox":"filterChanged","keydown":"onKeyInView"},"behaviors":{"Placeholder":{"behaviorClass":n},"TabableRegionBehavior":{"behaviorClass":r}},"constructor":function(e){this.options=e||{},this.container=e.container,this.title=e.title,this.headerView=this,i.ItemView.prototype.constructor.apply(this,arguments),this.container&&this.listenTo(this.container,"change:name",function(e){this.title=e.get("name"),this.render()})},"onRender":function(){this.ui.clearer.toggle(!1),this.ui.searchBox.toggleClass("binf-hidden"),this.ui.closeSearchButton.toggleClass("binf-hidden"),this.ui.searchInput.hide();var e=this;this.ui.searchInput.keyup(function(t){e.filterChanged(t)}),this.$el.find("*[data-cstabindex]").on("focus",function(){var i=t(this);e.focusedElement&&e.focusedElement.removeClass(r.accessibilityActiveElementClass),i.addClass(r.accessibilityActiveElementClass),e.focusedElement=i})},"currentlyFocusedElement":function(){var e=this.$el.find("*[data-cstabindex=-1]");return e.length&&e.prop("tabindex",0),this.focusedElement?this.focusedElement:(this.$el.find(".csui-folder-name.binf-hidden").length?this.focusElement=this.$el.find("input"):this.$el.find(".csui-targetbrowse-arrow-back .cs-go-back").is(":visible")?this.focusElement=this.$el.find(".csui-targetbrowse-arrow-back .cs-go-back"):this.$el.find(".csui-folder-name .icon-sv-search").is(":visible")&&(this.focusElement=this.$el.find(".csui-folder-name .icon-sv-search")),this.focusElement)},"onLastTabElement":function(e){var i=this.$("[data-cstabindex=-1]"),s=i.length-1;if(i.length){var n,o=0,l=s+1,a=1;e||(o=s,l=-1,a=-1);for(var c=o;c!=l;c+=a)if(t(i[c]).is(":visible")){o=c;break}return o>=0&&o<=s&&(n=i[o]),this.$(".csui-focus").removeClass("csui-focus"),t(n).hasClass(r.accessibilityActiveElementClass)&&!e}return!0},"onKeyInView":function(e){var i=t(e.target);switch(e.keyCode){case 13:i.removeClass(r.accessibilityActiveElementClass),t(e.target).trigger("click");break;case 27:t(e.target).hasClass(".icon-sv-search")||this.$el.trigger("tabNextRegion");break;default:return!0}return!1},"searchClicked":function(i){i.preventDefault(),i.stopPropagation(),s.trigger("closeToggleAction"),this.ui.headerTitle.toggleClass("binf-hidden"),this.ui.searchInput.toggleClass(r.accessibilityFocusableClass),this.ui.clearer.toggle(!1),this.getValue().length&&(this.ui.searchInput.val(""),this.filterChanged(i)),this.ui.searchInput.toggle(200,"linear",e.bind(function(){this.ui.searchInput.focus()},this)),this.ui.closeSearchButton.toggleClass(r.accessibilityFocusableClass),this.ui.closeSearchButton.removeClass(r.accessibilityActiveElementClass),this.ui.openSearchIcon.toggleClass(r.accessibilityFocusableClass),this.ui.searchBox.toggleClass("binf-hidden"),this.ui.closeSearchButton.toggleClass("binf-hidden"),t(i.target).hasClass("form-control-search")?(this.ui.searchInput.removeClass(r.accessibilityActiveElementClass),this.ui.openSearchIcon.addClass(r.accessibilityActiveElementClass),this.$el.trigger("setCurrentTabFocus")):(this.ui.searchInput.addClass(r.accessibilityActiveElementClass),this.ui.openSearchIcon.removeClass(r.accessibilityActiveElementClass)),this.trigger("changed:focus"),this.focusElement.focus()},"searchFieldClearerClicked":function(e){e.preventDefault(),e.stopPropagation(),this.ui.clearer.removeClass(r.accessibilityFocusableClass),this.ui.clearer.removeClass(r.accessibilityActiveElementClass),this.ui.searchInput.val(""),this.filterChanged(e),this.ui.searchInput.focus(),this.ui.searchInput.addClass(r.accessibilityActiveElementClass)},"getColumn":function(){return this.options.column},"getValue":function(){var e;return e=this.ui.searchInput.val(),e===this.ui.searchInput.attr("placeholder")&&(e=""),e},"setValue":function(e){e&&e.length&&(this.ui.searchInput.val(e),this.lastFilterValue=e)},"getShown":function(){return this.ui.searchInput.hasClass("binf-show")},"setShown":function(e){!0===e&&this.ui.searchInput.hasClass("binf-hidden")?this.ui.searchInput.toggleClass("show binf-hidden"):!1===e&&this.ui.searchInput.hasClass("binf-show")&&this.ui.searchInput.toggleClass("show binf-hidden")},"setFocus":function(){var e=this.ui.searchInput.val().length;this.ui.searchInput.focus(),this.ui.searchInput[0].setSelectionRange(e,e)},"contentPasted":function(e){this.applyFilter()},"filterChanged":function(e){return this.applyFilter(),!1},"applyFilter":function(){var e=this.getValue(),t=!!e.length;if(this.ui.clearer.toggle(t),t?this.ui.clearer.addClass(r.accessibilityFocusableClass):this.ui.clearer.removeClass(r.accessibilityFocusableClass),this.lastFilterValue!=e){this.lastFilterValue=e;var i=this;this.filterTimeout&&clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(function(){i.filterTimeout=void 0,i.trigger("change:filterValue",{"name":i.getValue(),"collection":i.options.collection})},1e3)}}})}),csui.define("hbs!csui/dialogs/members.picker/impl/select.view/impl/select.view",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div>\r\n  <div class="csui-mp-header cs-folder-name"></div>\r\n</div>\r\n<div class="csui-mp-content"></div>\r\n\r\n'}});return i.registerPartial("csui_dialogs_members.picker_impl_select.view_impl_select.view",s),s}),csui.define("css!csui/dialogs/members.picker/impl/select.view/impl/select.view",[],function(){}),csui.define("csui/dialogs/members.picker/impl/select.view/select.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/dialogs/members.picker/impl/member.list/member.list.view","csui/controls/list/list.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/dialogs/members.picker/impl/select.view/impl/header/header.view","hbs!csui/dialogs/members.picker/impl/select.view/impl/select.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","i18n!csui/dialogs/members.picker/impl/nls/lang","css!csui/dialogs/members.picker/impl/select.view/impl/select.view"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p){var m=n.LayoutView.extend({"template":d,"templateHelpers":function(){return{"backButtonTooltip":p.backButtonTooltip,"backButtonAria":p.backButtonTooltip}},"regions":{"viewHeaderRegion":".csui-mp-header","viewContentRegion":".csui-mp-content"},"ui":{"backButton":".csui-targetbrowse-arrow-back"},"behaviors":{"TabableRegion":{"behaviorClass":c}},"events":{"click @ui.backButton":"onClickFolderBack","keydown @ui.backButton":"selectFolderBack"},"constructor":function(e){e||(e={}),i.defaults(e,{"pageSize":30}),n.LayoutView.prototype.constructor.call(this,e),this.rendered=!1,this.selectedMember=null,this.collection=e.collection,this.completeCollection=e.collection,this.originalModels=e.collection.models,this.container=e.container,this.propagateEventsToRegions(),this.setHeader(e),this.setListView(e),this.onWinRefresh=i.bind(this.windowRefresh,this),t(window).bind("resize.app",this.onWinRefresh)},"windowRefresh":function(){var e=this.options.parentEl.height();(window.chrome||navigator.userAgent.indexOf("Firefox")>0)&&e>0&&this.$el.css("height",e+"px")},"onDestroy":function(){this.$el.off(),t(window).unbind("resize.app",this.onWinRefresh)},"onRender":function(){var e=this,t=e.$el.find(".csui-mp-content");this.viewHeaderRegion.show(this.headerView),this.viewContentRegion.show(this.listView),this.$el.hover(function(){t.addClass("binf-focus")},function(){t.removeClass("binf-focus")}),this.rendered=!0},"onDomRefresh":function(){this.windowRefresh()},"onShow":function(){this.rendered||this.render(),i.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.trigger("show")})},"getNumberOfSelectItems":function(){return null!==this.selectedMember?1:0},"setNewSelect":function(e,t){this.clearSelect(),this._setSelection({"member":e,"add":!0,"silent":t})},"clearSelect":function(){!!this.listView&&this.listView.clearSelect(),this.selectedMember=null},"setListView":function(e){e||(e={});var t={"collection":this.collection,"container":this.container,"commandType":e.commandType,"pageSize":e.pageSize},s=this.listView=new l(t);this.listenTo(s,"selection:change",this._setSelection).listenTo(s,"browse:select",i.bind(this.trigger,this,"browse:select",this)).listenTo(this,"browse:complete",i.bind(s.trigger,s,"browse:complete"))},"selectFolderBack":function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this.trigger("backbutton:click",this))},"onClickFolderBack":function(e){e.preventDefault(),e.stopPropagation(),this.trigger("backbutton:click",this)},"setHeader":function(){var e=this.container&&(this.container.get("name")||this.options.displayName);e=null===e?this.options.locationName:e,this.headerView=new u({"title":e,"container":this.container,"searchView":this.options.searchView}),this.listenTo(this.headerView,"change:filterValue",this.applyFilter)},"applyFilter":function(e){if(i.extend(e,{"type":this.options.listTypes}),this.collection.fetching)this.filterValuePending=e;else{var t=this;this.collection.setLimit(0,this.options.pageSize,!1),this.collection.setFilter(e,!1),this.collection.fetch({"reset":!0}).fail(function(e){t.listView.stopBlocker(),t.trigger("search:failed",{"resp":e,"view":t})}),this.listView.reset()}},"refresh":function(){var e=this;this.collection.fetch({"reset":!0}).fail(function(){e.listView.stopBlocker()})},"stopBlocker":function(){this.listView.stopBlocker()},"addMemberSelection":function(e){this._setSelection({"browse":!0,"add":!0,"breadCrumbSelection":!0,"member":e,"type":1})},"_setSelection":function(e){var t=(e.member.get("id"),this.options.commandType);this.selectedMember=null,e.add&&t.isSelectable(e.member)&&(this.selectedMember=e.member),e.silent||this.trigger("selection:change",e,this)}});return i.extend(m.prototype,h),m}),csui.define("hbs!csui/dialogs/members.picker/impl/select.views/selectviews",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return"\r\n"}});return i.registerPartial("csui_dialogs_members.picker_impl_select.views_selectviews",s),s}),csui.define("csui/dialogs/members.picker/impl/select.views/select.views",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/utils/base","i18n!csui/dialogs/members.picker/impl/nls/lang","csui/models/member/member.model","csui/models/member/membercollection","csui/dialogs/members.picker/impl/select.view/select.view","csui/dialogs/modal.alert/modal.alert","csui/utils/commands","hbs!csui/dialogs/members.picker/impl/select.views/selectviews","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/lib/jquery.ui/js/jquery-ui"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p){"use strict";var m=s.ItemView.extend({"className":"csui-select-lists","template":h,"constructor":function(e){e||(e={}),i.defaults(e,{"pageSize":30}),s.ItemView.prototype.constructor.call(this,e),this.commandType=e.commandType,this.leftView=this.rightView=null,this.rootGroup=e.rootGroup,this.invalidMembers=[],this.ancestorCollection=e.ancestorCollection,this.connector=e.connector},"onRender":function(){this.setLeftOnly(),this.leftView&&this.leftView.render(),this.rightView&&this.rightView.render()},"onDomRefresh":function(){this.leftView.triggerMethod("dom:refresh",this.leftView),this.rightView&&this.rightView.triggerMethod("dom:refresh",this.rightView)},"onShow":function(){this.leftView.triggerMethod("show"),this.rightView&&this.rightView.triggerMethod("show")},"setParentGroupAsTarget":function(e){var t=this.commandType.isSelectable(e);return this.rightView&&this.rightView.clearSelect(),this.leftView&&this.leftView.setNewSelect(e,!0),t},"getSelection":function(){var e=this.rightView?this.rightView.selectedMember:null,t=null===e?this.leftView.selectedMember:null;return null!==e?e:t},"getNumberOfSelectItems":function(){return this.rightView&&this.rightView.getNumberOfSelectItems()>0?this.rightView.getNumberOfSelectItems():this.leftView.getNumberOfSelectItems()},"leftNodeId":function(){var e=this.leftView.container;return e?e.get("id"):-1},"setLeftOnly":function(){var e=this._setView(this.rootGroup,"cs-start-locations left-only",!1,this.options),t=e.view.container,i=this;return e.promise.done(function(){t&&i.leftView.addMemberSelection(t),i.options.targetBrowseHistory.length>0?i.showBackButton():(i.options.targetBrowseHistory.length>1||1===i.options.targetBrowseHistory.length&&i.options.navigateFromHistory)&&i.showBackButton()}).fail(function(e){i.forceClose(e)}),this.leftView=e.view,e.promise},"forceClose":function(e){this._displayAlert(e).always(this.trigger("close"))},"newLeftView":function(e,t){var i=this;return this.options.pageSize=t,this._drillUp(e).done(function(t){i.leftView=t,i.leftView.addMemberSelection(e),i.trigger("changed"),i.onDomRefresh()}).fail(function(e){i._displayAlert(e)})},"onSelectionChange":function(e,t){var i,s=t&&this._isRightView(t);return e&&!e.breadCrumbSelection&&(s?e.add&&this.leftView.clearSelect():this.rightView&&(e.add&&this.rightView.clearSelect(),i=this.rightView.container.id!==e.member.id)),1===e.type&&this._updateAncestorCollection(e.member,{"isLeftView":!s,"replaceRightView":i}),e.member.add=e.add,this.trigger("change:complete",e.member),!0},"onBrowse":function(e,t){var i=this._isRightView(e),s=null;return this.trigger("changing:selection"),s=i?this.selectRight(t):this.selectLeft(t),s.done(function(){e.trigger("browse:complete")}).fail(function(){e.clearSelect()}),s},"selectLeft":function(e){var t=this;return this._runSelection(e,".cs-pane-view").done(function(e){e&&(t.rightView=e,t.onDomRefresh())})},"selectRight":function(e){var t=this,i=Math.floor((this.leftView.collection.skipCount||0)/this.leftView.collection.topCount)+1,s=parseInt(this.leftView.collection.topCount)*parseInt(i),n=e.member.get("parentId"),o=this.ancestorCollection.get(n),r=o&&this.ancestorCollection.get(o.get("parentId"));if(0===this.options.targetBrowseHistory.length)this.options.targetBrowseHistory.push("start.location");else{var l={"leftId":r?r.get("id"):null,"leftName":r?r.get("name"):void 0,"leftParent":r?r.get("parentId"):void 0,"leftType":r?r.get("type"):void 0,"rightId":o?o.get("id"):void 0,"rightName":o?o.get("name"):void 0,"rightParent":o?o.get("parentId"):void 0,"rightType":o?o.get("type"):void 0,"pageSize":s};this.options.targetBrowseHistory.push(l)}return this._runSelection(e,".csui-panel.cs-start-locations").done(function(e){e&&(t.leftView=t.rightView,t.showBackButton(),t.rightView=e,t.onDomRefresh())})},"showBackButton":function(){this.leftView&&this.options.targetBrowseHistory.length>=1&&this.leftView.headerView.ui.backButton.parent().show()},"hideBackButton":function(){this.leftView&&this.options.targetBrowseHistory.length<1&&this.leftView.headerView.ui.backButton.parent().hide()},"_runSelection":function(e,i){var s=e.member,n=this,o=t.Deferred();return this._drillDown(s,i).done(function(e){n.trigger("changed"),n.trigger("change:complete",s),o.resolve(e)}).fail(function(e){n._displayAlert(e),n.trigger("change:complete"),o.reject()}),o},"_drillUp":function(e,i){var s=this._setView(e,"csui-new-view left-only binf-hidden","prepend"),n=s.view,o=this,r=t.Deferred();return n.$el.addClass("zeroWidth").removeClass("binf-hidden"),n.render(),i||o._removeRightView(s.promise).done(function(){r.resolve(s.view)}).fail(function(e){r.reject(e)}),r},"_drillDown":function(e,t){var i=this._setView(e,"csui-new-view",!1),s=i.view;return s.render(),this.rightView?this._replaceView(i.promise,s,t):this._addRightView(i.promise,s)},"_showLeftOnly":function(){function e(){if(i){var e=i[0].selectView;s.cancelEventsToViewsPropagation(e),e.destroy(),i.remove(),s.rightView=null}}var t=this.$el.find(".csui-panel.cs-start-locations"),i=this.$el.find(".csui-panel.cs-pane-view.csui-slideMidLeft"),s=this;i.hide(),t.animate({"width":"100%"},{"duration":200,"complete":e})},"_removeRightView":function(e){
var i=this.$el.find(".csui-new-view"),s=this.$el.find(".csui-panel.cs-start-locations"),n=this.$el.find(".cs-pane-view"),o=t.Deferred(),r=this;return s.hide(),n.hide(),i[0].className="csui-panel cs-start-locations left-only",e.done(function(){r._finishRightRemove(i,s,n),o.resolve()}).fail(function(e){r._removeNewView(i,s,n),o.reject(e)}),o},"_removeNewView":function(e,t,i){e||(e=this.$el.find(".csui-new-view"));var s=e[0].selectView;this.cancelEventsToViewsPropagation(s),s.destroy(),e.remove(),t&&t.show(),i&&i.show()},"_finishRightRemove":function(e,t,i){var s;return i.length>0&&(s=i[0].selectView,this.cancelEventsToViewsPropagation(s),s.destroy(),i.remove(),this.rightView=null),s=t[0].selectView,this.cancelEventsToViewsPropagation(s),s.destroy(),t.remove(),this.leftView=null,!0},"_addRightView":function(e,i){var s=this.$el.find(".csui-panel.cs-start-locations"),n=this.$el.find(".csui-new-view"),o=t.Deferred(),r=this;return s[0].className="csui-panel cs-start-locations",n[0].className="csui-panel cs-pane-view csui-slideMidLeft",e.done(function(){o.resolve(i)}).fail(function(e){r._removeNewView(n),s.animate({"width":"100%"},200),r.leftView.clearSelect(),r.leftView.refresh(),o.reject(e)}),o},"_replaceView":function(e,i,s){var n=this.$el.find(s),o=t(".csui-new-view"),r=t(".cs-pane-view"),l=t.Deferred(),a=this;switch(n.hide(),s){case".csui-panel.cs-start-locations":r[0].className="csui-panel cs-start-locations csui-slideLeft",o[0].className="csui-panel cs-pane-view csui-slideMidLeft";break;case".cs-pane-view":o[0].className="csui-panel cs-pane-view csui-slideMidLeft"}return e.done(function(){a._removeView(n),l.resolve(i)}).fail(function(e){a._reverseRemoveView(o,s,r),".csui-panel.cs-start-locations"===s&&n.show(),l.reject(e)}),l},"_reverseRemoveView":function(e,t,i){switch(this._removeNewView(e),t){case".csui-panel.cs-start-locations":i[0].className="csui-panel cs-pane-view csui-slideRight",this.rightView.refresh();break;case".cs-pane-view":this._removeView(i),this.leftView.$el[0].className="csui-panel cs-start-locations left-only",this.leftView.clearSelect(),this.leftView.refresh()}return!0},"_removeView":function(e){var t=e[0].selectView;return this.cancelEventsToViewsPropagation(t),t.destroy(),e.remove(),!0},"_setView":function(e,t,s,n){n||(n=this._getViewOptions(e,this.connector)),i.defaults(n,this.options,{"invalidMembers":this.invalidMembers}),s||(s="append");var o=this._newView(n,t),r=this._fetchView(o);return o.el.selectView=o,this.$el[s](o.el),{"view":o,"promise":r}},"_fetchView":function(e){return this._fetchCollection(e)},"_fetchCollection":function(e){return e.collection.setOrder(this.options.orderBy,!1),e.collection.setLimit(0,this.options.pageSize,!1),e.collection.fetch({"reset":!1,"merge":!1,"remove":!1})},"_newView":function(e,t){var s=i.extend({"className":t+" csui-panel","parentEl":this.$el},e),n=new c(s);return this.propagateEventsToViews(n),this.listenTo(n,"selection:change",this.onSelectionChange),this.listenTo(n,"backbutton:click",this._onClickBackButton),this.listenTo(n,"browse:select",i.bind(this.onBrowse,this)),n},"_onClickBackButton":function(){var e=this,t=this.options.targetBrowseHistory.length>0?this.options.targetBrowseHistory.pop():void 0;if(this.options.navigateFromHistory=1===this.options.targetBrowseHistory.length,t.leftId){var i=new l({"id":t.leftId,"name":t.leftName},{"connector":this.connector}),s=new l({"id":t.rightId,"name":t.rightName},{"connector":this.connector});this.newLeftView(i,t.pageSize).done(function(){e.setParentGroupAsTarget(i),e.trigger("change:complete"),e.options.targetBrowseHistory.length>0&&s&&s.get("id")&&e.$el.find(".cs-left-item-"+s.get("id")).length>0&&e.$el.find(".cs-left-item-"+s.get("id")).trigger("click"),e.showBackButton()})}else if("start.location"===t)this.trigger("change:location",this.options.startLocation);else{e.hideBackButton();var n=new l({"id":this.options.container.groupId},{"connector":this.connector});this.options.container.groupId;this.newLeftView(n,t.pageSize).done(function(){e.setParentGroupAsTarget(n);var i=e.ancestorCollection.findByIndex(t.rightId);e.ancestorCollection.findByIndex(t.rightId),e.ancestorCollection.reset(e.ancestorCollection.slice(0,i))})}},"_isRightView":function(e){var t=e.$el[0].className.split(" ");return i.contains(t,"cs-pane-view")},"_addNewPanel":function(e,t){var i=document.createElement("div");return i.className=e,this.$el[t](i),i},"_getViewOptions":function(e,t){var i=new l({"id":e.get("id"),"name":e.get("name"),"parentId":e.get("parentId"),"nodeId":e.get("nodeId"),"categoryId":e.get("categoryId"),"groupId":e.get("groupId")},{"connector":t});return{"container":i,"collection":new a(void 0,{"member":i,"autofetch":!0,"orderBy":this.options.orderBy,"commands":d.getAllSignatures(),"connector":this.connector,"type":"all.groups"===this.options.startLocation?1:null})}},"_displayAlert":function(e){var t=i.str.sformat(r.serverError,"unknown");return e&&(e instanceof c?t=i.str.sformat(r.ViewDenied,e.member.get("name")):e.responseJSON&&(t=e.responseJSON.error)),u.showInformation(t)},"_updateAncestorCollection":function(e,t){var i=this.ancestorCollection.findByIndex(e.id);i>=0?this.ancestorCollection.reset(this.ancestorCollection.slice(0,i+1)):(t.isLeftView&&t.replaceRightView&&this.ancestorCollection.pop(),this.ancestorCollection.add(e.clone()))}});return i.extend(m.prototype,p),m}),csui.define("hbs!csui/dialogs/members.picker/impl/selectedMembers/impl/selectedMember",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-selected-member" id="'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'">\r\n  <div class="member-picture binf-pull-left">\r\n    <span class="csui-icon-paceholder csui-icon image_user_placeholder">'+this.escapeExpression((n=null!=(n=t.initials||(null!=e?e.initials:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"initials","hash":{}}):n))+'</span>\r\n    <img class="csui-icon-user csui-icon binf-img-circle binf-hidden" alt="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'"\r\n         src="'+this.escapeExpression((n=null!=(n=t.userImgSrc||(null!=e?e.userImgSrc:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"userImgSrc","hash":{}}):n))+'">\r\n  </div>\r\n  <div class="member-info binf-pull-left">\r\n    <span class="name binf-pull-left" title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n    <span class="department binf-pull-left" title="'+this.escapeExpression((n=null!=(n=t.department||(null!=e?e.department:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"department","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.department||(null!=e?e.department:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"department","hash":{}}):n))+'</span>\r\n\r\n  </div>\r\n  <button type="button" class="close notification_error" aria-label="'+this.escapeExpression((n=null!=(n=t.removeSelectedUserAria||(null!=e?e.removeSelectedUserAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"removeSelectedUserAria","hash":{}}):n))+'"\r\n          title="'+this.escapeExpression((n=null!=(n=t.removeSelectedUser||(null!=e?e.removeSelectedUser:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"removeSelectedUser","hash":{}}):n))+'"></button>\r\n</div>\r\n \r\n'}});return i.registerPartial("csui_dialogs_members.picker_impl_selectedMembers_impl_selectedMember",s),s}),csui.define("csui/dialogs/members.picker/impl/selectedMembers/selectedMember",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/utils/url","csui/utils/user.avatar.color","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/dialogs/members.picker/impl/selectedMembers/impl/selectedMember","i18n!csui/dialogs/members.picker/impl/nls/lang"],function(e,t,i,s,n,o,r,l,a){return i.ItemView.extend({"template":l,"tagName":"div","className":"csui-userpicker-item","ui":{"closeButton":".close","personalizedImage":".csui-icon-user","defaultImage":".csui-icon-paceholder"},"behaviors":{"TabableRegion":{"behaviorClass":r}},"events":{"click @ui.closeButton":"onRemoveButtonClicked"},"currentlyFocusedElement":function(){return this.ui.closeButton},"templateHelpers":function(){return{"name":s.formatMemberName(this.model),"department":this.model.get("group_id")&&this.model.get("group_id").name,"id":this.model.get("id"),"initials":this.model.get("initials"),"userImgSrc":"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=","removeSelectedUser":a.removeSelectedUser,"removeSelectedUserAria":e.str.sformat(a.removeSelectedUserAria,this.model.get("name_formatted"))}},"constructor":function(e){e||(e={}),e.disabledMessage||(e.disabledMessage=""),i.ItemView.prototype.constructor.call(this,e),this.listenTo(this,"render",this._assignUserColor)},"onRender":function(){this.options.lightWeight||this._displayProfileImage()},"onDestroy":function(){this._releasePhotoUrl()},"onRemoveButtonClicked":function(e){e.stopPropagation(),e.preventDefault(),this._parent.trigger("remove:selectItem",this.model)},"_displayProfileImage":function(){var i=this._getUserPhotoUrl();if(this.ui.personalizedImage.addClass("esoc-userprofile-img-"+this.model.get("id")),i){var s=this.options.model.connector.extendAjaxOptions({"url":i,"dataType":"binary"});this._releasePhotoUrl(),t.ajax(s).always(e.bind(function(e,t,i){200===i.status?this._showPersonalizedImage(e):this._showDefaultImage()},this))}else this._showDefaultImage()},"_getUserPhotoUrl":function(){var e=this.options.model&&this.options.model.connector.connection||this.options.connector&&this.options.connector.connection,t=new n(e.url).getCgiScript(),i=this.model.get("photo_url");if(i&&i.indexOf("?")>0)return n.combine(t,i)},"_showPersonalizedImage":function(e){this._releasePhotoUrl(),this._photoUrl=URL.createObjectURL(e),this.ui.personalizedImage.attr("src",this._photoUrl),this.ui.defaultImage.addClass("binf-hidden"),this.ui.personalizedImage.removeClass("binf-hidden")},"_showDefaultImage":function(e){this._releasePhotoUrl(),this.ui.personalizedImage.addClass("binf-hidden"),this.ui.defaultImage.removeClass("binf-hidden")},"_releasePhotoUrl":function(){this._photoUrl&&(URL.revokeObjectURL(this._photoUrl),this._photoUrl=void 0)},"_assignUserColor":function(){var e=o.getUserAvatarColor(this.model.attributes);this.ui.defaultImage.css("background",e)}})}),csui.define("hbs!csui/dialogs/members.picker/impl/selectedMembers/impl/selectedMemberList",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-selected-member-list"></div>'}});return i.registerPartial("csui_dialogs_members.picker_impl_selectedMembers_impl_selectedMemberList",s),s}),csui.define("css!csui/dialogs/members.picker/impl/selectedMembers/impl/selectedMember",[],function(){}),csui.define("csui/dialogs/members.picker/impl/selectedMembers/selectedMemberList",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/dialogs/members.picker/impl/selectedMembers/selectedMember","csui/controls/tile/behaviors/perfect.scrolling.behavior","hbs!csui/dialogs/members.picker/impl/selectedMembers/impl/selectedMemberList","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","css!csui/dialogs/members.picker/impl/selectedMembers/impl/selectedMember"],function(e,t,i,s,n,o,r,l){var a=s.CollectionView.extend({"template":r,"childView":n,"childViewContainer":".csui-selected-member-list","childViewOptions":{"collection":this.collection},"ui":{"memberListContainer":".csui-selected-member-list"},"behaviors":{"PerfectScrolling":{"behaviorClass":o,"suppressScrollX":!0,"scrollYMarginOffset":15}},"constructor":function(e){e||(e={}),this.collection=e.collection||new i.Collection,s.CollectionView.prototype.constructor.apply(this,arguments),this.listenTo(this,"show:selectItem",t.bind(function(e){this.collection.add(e)},this))},"onRender":function(){this.listenTo(this,"remove:selectItem",t.bind(function(e){this.collection.remove(e)},this))}});return t.extend(a.prototype,l),a}),csui.define("csui/models/memberancestorcollection",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone"],function(e,t,i,s){"use strict";return s.Collection.extend({"constructor":function(e,t,i){s.Collection.prototype.constructor.apply(this,arguments),this.context=i},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})},"isFetchable":function(){return!1},"add":function(e,t){s.Collection.prototype.add.apply(this,arguments),this.trigger("sync",this)},"findByIndex":function(e){for(var t=0;t<this.models.length;t++)if(this.models[t].id===e)return t;return-1}})}),csui.define("hbs!csui/dialogs/members.picker/impl/members.picker",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div id="csui-mp-selected-member-list-container"\r\n     class="csui-mp-selected-member-list-container"></div>\r\n<div id="csui-mp-breadcrumbs" class="cs-breadcrumb">\r\n  <div role="navigation" class="breadcrumb-inner"></div>\r\n  <div class="searchheader-inner"></div>\r\n</div>\r\n<div id="csui-mp-selectviews"></div>\r\n'}});return i.registerPartial("csui_dialogs_members.picker_impl_members.picker",s),s}),csui.define("csui/dialogs/members.picker/impl/members.picker.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/models/member/member.model","csui/dialogs/members.picker/impl/select.views/select.views","csui/dialogs/members.picker/impl/selectedMembers/selectedMemberList","csui/controls/breadcrumbs/breadcrumbs.view","csui/models/memberancestorcollection","hbs!csui/dialogs/members.picker/impl/members.picker","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin"],function(e,t,i,s,n,o,r,l,a,c,u,d,h){var p=s.LayoutView.extend({"template":d,"regions":{"breadcrumbRegion":"#csui-mp-breadcrumbs > .breadcrumb-inner","searchHeaderRegion":"#csui-mp-breadcrumbs > div.searchheader-inner","selectViewRegion":"#csui-mp-selectviews","selectedMemberListRegion":"#csui-mp-selected-member-list-container"},"ui":{"breadcrumb":"#csui-mp-breadcrumbs","breadcrumbContent":".breadcrumb-inner","selectViews":"#csui-mp-selectviews"},"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.call(this,e),this.propagateEventsToRegions(),this.rootGroup=e.container,this.ancestorCollection=new u(this.rootGroup.clone(),e,e.context),e.rootGroup=this.rootGroup,e.ancestorCollection=this.ancestorCollection,this.setBreadcrumbs(e),this.setViews(e),this.onWinRefresh=i.bind(this.windowRefresh,this),t(window).bind("resize.app",this.onWinRefresh)},"windowRefresh":function(){var e=t(".cs-breadcrumb"),i=e.is(":visible")?e.height():0;this.$el.height();window.chrome,this.selectViews.triggerMethod("dom:refresh",this.selectViews)},"onDestroy":function(){t(window).unbind("resize.app",this.onWinRefresh)},"onRender":function(){this.options.searchView&&this.searchHeaderRegion.show(this.searchHeaderView),this.breadcrumbs&&this.breadcrumbRegion.show(this.breadcrumbs),this.selectViews.options.navigateFromHistory=this.options.navigateFromHistory,this.selectViewRegion.show(this.selectViews),this.selectedMemberListRegion.show(this.selectedMemberList)},"onDomRefresh":function(){this.windowRefresh()},"onShow":function(){i.each(this.regionManager.regions,function(e){e.currentView&&e.currentView.trigger("show")}),this.options.adduserorgroup&&1===this.ancestorCollection.length&&(this.ui.breadcrumb.hide(),this.ui.selectViews.addClass("csui-full-height"))},"setViews":function(e){var t=this.selectViews=new l(e);this.selectedMemberList=new a,this.listenTo(t,"changed",this.updateBreadcrumbs),this.listenTo(t,"change:location",i.bind(this.trigger,this,"change:location")),this.listenTo(t,"change:complete",i.bind(this.trigger,this,"change:complete")),this.listenTo(t,"close",this.close),this.listenTo(this.selectedMemberList,"add:child remove:child",this.onMemberListChange)},"onMemberListChange":function(){this.adjustSelectViews(),this.trigger("update:button",this.selectedMemberList.collection)},"adjustSelectViews":function(){var e=this.selectedMemberList.collection.length<3?this.selectedMemberList.collection.length:3,t=e?e*this.selectedMemberList.$el.find(".csui-userpicker-item").height():0,i=t?"calc(100% - "+t+"px)":"100%";this.selectViews.$el.find(".list-content").css({"height":i})},"getSelection":function(){return this.selectViews.getSelection()},"getNumberOfSelectItems":function(){return this.selectViews.getNumberOfSelectItems()},"close":function(){this.destroy(),this.trigger("close")},"updateBreadcrumbs":function(){return this.options.adduserorgroup&&1===this.ancestorCollection.length?(this.ui.breadcrumb.hide(),this.ui.selectViews.addClass("csui-full-height")):(this.ui.breadcrumb.show(),this.ui.breadcrumbContent.show(),this.ui.selectViews.removeClass("csui-full-height")),this.windowRefresh(),this.adjustSelectViews(),!0},"setBreadcrumbs":function(e){return this.breadcrumbs=new c({"node":e.rootGroup,"collection":e.ancestorCollection}),this.setBreadcrumbEvents(),!0},"setBreadcrumbEvents":function(){this.listenTo(this.breadcrumbs,"before:defaultAction",function(e){var t=this.selectViews,i=this;t.newLeftView(e.node).done(function(e){t.setParentGroupAsTarget(e.container),i.trigger("change:complete",e.container)})})}});return i.extend(p.prototype,h),p}),csui.define("csui/models/permission/nodepermission.model",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/uploadable/uploadable.mixin"],function(e,t,i,s,n,o,r){"use strict";function l(e,t){var i=p.PERMISSION_LEVEL_NONE;return e&&e.length>0&&(i=e.indexOf("edit_permissions")>=0&&e.length===(t?10:9)?p.PERMISSION_LEVEL_FULL_CONTROL:e.indexOf("edit_permissions")<0&&e.indexOf("delete")>=0&&e.length===(t?9:8)?p.PERMISSION_LEVEL_WRITE:e.indexOf("see_contents")>=0&&2===e.length?p.PERMISSION_LEVEL_READ:p.PERMISSION_LEVEL_CUSTOM),i}function a(){return["see","see_contents"]}function c(e){var t=["see","see_contents","modify","edit_attributes","add_items","reserve","add_major_version","delete_versions","delete"];return e||t.splice(t.indexOf("add_items"),1),t}function u(e){var t=["see","see_contents","modify","edit_attributes","add_items","reserve","add_major_version","delete_versions","delete","edit_permissions"];return e||t.splice(t.indexOf("add_items"),1),t}function d(e,t){var i=null;switch(e){case p.PERMISSION_LEVEL_NONE:i=[];break;case p.PERMISSION_LEVEL_READ:i=a();break;case p.PERMISSION_LEVEL_WRITE:i=c(t);break;case p.PERMISSION_LEVEL_FULL_CONTROL:i=u(t)}return i}var h=t.extend({"idAttribute":null},e.config()),p=s.Model.extend({"idAttribute":h.idAttribute,"defaults":{"addEmptyAttribute":!0},"constructor":function(e,i){e||(e={}),i||(i={}),s.Model.prototype.constructor.call(this,e,i),this.options=t.pick(i,["connector"]),this.makeConnectable(i).makeUploadable(i)},"isNew":function(){return!this.get("type")||!(this.has("right_id")||"public"===this.get("type"))},"urlBase":function(){var e=this.get("type"),i=this.get("right_id"),s=this.nodeId,o=this.apply_to,r=this.include_sub_types,l="",a=this.options.connector.connection.url;if(t.isNumber(s)&&!(s>0))throw new Error("Unsupported id value");if(a=n.combine(a,"nodes",s,"permissions"),o&&(l=n.combineQueryString(l,{"apply_to":o})),r&&t.each(r,function(e){l=n.combineQueryString(l,{"include_sub_types":e})}),l=l.length>0?"?"+l:l,e)if("custom"!==e)a=n.combine(a,e+l);else{if(t.isNumber(i)&&!(i>0))throw new Error("Unsupported permission type or user id");a=n.combine(a,e,i+l)}else a=n.combine(a,"custom"+l);return a},"url":function(){var e=this.urlBase();return e=e.replace("/v1","/v2")},"parse":function(e,t){var i=e.permissions?e.permissions.indexOf("add_items"):-1;return this.collection&&!this.collection.isContainer&&-1!==i&&e.permissions.splice(i,1),e},"getPermissionLevel":function(){return p.getPermissionLevel(this.get("permissions"),this.collection.isContainer)}},{"getPermissionLevel":l,"getReadPermissions":a,"getWritePermissions":c,"getFullControlPermissions":u,"getPermissionsByLevelExceptCustom":d});return p.prototype.PERMISSION_LEVEL_NONE=p.PERMISSION_LEVEL_NONE=0,p.prototype.PERMISSION_LEVEL_READ=p.PERMISSION_LEVEL_READ=1,p.prototype.PERMISSION_LEVEL_WRITE=p.PERMISSION_LEVEL_WRITE=2,p.prototype.PERMISSION_LEVEL_FULL_CONTROL=p.PERMISSION_LEVEL_FULL_CONTROL=3,p.prototype.PERMISSION_LEVEL_CUSTOM=p.PERMISSION_LEVEL_CUSTOM=4,p.prototype.getReadPermissions=p.getReadPermissions,p.prototype.getWritePermissions=p.getWritePermissions,p.prototype.getFullControlPermissions=p.getFullControlPermissions,p.prototype.getPermissionsByLevelExceptCustom=p.getPermissionsByLevelExceptCustom,o.mixin(p.prototype),r.mixin(p.prototype),p}),csui.define("csui/dialogs/members.picker/start.locations/start.location.collection",["require","module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone"],function(e,t,i,s,n){"use strict";function o(e){return e.lastIndexOf("/")>=0?e:"csui/dialogs/members.picker/start.locations/"+e}function r(e){return!i.contains(c.blacklist,e)&&(!c.whitelist.length||i.contains(c.whitelist,e))}var l=t.config(),a=l.startLocations||[],c=l.masks||{};i.isArray(a)||(a=Array.prototype.concat.apply([],i.values(a))),c=i.reduce(i.values(c),function(e,t){return{"blacklist":e.blacklist.concat(t.blacklist||[]),"whitelist":e.whitelist.concat(t.whitelist||[])}},{"blacklist":[],"whitelist":[]}),c={"blacklist":i.unique(c.blacklist),"whitelist":i.unique(c.whitelist)},a=i.chain(a).map(o).filter(r).unique().value();var u=n.Model.extend({"defaults":{"id":null,"name":null,"icon":null,"invalid":!1,"factory":null,"unselectable":!0},"constructor":function(e,t){n.Model.prototype.constructor.apply(this,arguments)},"sync":function(e,t,i){if("read"!==e)throw new Error("Only fetching the widget is supported.");var n=this;return i||(i={}),this._resolveFactory(i).then(function(){return n.get("factory").updateLocationModel(n)}).then(function(){var e=n.toJSON();i.success&&i.success(e,i),n.trigger("sync",n,e,i)},function(){var e=n.get("error");return i.error&&i.error(e,i),n.trigger("error",n,e,i),s.Deferred().reject(e)})},"_resolveFactory":function(t){var i=this,n=s.Deferred(),o=this.getFactoryData(),r=this.getFactoryModulePath(o);return e([r],function(e){i.set("factory",new e(t)),n.resolve()},function(e){i.set("error",e),t.ignoreErrors?n.resolve():n.reject(e)}),n.promise()},"getFactoryData":function(){var e,t=this.get("id"),i=t.lastIndexOf("/");return i<0?e="csui/dialogs/members.picker/start.locations/"+t:(e=t,t=t.substring(i+1)),{"name":t,"path":e}},"getFactoryModulePath":function(e){return e.path+"/"+e.name+".factory"}});return n.Collection.extend({"model":u,"constructor":function(e){e||(e={});var t=e.startLocations;t=t?i.chain(t).concat(["current.group"]).map(o).filter(r).unique().value():a;var s=i.map(t,function(e){return{"id":e}});n.Collection.prototype.constructor.call(this,s,e)},"sync":function(e,t,i){if("read"!==e)throw new Error("Only fetching the start locations is supported.");var s=this;return i||(i={}),this._resolveFactories(i).then(function(){if(!1!==i.removeInvalid){var e=s.where({"invalid":!0});s.remove(e)}var t=s.toJSON();i.success&&i.success(t,i),s.trigger("sync",s,t,i)})},"_resolveFactories":function(e){var t=this.filter(function(e){return e.has("id")&&!(e.has("factory")||e.has("error"))}),n=i.defaults({"ignoreErrors":!0},i.omit(e,"success","error")),o=i.invoke(t,"fetch",n);return s.when.apply(s,o)}})}),csui.define("csui/dialogs/members.picker/impl/command.type",["module","csui/lib/underscore","i18n!csui/dialogs/members.picker/impl/nls/lang"],function(e,t,i){var s=(e.config(),function(e){var t=e.initialContainer;this.unselectableMembers=e.unselectableMembers,this.selectableMembers=e.selectableMembers,this.invalidMembers=e.invalidMembers,this.selectableTypes=e.selectableTypes||[],this.unselectableTypes=e.unselectableTypes||[],this.showAllTypes=e.showAllTypes||!1,this.parentId=t?t.get("id"):-1,this.addButtonLabel=e.addButtonLabel||i.addButtonLabel});return t.extend(s.prototype,{"getSelectableMemberTypes":function(){return this.showAllTypes?[]:this.selectableTypes},"validateTarget":function(e){var i=e.data?e.data.id:e.get("id"),s=e.get("type"),n=t.every(this.unselectableMembers,function(e){return i!==e});return this.browseAllowed(e)&&(n=t.every(this.unselectableTypes,function(e){return s!==e})),n},"validId":function(e){return(e.data?e.data.id:e.get("id"))!==this.parentId},"validateAddableTypes":function(e){return!e.addable_types},"isSelectableType":function(e){var i=e.get("type");if(!i&&0!==i)return!1;var s=t.every(this.unselectableTypes,function(e){return i!==e});return s&&!t.isEmpty(this.selectableTypes)&&!(s=-1!==t.indexOf(this.selectableTypes,i))&&this.browseAllowed(e)&&t.indexOf(this.selectableTypes,-1)>-1&&(s=!0),s},"isSelectable":function(e){var i=e.data?e.data.id:e.get("id");if(e.get("unselectable"))return!1;var s=this.isSelectableType(e);return s&&(s=t.every(this.unselectableMembers,function(e){return i!==e})),this.selectableMembers&&(s=1===e.get("type")),s},"browseAllowed":function(e){return 1===e.get("type")},"validateMember":function(e){var t=this._hasValidId(e);return t&&!this.showAllTypes&&(this.browseAllowed(e)||this.selectableTypes.length>0&&-1===this.selectableTypes.indexOf(e.get("type"))&&(t=!1)),t},"_hasValidId":function(e){return t.every(this.invalidmembers,function(t){return t.get("id")!==e.get("id")})}}),s}),csui.define("hbs!csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector.item",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'    <span class="cs-icon '+this.escapeExpression((n=null!=(n=t.iconClass||(null!=e?e.iconClass:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"iconClass","hash":{}}):n))+'"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<a role="menuitem" tabindex="-1" href="#" class='+this.escapeExpression((o=null!=(o=t.class||(null!=e?e.class:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"class","hash":{}}):o))+">\r\n"+(null!=(n=t.if.call(e,null!=e?e.icon:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'  <span class="cs-label">'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+"</span>\r\n</a>\r\n"}});return i.registerPartial("csui_dialogs_node.picker_impl_header_start.location.selector_start.location.selector.item",s),s}),csui.define("hbs!csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<button id="'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'" class="binf-btn binf-btn-default binf-dropdown-toggle csui-acc-focusable"\r\n        data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="false"\r\n        aria-label="'+this.escapeExpression((n=null!=(n=t.labelSelectLocation||(null!=e?e.labelSelectLocation:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"labelSelectLocation","hash":{}}):n))+'">\r\n  <span class="'+this.escapeExpression((n=null!=(n=t.iconClass||(null!=e?e.iconClass:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"iconClass","hash":{}}):n))+'"></span>\r\n  <span class="cs-label">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n  <span class="cs-icon icon-caret-down"></span>\r\n</button>\r\n<div class="csui-separator"></div>\r\n<ul class="binf-dropdown-menu" role="menu" aria-labelledby="'+this.escapeExpression((n=null!=(n=t.id||(null!=e?e.id:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"id","hash":{}}):n))+'"></ul>\r\n'}});return i.registerPartial("csui_dialogs_node.picker_impl_header_start.location.selector_start.location.selector",s),s}),csui.define("csui/dialogs/node.picker/start.locations/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/dialogs/node.picker/start.locations/impl/nls/root/lang",{"labelNoSelection":"Go to...","labelSearch":"Search","labelCurrentLocation":"Current location","labelFavorites":"Favorites","labelEnterpriseVolume":"Enterprise Volume","labelPersonalVolume":"Personal Volume","labelPerspectiveAssetsVolume":"Perspective Assets Volume","labelRecentContainers":"Recent Places","labelSelectLocation":"Select start location"}),csui.define("css!csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector",[],function(){}),csui.define("csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector.view",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector.item","hbs!csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang","css!csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector","csui/lib/binf/js/binf"],function(e,t,i,s,n,o,r){"use strict";function l(e){var t=e.get("icon")||"";return t&&t.indexOf("-")<0&&(t="icon-menu-"+t),"cs-icon "+t}var a=i.ItemView.extend({"tagName":"li","attributes":{"role":"presentation"},"template":n,"templateHelpers":function(){return{"iconClass":l(this.model)}},"triggers":{"click >a":"click:link"},"constructor":function(){i.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",this.render)}});return i.CompositeView.extend({"className":"dropdown-locations","template":o,"childView":a,"childViewContainer":"> .binf-dropdown-menu","behaviors":{"TabableRegion":{"behaviorClass":s}},"ui":{"toggle":"> .binf-dropdown-toggle","selectedLabel":">.binf-dropdown-toggle >.cs-label","selectedIcon":">.binf-dropdown-toggle >.cs-icon:not(.icon-caret-down)","selectedLocation":">.binf-dropdown-toggle >span:not(.icon-caret-down)"},"events":{"keyup":"onKeyInView"},"constructor":function(e){i.CompositeView.prototype.constructor.apply(this,arguments),this.selected=new t.Model,this.options.selected?this._setSelection(this.options.selected.attributes):this.resetSelection(),this.listenTo(this.collection,"change",this._refreshSelection),this.listenTo(this.selected,"change",this._updateSelection),this.listenTo(t,"closeToggleAction",this._closeToggle)},"filter":function(e,t,i){return!e.get("hide")},"currentlyFocusedElement":function(){return this.$el.find("button")},"accDeactivateTabableRegion":function(){this._closeToggle()},"reset":function(){this.resetSelection()},"resetSelection":function(){this.selected.set({"id":e.uniqueId(),"name":r.labelNoSelection,"icon":""})},"serializeData":function(){var t=e.pick(this.selected.toJSON(),["id","name","icon"]);return e.defaults({"id":e.uniqueId()},t)},"templateHelpers":function(){return{"search":r.labelSearch,"iconClass":l(this.selected),"labelSelectLocation":r.labelSelectLocation}},"onKeyInView":function(e){
var t=this.$el.hasClass("binf-open");if(27===e.keyCode&&t)return this.$el.removeClass("binf-open"),this.$('*[tabindex = "0"]').focus(),!1},"onRender":function(){this.ui.toggle.binf_dropdown()},"onChildviewClickLink":function(e){this.ui.selectedLabel.removeClass("select-prompt"),this._setSelection(e.model.attributes),this.ui.toggle.binf_dropdown("toggle"),this.ui.selectedLocation.removeClass("binf-hide"),this.triggerMethod("change:location",e.model),this.$el.trigger("setCurrentTabFocus")},"hideDropDownLabel":function(e){var t=this.selected.get("factory"),i=t.getLocationParameters().container,s=i&&i.get("id");(e&&e.get("id"))!==s&&(this._setSelection({"name":r.labelSelectLocation,"id":""}),this.ui.selectedLabel.addClass("select-prompt"),this.ui.selectedIcon.addClass("binf-hide"))},"_setSelection":function(e){this.selected.set(e)},"_updateSelection":function(){this.ui.selectedLabel.text(this.selected.get("name")),this.ui.selectedIcon.attr("class",l(this.selected))},"_refreshSelection":function(e){e.get("id")===this.selected.get("id")&&this._setSelection(e.attributes)},"_closeToggle":function(){var e=this.$el;e.hasClass&&e.hasClass("binf-open")&&this.ui.toggle.binf_dropdown("toggle"),this.ui.toggle&&this.ui.toggle.attr&&this.ui.toggle.attr("aria-expanded","false")}})}),csui.define("hbs!csui/dialogs/members.picker/impl/header/user.search/user.search",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-user-search-container">\r\n  <div class="csui-user-search-bar"></div>\r\n</div><a href="javascript:void(0);" class="icon icon-global-search csui-header-userpicker-icon\r\n         icon-header-search csui-acc-focusable" title="'+this.escapeExpression((n=null!=(n=t.searchIconTitle||(null!=e?e.searchIconTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"searchIconTitle","hash":{}}):n))+'" tabindex="0"\r\n         data-cstabindex="-1" role="button" aria-expanded="false"\r\n         aria-label="'+this.escapeExpression((n=null!=(n=t.searchIconAria||(null!=e?e.searchIconAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"searchIconAria","hash":{}}):n))+'"></a>'}});return i.registerPartial("csui_dialogs_members.picker_impl_header_user.search_user.search",s),s}),csui.define("csui/dialogs/members.picker/impl/header/user.search/user.search.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","i18n","i18n!csui/dialogs/members.picker/impl/nls/lang","hbs!csui/dialogs/members.picker/impl/header/user.search/user.search"],function(e,t,i,s,n,o,r){return i.ItemView.extend({"className":"csui-user-lookup","template":r,"templateHelpers":{"searchIconTitle":o.searchIconTitle,"searchIconAria":o.searchIconAria},"ui":{"input":".cs-search","userPickerIcon":".csui-header-userpicker-icon"},"events":{"click @ui.userPickerIcon":"userPickerIconClicked"},"initialize":function(e){this.options=e},"constructor":function(e){e||(e={}),e.data||(e.data={}),this.options=e,this.direction=n.settings.rtl?"left":"right",i.ItemView.prototype.constructor.call(this,e)},"onShow":function(){var e=this;csui.require(["csui/controls/userpicker/userpicker.view"],function(s){e.pickerView=new s({"context":e.options.context,"limit":5,"memberFilter":{"type":[0,1]},"widgetoptions":e.options,"placeholder":e.options.placeHolder||o.UserPickerPlaceHolder,"prettyScrolling":!0,"scrollContainerHeight":"auto","model":e.options.userPickerModel,"id_input":t.uniqueId("csui-inline-permissions-user-picker-input"),"lightWeight":!1}),new i.Region({"el":e.$el.find(".csui-user-search-bar")}).show(e.pickerView),e.listenTo(e.pickerView,"item:change",e.processItemChange),e.listenTo(e.pickerView,"item:clear",e.processItemChange)})},"processItemChange":function(){var e=arguments.length>0&&arguments[0].item;this.param=e,this.trigger("show:selectItem",this.param),this.processAfterSelect()},"processAfterSelect":function(){""!==this.pickerView.ui.searchbox.val()&&this.pickerView&&this.pickerView.ui&&this.pickerView.ui.searchclear&&this.pickerView.ui.searchclear.trigger("click")},"updatePlaceHolder":function(e){e?this.$el.find("input").attr("placeholder",o.addAnotherNamePlaceHolder):this.$el.find("input").attr("placeholder",o.UserPickerPlaceHolder)},"currentlyFocusedElement":function(e){if(this.$el){var t=this.$el.find("*[data-cstabindex=-1]");t.length&&t.prop("tabindex",0);!(!!e&&e.shiftKey)&&this.$el.find(".search-bar").length&&this.$el.find(".search-bar").is(":visible")?this.focusElement=this.$el.find(".csui-input"):this.$el.find("a.csui-acc-focusable").length&&(this.focusElement=this.$el.find("a.csui-acc-focusable"))}return this.focusElement},"userPickerIconClicked":function(t){if(e(document).bind("click."+this.cid+" keydown."+this.cid,this,this._hideSearchBar),this.ui.input.toggleClass(s.accessibilityFocusableClass),this.$el.find(".csui-user-search-container").is(":visible"));else if(this.$el&&this.$el.parents()){var i=this;this.hideStartLocations(),this.$el.find(".csui-user-search-container").show("blind",{"direction":this.direction},"200",function(){i.$el.find(".csui-user-search-container input").focus()})}this.ui.userPickerIcon.attr("aria-expanded",!0)},"_hideSearchBar":function(t){var i=t||window.event,s=e(".csui-user-search-container"),n=t.data;s.is(":visible")&&(("keydown"!==i.type||27!==i.keyCode&&27!==i.which)&&(e(i.target).closest(s).length||"click"!==i.type||e(i.target).closest(".csui-header-userpicker-icon").length)||(n.$el.find(".csui-user-search-container input").val(""),n.$el.find(s).hide("blind",{"direction":t.data.direction},"200",function(){n.showStartLocations(),n.focusedElement=void 0,n.currentlyFocusedElement().focus()}),e(document).unbind("click."+n.cid+" keydown."+n.cid),n.ui.userPickerIcon instanceof Object&&n.ui.userPickerIcon.attr("aria-expanded",!1)))},"showStartLocations":function(e){this.trigger("show:startLocation")},"hideStartLocations":function(e){this.trigger("hide:startLocation")}})}),csui.define("hbs!csui/dialogs/members.picker/impl/header/members.picker.header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return'  <h2 class="member-title">'+(null!=(o=null!=(o=t.title||(null!=e?e.title:e))?o:t.helperMissing,n="function"==typeof o?o.call(e,{"name":"title","hash":{}}):o)?n:"")+'</h2><span class="csui-separator"></span>\r\n  <div class="csui-target-controls">\r\n'+(null!=(n=t.if.call(e,null!=e?e.locationSelector:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+'    <div class="csui-member-picker-container">\r\n      <div class="csui-member-picker"></div>\r\n    </div>\r\n  </div>\r\n'},"2":function(e,t,i,s){var n;return'      <div class="csui-start-locations binf-dropdown '+(null!=(n=t.if.call(e,null!=e?e.displayStartLocation:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+'"></div>\r\n'},"3":function(e,t,i,s){return"binf-hidden"},"5":function(e,t,i,s){var n,o;return'  <h2 class="member-title member-picker-view-header">'+this.escapeExpression((o=null!=(o=t.title||(null!=e?e.title:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+'</h2><span\r\n      class="csui-view-separator csui-separator binf-hidden"></span>\r\n  <div class="csui-target-controls">\r\n'+(null!=(n=t.if.call(e,null!=e?e.isNotDeleted:e,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.noop}))?n:"")+"  </div>\r\n"},"6":function(e,t,i,s){var n;return'      <div class="csui-member-picker-container">\r\n        <span class="csui-member-picker"></span>\r\n        <span tabindex="-1" class="csui-add-member icon-toolbarAdd binf-hidden"\r\n              title="'+this.escapeExpression((n=null!=(n=t.addMemberTitle||(null!=e?e.addMemberTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"addMemberTitle","hash":{}}):n))+'"></span>\r\n      </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.adduserorgroup:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(5,s,0)}))?n:""}});return i.registerPartial("csui_dialogs_members.picker_impl_header_members.picker.header",s),s}),csui.define("css!csui/dialogs/members.picker/impl/header/members.picker.header",[],function(){}),csui.define("csui/dialogs/members.picker/impl/header/members.picker.header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector.view","csui/dialogs/members.picker/impl/header/user.search/user.search.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/dialogs/members.picker/impl/header/members.picker.header","i18n!csui/dialogs/members.picker/impl/nls/lang","css!csui/dialogs/members.picker/impl/header/members.picker.header"],function(e,t,i,s,n,o,r,l){return i.LayoutView.extend({"template":r,"className":"cs-header-control","regions":{"startLocations":".csui-start-locations","userSearch":".csui-member-picker"},"templateHelpers":function(){return{"adduserorgroup":this.options.adduserorgroup,"locationSelector":this.options.locationSelector,"displayStartLocation":this.options.displayStartLocation,"isNotDeleted":!(this.options.headerViewoptions.selectedGroup&&this.options.headerViewoptions.selectedGroup.get("right_id_expand").deleted),"title":this.options.title?this.options.title:l.dialogTitle,"addMemberTitle":l.AddMember}},"ui":{"addIcon":".csui-add-member.icon-toolbarAdd","memberPickerContainer":".csui-member-picker-container","viewSeparator":".csui-view-separator","headerTitle":".member-picker-view-header"},"events":{"click @ui.addIcon":"onAddMemberClick","keyup":"onKeyInView"},"onAddMemberClick":function(e){e.stopPropagation(),e.preventDefault(),this.ui.addIcon.addClass("binf-hidden"),this.ui.viewSeparator.removeClass("binf-hidden"),this.ui.headerTitle.html(l.AddUserOrGroup),this.editPermission&&this.showUserSearchView(e),this.trigger("enable:add")},"behaviors":{"TabableRegion":{"behaviorClass":o}},"currentlyFocusedElement":function(e){if(this.$el){var i=this.$("*[tabindex]:visible");return i.length&&i.prop("tabindex",0),!!i[0]&&t(i[0])}},"onKeyInView":function(e){13===e.keyCode&&t(e.target).hasClass("csui-add-member")&&t(e.target).trigger("click")},"initialize":function(){var e=this.options;e.locationSelector&&e.adduserorgroup&&(this.startLocationView=new s({"collection":this.options.locations,"title":this.options.dialogTitle,"selected":this.options.initialLocation}),e.placeHolder=void 0!==this.options.selectedMember?l.addAnotherNamePlaceHolder:l.userSearchPlaceHolder,e.addAnotherNamePlaceHolder=l.addAnotherNamePlaceHolder,this.options=e)},"onRender":function(){var e=this.options,t=this.options.authUser&&this.options.authUser.get("id"),i=this.options.headerViewoptions.selectedGroup&&this.options.headerViewoptions.selectedGroup.get("right_id_expand").leader_id,s=!1;i&&i===t&&(s=!0),this.editPermission=s||this.options.authUser&&this.options.authUser.get("privilege_user_admin_rights"),this.editPermission?this.ui.addIcon.removeClass("binf-hidden"):this.ui.addIcon.addClass("binf-hidden"),this.options.showUserPicker&&(this.ui.addIcon.addClass("binf-hidden"),this.showUserSearchView(),this.trigger("enable:add")),this.startLocationView&&e.adduserorgroup&&(this.startLocations.show(this.startLocationView),this.options.showUserPicker&&(this.showUserSearchView(),this.userSearchView.on("show:startLocation",this.showStartLocations,this),this.userSearchView.on("hide:startLocation",this.hideStartLocations,this)))},"showUserSearchView":function(e){this.userSearchView=new n(this.options),this.userSearch.show(this.userSearchView),this.userSearchView.userPickerIconClicked(e),this.userSearchView.on("show:selectItem",this.selectUsers,this)},"selectUsers":function(e){e&&this.trigger("show:selectItem",e)},"showStartLocations":function(){this.startLocationView.$el.removeClass("binf-hidden")},"hideStartLocations":function(){this.startLocationView.$el.addClass("binf-hidden")},"onDestroy":function(){this.startLocationView&&this.startLocationView.destroy()}})}),csui.define("csui/controls/wizard/step/impl/footer.view",["csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior"],function(e,t){var i=e.ItemView.extend({"tagName":"button","className":"binf-btn","template":!1,"triggers":{"click":"click"},"behaviors":{"TabableRegion":{"behaviorClass":t}},"constructor":function(t){e.View.prototype.constructor.apply(this,arguments)},"isTabable":function(){return this.$el.is(":not(:disabled)")&&this.$el.is(":not(:hidden)")},"currentlyFocusedElement":function(){return-1===this.$el.prop("tabindex")&&this.$el.prop("tabindex",0),this.$el},"onRender":function(){var e=this.$el,t=this.model.attributes;e.text(t.label),e.addClass(t.default?"binf-btn-primary cs-add-button":"binf-btn-default"),t.toolTip&&e.attr("title",t.toolTip),t.separate&&e.addClass("cs-separate"),this.updateButton(t)},"updateButton":function(e){var t=this.$el;e||(e={}),void 0!==e.hidden&&(e.hidden?t.addClass("binf-hidden"):t.removeClass("binf-hidden")),void 0!==e.disabled&&t.prop("disabled",e.disabled)}});return e.CollectionView.extend({"childView":i,"constructor":function(t){e.CollectionView.prototype.constructor.apply(this,arguments),this.listenTo(this,"update:button",this.selectedMemberCollection,this)},"onDomRefresh":function(){this.children.each(function(e){e.trigger("dom:refresh")})},"selectedMemberCollection":function(e){this.selectedMemberCollection=e},"getButtons":function(){return this.children.toArray()},"updateButton":function(e,t){var s=this.collection.get(e);s?this.children.findByModel(s).updateButton(t):!!i.updateButton&&i.updateButton(this.$('[data-cs-id="'+e+'"]'),t)},"getPreviousButton":function(){return this.children.toArray()[0]},"getNextButton":function(){var e=this.children.toArray();return e[e.length-1]}})}),csui.define("hbs!csui/controls/wizard/step/impl/step.header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return(null!=(n=t.if.call(e,null!=e?e.actionIconLeft:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.iconLeft:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:"")+'    <h4 class="tile-title binf-modal-title">'+this.escapeExpression((o=null!=(o=t.title||(null!=e?e.title:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+'</h4>\r\n  </div>\r\n\r\n    <div class="cs-header-control"></div>\r\n\r\n'+(null!=(n=t.if.call(e,null!=e?e.showCloseBtn:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")+"\r\n"},"2":function(e,t,i,s){var n;return'    <span class="tile-type-action-icon cs-icon-left '+this.escapeExpression((n=null!=(n=t.actionIconLeft||(null!=e?e.actionIconLeft:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"actionIconLeft","hash":{}}):n))+'" tabindex="0"></span>\r\n'},"4":function(e,t,i,s){var n;return'    <span class="tile-type-icon cs-icon-left '+this.escapeExpression((n=null!=(n=t.iconLeft||(null!=e?e.iconLeft:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"iconLeft","hash":{}}):n))+'"></span>\r\n    <div class="tile-title">\r\n'},"6":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.imageLeftUrl:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:""},"7":function(e,t,i,s){var n;return'        <div class="tile-type-image '+this.escapeExpression((n=null!=(n=t.imageLeftClass||(null!=e?e.imageLeftClass:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"imageLeftClass","hash":{}}):n))+'">\r\n          <img src="'+this.escapeExpression((n=null!=(n=t.imageLeftUrl||(null!=e?e.imageLeftUrl:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"imageLeftUrl","hash":{}}):n))+'" aria-hidden="true" alt="">\r\n        </div>\r\n      <div class="tile-title">\r\n'},"9":function(e,t,i,s){return'      <div class="tile-title cs-text-only">\r\n'},"11":function(e,t,i,s){var n;return'      <div class="cs-close" title="'+this.escapeExpression((n=null!=(n=t.dialogCloseButtonTooltip||(null!=e?e.dialogCloseButtonTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"dialogCloseButtonTooltip","hash":{}}):n))+'">\r\n        <div class="icon circular '+this.escapeExpression((n=null!=(n=t.iconRight||(null!=e?e.iconRight:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"iconRight","hash":{}}):n))+'" tabindex="0" aria-label="'+this.escapeExpression((n=null!=(n=t.dialogCloseAria||(null!=e?e.dialogCloseAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"dialogCloseAria","hash":{}}):n))+'"\r\n             role="button"></div>\r\n      </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.expandedHeader:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return i.registerPartial("csui_controls_wizard_step_impl_step.header",s),s}),csui.define("csui/controls/wizard/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/wizard/impl/nls/root/lang",{"dialogCloseButtonTooltip":"Close","dialogCloseAria":"Close dialog","back":"Back","next":"Next","cancel":"Cancel"}),csui.define("css!csui/controls/wizard/impl/wizard",[],function(){}),csui.define("csui/controls/wizard/step/impl/header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/controls/wizard/step/impl/step.header","i18n!csui/controls/wizard/impl/nls/lang","css!csui/controls/wizard/impl/wizard"],function(e,t,i,s,n,o){return i.ItemView.extend({"template":n,"behaviors":{"TabableRegion":{"behaviorClass":s}},"ui":{"headerControl":".cs-header-control"},"events":{"keydown":"onKeyInView"},"templateHelpers":function(){return{"iconLeft":this.options.iconLeft,"actionIconLeft":this.options.actionIconLeft,"imageLeftUrl":this.options.imageLeftUrl,"imageLeftClass":this.options.imageLeftClass,"title":this.options.title,"showCloseBtn":this.options.showCloseBtn,"iconRight":this.options.iconRight||"cs-icon-cross","expandedHeader":this.options.expandedHeader,"dialogCloseButtonTooltip":o.dialogCloseButtonTooltip,"dialogCloseAria":o.dialogCloseAria}},"constructor":function(e){i.View.prototype.constructor.apply(this,arguments)},"isTabable":function(){return this.$("*[tabindex]").length>0},"currentlyFocusedElement":function(e){var i=this.$("*[tabindex]");return i.length&&i.prop("tabindex",0),t(e&&e.shiftKey?i[i.length-1]:i[0])},"onLastTabElement":function(e,t){return e&&t.target===this.$("*[tabindex]")[0]},"onKeyInView":function(e){var i=e.keyCode;13!==i&&32!==i||t(e.target).click()},"onRender":function(){var t=this.options.headers||[];t.length&&e.each(t,function(e){var t=this._renderHeader(e);this.$el.append(t)},this);var i=this.options.headerControl;i&&(this.ui.headerControl.append(i.$el),i.render(),i.trigger("dom:refresh")),this.options.actionIconLeft&&this._adjustTitleCSS()},"onDomRefresh":function(){var e=this.options.headerControl;e&&(e.triggerMethod("dom:refresh"),e.triggerMethod("after:show"))},"_renderHeader":function(e){var i=t('<div class="modal-header-item"></div>').text(e.label);return e.class&&i.addClass(e.class),e.id&&i.attr("id",e.id),i},"_adjustTitleCSS":function(e){this.$el.find("div.tile-title").addClass("tile-action-icon-tittle")}})}),csui.define("hbs!csui/controls/wizard/step/impl/wizard.step",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'  <div class="binf-modal-dialog binf-modal-lg">\r\n'},"3":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.midSize:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:""},"4":function(e,t,i,s){return'    <div class="binf-modal-dialog binf-modal-md">\r\n'},"6":function(e,t,i,s){return'    <div class="binf-modal-dialog">\r\n'},"8":function(e,t,i,s){var n;return'      <div class="binf-modal-body cs-dialog cs-dialog-bodymessage">'+this.escapeExpression((n=null!=(n=t.bodyMessage||(null!=e?e.bodyMessage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"bodyMessage","hash":{}}):n))+"</div>\r\n"},"10":function(e,t,i,s){return'      <div class="binf-modal-body"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return(null!=(n=t.if.call(e,null!=e?e.largeSize:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'\r\n  <div class="binf-modal-content" aria-label="'+this.escapeExpression((o=null!=(o=t.dialogTxtAria||(null!=e?e.dialogTxtAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"dialogTxtAria","hash":{}}):o))+'">\r\n\r\n    <div class="tile-header binf-modal-header"></div>\r\n\r\n'+(null!=(n=t.if.call(e,null!=e?e.bodyMessage:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.program(10,s,0)}))?n:"")+'\r\n    <div class="binf-modal-footer binf-hidden"></div>\r\n\r\n  </div>\r\n\r\n</div>\r\n'}});return i.registerPartial("csui_controls_wizard_step_impl_wizard.step",s),s}),csui.define("csui/controls/wizard/step/wizard.step.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabables.behavior","csui/controls/wizard/step/impl/footer.view","csui/controls/wizard/step/impl/header.view","hbs!csui/controls/wizard/step/impl/wizard.step","csui/utils/log","i18n!csui/controls/wizard/impl/nls/lang","i18n"],function(e,t,i,s,n,o,r,l,a,c,u,d,h){u=u(e.id);var p=n.LayoutView.extend({"className":function(){var e="cs-wizard-step cs-dialog binf-modal binf-fade";return this.options.className&&(e+=" "+t.result(this.options,"className")),e},"attributes":{"tabindex":"-1","role":"dialog","aria-hidden":"true"},"template":c,"behaviors":{"TabablesBehavior":{"behaviorClass":r,"recursiveNavigation":!0,"containTabFocus":!0}},"regions":{"body":".binf-modal-body","header":".binf-modal-header","footer":".binf-modal-footer"},"ui":{"header":".binf-modal-header","footer":".binf-modal-footer","body":".binf-modal-body"},"events":{"hide.binf.modal":"onHiding","hidden.binf.modal":"onHidden","click .cs-close":"onClickClose","shown.binf.modal":"onShown","keyup":"onKeyInView","setCurrentTabFocus":"setCurrentTabFocus","tabNextRegion":"tabNextRegion","click .tile-type-action-icon":"onClickActionIcon"},"templateHelpers":function(){return{"largeSize":this.options.largeSize,"midSize":this.options.midSize,"bodyMessage":this.options.bodyMessage,"dialogTxtAria":this.options.dialogTxtAria}},"constructor":function(){n.LayoutView.prototype.constructor.apply(this,arguments),this.listenToOnce(this,"before:hide",r.popTabableHandler),this.propagateEventsToRegions()},"onKeyInView":function(e){27===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.destroy(),this.trigger("close:wizard"))},"setCurrentTabFocus":function(){this.focusOnLastRegion=!0,this.$el.focus()},"tabNextRegion":function(){this.trigger("changed:focus")},"onRender":function(){this.$el.addClass(p.prototype.className.call(this)).attr("tabindex",0),this._renderHeader(),this.options.view&&this.body.show(this.options.view),this._renderFooter()},"onShow":function(){i(window).scrollTop(0),this.$el.binf_modal({"backdrop":"static","keyboard":!1,"paddingWhenOverflowing":!1})},"kill":function(){return p.__super__.destroy.apply(this,arguments),this._scrollToBegin(),!0},"destroy":function(){return this.$el.is(":visible")?(this.$el.binf_modal("hide"),i("body").removeClass("binf-modal-open")):p.__super__.destroy.apply(this,arguments),this._scrollToBegin(),this},"updateButton":function(e,t){var i=this.footerView;if(!i.updateButton)throw new Error("Dialog footer does not support button updating.");i.updateButton(e,t)},"showView":function(e){this.body.show(e),e.triggerMethod("after:show")},"onShown":function(){this.options.view&&(this.options.view.triggerMethod("dom:refresh"),this.options.view.triggerMethod("after:show")),this.headerView&&(this.headerView.triggerMethod("dom:refresh"),this.headerView.triggerMethod("after:show")),this.footerView&&(this.footerView.triggerMethod("dom:refresh"),this.footerView.triggerMethod("after:show"))},"onHiding":function(){this.triggerMethod("before:hide")},"onHidden":function(){this.triggerMethod("hide"),this.destroy()},"onClickClose":function(e){e.preventDefault(),e.stopPropagation(),this.trigger("close:wizard")},"onClickActionIcon":function(e){this.options.view.trigger("click:actionIcon")},"onClickButton":function(e){if("Add"===e.model.get("id"))this.trigger("add:member");else{var t=e.model.attributes;t.click&&t.click({"dialog":this,"button":this.$el}),t.close&&this.trigger("close:wizard")}},"_scrollToBegin":function(){if(!0===h.settings.rtl){var e=i("body").width();i("body").scrollLeft(e)}else i("body").scrollLeft(0),i(".csui-add-permission").focus()},"_renderHeader":function(){var e=this.headerView=this.options.headerView,t=void 0!==this.options.standardHeader?this.options.standardHeader:!this.options.template;if(e&&(e.editpermission=!!this.options.wizard&&!!this.options.wizard.edit_permission&&this.options.wizard.edit_permission),e)this.header.show(e);else{var i={"iconLeft":this.options.iconLeft,"actionIconLeft":this.options.actionIconLeft,"imageLeftUrl":this.options.imageLeftUrl,"imageLeftClass":this.options.imageLeftClass,"title":this.options.title,"iconRight":this.options.iconRight||"cs-icon-cross","headers":this.options.headers,"headerControl":this.options.headerControl,"expandedHeader":t,"el":this.ui.header[0]};e=this.headerView=new a(i),e.render(),this.header.attachView(e),this.headerView.trigger("dom:refresh")}},"_renderFooter":function(){var e=this.footerView=this.options.footerView;if(e)this.ui.footer.removeClass("binf-hidden"),this.footer.show(e);else{var i=[];this.options.isFirstStep||i.push({"id":"previous","label":this.options.previousButtonLabel||d.back,"toolTip":this.options.previousButtonLabel||d.back,"default":!1,"disabled":!1,"separate":!0,"click":t.bind(this.onClickPreviousButton,this)});var n={"id":"next","label":this.options.nextButtonLabel||d.next,"toolTip":this.options.nextButtonLabel||d.next,"default":!0,"disabled":void 0===this.options.disableNext||this.options.disableNext,"click":t.bind(this.onClickNextButton,this)},o={"id":"done","label":this.options.doneButtonLabel||d.next,"toolTip":this.options.doneButtonLabel||d.next,"default":!0,"disabled":void 0===this.options.disableDone||this.options.disableDone,"click":t.bind(this.onClickDoneButton,this)};this.options.nextButton?i.push(n):this.options.doneButton&&i.push(o),i.push({"id":"cancel","label":d.cancel,"toolTip":d.cancel,"close":!0});var r=this.options.buttons||i;r.length&&this.ui.footer.removeClass("binf-hidden"),e=this.footerView=new l({"collection":new s.Collection(r),"wizardView":this,"el":this.ui.footer[0]}),this.listenTo(e,"childview:click",this.onClickButton),e.render(),this.footer.attachView(e)}},"showPreviousButton":function(){this.footer.currentView.getPreviousButton().$el.removeClass("binf-hidden")},"hidePreviousButton":function(){this.footer.currentView.getPreviousButton().$el.addClass("binf-hidden")},"validate":function(){return!this.body.currentView||!this.body.currentView.validate||this.body.currentView.validate()},"onClickNextButton":function(){this.trigger("next:clicked")},"onClickDoneButton":function(){this.trigger("done:clicked")},"onClickPreviousButton":function(){this.trigger("previous:clicked")}});return t.extend(p.prototype,o),p}),csui.define("hbs!csui/controls/wizard/impl/wizard",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return""}});return i.registerPartial("csui_controls_wizard_impl_wizard",s),s}),csui.define("csui/controls/wizard/wizard.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabables.behavior","csui/controls/wizard/step/wizard.step.view","hbs!csui/controls/wizard/impl/wizard","csui/utils/non-emptying.region/non-emptying.region","csui/utils/log","i18n","css!csui/controls/wizard/impl/wizard","csui/lib/binf/js/binf"],function(e,t,i,s,n,o,r,l,a,c,u,d){var h=n.LayoutView.extend({"id":"wizard","template":a,"behaviors":{"TabablesBehavior":{"behaviorClass":r,"recursiveNavigation":!0,"containTabFocus":!0}},"className":function(){var e="cs-wizard";return this.options.className&&(e+=" "+t.result(this.options,"className")),e},"templateHelpers":function(){return{}},"constructor":function(e){e||(e={}),n.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"initialize":function(){this.currentStep=0,this.stepViews=[],this.direction="right"},"show":function(e){var t=i.fn.binf_modal.getDefaultContainer(),s=new c({"el":t});return this.edit_permission=e.editpermission,s.show(this),this},"onRender":function(){return this.renderCurrentStep(),this},"renderCurrentStep":function(){if(this.currentView=this.getCurrentView(),this.currentView._isRendered)this.showCurrentView();else{new c({"el":this.el}).show(this.currentView)}},"getCurrentView":function(){if(this.currentStep<this.stepViews.length)return this.stepViews[this.currentStep];var e=this.currentStep,i=new l(t.extend(this.options.steps[e],{"wizard":this,"isFirstStep":this.isFirstStep()}));return this.stepViews.push(i),this.listenTo(i,"next:clicked",this.nextStep).listenTo(i,"previous:clicked",this.prevStep).listenTo(i,"done:clicked",this.save).listenTo(i,"add:member",this.addMember).listenTo(i,"close:wizard",this.closeWizard),i},"nextStep":function(){this.currentView.validate()&&(this.isLastStep()?this.save():(this.hideCurrentView(),this.currentStep+=1,this.direction=d&&d.settings.rtl?"left":"right",this.renderCurrentStep()))},"prevStep":function(){this.isFirstStep()||(this.hideCurrentView(),this.currentStep-=1,this.direction=d&&d.settings.rtl?"right":"left",this.renderCurrentStep())},"hideCurrentView":function(){this.currentView.$el.addClass("binf-hidden")},"showCurrentView":function(){this.currentView.$el.removeClass("binf-hidden")},"addDirection":function(){this.currentView.$el.find(".binf-modal-dialog").removeClass("left"),this.currentView.$el.find(".binf-modal-dialog").removeClass("right"),this.currentView.$el.find(".binf-modal-dialog").addClass(this.direction)},"updateButton":function(e,t){if(!this.currentView.updateButton)throw new Error("Dialog footer does not support button updating.");this.currentView.updateButton(e,t)},"save":function(){this.trigger("save:result")},"addMember":function(){this.trigger("add:member")},"isFirstStep":function(){return 0===this.currentStep},"isLastStep":function(){return this.currentStep===this.options.steps.length-1},"onBeforeDestroy":function(){t.each(this.stepViews,function(e,t){e.destroy()})},"closeWizard":function(){this.trigger("closing:wizard"),this.destroy()},"getStepViewByStepNumber":function(e){return this.stepViews&&e<this.stepViews.length?this.stepViews[e]:null}});return t.extend(h.prototype,o),h}),csui.define("hbs!csui/widgets/permissions/impl/edit/permission.level.selector/impl/permission.level.selector",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n
;return'    <li class="csui-permission-level-item" data-optionid="'+this.escapeExpression(this.lambda(null!=e?e.id:e,e))+'" role="listitem"\r\n        aria-label="'+this.escapeExpression(this.lambda(null!=e?e.name:e,e))+'">\r\n      <a tabindex="-1" href="#">\r\n        <span class="cs-icon"></span>\r\n        <span class="cs-label">'+this.escapeExpression(this.lambda(null!=e?e.name:e,e))+"</span>\r\n"+(null!=(n=t.if.call(e,null!=e?e.showActionIcon:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+"      </a>\r\n    </li>\r\n"},"2":function(e,t,i,s){return'          <span class="csui-icon '+this.escapeExpression(this.lambda(null!=e?e.actionIcon:e,e))+'"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<ul class="csui-permission-levels" role="listbox">\r\n'+(null!=(n=t.each.call(e,null!=e?e.permissionLevelOptions:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"</ul>\r\n"}});return i.registerPartial("csui_widgets_permissions_impl_edit_permission.level.selector_impl_permission.level.selector",s),s}),csui.define("csui/widgets/permissions/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/permissions/impl/nls/root/lang",{"properties":"Properties","versions":"Versions","general":"General","UserPickerPlaceHolder":"Enter name or group","PermissionLookupPlaceHolder":"Enter name or group for permissions lookup","right_id":"User / Group","permission_level":"Permission level","goBackTooltip":"Go back","emptyPermissionListMsg":"{0} was not found in this permissions list.","addMemberToGroup":"Add {0} as a member to a group that currently has permissions","grantAccessToMember":"Grant access to a group in which {0} is already a member","permissionLevelFullControl":"Full control","permissionLevelWrite":"Write","permissionLevelRead":"Read","permissionLevelCustom":"Custom...","permissionLevelNone":"None","FullControl":"Full control","Write":"Write","Read":"Read","Custom":"Custom","None":"None","see":"See","see_contents":"See contents","modify":"Modify","edit_attributes":"Edit attributes","add_items":"Add items","reserve":"Reserve","delete_versions":"Delete version","delete":"Delete","edit_permissions":"Edit permissions","saveButtonLabel":"Ok","cancelButtonLabel":"Cancel","applyButtonLabel":"Apply","AddDropdownTitle":"Add","AddUserOrGroup":"Add user or group","NoOwnerAssigned":"No owner assigned","addMajorVersion":"Add major version","allUsersAndGroups":"Users and Groups","addUsersAndGroups":"Add users or groups","addButtonLabel":"Add","addButtonTooltip":"Add member to group","cancelButtonTooltip":"Close dialog","noPermissionsAvailable":"Permissions page is not available for {0}"});csui.define("css!csui/widgets/permissions/impl/permissions",[],function(){}),csui.define("csui/widgets/permissions/impl/edit/permission.level.selector/permission.level.selector.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/models/permission/nodepermission.model","hbs!csui/widgets/permissions/impl/edit/permission.level.selector/impl/permission.level.selector","i18n!csui/widgets/permissions/impl/nls/lang","css!csui/widgets/permissions/impl/permissions","csui/lib/binf/js/binf"],function(e,t,i,s,n,o,r){"use strict";return i.ItemView.extend({"_permissionLevelOptions":void 0,"selected":void 0,"openSelectedProperties":!1,"className":"cs-permission-level-selector","template":o,"behaviors":{"TabableRegion":{"behaviorClass":s}},"events":{"click li[data-optionid]":"onClickOption","keydown":"onKeyInView"},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)},"initialize":function(){this.focusIndex=0,this._setupPermissionLevelOptions();var t=this.options.selected||this.options.permissionModel.getPermissionLevel();-1!==e.indexOf(e.pluck(this._permissionLevelOptions,"id"),t)?this._setSelected(t):this._setSelected(n.PERMISSION_LEVEL_NONE)},"onKeyInView":function(e){var i=e.keyCode,s=this.$el.find("a[tabindex]");if(s.length)if(13===e.keyCode)t(s[this.focusIndex]).parent().click(),e.stopPropagation(),e.preventDefault();else if(38===i||40===i)38===i?this.focusIndex>0&&--this.focusIndex:this.focusIndex<s.length-1&&++this.focusIndex,t(s[this.focusIndex]).focus(),e.stopPropagation(),e.preventDefault();else if(9===i){var n=this.$el.parents("body").find(".csui-edit-permission-popover-container .binf-popover");n.binf_popover("destroy")}},"onClickOption":function(e){e.preventDefault(),e.stopPropagation(),this._setSelected(parseInt(t(e.currentTarget).attr("data-optionid"))),this._showSelected(),this.trigger("permission:level:selected"),this.$el.trigger("setCurrentTabFocus")},"templateHelpers":function(){return{"permissionLevelOptions":this._permissionLevelOptions}},"currentlyFocusedElement":function(){var e=this.$el.find("a[tabindex]");if(e.length)return t(e[this.focusIndex])},"accDeactivateTabableRegion":function(){},"onRender":function(){this._showSelected()},"_getOptionName":function(t){var i;return i=e.indexOf(e.pluck(this._permissionLevelOptions,"id"),t),-1===i?"":this._permissionLevelOptions[i].name},"_setupPermissionLevelOptions":function(){this._permissionLevelOptions=[{"id":n.PERMISSION_LEVEL_NONE,"name":r.permissionLevelNone},{"id":n.PERMISSION_LEVEL_READ,"name":r.permissionLevelRead},{"id":n.PERMISSION_LEVEL_WRITE,"name":r.permissionLevelWrite},{"id":n.PERMISSION_LEVEL_FULL_CONTROL,"name":r.permissionLevelFullControl},{"id":n.PERMISSION_LEVEL_CUSTOM,"name":r.permissionLevelCustom,"showActionIcon":!0}]},"_setSelected":function(e){this.selected=e},"_showSelected":function(){var e=this.$el.find("li[data-optionid]");e.find(".cs-icon").removeClass("icon-listview-checkmark"),e.removeAttr("aria-selected");var t=this.$el.find("li[data-optionid="+this.selected+"]");t.find(".cs-icon").addClass("icon-listview-checkmark"),t.attr("aria-selected","true")},"_showOpenSelectedProperties":function(){!0===this.openSelectedProperties?(this.ui.toggle.attr("aria-expanded","true"),this.ui.iconOpenSelectedProperties.removeClass("icon-checkbox").addClass("icon-checkbox-selected")):(this.ui.toggle.attr("aria-expanded","false"),this.ui.iconOpenSelectedProperties.removeClass("icon-checkbox-selected").addClass("icon-checkbox"))},"getSelectedPermissions":function(){return n.getPermissionsByLevelExceptCustom(this.selected,this.options.isContainer)}})}),csui.define("hbs!csui/controls/tree/impl/treeview",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return'  <div class="csui-tree-child '+(null!=(n=t.if.call(e,null!=e?e.nodeSplit:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+" "+(null!=(n=t.if.call(e,null!=e?e.nodeClass:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?n:"")+'">\r\n      <input type="checkbox" id="node_'+this.escapeExpression((o=null!=(o=t.nodeId||(null!=e?e.nodeId:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeId","hash":{}}):o))+'" tabindex="-1" name="'+this.escapeExpression((o=null!=(o=t.nodeId||(null!=e?e.nodeId:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeId","hash":{}}):o))+'"\r\n             aria-label="'+this.escapeExpression((o=null!=(o=t.nodeName||(null!=e?e.nodeName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeName","hash":{}}):o))+'" class="csui-tree-checkbox\r\n    '+(null!=(n=t.if.call(e,null!=e?e.readonly:e,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.noop}))?n:"")+'" '+(null!=(n=t.if.call(e,null!=e?e.readonly:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.program(13,s,0)}))?n:"")+'>\r\n    <label for="node_'+this.escapeExpression((o=null!=(o=t.nodeId||(null!=e?e.nodeId:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeId","hash":{}}):o))+'"></label>\r\n    <span class="csui-node-name">'+this.escapeExpression((o=null!=(o=t.nodeName||(null!=e?e.nodeName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeName","hash":{}}):o))+"</span>\r\n"+(null!=(n=t.if.call(e,null!=e?e.nodeSplit:e,{"name":"if","hash":{},"fn":this.program(16,s,0),"inverse":this.noop}))?n:"")+"  </div>\r\n  <ul></ul>\r\n"},"2":function(e,t,i,s){var n;return" "+this.escapeExpression((n=null!=(n=t.splitClass||(null!=e?e.splitClass:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"splitClass","hash":{}}):n))},"4":function(e,t,i,s){return" nodeClass"},"6":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.checked:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:""},"7":function(e,t,i,s){return"  icon-checkbox-on_disabled\r\n    "},"9":function(e,t,i,s){return" icon-checkbox-disabled"},"11":function(e,t,i,s){return"disabled "},"13":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.checked:e,{"name":"if","hash":{},"fn":this.program(14,s,0),"inverse":this.noop}))?n:""},"14":function(e,t,i,s){return' tabindex="-1"  checked'},"16":function(e,t,i,s){var n;return'      <div class="csui-tree-split '+this.escapeExpression((n=null!=(n=t.splitClass||(null!=e?e.splitClass:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"splitClass","hash":{}}):n))+'">\r\n        <div class="csui-splitcontrol-label">\r\n          <span>'+this.escapeExpression((n=null!=(n=t.splitName||(null!=e?e.splitName:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"splitName","hash":{}}):n))+'</span>\r\n        </div>\r\n      </div>\r\n      <div class="csui-separator"></div>\r\n'},"18":function(e,t,i,s){var n,o;return'    <div class="csui-tree-child '+(null!=(n=t.if.call(e,null!=e?e.nodeSplit:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+'">\r\n      <input type="checkbox" id="node_'+this.escapeExpression((o=null!=(o=t.nodeId||(null!=e?e.nodeId:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeId","hash":{}}):o))+'" name="'+this.escapeExpression((o=null!=(o=t.nodeId||(null!=e?e.nodeId:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeId","hash":{}}):o))+'"\r\n             aria-label="'+this.escapeExpression((o=null!=(o=t.nodeName||(null!=e?e.nodeName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeName","hash":{}}):o))+'"  tabindex="-1" class="csui-tree-checkbox\r\n             '+(null!=(n=t.if.call(e,null!=e?e.nodeClass:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.noop}))?n:"")+"\r\n        "+(null!=(n=t.if.call(e,null!=e?e.readonly:e,{"name":"if","hash":{},"fn":this.program(19,s,0),"inverse":this.noop}))?n:"")+'" '+(null!=(n=t.if.call(e,null!=e?e.readonly:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.program(22,s,0)}))?n:"")+'>\r\n      <label for="node_'+this.escapeExpression((o=null!=(o=t.nodeId||(null!=e?e.nodeId:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeId","hash":{}}):o))+'"></label>\r\n      <span class="csui-node-name">'+this.escapeExpression((o=null!=(o=t.nodeName||(null!=e?e.nodeName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"nodeName","hash":{}}):o))+"</span>\r\n"+(null!=(n=t.if.call(e,null!=e?e.nodeSplit:e,{"name":"if","hash":{},"fn":this.program(25,s,0),"inverse":this.noop}))?n:"")+"    </div>\r\n"},"19":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.checked:e,{"name":"if","hash":{},"fn":this.program(20,s,0),"inverse":this.program(9,s,0)}))?n:""},"20":function(e,t,i,s){return" icon-checkbox-on_disabled\r\n    "},"22":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.checked:e,{"name":"if","hash":{},"fn":this.program(23,s,0),"inverse":this.noop}))?n:""},"23":function(e,t,i,s){return" checked"},"25":function(e,t,i,s){var n;return'        <div class="csui-tree-split '+this.escapeExpression((n=null!=(n=t.splitClass||(null!=e?e.splitClass:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"splitClass","hash":{}}):n))+'">\r\n          <div class="csui-splitcontrol-label">\r\n            <span>'+this.escapeExpression((n=null!=(n=t.splitName||(null!=e?e.splitName:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"splitName","hash":{}}):n))+'</span>\r\n          </div>\r\n        </div>\r\n        <div class="csui-separator"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.isNodesExists:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(18,s,0)}))?n:""}});return i.registerPartial("csui_controls_tree_impl_treeview",s),s}),csui.define("css!csui/controls/tree/impl/treeview",[],function(){}),csui.define("csui/controls/tree/tree.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","hbs!csui/controls/tree/impl/treeview","css!csui/controls/tree/impl/treeview"],function(e,t,i,s,n,o){"use strict";var r=n.CompositeView.extend({"template":o,"templateHelpers":function(){return{"isNodesExists":!!(this.model.nodes&&this.model.nodes.length>0),"readonly":!!this.model.attributes&&this.model.attributes.readonly}},"tagName":"li","childViewContainer":"ul","className":"csui-tree-root","events":{"click input.csui-tree-checkbox":"onNodeClicked"},"initialize":function(){this.collection=this.model.nodes},"onNodeClicked":function(e){this.trigger("Node:clicked",e.target)}});return n.CollectionView.extend({"tagName":"ul","className":"csui-tree-container","childView":r,"childEvents":{"Node:clicked":"onChildNodeClicked"},"onChildNodeClicked":function(e,t){t.checked?this.trigger("node:selected",t):this.trigger("node:unselected",t)}})}),csui.define("csui/models/permission/permissionlevel",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone"],function(e,t,i,s){"use strict";var n=s.Model.extend({"initialize":function(){var e=this.get("nodes");e&&(this.nodes=new o(e),this.unset("nodes"))}}),o=s.Collection.extend({"model":n});return o}),csui.define("csui/widgets/permissions/impl/edit/permission.attributes/impl/permission.attributes.data",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/models/permission/permissionlevel","i18n!csui/widgets/permissions/impl/nls/lang"],function(e,t,i,s,n){function o(e){var t=!1!==e.readonly,i=e.permissions||[],o=[{"nodeName":n.see,"nodeId":"see","readonly":t,"checked":i.indexOf("see")>=0,"nodes":[{"nodeName":n.see_contents,"nodeId":"see_contents","nodeClass":"","nodeSplit":!0,"splitName":n.Read,"splitClass":"csui-split-read","readonly":t,"checked":i.indexOf("see_contents")>=0},{"nodeName":n.modify,"nodeId":"modify","readonly":t,"checked":i.indexOf("modify")>=0,"nodes":[{"nodeName":n.edit_attributes,"nodeId":"edit_attributes","readonly":t,"checked":i.indexOf("edit_attributes")>=0},{"nodeName":n.reserve,"nodeId":"reserve","readonly":t,"checked":i.indexOf("reserve")>=0,"nodes":[{"nodeName":n.addMajorVersion,"nodeId":"add_major_version","readonly":t,"checked":i.indexOf("add_major_version")>=0}]},{"nodeName":n.delete_versions,"nodeId":"delete_versions","readonly":t,"checked":i.indexOf("delete_versions")>=0,"nodes":[{"nodeName":n.delete,"nodeId":"delete","nodeSplit":!0,"splitName":n.Write,"splitClass":"csui-split-write","readonly":t,"checked":i.indexOf("delete")>=0,"nodes":[{"nodeName":n.edit_permissions,"nodeId":"edit_permissions","nodeSplit":!0,"splitName":n.FullControl,"splitClass":"csui-split-fullcontrol","readonly":t,"checked":i.indexOf("edit_permissions")>=0}]}]}]}]}];return e.node&&e.node.get("container")&&o[0].nodes[1].nodes.splice(1,0,{"nodeName":n.add_items,"nodeId":"add_items","readonly":t,"checked":i.indexOf("add_items")>=0}),new s(o)}return{"getPermissionAttributes":o}}),csui.define("hbs!csui/widgets/permissions/impl/edit/permission.attributes/impl/permission.attributes",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <div class="csui-permission-attribute-buttons-container">\r\n    <button class="cs-save-btn binf-btn binf-btn-primary\r\n  binf-btn-default" tabindex="-1">'+this.escapeExpression((n=null!=(n=t.save_button_label||(null!=e?e.save_button_label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"save_button_label","hash":{}}):n))+'</button>\r\n    <button class="cs-cancel-btn binf-btn binf-btn-default"\r\n            tabindex="-1">'+this.escapeExpression((n=null!=(n=t.cancel_button_label||(null!=e?e.cancel_button_label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cancel_button_label","hash":{}}):n))+"</button>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-permission-attribute-tree"></div>\r\n\r\n'+(null!=(n=t.if.call(e,null!=e?e.showButtons:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("csui_widgets_permissions_impl_edit_permission.attributes_impl_permission.attributes",s),s}),csui.define("csui/widgets/permissions/impl/edit/permission.attributes/permission.attributes.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/base","i18n","csui/behaviors/keyboard.navigation/tabables.behavior","csui/controls/tree/tree.view","csui/widgets/permissions/impl/edit/permission.attributes/impl/permission.attributes.data","hbs!csui/widgets/permissions/impl/edit/permission.attributes/impl/permission.attributes","i18n!csui/widgets/permissions/impl/nls/lang"],function(e,t,i,s,n,o,r,l,a,c){return i.LayoutView.extend({"className":"csui-permission-attributes","template":a,"regions":{"treeRegion":".csui-permission-attribute-tree"},"events":{"click button.cs-save-btn":"onClickSave","click button.cs-cancel-btn":"onClickCancel","keydown":"_handleKeyEvents"},"behaviors":{"TabablesBehavior":{"behaviorClass":o}},"_handleKeyEvents":function(t){var i=this.$el.find("input.csui-tree-checkbox");t&&t.shiftKey&&9===t.keyCode?e(i[i.length]).focus():"Cancel"===t.target.textContent&&9===t.keyCode&&i.length&&e(i[0]).focus()},"currentlyFocusedElement":function(t){var i=this.$("*[tabindex]");return i.length&&i.prop("tabindex",0),e(t&&t.shiftKey?i[i.length-1]:i[0])},"templateHelpers":function(){var e=this.options.showButtons;return void 0===e&&(e=!this.options.readonly),{"save_button_label":c.saveButtonLabel,"cancel_button_label":c.cancelButtonLabel,"showButtons":e}},"constructor":function(e){e||(e={}),i.LayoutView.prototype.constructor.call(this,e),this.options=e,this.focusIndex=0},"onRender":function(){var e=l.getPermissionAttributes({"readonly":this.options.readonly,"node":this.options.node,"permissions":this.options.permissions||this.model.get("permissions")});this.treeView=new r({"collection":e}),this.treeRegion.show(this.treeView),this.listenTo(this.treeView,"node:selected",this.onPermissionNodeSelected),this.listenTo(this.treeView,"node:unselected",this.onPermissionNodeUnselected)},"onPermissionNodeSelected":function(e){var t,i=this.treeView;t="edit_permissions"===e.attributes.name.value?i.$el.find("input.csui-tree-checkbox"):i.$el.find(e).closest(".csui-tree-root").parents(".csui-tree-root").children(".csui-tree-child").find("input.csui-tree-checkbox"),t.prop("checked",!0),t.length&&(i.$el.find("#node_see_contents")[0].checked=!0)},"onPermissionNodeUnselected":function(e){var t,i=this.treeView;"see_contents"===e.attributes.name.value?t=i.$el.find(e).closest(".csui-tree-root").siblings(".csui-tree-root").find("input.csui-tree-checkbox"):(t=i.$el.find(e).closest(".csui-tree-root").children("ul").find("input.csui-tree-checkbox"),t.length&&"reserve"!==e.attributes.name.value||(i.$el.find("#node_edit_permissions")[0].checked=!1)),t.prop("checked",!1)},"onClickSave":function(){var e=this.getSelectedPermissions();this.trigger("permission:attribute:save:clicked",e)},"onClickCancel":function(){this.trigger("permission:attribute:cancel:clicked")},"onDestroy":function(){},"getSelectedPermissions":function(){for(var e=this.treeView.$el.find("input.csui-tree-checkbox"),t=[],i=0;i<e.length;i++)e[i].checked&&t.push(e[i].name);return t}})}),csui.define("hbs!csui/widgets/permissions/impl/edit/apply.permission/impl/apply.permission",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-apply-permission-content">\r\n  <span class="csui-apply-permission-message"></span>\r\n</div>\r\n<div class="csui-apply-permission-subfolder-container">\r\n  <div class="csui-apply-permission-sub-folder">\r\n    <span class="csui-apply-permission-sub-folder-label"></span>\r\n    <div class="required-fields-switch"></div>\r\n  </div>\r\n  <div class="csui-apply-permission-subitems-container">\r\n    <div class="csui-apply-subitems-message"></div>\r\n  </div>\r\n</div>'}});return i.registerPartial("csui_widgets_permissions_impl_edit_apply.permission_impl_apply.permission",s),s}),csui.define("hbs!csui/widgets/permissions/impl/edit/apply.permission/impl/include.subitems",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <div class="csui-selected-checkbox csui-slice-checkbox csui-checkbox-primary\r\n  csui-permisison-subItem">\r\n    <input type="checkbox" class="csui-subtypes-option" name="'+this.escapeExpression((n=null!=(n=t.itemName||(null!=e?e.itemName:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"itemName","hash":{}}):n))+'" id="'+this.escapeExpression((n=null!=(n=t.value||(null!=e?e.value:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'"\r\n           value="'+this.escapeExpression((n=null!=(n=t.value||(null!=e?e.value:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'">\r\n    <label class="csui-subtype-name" for="'+this.escapeExpression((n=null!=(n=t.itemName||(null!=e?e.itemName:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"itemName","hash":{}}):n))+'" title="'+this.escapeExpression((n=null!=(n=t.itemName||(null!=e?e.itemName:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"itemName","hash":{}}):n))+'">\r\n      <span class="cs-ellipsis">'+this.escapeExpression((n=null!=(n=t.itemName||(null!=e?e.itemName:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"itemName","hash":{}}):n))+"\r\n        ("+this.escapeExpression((n=null!=(n=t.total||(null!=e?e.total:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"total","hash":{}}):n))+" "+this.escapeExpression((n=null!=(n=t.itemTitle||(null!=e?e.itemTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"itemTitle","hash":{}}):n))+")\r\n  </span>\r\n    </label>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.each.call(e,null!=e?e.subItems:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return i.registerPartial("csui_widgets_permissions_impl_edit_apply.permission_impl_include.subitems",s),s}),csui.define("csui/widgets/permissions/impl/edit/apply.permission/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/permissions/impl/edit/apply.permission/impl/nls/root/lang",{"applyPermissionHeaderTitle":"Apply permissions","removePermissionHeaderTitle":"Remove {0}","restorePublicAccessHeaderTitle":"Restore public access","applytoSubFolder":"Apply to sub-folders","applytoSubFolderWithCount":"Apply to sub-folders ( {0} )","applyToSubItemsTitle":"Include special items in {0} and sub-folders","applyToItem":"Permissions will be applied to all items in {0}.","applyToThresholdExceeded":"Permissions will be applied to large number of items in {0}.","removeThresholdExceeded":"Permissions will be removed from large number of items in {0}","removeToItem":"Permissions will be removed from all items in {0}","includeSubItems":"Including {0}","publicAccess":"Public Access","item":"item","items":"items","204":"Task lists","207":"Channels","215":"Discussions","298":"Collections","3030202":"Communities"}),csui.define("csui/widgets/permissions/impl/edit/apply.permission/apply.permission.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/models/permission/nodepermission.model","hbs!csui/widgets/permissions/impl/edit/apply.permission/impl/apply.permission","hbs!csui/widgets/permissions/impl/edit/apply.permission/impl/include.subitems","i18n!csui/widgets/permissions/impl/edit/apply.permission/impl/nls/lang","csui/utils/taskqueue","csui/lib/handlebars.helpers.xif","css!csui/widgets/permissions/impl/permissions"],function(e,t,i,s,n,o,r,l,a,c,u){"use strict";var d=e.config();return t.defaults(d,{"parallelism":5}),n.ItemView.extend({"className":"csui-apply-permission","template":l,"includeSubitemsTemplate":a,"ui":{"applyPermissionMsg":".csui-apply-permission-message","appplyToSubFolderContainer":".csui-apply-permission-sub-folder","appplyToSubFolder":".csui-apply-permission-sub-folder-label","applyToSubItemsContainer":"csui-apply-permission-subitems-container","applyToSubItemsTitle":".csui-apply-subitems-message","subItemsCheckBox":".csui-subtypes-option"},"behaviors":{"TabableRegion":{"behaviorClass":o}},"events":{"keydown":"onKeyInView"},"constructor":function(e){var i=this;i._=t,i.userSelectionCount=0,e||(e={}),n.ItemView.prototype.constructor.apply(this,arguments)},"initialize":function(){this.focusIndex=0},"onKeyInView":function(e){var t=e.keyCode,s=this.$el.find("*[tabindex]");s.length&&(13===e.keyCode?(i(s[this.focusIndex]).parent().click(),e.stopPropagation(),e.preventDefault()):38!==t&&40!==t||(38===t?this.focusIndex>0&&--this.focusIndex:this.focusIndex<s.length-1&&++this.focusIndex,i(s[this.focusIndex]).focus(),e.stopPropagation(),e.preventDefault()))},"currentlyFocusedElement":function(){var e=this.$el.find("*[tabindex]");if(e.length)return i(e[this.focusIndex])},"onRender":function(){var e="";e=this.options.removePermission?t.str.sformat(c.removeToItem,this.options.model.get("container")):t.str.sformat(c.applyToItem,this.options.model.get("name")),this.ui.applyPermissionMsg.html(e),this.options.model&&this.options.model.get("container")&&(this.loadSubFolderDeatils(this),this.options.applyTo&&this.loadSpecialItems(this.options.applyTo.subTypes,this.options.applyTo.thresholdExceeded))},"loadSubFolderDeatils":function(e){if((e.options.applyTo&&e.options.applyTo.subTypes.indexOf(0))>=0){e.ui.appplyToSubFolderContainer.removeClass("binf-hidden"),e.$(e.ui.appplyToSubFolder).html(c.applytoSubFolder),e.requiredFieldSwitchModel=new s.Model({"data":!1});var i=t.uniqueId("appplyToSubFolder");e.ui.appplyToSubFolder.attr("id",i),csui.require(["csui/controls/form/fields/booleanfield.view"],function(t){e.requiredFieldSwitchView=new t({"mode":"writeonly","model":e.requiredFieldSwitchModel,"labelId":i}),e.requiredFieldSwitchView.render(),e.requiredFieldSwitchView.on("field:changed",function(t){e.subFolderSelected=t.fieldvalue,t.fieldvalue?e.options.subTypes?e.loadSpecialItems(e.options.subTypes,e.options.thresholdExceeded):e.fetchSubFoldersSubItems(e.options).then(function(t){e.loadSpecialItems(e.options.subTypes,e.options.thresholdExceeded)}):e.options.applyTo&&e.loadSpecialItems(e.options.applyTo.subTypes,e.options.applyTo.thresholdExceeded)}),e.$(".required-fields-switch").append(e.requiredFieldSwitchView.$el)})}else e.ui.appplyToSubFolderContainer.addClass("binf-hidden")},"loadSpecialItems":function(e,i){var s=this,n=e,o=i,r=(s.options.applyTo&&s.options.applyTo.subTypes.indexOf(0),s.model.get("name")),l=this.options.permissionModel&&this.options.permissionModel.get("right_id_expand")&&this.options.permissionModel.get("right_id_expand").name_formatted,a="";l=this.options.permissionModel&&"public"===this.options.permissionModel.get("type")?c.publicAccess:l,n.indexOf(204)>=0&&(a=""===a?a+c[204]:a+", "+c[204]),n.indexOf(207)>=0&&(a=""===a?a+c[207]:a+", "+c[207]),n.indexOf(215)>=0&&(a=""===a?a+c[215]:a+", "+c[215]),n.indexOf(298)>=0&&(a=""===a?a+c[298]:a+", "+c[298]),n.indexOf(3030202)>=0&&(a=""===a?a+c[3030202]:a+", "+c[3030202]),this.options.removePermission&&t.str.sformat(c.removeToItem,r),o?this.options.removePermission?s.ui.applyPermissionMsg.html(t.str.sformat(c.removeThresholdExceeded,r)):s.ui.applyPermissionMsg.html(t.str.sformat(c.applyToThresholdExceeded,r)):this.options.removePermission?s.ui.applyPermissionMsg.html(t.str.sformat(c.removeToItem,r)):!!s.ui.applyPermissionMsg.html&&s.ui.applyPermissionMsg.html(t.str.sformat(c.applyToItem,r)),""!==a?(s.ui.applyToSubItemsContainer.removeClass("binf-hidden"),s.ui.applyToSubItemsTitle.html(t.str.sformat(c.includeSubItems,a))):(!!s.ui.applyToSubItemsTitle.html&&s.ui.applyToSubItemsTitle.html(""),!!s.ui.applyToSubItemsContainer.addClass&&s.ui.applyToSubItemsContainer.addClass("binf-hidden"))},"fetchSubFoldersSubItems":function(e){this.options=e,this.options.subTypes=[];var s=this,n=[204,207,215,298,3030202],o=new u({"parallelism":d.parallelism}),r=s.model.get("id"),l=s.model.connector.connection.url.replace("v1","v2")+"/nodes/"+r+"/descendents/subtypes/exists?sub_types=",a=t.map(n,function(e){var t=i.Deferred();return o.pending.add({"worker":function(){var n=s.model.connector.extendAjaxOptions({"url":l+e,"type":"GET","data":{"include_sub_items":!0}});return i.ajax(n).done(function(e){void 0!==e.results.data.subtypes_info&&s.options.subTypes.push(e.results.data.subtypes_info[0].id),s.options.thresholdExceeded=e.results.data.threshold_exceeded,t.resolve(e)}).fail(function(e){t.reject(e)}),t.promise()}}),t.promise(a)});return i.whenAll.apply(i,a)},"getApplyToFlag":function(){return this.subFolderSelected}})}),csui.define("hbs!csui/dialogs/node.picker/impl/node.list/list.item",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<a class="csui-item-standard csui-list-group-item" href="#">\r\n<span class="csui-icon csui-start-icon '+this.escapeExpression((n=null!=(n=t.selected||(null!=e?e.selected:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"selected","hash":{}}):n))+'"></span>\r\n<span class="csui-type-icon" aria-hidden="true" title="'+this.escapeExpression((n=null!=(n=t.iconTitle||(null!=e?e.iconTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"iconTitle","hash":{}}):n))+'"></span>\r\n<span title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" class="csui-list-item-title">\r\n  '+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'\r\n</span>\r\n<span class="csui-icon csui-end-icon '+this.escapeExpression((n=null!=(n=t.browsed||(null!=e?e.browsed:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"browsed","hash":{}}):n))+'"></span>\r\n</a>\r\n'}});return i.registerPartial("csui_dialogs_node.picker_impl_node.list_list.item",s),s}),csui.define("csui/dialogs/node.picker/impl/node.list/list.item.view",["csui/lib/underscore","csui/lib/jquery","csui/controls/listitem/listitemstandard.view","hbs!csui/dialogs/node.picker/impl/node.list/list.item","hbs!csui/dialogs/node.picker/impl/search.list/search.location.item","csui/controls/node-type.icon/node-type.icon.view","csui/behaviors/default.action/default.action.behavior","i18n!csui/dialogs/node.picker/impl/nls/lang"],function(e,t,i,s,n,o,r,l){return i.extend({"template":s,"searchLocationTemplate":n,"templateHelpers":function(){return{"selected":this.selected?"icon-listview-checkmark":"","browsed":this.browsed?"icon-sidebar-expand24":""}},"tagName":"li","events":{"keydown":"onKeyInView"},"ui":{"link":".csui-list-group-item"},"onKeyInView":function(e){return 39!==e.keyCode&&32!==e.keyCode&&13!==e.keyCode||(this.$el.trigger("click"),this.$el.focus(),!1)},"constructor":function(e){i.apply(this,arguments),this.selected=!1,this.browsed=!1},"toggleSelect":function(){
this.selected=!this.selected,this.render()},"toggleBrowse":function(){this.browsed=!this.browsed,this.render()},"assignedBrowseNSelect":function(){this.browsed=this.selected=!0,this.render()},"unassignBrowseNSelect":function(){this.isDestroyed||(this.browsed=this.selected=!1,this.render())},"isSelected":function(){return this.selected},"isBrowsed":function(){return this.browsed},"setValidity":function(e){this.valid=e},"setEnable":function(t){if(t){this.$el.removeClass("csui-disabled");var i=e.str.sformat(l.itemTypeNameAria,this.model.get("type_name"),this.model.get("name"));this.valid||(i=e.str.sformat(l.disabledItemTypeNameAria,this.model.get("type_name"),this.model.get("name"))),this.$el.attr("aria-label",i)}else{this.$el.addClass("csui-disabled");var s=e.str.sformat(l.disabledItemTypeNameAria,this.model.get("type_name"),this.model.get("name"));this.$el.attr("aria-label",s)}},"onRender":function(){this.$el.addClass("cs-left-item-"+this.model.get("id")),this.$el.removeClass("select"),this.$el.removeClass("browse"),this.ui.link.removeAttr("aria-expanded","false"),this.$el.removeAttr("aria-selected"),this.$el.attr("role","option"),this.setEnable(!0),this.options.searchView||(t(".binf-list-group").removeClass("search-left-item"),t(".csui-np-content .csui-search-item-left-panel").is(":visible")?t(".binf-list-group").addClass("search-left-folder-right"):t(".cs-start-locations .binf-search-location-group").is(":visible")&&t(".binf-list-group").removeClass("search-left-folder-right"),this._nodeLocationIconView&&this._nodeLocationIconView.destroy()),this._isBrowsable(this.model)&&this.ui.link.attr("aria-haspopup","true"),this.selected?(this.$el.addClass("select"),this.ui.link.attr("aria-expanded","true"),this.$el.attr("aria-selected","true")):this.browsed&&this.$el.addClass("browse"),this._nodeIconView=new o({"el":this.$(".csui-type-icon").get(0),"node":this.model});var e=this._nodeIconView.model.get("className");e=this.valid?e:e+"_nonselectable",this._nodeIconView.model.set("className",e);var i=this._nodeIconView.model.get("mainClassName");i=this.valid?i:i+"_nonselectable",this._nodeIconView.model.set("mainClassName",i),this._nodeIconView.render()},"onBeforeDestroy":function(){this._nodeIconView&&this._nodeIconView.destroy()},"_openSearchLocation":function(e){e.preventDefault(),e.stopPropagation(),this._parent.triggerMethod("click:location",this.model.parent)},"_isBrowsable":function(e){return e.get("container")&&!1!==e.get("perm_see_contents")},"getResolvedModel":function(){var e=this.model;return this.options.resolveShortcuts&&1===e.get("type")&&void 0!==e.original&&(e=e.original),e}})}),csui.define("hbs!csui/dialogs/node.picker/impl/node.list/node.list",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return"search-left-item"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'\r\n<div class="list-content">\r\n  <ul class="binf-list-group '+(null!=(n=t.if.call(e,null!=e?e.searchView:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'" aria-label="'+this.escapeExpression((o=null!=(o=t.nodePickerChoices||(null!=e?e.nodePickerChoices:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"nodePickerChoices","hash":{}}):o))+'" role="listbox"></ul>\r\n  <div class="binf-search-location-group"></div>\r\n</div>\r\n'}});return i.registerPartial("csui_dialogs_node.picker_impl_node.list_node.list",s),s}),csui.define("hbs!csui/dialogs/node.picker/impl/node.list/empty.node.list",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'    <p class="csui-no-result-message">\r\n      '+this.escapeExpression((n=null!=(n=t.noSearchResultMessage||(null!=e?e.noSearchResultMessage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"noSearchResultMessage","hash":{}}):n))+"\r\n    </p>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-no-result-wrapper">\r\n'+(null!=(n=t.if.call(e,null!=(n=null!=e?e.noSearchResultMessage:e)?n.length:n,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"</div>\r\n\r\n\r\n\r\n"}});return i.registerPartial("csui_dialogs_node.picker_impl_node.list_empty.node.list",s),s}),csui.define("css!csui/dialogs/node.picker/impl/search.list/search.list",[],function(){}),csui.define("csui/dialogs/node.picker/impl/search.list/search.location.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","i18n!csui/dialogs/node.picker/impl/nls/lang","hbs!csui/dialogs/node.picker/impl/search.list/search.location.item","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/behaviors/default.action/default.action.behavior","csui/models/node/node.model","csui/controls/node-type.icon/node-type.icon.view","csui/utils/node.links/node.links","css!csui/dialogs/node.picker/impl/search.list/search.list"],function(e,t,i,s,n,o,r,l,a,c,u){"use strict";var d=s.ItemView.extend({"constructor":function(e){e||(e={}),s.View.prototype.constructor.apply(this,arguments)},"triggers":{"click":"click:location"},"tagName":"a","template":o,"className":"search-location-name","behaviors":{"DefaultAction":{"behaviorClass":l}},"templateHelpers":function(){return{"name":this.model.parent.get("name")?this.model.parent.get("name"):n.noValue}},"onRender":function(e){if(this.model.parent){var t=new a(this.model.get("parent_id_expand"),{"connector":this.model.connector}),i=u.getUrl(t);this.$el.prop("href",i),this._nodeIconViewLocation=new c({"el":this.$(".csui-type-location-icon").get(0),"node":this.model.parent}),this._nodeIconViewLocation.render()}}});return s.CollectionView.extend({"childView":d,"childEvents":{"click:location":"onLocationClick"},"events":{"keydown":"onKeyInView"},"onAddChild":function(e){e.$el.addClass("csui-acc-focusable")},"childViewOptions":function(){return{"notTabableRegion":this.options.notTabableRegion}},"updateChildOptions":function(e){this.childViewOptions.notTabableRegion=!0},"constructor":function(e){e||(e={}),s.CollectionView.prototype.constructor.apply(this,arguments),this.focusIndex=0,this.on("render",function(){var e=this;setTimeout(function(){e.trigger("dom:refresh")},100)})},"onLocationClick":function(e){this.trigger("click:location",e.model.parent)},"behaviors":{"TabableRegion":{"behaviorClass":r}},"isTabable":function(){return this.children.find(function(e){var t=e.$el;return t.is(":visible")&&!t.is(":disabled")})},"currentlyFocusedElement":function(){var e=this.$el.find(".search-location-name.csui-acc-focusable");if(e.length)return t(e[this.focusIndex])},"setFocus":function(){var e=this.$el.find(".search-location-name.csui-acc-focusable");t(e[this.focusIndex]).focus()},"onKeyInView":function(e){var i=e.keyCode,s=this.$el.find(".search-location-name.csui-acc-focusable");switch(i){case 38:case 40:38===i?this.focusIndex>0&&--this.focusIndex:this.focusIndex<s.length-1&&++this.focusIndex,document.activeElement.classList.contains("search-location-name")&&(s=this.$el.find(".search-location-name.csui-acc-focusable")),this.trigger("changed:focus"),t(s[this.focusIndex]).focus()}}})}),csui.define("css!csui/dialogs/node.picker/impl/node.list/node.list",[],function(){}),csui.define("csui/dialogs/node.picker/impl/node.list/node.list.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/dialogs/node.picker/impl/node.list/list.item.view","csui/controls/progressblocker/blocker","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/models/node/node.model","hbs!csui/dialogs/node.picker/impl/node.list/node.list","hbs!csui/dialogs/node.picker/impl/node.list/empty.node.list","csui/dialogs/node.picker/impl/search.list/search.location.view","i18n!csui/dialogs/node.picker/impl/nls/lang","css!csui/dialogs/node.picker/impl/node.list/node.list"],function(e,t,i,s,n,o,r,l,a,c,u,d,h){"use strict";var p=i.ItemView.extend({"template":u,"constructor":function(e){i.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",this.render)}});return i.CompositeView.extend({"className":"cs-list","template":c,"emptyView":p,"emptyViewOptions":function(){return{"model":this.emptyModel}},"templateHelpers":function(){return{"searchView":this.options.searchView}},"childViewContainer":".binf-list-group","childView":n,"childViewOptions":function(){return{"searchView":this.options.searchView,"locationEle":this.ui.location,"resolveShortcuts":this.options.resolveShortcuts}},"childEvents":{"click:item":"onItemClick","before:add:child":"onBeforeAddChild","change:child":"onChangeChild"},"ui":{"listParent":".list-content","list":".binf-list-group","location":".binf-search-location-group"},"events":{"keydown":"onKeyInView"},"onBeforeAddChild":function(t){var i=t.model,s=this.commandType.validateTarget(i),n=i.get("id");s=s&&e.every(this.commandType.unselectableNodes,function(e){return n!==e}),t.setValidity(s)},"onChangeChild":function(e){if(e!==this.collection){var t=this.children.findByModel(e);t.render(),this.validateAndUpdateChild(t)}},"onAddChild":function(e){var t=e.model.get("id");return this.selectItems[t]&&(this.selectItems[t]=e,this.toggleSelectedChild(e)),this.validateAndUpdateChild(e),this.browsedChild&&this.browsedChild.model.get("id")===t&&(this.browsedChild=e,this.toggleBrowsedChild(e)),!0},"shouldDisable":function(e){return void 0===e||(!!this.commandType.isActionNode(e)||(this.options.resolveShortcuts&&1===e.get("type")&&void 0!==e.original?this.shouldDisable(e.original):!this.commandType.isSelectable(e)&&!this._isBrowsable(e)))},"validateAndUpdateChild":function(e){this.options.searchView||this.commandType.validateNode(e.getResolvedModel())?e.$el.addClass("csui-acc-focusable"):e.$el.hide();var t=this.shouldDisable(e.model);e.setEnable(!t),this._isBrowsable(e.model)?(e.ui.link.attr("aria-haspopup","true"),e.ui.link.attr("aria-expanded","false")):(e.ui.link.removeAttr("aria-haspopup"),e.ui.link.removeAttr("aria-expanded"))},"collectionEvents":{"sync":"syncUpdate","change":"onChangeChild"},"behaviors":{"PerfectScrolling":{"behaviorClass":l,"contentParent":"> .list-content","suppressScrollX":!0},"TabableRegion":{"behaviorClass":r}},"isTabable":function(){return this.children.find(function(e){var t=e.$el;return t.is(":visible")&&!t.is(":disabled")})},"currentlyFocusedElement":function(){var e=this.$el.find(".binf-list-group-item.csui-acc-focusable");if(e.length)return t(e[this.focusIndex])},"setFocus":function(){var e=this.$el.find(".binf-list-group-item.csui-acc-focusable");t(e[this.focusIndex]).focus()},"onKeyInView":function(e){var i=e.keyCode,s=this.$el.find(".binf-list-group-item.csui-acc-focusable");switch(i){case 9:document.activeElement.classList.contains("search-location-name")||(this.locationView.focusIndex=this.focusIndex);break;case 38:case 40:38===i?this.focusIndex>0&&--this.focusIndex:this.focusIndex<s.length-1&&++this.focusIndex,document.activeElement.classList.contains("search-location-name")&&(s=this.$el.find(".search-location-name.csui-acc-focusable")),this.trigger("changed:focus"),t(s[this.focusIndex]).focus();break;case 35:this.focusIndex=this.collection.length-1,this.trigger("changed:focus"),t(s[this.focusIndex]).focus();break;case 36:this.focusIndex=0,this.trigger("changed:focus"),t(s[this.focusIndex]).focus()}},"constructor":function(n){n||(n={}),e.defaults(n,{"pageSize":30}),i.CompositeView.prototype.constructor.apply(this,arguments),this.jQuery=t,o.imbue(this),this.selectItems=e.extend({},n.selection),this.blockScroll=!0,this.notFetching=!0,this.init=!0,this.nextCollectionPage=e.bind(this.addNextCollectionPage,this),this.commandType=n.commandType,this.focusIndex=0,this.emptyModel=new s.Model({"noSearchResultMessage":""}),this.listenTo(this.collection,"sync",function(){0===this.collection.totalCount?(t(".binf-list-group").removeClass("search-left-item"),this.$el.find(".binf-list-group").addClass("csui-no-results")):this.$el.find(".binf-list-group").removeClass("csui-no-results"),this.emptyModel.set("noSearchResultMessage",h.noSearchResultMessage)}),this.locationView=new d({"collection":this.collection}),this.listenTo(this.locationView,"click:location",this.onClickLocation),this.listenTo(this.collection,"request",this.setBlocker),this.listenTo(this.collection,"reset",this.setBlocker),this.listenTo(this,"browse:complete",function(){this.notFetching=!0})},"onRender":function(e){var t=new i.Region({"el":this.ui.location});this.options.searchView&&t.show(this.locationView)},"onClickLocation":function(e){this.trigger("click:location",e)},"syncUpdate":function(){this.nextTriggerSetting=this.options.pageSize/2,this.blockScroll=!0,this.notFetching=!0,this.init=!0,this.unblockActions(),this.confirmSelectionList(),this.trigger("dom:refresh")},"reset":function(){this.init=!0,this.scrollBar&&this.scrollBar.scrollTop(0)},"stopBlocker":function(){return this.unblockActions(),!0},"setBlocker":function(){return this.blockScroll&&(this.blockScroll=!1,this.blockActions()),!0},"addNextCollectionPage":function(e,t){var i=this.collection.length,s=this.ui.list.height()-this.ui.listParent.height(),n=this.ui.listParent.scrollTop()/s,o=(i-this.nextTriggerSetting)/i;if(i<this.collection.totalCount&&n>=o){var r=this;this.notFetching&&(this.notFetching=!1,this.collection.setSkip(i,!1),this.collection.fetch({"reset":!1,"remove":!1,"merge":!1}).done(function(){if(r.options.resolveShortcuts){var e=r.collection.filter(function(e,t){return t>=i&&r.commandType.shouldResolveShortcut(e)});r.resolveShortcuts(e)}})),n>.98&&this.init&&(this.setBlocker(),this.init=!1)}},"resolveShortcuts":function(e){var i=this,s=[];return i.options.resolveShortcuts?(e.filter(i.commandType.shouldResolveShortcut).forEach(function(e){var t=void 0!==e.original?e.original.get("id"):e.original_id,i=new a({"id":t},{"connector":e.connector});s.push(i.fetch().done(function(){e.original=i,e.trigger("change",e)}))}),t.whenAll.apply(t,s)):t.Deferred().resolve()},"onDomRefresh":function(){this.scrollBar||(this.scrollBar=this.ui.listParent,this.scrollBar.on("scroll",this.nextCollectionPage))},"onItemClick":function(e){if(s.trigger("closeToggleAction"),!e.$el.hasClass("csui-disabled")){this.options.searchView?(this.childView=n,this._processClickedItem(e),e.getResolvedModel().get("container")&&(this.jQuery(".csui-node-picker .binf-search-location-group").addClass("binf-hidden"),this.jQuery(".csui-node-picker .csui-search-item-right-panel").addClass("binf-hidden"))):(this._processClickedItem(e),this.options.searchView=!1,e.options.searchView=!1);var i=this.$el.find(".binf-list-group-item.csui-acc-focusable");this.focusIndex=t(i).index(e.el),this.trigger("changed:focus"),t(i[this.focusIndex]).focus()}},"_processClickedItem":function(e){var t=this._isBrowsable(e.getResolvedModel());return this.notFetching&&(this.notFetching=!1,t?this._browseSelection(e):this._targetSelection(e),e.$el.blur()),this.$el.trigger("setCurrentTabFocus"),!0},"clearSelect":function(){var t=this;return e.each(this.selectItems,function(e){t.toggleSelectedChild(e)}),this.selectItems={},!0},"toggleSelectedChild":function(e){this.commandType.isSelectable(e.getResolvedModel())&&e.toggleSelect()},"toggleBrowsedChild":function(e){e&&e.toggleBrowse()},"confirmSelectionList":function(){e.each(this.selectItems,function(t,i){e.find(this.collection.models,function(e){return e.get("id").toString()===i})||this.commandType.multiSelect||(delete this.selectItems[i],this.trigger("selection:change",{"node":this._getNodeForSelection(t),"add":!1}))},this)},"_isBrowsable":function(e){return this.options.resolveShortcuts&&1===e.get("type")&&void 0!==e.original?this.commandType.browseAllowed(e.original):this.commandType.browseAllowed(e)},"_targetSelection":function(e){var t=this._getNodeForSelection(e),i=t.get("id"),s=e.isSelected();s?(this.toggleSelectedChild(e),delete this.selectItems[i]):(this.commandType.multiSelect||this.clearSelect(),this.selectItems[i]=e,this.toggleSelectedChild(e)),this.trigger("selection:change",{"node":t,"add":!s}),this.notFetching=!0},"_browseSelection":function(e){var t=e.getResolvedModel(),i=this.commandType.isSelectableType(t),s=this.commandType.browseAllowed(t),n=this.commandType.isSelectable(t),o=e.isBrowsed(),r=e.isSelected(),l=!1;o||r?(n&&this._targetSelection(e),this.notFetching=!0):(n?(this._browseNSelect(e),l=!0):((s||i)&&(this.clearSelect(),l=!0),this.toggleBrowsedChild(e)),this.options.searchView=!1,e.options.searchView=!1,this._browse(e,l),l&&this.trigger("selection:change",{"node":this._getNodeForSelection(e),"silent":!0,"add":l}))},"_browse":function(e,t){this.browsedChild&&this.browsedChild.toggleBrowse(),this.browsedChild=e,e.ui.link.attr("aria-expanded","true"),this.trigger("browse:select",{"node":e.getResolvedModel(),"add":t})},"_browseNSelect":function(e){var t=this._getNodeForSelection(e).get("id");this.commandType.multiSelect||this.clearSelect(),this.selectItems[t]=e,e.assignedBrowseNSelect()},"_getNodeForSelection":function(e){var t=e.model;return this.options.resultOriginalNode&&null!=e.model.original&&(t=e.model.original),t}})}),csui.define("hbs!csui/dialogs/node.picker/impl/select.view/impl/header/header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <div class="csui-search-item-left-panel">\r\n    <div class="csui-search-item-type">\r\n      <span class="csui-type-label"> '+this.escapeExpression((n=null!=(n=t.type||(null!=e?e.type:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"type","hash":{}}):n))+' </span>\r\n    </div>\r\n    <div class="csui-search-item">\r\n      <div class="csui-search-item-name">\r\n        '+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="csui-search-item-right-panel">\r\n    <div class="csui-search-item-location">\r\n      <div class="csui-search-toolbar-container">\r\n        '+this.escapeExpression((n=null!=(n=t.location||(null!=e?e.location:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"location","hash":{}}):n))+"\r\n      </div>\r\n    </div>\r\n  </div>\r\n"},"3":function(e,t,i,s){var n;return'  <div class="csui-folder-name">\r\n    <h3 class="folder-name" title="'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+'</h3>\r\n    <span class="cs-icon icon-sv-search csui-acc-focusable" tabindex="0" data-cstabindex="-1"\r\n          role="button" aria-expanded="false" aria-haspopup="true" title="'+this.escapeExpression((n=null!=(n=t.searchInButtonAria||(null!=e?e.searchInButtonAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"searchInButtonAria","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.searchInButtonAria||(null!=e?e.searchInButtonAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"searchInButtonAria","hash":{}}):n))+'"></span>\r\n  </div>\r\n\r\n  <form class="cs-modal-filter">\r\n    <div class="binf-form-group">\r\n      <input class="binf-form-control cs-filter-input" placeholder="'+this.escapeExpression((n=null!=(n=t.search_placeholder||(null!=e?e.search_placeholder:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"search_placeholder","hash":{}}):n))+'"\r\n             tabindex="0" data-cstabindex="-1" aria-label="'+this.escapeExpression((n=null!=(n=t.search_placeholder||(null!=e?e.search_placeholder:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"search_placeholder","hash":{}}):n))+'">\r\n      <span class="binf-form-control-feedback cs-icon icon-formfield-clear" role="button"\r\n            title="'+this.escapeExpression((n=null!=(n=t.clearSearchButtonAria||(null!=e?e.clearSearchButtonAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"clearSearchButtonAria","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.clearSearchButtonAria||(null!=e?e.clearSearchButtonAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"clearSearchButtonAria","hash":{}}):n))+'" tabindex="0" data-cstabindex="-1"></span>\r\n\r\n      <button class="binf-btn csui-form-control-search" title="'+this.escapeExpression((n=null!=(n=t.collapseSearch||(null!=e?e.collapseSearch:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"collapseSearch","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.collapseSearch||(null!=e?e.collapseSearch:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"collapseSearch","hash":{}}):n))+'" aria-expanded="true" aria-haspopup="true"\r\n              tabindex="0" data-cstabindex="-1">\r\n        <span class="form-control-search cs-icon icon-sv-search-hide"></span>\r\n      </button>\r\n    </div>\r\n  </form>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'  <div class="csui-targetbrowse-history">\r\n      <span class="csui-targetbrowse-arrow-back">\r\n        <span class="icon arrow_back cs-go-back" title="'+this.escapeExpression((o=null!=(o=t.backButtonTooltip||(null!=e?e.backButtonTooltip:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"backButtonTooltip","hash":{}}):o))+'"\r\n              aria-label="'+this.escapeExpression((o=null!=(o=t.backButtonAria||(null!=e?e.backButtonAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"backButtonAria","hash":{}}):o))+'" tabindex="0" data-cstabindex="-1"\r\n              role="link"></span>\r\n      </span>\r\n  </div>\r\n'+(null!=(n=t.if.call(e,null!=e?e.searchView:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")}});return i.registerPartial("csui_dialogs_node.picker_impl_select.view_impl_header_header",s),s}),csui.define("css!csui/dialogs/node.picker/impl/select.view/impl/header/header",[],function(){}),csui.define("csui/dialogs/node.picker/impl/select.view/impl/header/header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/behaviors/input/placeholder","i18n!csui/controls/table/impl/nls/lang","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/dialogs/node.picker/impl/select.view/impl/header/header","i18n!csui/dialogs/node.picker/impl/nls/lang","css!csui/dialogs/node.picker/impl/select.view/impl/header/header","csui/lib/jquery.ui/js/jquery-ui"],function(e,t,i,s,n,o,r,l,a){return i.ItemView.extend({"template":l,"tagName":"div","templateHelpers":function(){return{"search_icon_tooltip":e.str.sformat(o.searchIconTooltip,this.options.columnTitle),"search_placeholder":o.searchByNamePlaceholder,"search_clear_icon_tooltip":o.searchClearIconTooltip,"title":this.title,"backButtonTooltip":a.backButtonTooltip,"type":a.Type,"name":a.Name,"location":a.Location,"searchView":this.options.searchView,"searchInButtonAria":e.str.sformat(o.searchPlaceholder,this.title),"clearSearchButtonAria":a.clearSearchButtonAria,"collapseSearch":a.collapseSearch,"backButtonAria":a.backButtonTooltip}},"ui":{"searchBox":"> form.cs-modal-filter","closeSearchIcon":"> form .csui-form-control-search","openSearchIcon":"> .csui-folder-name .icon-sv-search","headerTitle":"> .csui-folder-name","searchInput":"> form .cs-filter-input","clearer":"> form .binf-form-control-feedback","tabElements":"> *[tabindex]","backBtn":".csui-targetbrowse-history"},"events":{"click .icon-sv-search":"searchClicked","click .csui-form-control-search":"searchClicked","paste @ui.searchInput":"contentPasted","change @ui.searchInput":"filterChanged","click @ui.clearer":"searchFieldClearerClicked","submit @ui.searchBox":"filterChanged","keydown":"onKeyInView"},"behaviors":{"Placeholder":{"behaviorClass":n},"TabableRegionBehavior":{"behaviorClass":r}},"constructor":function(e){this.options=e||{},this.container=e.container,this.lastFilterValue="",this.title=e.title,i.ItemView.prototype.constructor.apply(this,arguments),this.container&&this.listenTo(this.container,"change:name",function(e){this.title=e.get("name"),this.render()})},"currentlyFocusedElement":function(e){var t=this.$el.find("*[data-cstabindex=-1]");return t.length&&t.prop("tabindex",0),t.length>1?this.$el.find(".cs-go-back:visible").length&&!e.shiftKey?this.$el.find(".cs-go-back"):this.$el.find(".csui-folder-name.binf-hidden").length&&!e.shiftKey?this.$el.find("input"):this.$el.find(".csui-folder-name.binf-hidden").length&&e.shiftKey?this.$el.find("button"):this.$el.find(".csui-folder-name .icon-sv-search"):t[0]},"onLastTabElement":function(e){var i=this.$("[data-cstabindex=-1]"),s=i.length-1;if(i.length){var n=e?i[0]:i[s];return this.$(".csui-focus").removeClass("csui-focus"),t(n).hasClass(r.accessibilityActiveElementClass)&&!e}return!0},"onKeyInView":function(e){var i=t(e.target);switch(e.keyCode){case 13:i.removeClass(r.accessibilityActiveElementClass),t(e.target).trigger("click");break;case 27:t(e.target).hasClass(".icon-sv-search")||this.$el.trigger("tabNextRegion");break;default:return!0}return!1},"onRender":function(){this.ui.clearer.toggle(!1),this.ui.searchBox.toggleClass("binf-hidden"),this.ui.closeSearchIcon.toggleClass("binf-hidden"),this.ui.searchInput.hide();var e=this;this.ui.searchInput.keyup(function(t){e.filterChanged(t)}),this.$el.find("*[data-cstabindex]").on("focus",function(){var i=t(this);e.focusedElement&&e.focusedElement.removeClass(r.accessibilityActiveElementClass),i.addClass(r.accessibilityActiveElementClass),e.focusedElement=i})},"searchClicked":function(i){i.preventDefault(),i.stopPropagation(),s.trigger("closeToggleAction"),this.ui.headerTitle.toggleClass("binf-hidden"),this.ui.searchInput.toggleClass(r.accessibilityFocusableClass),this.ui.clearer.toggle(!1),this.getValue().length&&(this.ui.searchInput.val(""),this.filterChanged(i)),this.ui.searchInput.toggle(200,"linear",e.bind(function(){this.ui.searchInput.focus(),this.ui.closeSearchIcon.toggleClass("binf-hidden")},this)),this.ui.closeSearchIcon.toggleClass(r.accessibilityFocusableClass),this.ui.closeSearchIcon.removeClass(r.accessibilityActiveElementClass),this.ui.openSearchIcon.toggleClass(r.accessibilityFocusableClass),this.ui.searchBox.toggleClass("binf-hidden"),t(i.target).hasClass("form-control-search")?(this.ui.searchInput.removeClass(r.accessibilityActiveElementClass),this.ui.openSearchIcon.addClass(r.accessibilityActiveElementClass),this.$el.trigger("setCurrentTabFocus")):(this.ui.searchInput.addClass(r.accessibilityActiveElementClass),this.ui.openSearchIcon.removeClass(r.accessibilityActiveElementClass)),this.trigger("changed:focus"),this.focusElement&&this.focusElement.focus()},"searchFieldClearerClicked":function(e){e.preventDefault(),e.stopPropagation(),this.ui.clearer.removeClass(r.accessibilityFocusableClass),this.ui.clearer.removeClass(r.accessibilityActiveElementClass),this.ui.searchInput.val(""),this.filterChanged(e),this.ui.searchInput.focus(),this.ui.searchInput.addClass(r.accessibilityActiveElementClass)},"getColumn":function(){return this.options.column},"getValue":function(){var e;return e=this.ui.searchInput.val(),e===this.ui.searchInput.attr("placeholder")&&(e=""),e},"setValue":function(e){e&&e.length&&(this.ui.searchInput.val(e),this.lastFilterValue=e)},"getShown":function(){return this.ui.searchInput.hasClass("binf-show")},"setShown":function(e){!0===e&&this.ui.searchInput.hasClass("binf-hidden")?this.ui.searchInput.toggleClass("show binf-hidden"):!1===e&&this.ui.searchInput.hasClass("binf-show")&&this.ui.searchInput.toggleClass("show binf-hidden")},"setFocus":function(){var e=this.ui.searchInput.val().length;this.ui.searchInput.focus(),this.ui.searchInput[0].setSelectionRange(e,e)},"contentPasted":function(e){this.applyFilter()},"filterChanged":function(e){return this.applyFilter(),!1},"applyFilter":function(){var e=this.getValue(),t=!!e.length;if(this.ui.clearer.toggle(t),t?this.ui.clearer.addClass(r.accessibilityFocusableClass):this.ui.clearer.removeClass(r.accessibilityFocusableClass),this.lastFilterValue!=e){this.lastFilterValue=e;var i=this;this.filterTimeout&&clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(function(){i.filterTimeout=void 0,i.trigger("change:filterValue",{"name":i.getValue()})},1e3)}}})}),csui.define("hbs!csui/dialogs/node.picker/impl/select.view/impl/select.view",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div>\r\n  <div class="csui-np-header cs-folder-name"></div>\r\n</div>\r\n<div class="csui-np-content"></div>\r\n\r\n'}});return i.registerPartial("csui_dialogs_node.picker_impl_select.view_impl_select.view",s),s}),csui.define("css!csui/dialogs/node.picker/impl/select.view/impl/select.view",[],function(){}),csui.define("csui/dialogs/node.picker/impl/select.view/select.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/dialogs/node.picker/impl/node.list/node.list.view","csui/dialogs/node.picker/impl/select.view/impl/header/header.view","hbs!csui/dialogs/node.picker/impl/select.view/impl/select.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","i18n!csui/dialogs/node.picker/impl/nls/lang","css!csui/controls/list/impl/list","css!csui/dialogs/node.picker/impl/select.view/impl/select.view"],function(e,t,i,s,n,o,r,l,a,c,u,d,h){var p=n.LayoutView.extend({"template":c,"templateHelpers":function(){var e,t="";return this.options.targetBrowseHistory.length&&(e=this.options.targetBrowseHistory[this.options.targetBrowseHistory.length-1],t="search"===e[0]?h.backToSearchAria:"location"===e[0]?h.backToFolderView:"node"===e[0]?h.backToFolderView:""),{"backButtonTooltip":h.backButtonTooltip,"backButtonAria":""!=t?t:h.backToFolderView}},"regions":{"viewHeaderRegion":".csui-np-header","viewContentRegion":".csui-np-content"},"ui":{"backSearchButton":".csui-targetbrowse-arrow-back"},"events":{"tabNextRegion":"tabNextRegion","click @ui.backSearchButton":"onClickFolderBack","keydown @ui.backSearchButton":"selectFolderBack"},"behaviors":{"TabableRegion":{"behaviorClass":d,"recursiveNavigation":!0,"containTabFocus":!0}},"constructor":function(e){e||(e={}),i.defaults(e,{"pageSize":30}),n.LayoutView.prototype.constructor.call(this,e),this.search=!1,this.rendered=!1,this.selectList={},this.collection=e.collection,this.container=e.container,this.propagateEventsToRegions(),this.listenTo(this.collection,"sync",this._handlePendingFilter),this.setHeader(e),this.setListView(e),this.onWinRefresh=i.bind(this.windowRefresh,this),t(window).bind("resize.app",this.onWinRefresh)},"tabNextRegion":function(e){this.listView.currentlyFocusedElement()&&(e.preventDefault(),e.stopPropagation(),this.listView.setFocus())},"windowRefresh":function(){var e=this.options.parentEl.height();(window.chrome||navigator.userAgent.indexOf("Firefox")>0)&&e>0&&this.$el.css("height",e+"px")},"onDestroy":function(){this.$el.off(),t(window).unbind("resize.app",this.onWinRefresh)},"onRender":function(){var e=this,i=e.$el.find(".csui-np-content");this.viewHeaderRegion.show(this.headerView),this.viewContentRegion.show(this.listView),this.$el.hover(function(){i.addClass("binf-focus")},function(){i.removeClass("binf-focus")}),this.$el.find("*[data-cstabindex]").on("focus",function(){var i=t(this);e.focusedElement&&e.focusedElement.removeClass(d.accessibilityActiveElementClass),i.addClass(d.accessibilityActiveElementClass),e.focusedElement=i}),this.rendered=!0,this.trigger("dom:refresh")},"onDomRefresh":function(){this.windowRefresh()},"onShow":function(){this.rendered||this.render(),i.each(this.regionManager._regions,function(e){
e.currentView&&e.currentView.trigger("show")})},"getNumberOfSelectItems":function(){return i.size(this.selectList)},"setNewSelect":function(e,t){this.clearSelect(),this._setSelection({"node":e,"add":!0,"silent":t})},"isTabable":function(){return this.$("*[tabindex]").length>0},"currentlyFocusedElement":function(e){var t=this.$el.find("*[tabindex=-1]");return t.length&&t.prop("tabindex",0),this.$el.find(".csui-folder-name.binf-hidden").length?this.$el.find("input"):this.$el.find(".csui-targetbrowse-arrow-back .cs-go-back:visible").length&&!e.shiftKey?this.$el.find(".csui-targetbrowse-arrow-back .cs-go-back"):this.$el.find(".csui-folder-name .icon-sv-search")},"onLastTabElement":function(e){var i=this.$("[data-cstabindex=-1]"),s=i.length-1;if(i.length){var n=e?i[0]:i[s];return this.$(".csui-focus").removeClass("csui-focus"),t(n).hasClass(d.accessibilityActiveElementClass)}return!0},"clearSelect":function(){this.listView.clearSelect(),this.selectList={}},"setListView":function(e){e||(e={});var t={"collection":this.collection,"container":this.container,"commandType":e.commandType,"pageSize":e.pageSize,"searchView":e.searchView,"resolveShortcuts":e.resolveShortcuts,"resultOriginalNode":e.resultOriginalNode,"context":e.context},s=this.listView=new l(t);this.listenTo(s,"selection:change",this._setSelection).listenTo(s,"click:location",this._clickLocation).listenTo(s,"browse:select",i.bind(this.trigger,this,"browse:select",this)).listenTo(this,"browse:complete",i.bind(s.trigger,s,"browse:complete"))},"selectFolderBack":function(e){13!==e.keyCode&&32!==e.keyCode||this.trigger("backbutton:click",this)},"onClickFolderBack":function(e){this.trigger("backbutton:click",this)},"setHeader":function(e){var t=this.container&&(this.container.get("name")||"");t=null==t?this.options.locationName:t,this.headerView=new a({"title":t,"container":this.container,"searchView":e.searchView}),this.listenTo(this.headerView,"change:filterValue",this.applyFilter)},"applyFilter":function(e){if(i.extend(e,{"type":this.options.listTypes}),this.collection.fetching)this.filterValuePending=e;else{var t=this;this.collection.setLimit(0,this.options.pageSize,!1),this.collection.setFilter(e,!1),this.collection.fetch({"reset":!0}).fail(function(e){t.listView.stopBlocker(),t.trigger("search:failed",{"resp":e,"view":t})}),this.listView.reset()}},"refresh":function(){var e=this;this.collection.fetch({"reset":!0}).fail(function(){e.listView.stopBlocker()})},"addFolderSelection":function(e){this._setSelection({"browse":!0,"add":!0,"node":e})},"_handlePendingFilter":function(){i.isEmpty(this.filterValuePending)||(this.collection.setFilter(this.filterValuePending),this.filterValuePending={})},"_setSelection":function(e){var t=e.node.get("id"),s=this.options.commandType;if(!s.multiSelect&&(this.selectList={}),e.add&&s.isSelectable(e.node)){if(s.multiSelect){var n=this;i.each(this.selectList,function(t){var i=e.node.parent;t.get("id")===i.get("id")&&(n.selectList={})})}this.selectList[t]=e.node}else delete this.selectList[t],s.multiSelect||this.trigger("clear:selectList",e,this);e.silent||this.trigger("selection:change",e,this)},"_clickLocation":function(e){this.trigger("click:location",e,this)}});return i.extend(p.prototype,u),p}),csui.define("hbs!csui/dialogs/node.picker/impl/select.views/selectviews",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return"\r\n"}});return i.registerPartial("csui_dialogs_node.picker_impl_select.views_selectviews",s),s}),csui.define("csui/dialogs/node.picker/impl/search.list/search.results.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/node/node.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/browsable.mixin","csui/models/browsable/v1.request.mixin","csui/models/browsable/v2.response.mixin","csui/utils/deepClone/deepClone"],function(e,t,i,s,n,o,r,l,a,c){"use strict";var u=i.Collection.extend({"model":n,"constructor":function(e,t){this.options=t||(t={}),i.Collection.prototype.constructor.call(this,e,t),this.makeConnectable(t).makeFetchable(t).makeBrowsable(t).makeBrowsableV1Request(t).makeBrowsableV2Response(t)},"clone":function(){return new this.constructor(this.models,{"connector":this.connector,"skip":this.skipCount,"top":this.topCount,"filter":e.deepClone(this.filters),"orderBy":e.clone(this.orderBy)})}});return l.mixin(u.prototype),a.mixin(u.prototype),c.mixin(u.prototype),o.mixin(u.prototype),r.mixin(u.prototype),e.extend(u.prototype,{"isFetchable":function(){return!!this.options.query.get("where")},"cacheId":"","url":function(){var e=this.connector.connection.url.replace("/v1","/v2"),t=this.options.query.toJSON();return t.where="OTName:"+t.where,this.orderBy="OTName",t=s.combineQueryString(this.getBrowsableUrlQuery(),{"actions":"open","expand":"properties{parent_id}"},t),s.combine(e,"search?"+t)},"parse":function(e,t){return this.parseBrowsedState(e.collection,t),e.results.sorting=e.collection.sorting,this.cacheId=e.collection&&e.collection.searching&&e.collection.searching.cache_id?e.collection.searching.cache_id:"",this.parseBrowsedItems(e,t)}}),u}),csui.define("css!csui/dialogs/node.picker/impl/select.views/selectviews",[],function(){}),csui.define("css!csui/dialogs/node.picker/impl/select.views/slider",[],function(){}),csui.define("csui/dialogs/node.picker/impl/select.views/select.views",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/utils/base","i18n!csui/dialogs/node.picker/impl/nls/lang","csui/models/node/node.model","csui/models/nodechildren","csui/dialogs/node.picker/impl/select.view/select.view","csui/dialogs/modal.alert/modal.alert","csui/utils/commands","hbs!csui/dialogs/node.picker/impl/select.views/selectviews","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/dialogs/node.picker/impl/search.list/search.results.model","csui/lib/binf/js/binf","csui/lib/jquery.ui/js/jquery-ui","css!csui/dialogs/node.picker/impl/select.views/selectviews","css!csui/dialogs/node.picker/impl/select.views/slider"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f){"use strict";var b=s.ItemView.extend({"className":"csui-select-lists","template":h,"constructor":function(e){e||(e={}),i.defaults(e,{"pageSize":30}),s.ItemView.prototype.constructor.call(this,e),this.commandType=e.commandType,this.selectableTypes=this.commandType.getSelectableNodeTypes(),this.listTypes=i.isEmpty(this.selectableTypes)?[]:i.contains(this.selectableTypes,-1)?this.selectableTypes:i.union(this.selectableTypes,[-1]),this.leftView=this.rightView=null,this.invalidNodes=[],this.connector=e.connector},"onRender":function(){this.setLeftOnly(),this.leftView&&this.leftView.render(),this.rightView&&this.rightView.render()},"onDomRefresh":function(){this.leftView.triggerMethod("dom:refresh",this.leftView),this.rightView&&this.rightView.triggerMethod("dom:refresh",this.rightView)},"onShow":function(){this.leftView.triggerMethod("show"),this.rightView&&this.rightView.triggerMethod("show")},"setParentNodeAsTarget":function(e){var t=this.commandType.isSelectable(e);return this.rightView&&this.rightView.clearSelect(),this.commandType.multiSelect||this.leftView&&this.leftView.setNewSelect(e,!0),t},"getSelection":function(){var e={},t=this.rightView?this.rightView.selectList:{},s=this.leftView.selectList;return i.extend(e,s,t),e},"getNumberOfSelectItems":function(){var e=this.leftView.getNumberOfSelectItems();return this.rightView&&(e+=this.rightView.getNumberOfSelectItems()||0),e},"leftNodeId":function(){var e=this.leftView.container;return e?e.get("id"):-1},"setLeftOnly":function(){var e=this._setView(-1,"cs-start-locations left-only",this.options.searchView,!1,this.options),t=e.view.container,i=this;return e.promise.done(function(){t&&!i.commandType.multiSelect&&i.leftView.addFolderSelection(t),i.options.searchView&&i.trigger("update:searchHeader",this),0===i.options.targetBrowseHistory.length&&i.options.searchView&&i.options.targetBrowseHistory.push(["location",i.options.previousLocation.id]),i.options.targetBrowseHistory.length>0?i.showBackButton():(i.options.targetBrowseHistory.length>1||1===i.options.targetBrowseHistory.length&&i.options.navigateFromHistory)&&i.showBackButton()}).fail(function(e){i.forceClose(e)}),this.leftView=e.view,e.promise},"forceClose":function(e){this._displayAlert(e).always(this.trigger("close"))},"newLeftView":function(e,t){var i=e.get("id"),s=this;return this.options.pageSize=t,this._drillUp(i).done(function(t){if(s.leftView=t,s.commandType.multiSelect||s.leftView.addFolderSelection(e),s.onDomRefresh(),0===s.options.targetBrowseHistory.length){var i=Math.floor((s.leftView.collection.skipCount||0)/s.leftView.collection.topCount)+1,n=parseInt(s.leftView.collection.topCount)*parseInt(i),o={"leftId":s.leftView&&s.leftView.container?s.leftView.container.get("id"):e.parent?e.parent.get("id"):void 0,"rightId":s.rightView&&s.rightView.container?s.rightView.container.get("id"):void 0,"pageSize":n};s.options.targetBrowseHistory.push(["node",o])}}).fail(function(e){s._displayAlert(e)})},"onSelectionChange":function(e,t){var i=t&&this._isRightView(t);return e&&e.add&&(i?this.leftView.clearSelect():this.rightView&&this.rightView.clearSelect()),t.options.searchView&&e.node.get("container")?this.trigger("update:searchHeader",e.node):this.trigger("change:complete",e.node),!0},"onBrowse":function(e,t){var i=this._isRightView(e),s=null;return this.trigger("changing:selection"),s=i?this.selectRight(t):this.selectLeft(t),s.done(function(){e.trigger("browse:complete")}).fail(function(){e.clearSelect()}),s},"onClickLocation":function(e,t){this.trigger("click:location",e)},"selectLeft":function(e,t){var i=this;return this.options.searchView&&this.options.targetBrowseHistory.push(["search",this.options.query.clone()]),this._runSelection(e,".cs-pane-view","right").done(function(e){e&&(i.rightView=e,i.onDomRefresh())})},"selectRight":function(e,t){var i=this;if(0===this.options.targetBrowseHistory.length)this.options.targetBrowseHistory.push(["location",this.options.previousLocation.id]);else{var s=Math.floor((this.leftView.collection.skipCount||0)/this.leftView.collection.topCount)+1,n=parseInt(this.leftView.collection.topCount)*parseInt(s),o=this.leftView.listView.browsedChild,r={"leftId":o?o.model.parent.get("id"):void 0,"rightId":o?o.model.get("id"):void 0,"pageSize":n};this.options.targetBrowseHistory.push(["node",r])}return this._runSelection(e,".csui-panel.cs-start-locations","left").done(function(e){e&&(i.leftView=i.rightView,i.rightView=e,i.onDomRefresh(),i.showBackButton())})},"showBackButton":function(){this.leftView&&this.options.targetBrowseHistory.length>=1&&this.leftView.headerView&&this.leftView.headerView.ui.backBtn.show()},"hideBackButton":function(){this.leftView&&this.options.targetBrowseHistory.length<1&&this.leftView.headerView&&this.leftView.headerView.ui.backBtn.hide()},"_runSelection":function(e,i,s){var n=e.node,o=this,r=t.Deferred(),l=n.get("id");return this._drillDown(l,i).done(function(e){"left"===s?o.onClearLeftViewSelectList():"right"===s&&o.onClearRightViewSelectList();var t=("left"===s?o.rightView:o.leftView).listView.browsedChild.model;o.trigger("changed",t.get("id")),o.trigger("change:complete",n),r.resolve(e)}).fail(function(e){o._displayAlert(e),o.trigger("change:complete"),r.reject()}),r},"_drillUp":function(e,i){this.trigger("drill:up",e);var s=this._setView(e,"csui-new-view left-only binf-hidden",this.options.searchView,"prepend"),n=s.view,o=this,r=t.Deferred();return n.$el.addClass("zeroWidth").removeClass("binf-hidden"),n.render(),i||o._removeRightView(s.promise).done(function(){r.resolve(s.view)}).fail(function(e){r.reject(e)}),r},"_drillDown":function(e,i){var s=this._setView(e,"csui-new-view",!1),n=null,o=s.view;return o.render(),null==this.rightView?(o.options.searchView=!1,t(".binf-list-group").removeClass("search-left-item"),t(".csui-search-item-left-panel").is(":visible")&&t(".binf-list-group").addClass("search-left-folder-right"),n=this._addRightView(s.promise,o)):n=this._replaceView(s.promise,o,i),n},"_showLeftOnly":function(){function e(){if(null!=i){var e=i[0].selectView;s.cancelEventsToViewsPropagation(e),e.destroy(),i.remove(),s.rightView=null}}var t=this.leftView,i=this.rightView,s=this;t.animate({"width":"100%"},{"duration":200,"complete":e})},"_removeRightView":function(e){var i=this.$el.find(".csui-new-view"),s=this.$el.find(".csui-panel.cs-start-locations"),n=this.$el.find(".cs-pane-view"),o=t.Deferred(),r=this;return s.hide(),n.hide(),i[0].className="csui-panel cs-start-locations left-only",e.done(function(){r._finishRightRemove(i,s,n),o.resolve()}).fail(function(e){r._removeNewView(i,s,n),o.reject(e)}),o},"_removeNewView":function(e,t,i){e||(e=this.$el.find(".csui-new-view"));var s=e[0].selectView;this.cancelEventsToViewsPropagation(s),s.destroy(),e.remove(),t&&t.show(),i&&i.show()},"_finishRightRemove":function(e,t,i){var s;return i.length>0&&(s=i[0].selectView,this.cancelEventsToViewsPropagation(s),s.destroy(),i.remove(),this.rightView=null),s=t[0].selectView,this.cancelEventsToViewsPropagation(s),s.destroy(),t.remove(),this.leftView=null,!0},"_addRightView":function(e,i){var s=this.$el.find(".csui-panel.cs-start-locations"),n=this.$el.find(".csui-new-view"),o=t.Deferred(),r=this;return s[0].className="csui-panel cs-start-locations",n[0].className="csui-panel cs-pane-view csui-slideMidLeft",e.done(function(){o.resolve(i)}).fail(function(e){r._removeNewView(n),s.animate({"width":"100%"},{"duration":200,"complete":function(){s.addClass("left-only").css("width","")}}),r.leftView.clearSelect(),r.leftView.refresh(),o.reject(e)}),o},"_replaceView":function(e,i,s){var n=this.$el.find(s),o=t(".csui-new-view"),r=t(".cs-pane-view"),l=t.Deferred(),a=this;switch(n.hide(),s){case".csui-panel.cs-start-locations":r[0].className="csui-panel cs-start-locations csui-slideLeft",o[0].className="csui-panel cs-pane-view csui-slideMidLeft";break;case".cs-pane-view":o[0].className="csui-panel cs-pane-view csui-slideMidLeft"}return this.$el.find(".left-only").removeClass("left-only"),e.done(function(){a._removeView(n),l.resolve(i)}).fail(function(e){a._reverseRemoveView(o,s,r),".csui-panel.cs-start-locations"===s&&n.show(),l.reject(e)}),l},"_reverseRemoveView":function(e,t,i){switch(this._removeNewView(e),t){case".csui-panel.cs-start-locations":i[0].className="csui-panel cs-pane-view csui-slideRight",this.rightView.refresh();break;case".cs-pane-view":this._removeView(i),this.leftView.$el[0].className="csui-panel cs-start-locations left-only",this.leftView.clearSelect(),this.leftView.refresh()}return!0},"_removeView":function(e){if(e.length){var t=e[0].selectView;return this.cancelEventsToViewsPropagation(t),t.destroy(),e.remove(),!0}return!1},"_setView":function(e,t,s,n,o){o||(o=this._getViewOptions(e,this.connector)),this.options.searchView=s,i.defaults(o,this.options,{"invalidNodes":this.invalidNodes}),n||(n="append");var r=this._newView(o,t),l=this._fetchView(r);return this.options.fromSearch=!!s,r.el.selectView=r,this.$el[n](r.el),{"view":r,"promise":l}},"_fetchView":function(e){return this._fetchContainer(e),this._fetchCollection(e)},"_fetchContainer":function(e){return e.container&&e.container.get("id")&&e.container.fetch(),!0},"_fetchCollection":function(e){e.collection.setOrder(this.options.orderBy,!1),e.collection.setFilter({"type":this.listTypes},!1),e.collection.setLimit(0,this.options.pageSize||e.options.pageSize,!1);var i=t.Deferred();return e.collection.fetch({"reset":!1,"merge":!1,"remove":!1}).done(function(t){e.listView.resolveShortcuts(e.collection).always(function(){i.resolve(e.collection)})}).fail(function(e){i.reject(e)}),i},"_newView":function(e,t){var s=i.extend({"listTypes":this.listTypes,"className":t+" csui-panel","parentEl":this.$el},e),n=new c(s);return this.propagateEventsToViews(n),this.listenTo(n,"selection:change",this.onSelectionChange),this.listenTo(n,"search:failed",this._searchFailed),this.listenTo(n,"backbutton:click",this._onClickBackButton),this.listenTo(n,"clear:selectList",this.onClearLeftViewSelectList),this.listenTo(n,"browse:select",i.bind(this.onBrowse,this)),this.listenTo(n,"click:location",i.bind(this.onClickLocation,this)),n},"onClearLeftViewSelectList":function(){this.leftView&&(this.leftView.selectList={})},"onClearRightViewSelectList":function(){this.rightView&&(this.rightView.selectList={})},"_onClickBackButton":function(e){var t=this,i=this.options.targetBrowseHistory.length>0?this.options.targetBrowseHistory.pop():void 0;if(1===this.options.targetBrowseHistory.length?this.options.navigateFromHistory=!0:this.options.navigateFromHistory=!1,i&&"search"===i[0])this.requestedQueryModel=i[1],this.trigger("back:toSearch",this),this.options.targetBrowseHistory.length>0&&this.showBackButton();else if(i&&"location"===i[0])this.onClearLeftViewSelectList(),this.onClearRightViewSelectList(),this.trigger("change:location",i);else if(this.options.searchView&&i&&"node"===i[0]||i&&"node"===i[0]){this.options.searchView=!1;var s=new l({"id":i[1].leftId},{"connector":this.connector}),n=new l({"id":i[1].rightId},{"connector":this.connector});this.newLeftView(s,i[1].pageSize).done(function(e){t.setParentNodeAsTarget(s),t.trigger("change:complete"),t.trigger("toggle:breadcrumbs",t.leftNodeId()),t.options.targetBrowseHistory&&t.hideBackButton(),t.options.targetBrowseHistory.length>0&&n&&n.get("id")?(t.$el.find(".cs-left-item-"+n.get("id")).length>0&&t.$el.find(".cs-left-item-"+n.get("id")).trigger("click"),t.showBackButton()):t.hideBackButton()})}this.options.backBtn=!0},"_searchFailed":function(e){this._isRightView(e.view)?this._displayAlert(e.resp):this.forceClose(e.resp)},"_isRightView":function(e){var t=e.$el[0].className.split(" ");return i.contains(t,"cs-pane-view")},"_addNewPanel":function(e,t){var i=document.createElement("div");return i.className=e,this.$el[t](i),i},"_getViewOptions":function(e,t){var i=new l({"id":e},{"connector":t});return{"container":i,"collection":new a(void 0,{"node":i,"autofetch":!0,"orderBy":this.options.orderBy,"expand":["node"],"commands":d.getAllSignatures()})}},"_displayAlert":function(e){var t=i.str.sformat(r.serverError,"unknown");return e&&(e instanceof c?t=i.str.sformat(r.ViewDenied,e.node.get("name")):e.responseJSON&&(t=e.responseJSON.error)),u.showInformation(t)}});return i.extend(b.prototype,p),b}),csui.define("hbs!csui/dialogs/node.picker/impl/node.picker",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div id="csui-np-breadcrumbs" class="cs-breadcrumb">\r\n  <div class="breadcrumb-inner" role="navigation" aria-label="'+this.escapeExpression((n=null!=(n=t.breadcrumbAria||(null!=e?e.breadcrumbAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"breadcrumbAria","hash":{}}):n))+'"></div>\r\n  <div class="searchheader-inner"></div>\r\n</div>\r\n<div id="csui-np-selectviews"></div>\r\n'}});return i.registerPartial("csui_dialogs_node.picker_impl_node.picker",s),s}),csui.define("hbs!csui/dialogs/node.picker/impl/search.list/header/search.result.header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-search-header">\r\n    <span class="csui-search-header-title">\r\n        <span class="results-title searchResultsTitle">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.searchResults:n,e))+'</span>\r\n        <span class="headerCount searchHeaderCount" aria-live="polite"></span>\r\n    </span>\r\n</div>\r\n'}});return i.registerPartial("csui_dialogs_node.picker_impl_search.list_header_search.result.header",s),s}),csui.define("csui/dialogs/node.picker/impl/search.list/header/search.result.header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","i18n!csui/dialogs/node.picker/impl/nls/lang","hbs!csui/dialogs/node.picker/impl/search.list/header/search.result.header","css!csui/dialogs/node.picker/impl/search.list/search.list"],function(e,t,i,s,n){"use strict";return i.ItemView.extend({"className":"csui-search-data-header","template":n,"templateHelpers":function(){return{"messages":{"searchResults":s.searchResults}}},"constructor":function(e){e||(e={}),i.View.prototype.constructor.apply(this,arguments)},"onRender":function(){var e=this.collection;this.rendered=!0,this.$el.show(),this._assignTotalItemElem(e)},"_assignTotalItemElem":function(t){this.totalCount=0,t&&t.length>0&&(this.totalCount=t.totalCount);var i=this.$el.find(".searchHeaderCount"),n=s.searchFoundZero;return null!==this.totalCount&&(n=e.str.sformat(s.searchFoundAbout,this.totalCount)),i.empty(),i.append(n),!0}})}),csui.define("csui/dialogs/node.picker/impl/node.picker.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/models/node/node.model","csui/models/nodechildren","csui/dialogs/node.picker/impl/select.views/select.views","csui/controls/breadcrumbs/breadcrumbs.view","csui/utils/contexts/factories/ancestors","csui/models/nodeancestors","hbs!csui/dialogs/node.picker/impl/node.picker","i18n!csui/dialogs/node.picker/impl/nls/lang","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/dialogs/node.picker/impl/search.list/header/search.result.header.view"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f){var b=s.LayoutView.extend({"template":h,"className":"csui-node-picker","regions":{"breadcrumbRegion":"#csui-np-breadcrumbs > div.breadcrumb-inner","searchHeaderRegion":"#csui-np-breadcrumbs > div.searchheader-inner","selectViewRegion":"#csui-np-selectviews"},"ui":{"breadcrumb":"#csui-np-breadcrumbs","breadcrumbContent":".breadcrumb-inner","searchHeaderContent":".searchheader-inner","selectViews":"#csui-np-selectviews"},"templateHelpers":function(){return{"breadcrumbAria":p.breadcrumbAria,"nodePickerChoices":p.nodePickerChoices}},"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.call(this,e),this.propagateEventsToRegions(),this.setViews(e),this.setBreadcrumbs(e),e.searchView&&(this.updatedBreadcrumbId=e.locationID,this.setSearchResultsHeader(e)),this.onWinRefresh=i.bind(this.windowRefresh,this),t(window).bind("resize.app",this.onWinRefresh)},"windowRefresh":function(){var e=t(".cs-breadcrumb"),i=e.is(":visible")?e.height():0,s=this.$el.height()-i;window.chrome&&s>0&&this.selectViews.$el.css("height",s+"px"),this.selectViews.triggerMethod("dom:refresh",this.selectViews),this.breadcrumbs&&this.breadcrumbs.refresh()},"onBeforeDestroy":function(){this.selectViews&&(this.selectViews.leftView&&this.selectViews.leftView.clearSelect(),this.selectViews.rightView&&this.selectViews.rightView.clearSelect())},"onDestroy":function(){t(window).unbind("resize.app",this.onWinRefresh)},"onRender":function(){this.options.searchView&&this.searchHeaderRegion.show(this.searchHeaderView),this.breadcrumbs&&this.breadcrumbRegion.show(this.breadcrumbs),this.selectViews.options.navigateFromHistory=this.options.navigateFromHistory,this.selectViewRegion.show(this.selectViews)},"onDomRefresh":function(){this.windowRefresh()},"onShow":function(){i.each(this.regionManager.regions,function(e){e.currentView&&e.currentView.trigger("show")}),this.options.container||this.options.searchView||(this.ui.breadcrumb.hide(),this.ui.selectViews.addClass("csui-full-height"))},"setViews":function(e){var t=this.selectViews=new a(e);this.listenTo(t,"changed",this.updateBreadcrumbs),this.listenTo(t,"update:searchHeader",this.updateSearchResultHeader),this.listenTo(t,"change:complete",i.bind(this.trigger,this,"change:complete")),this.listenTo(t,"click:location",i.bind(this.trigger,this,"open:location")),this.listenTo(t,"change:location",i.bind(this.trigger,this,"change:location")),this.listenTo(t,"back:toSearch",function(e){this.trigger("back:toSearch",e)}),this.listenTo(t,"backto:folder",function(e){this.trigger("backto:folder",e)}),this.listenTo(t,"close",this.close).listenTo(t,"toggle:breadcrumbs",this.updateBreadcrumbs)},"getSelection":function(){return i.values(this.selectViews.getSelection())},"getNumberOfSelectItems":function(){return this.selectViews.getNumberOfSelectItems()},"close":function(){this.destroy(),this.trigger("close")},"updateBreadcrumbs":function(e){if(this.updatedBreadcrumbId=void 0,this.breadcrumbNode&&this.breadcrumbNode.set("id",e),e){this.getAncestors(e).fetch()}return this.listenTo(this.breadcrumbs,"after:synchronized",this.onAfterBreadcrumbsSynchronized),!0},"getAncestors":function(e){var t=new r({"id":e},{"connector":this.options.connector}),i={"node":t,"autofetch":!0},s=new d(void 0,i);return this.breadcrumbs=new c({"node":t,"collection":s}),this.breadcrumbs.synchronizeCollections(),this.breadcrumbNode||(this.breadcrumbNode=t),s},"setBreadcrumbs":function(e){var t=e.container||e.initialContainer,i=t?t.get("id"):0;if(!i||0===i)return this.getAncestors(0),void this.setBreadcrumbEvents();if(e.container){this.getAncestors(i).fetch()}else this.getAncestors(0),this.setBreadcrumbEvents();return this.setBreadcrumbEvents(),!0},"showBackButton":function(){this.selectViews.showBackButton()},"setBreadcrumbEvents":function(){this.listenTo(this.breadcrumbs,"before:defaultAction",function(e){var t=this.selectViews,i=this;t.newLeftView(e.node).done(function(e){t.setParentNodeAsTarget(e.container),i.trigger("change:complete",e.container)})}),this.listenTo(this.breadcrumbs,"after:synchronized",this.onAfterBreadcrumbsSynchronized)},"onAfterBreadcrumbsSynchronized":function(){this.ui.breadcrumb.hasClass("cs-breadcrumb")&&(this.ui.breadcrumb.show(),this.ui.breadcrumbContent.show(),this.ui.searchHeaderContent.hide(),this.ui.selectViews.removeClass("csui-full-height"),1===this.breadcrumbs.collection.length&&(this.options.targetBrowseHistory=[]),this.windowRefresh())},"setSearchResultsHeader":function(e){return this.searchHeaderView=new f({"collection":this.collection}),!0},"updateSearchResultHeader":function(){this.options.searchView&&(this.options.container?this.ui.searchHeaderContent.removeClass("csui-non-container-padding"):this.ui.searchHeaderContent.addClass("csui-non-container-padding"),this.ui.breadcrumbContent.hide(),this.ui.searchHeaderContent.show(),this.searchHeaderView._assignTotalItemElem(this.collection))}});return i.extend(b.prototype,m),b}),csui.define("csui/dialogs/node.picker/start.locations/start.location.collection",["require","module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone"],function(e,t,i,s,n){"use strict";function o(e){return e.lastIndexOf("/")>=0?e:"csui/dialogs/node.picker/start.locations/"+e}function r(e){return!i.contains(c.blacklist,e)&&(!c.whitelist.length||i.contains(c.whitelist,e))}var l=t.config(),a=l.startLocations||[],c=l.masks||{};i.isArray(a)||(a=Array.prototype.concat.apply([],i.values(a))),c=i.reduce(i.values(c),function(e,t){return{"blacklist":e.blacklist.concat(t.blacklist||[]),"whitelist":e.whitelist.concat(t.whitelist||[])}},{"blacklist":[],"whitelist":[]}),c={"blacklist":i.unique(c.blacklist),"whitelist":i.unique(c.whitelist)},a=i.chain(a).map(o).filter(r).unique().value();var u=n.Model.extend({"defaults":{"id":null,"name":null,"icon":null,"invalid":!1,"factory":null,"unselectable":!0},"constructor":function(e,t){n.Model.prototype.constructor.apply(this,arguments)},"sync":function(e,t,i){if("read"!==e)throw new Error("Only fetching the widget is supported.");var n=this;return i||(i={}),this._resolveFactory(i).then(function(){return n.get("factory").updateLocationModel(n)}).then(function(){var e=n.toJSON();i.success&&i.success(e,i),n.trigger("sync",n,e,i)},function(){var e=n.get("error");return i.error&&i.error(e,i),n.trigger("error",n,e,i),s.Deferred().reject(e)})},"_resolveFactory":function(t){var i=this,n=s.Deferred(),o=this.getFactoryData(),r=this.getFactoryModulePath(o);return e([r],function(e){i.set("factory",new e(t)),n.resolve()},function(e){i.set("error",e),t.ignoreErrors?n.resolve():n.reject(e)}),n.promise()},"getFactoryData":function(){var e,t=this.get("id"),i=t.lastIndexOf("/");return i<0?e="csui/dialogs/node.picker/start.locations/"+t:(e=t,t=t.substring(i+1)),{"name":t,"path":e}},"getFactoryModulePath":function(e){return e.path+"/"+e.name+".factory"}});return n.Collection.extend({"model":u,"constructor":function(e){e||(e={});var t=e.startLocations;t=t?i.chain(t).concat(["search.location","default.location"]).map(o).filter(r).unique().value():a;var s=i.map(t,function(e){return{"id":e}});n.Collection.prototype.constructor.call(this,s,e)},"sync":function(e,t,i){if("read"!==e)throw new Error("Only fetching the start locations is supported.");var s=this;return i||(i={}),this._resolveFactories(i).then(function(){if(!1!==i.removeInvalid){var e=s.where({"invalid":!0});s.remove(e)}var t=s.toJSON();i.success&&i.success(t,i),s.trigger("sync",s,t,i)})},"_resolveFactories":function(e){var t=this.filter(function(e){return e.has("id")&&!(e.has("factory")||e.has("error"))}),n=i.defaults({"ignoreErrors":!0},i.omit(e,"success","error")),o=i.invoke(t,"fetch",n);return s.when.apply(s,o)}})}),csui.define("hbs!csui/dialogs/node.picker/impl/header/apply.properties.selector/impl/apply.properties.selector",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'    <li role="presentation" data-optionid="'+this.escapeExpression(this.lambda(null!=e?e.id:e,e))+'">\r\n      <a role="menuitem" tabindex="-1" href="#">\r\n        <span class="cs-label">'+this.escapeExpression(this.lambda(null!=e?e.name:e,e))+"</span>\r\n      </a>\r\n    </li>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<button id="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" class="binf-btn binf-btn-default binf-dropdown-toggle csui-acc-focusable" data-binf-toggle="dropdown"\r\n        aria-haspopup="true" aria-expanded="false" aria-label="'+this.escapeExpression((o=null!=(o=t.applyPropertiesAria||(null!=e?e.applyPropertiesAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"applyPropertiesAria","hash":{}}):o))+'">\r\n  <span class="cs-label">'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'</span>\r\n  <span class="cs-icon icon-caret-down"></span>\r\n</button>\r\n<ul class="binf-dropdown-menu" role="menu" aria-labelledby="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n'+(null!=(n=t.each.call(e,null!=e?e.applyPropertiesOptions:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'  <li class="binf-divider"></li>\r\n  <li role="presentation" class="open-selected-properties">\r\n    <a role="menuitem"  tabindex="-1" href="#">\r\n      <span class="cs-icon"></span>\r\n      <span class="cs-label">'+this.escapeExpression((o=null!=(o=t.openSelectedProperties||(null!=e?e.openSelectedProperties:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"openSelectedProperties","hash":{}}):o))+"</span>\r\n    </a>\r\n  </li>\r\n</ul>\r\n"}});return i.registerPartial("csui_dialogs_node.picker_impl_header_apply.properties.selector_impl_apply.properties.selector",s),s}),csui.define("csui/dialogs/node.picker/impl/header/apply.properties.selector/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/dialogs/node.picker/impl/header/apply.properties.selector/impl/nls/root/lang",{"ApplyPropertiesAria":"Select properties handling","KeepOriginalProperties":"Keep original properties","ApplyDestinationProperties":"Apply destination properties","CombineAllProperties":"Combine all properties",
"OpenSelectedProperties":"Open selected properties"}),csui.define("css!csui/dialogs/node.picker/impl/header/apply.properties.selector/impl/apply.properties.selector",[],function(){}),csui.define("csui/dialogs/node.picker/impl/header/apply.properties.selector/apply.properties.selector.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/dialogs/node.picker/impl/header/apply.properties.selector/impl/apply.properties.selector","i18n!csui/dialogs/node.picker/impl/header/apply.properties.selector/impl/nls/lang","css!csui/dialogs/node.picker/impl/header/apply.properties.selector/impl/apply.properties.selector","csui/lib/binf/js/binf"],function(e,t,i,s,n,o,r){"use strict";var l=s.ItemView.extend({"_applyOptions":void 0,"selected":void 0,"openSelectedProperties":!1,"className":"cs-apply-properties-selector binf-dropdown","template":o,"behaviors":{"TabableRegion":{"behaviorClass":n}},"ui":{"toggle":">.binf-dropdown-toggle","selectedLabel":">.binf-dropdown-toggle >.cs-label","iconOpenSelectedProperties":"li.open-selected-properties > a > span.cs-icon"},"events":{"click li[data-optionid]":"onClickPropertiesOption","click li.open-selected-properties":"onClickOpenSelectedProperties","keydown":"onKeyInView","keyup":"onKeyUpInView"},"constructor":function t(i){i||(i={}),e.defaults(i,{"startSelection":t.KEEP_ORIGINAL_PROPERTIES}),s.ItemView.prototype.constructor.apply(this,arguments)},"onKeyInView":function(e){if(27===e.keyCode&&this.$el.hasClass("binf-open"))return this.$el.removeClass("binf-open"),this.$('*[tabindex = "0"]').focus(),this.isKeydownClosedDropDown=!0,!1;27!==e.keyCode||this.$el.hasClass("binf-open")||(this.isKeydownClosedDropDown=!1)},"onKeyUpInView":function(e){return!this.isKeydownClosedDropDown&&27===e.keyCode||27!==e.keyCode&&void 0},"onClickPropertiesOption":function(e){e.preventDefault(),e.stopPropagation(),this._setSelected(parseInt(t(e.currentTarget).attr("data-optionid"))),this._showSelected(),this.ui.toggle.click(),this.trigger("property:click:event"),this.$el.trigger("setCurrentTabFocus")},"onClickOpenSelectedProperties":function(e){e.preventDefault(),e.stopPropagation(),this.openSelectedProperties=!this.openSelectedProperties,this._showOpenSelectedProperties(),this.ui.toggle.click(),this.$el.trigger("setCurrentTabFocus")},"initialize":function(){this._setupApplyOptions(),-1!==e.indexOf(e.pluck(this._applyOptions,"id"),this.options.selected)?this._setSelected(this.options.selected):this._setSelected(l.KEEP_ORIGINAL_PROPERTIES),this.listenTo(i,"closeToggleAction",this._closeToggle)},"templateHelpers":function(){return{"id":e.uniqueId("optionsDropdown"),"applyPropertiesOptions":this._applyOptions,"applyPropertiesAria":r.ApplyPropertiesAria,"openSelectedProperties":r.OpenSelectedProperties}},"currentlyFocusedElement":function(){return this.$el.find("button")},"accDeactivateTabableRegion":function(){this._closeToggle()},"onRender":function(){this.ui.toggle.binf_dropdown(),this._showSelected(),this._showOpenSelectedProperties()},"_getOptionName":function(t){var i;return i=e.indexOf(e.pluck(this._applyOptions,"id"),t),-1===i?"":this._applyOptions[i].name},"_setupApplyOptions":function(){this._applyOptions=[{"id":l.KEEP_ORIGINAL_PROPERTIES,"name":r.KeepOriginalProperties},{"id":l.APPLY_DESTINATION_PROPERTIES,"name":r.ApplyDestinationProperties}],!0===this.options.includeCombineProperties&&this._applyOptions.push({"id":l.COMBINE_ALL_PROPERTIES,"name":r.CombineAllProperties})},"_setSelected":function(e){this.selected=e},"_showSelected":function(){this.ui.selectedLabel.text(this._getOptionName(this.selected)),this.$el.find("li[data-optionid]").removeClass("binf-active"),this.$el.find("li[data-optionid="+this.selected+"]").addClass("binf-active")},"_showOpenSelectedProperties":function(){!0===this.openSelectedProperties?(this.ui.toggle.attr("aria-expanded","true"),this.ui.iconOpenSelectedProperties.removeClass("icon-checkbox").addClass("icon-checkbox-selected")):(this.ui.toggle.attr("aria-expanded","false"),this.ui.iconOpenSelectedProperties.removeClass("icon-checkbox-selected").addClass("icon-checkbox"))},"_closeToggle":function(){this.ui.toggle.parent&&this.ui.toggle.parent().hasClass("binf-open")&&this.ui.toggle.binf_dropdown("toggle")}});return l.KEEP_ORIGINAL_PROPERTIES=1,l.APPLY_DESTINATION_PROPERTIES=2,l.COMBINE_ALL_PROPERTIES=3,l}),csui.define("csui/dialogs/node.picker/impl/search.list/search.query.model",["module","csui/lib/underscore","csui/lib/backbone"],function(e,t,i){var s=i.Model.extend({"constructor":function e(t,i){e.__super__.constructor.apply(this,arguments)},"toJSON":function(){return s.__super__.toJSON.apply(this,arguments)}});return s}),csui.define("csui/dialogs/node.picker/impl/header/search.box/impl/search.box.model",["module","csui/lib/underscore","csui/lib/backbone"],function(e,t,i){var s=i.Model.extend({"constructor":function e(t,i){e.__super__.constructor.apply(this,arguments)},"toJSON":function(){return s.__super__.toJSON.apply(this,arguments)}});return s}),csui.define("csui/dialogs/node.picker/impl/header/search.box/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/dialogs/node.picker/impl/header/search.box/impl/nls/root/lang",{"placeholder":"Search","clearerTitle":"Clear keywords","searchBoxTitle":"Enter your search term","searchOptionsTitle":"Show search options","searchFromHere":"Search from here","searchFromHereAria":"Select: search from here","searchIconTitle":"Search","searchIconAria":"Open searchbar","searchOptionsSelect":"Select: ","startSearch":"Start search"}),csui.define("hbs!csui/dialogs/node.picker/impl/header/search.box/impl/search.box",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="search-bar">\r\n  <div class="search-bar-content">\r\n    <div class="csui-search-input-container">\r\n      <input type="search" class="csui-input csui-acc-focusable"\r\n             placeholder="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.placeholder:n,e))+'" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.searchBoxTitle:n,e))+'" tabindex="0"\r\n             data-cstabindex="-1" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.searchBoxTitle:n,e))+'">\r\n      <div class="csui-search-options-dropdown"></div>\r\n    </div>\r\n    <span class="csui-clearer formfield_clear csui-acc-focusable" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.clearerTitle:n,e))+'"\r\n          aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.clearerTitle:n,e))+'" role="button" tabindex="0" data-cstabindex="-1"></span>\r\n  </div>\r\n</div><a href="javascript:void(0);"\r\n         class="icon icon-global-search csui-header-search-icon csui-acc-focusable"\r\n         title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.searchIconTitle:n,e))+'" aria-label="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.messages:e)?n.searchIconAria:n,e))+'"\r\n         tabindex="0" data-cstabindex="-1" role="button" aria-haspopup="true" aria-expanded="false"></a>\r\n'}});return i.registerPartial("csui_dialogs_node.picker_impl_header_search.box_impl_search.box",s),s}),csui.define("hbs!csui/dialogs/node.picker/impl/header/search.box/impl/search.slice.dropdown",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-selected-checkbox csui-slice-checkbox csui-checkbox-primary" tabindex="0"\r\n     data-cstabindex="-1" aria-label="'+this.escapeExpression(this.lambda(null!=e?e.searchFromHereAria:e,e))+'">\r\n  <input type="checkbox" class="csui-searchbox-option" name="'+this.escapeExpression(this.lambda(null!=e?e.nodeId:e,e))+'" id="'+this.escapeExpression(this.lambda(null!=e?e.nodeIdSO:e,e))+'"\r\n         value="'+this.escapeExpression(this.lambda(null!=e?e.nodeId:e,e))+'">\r\n  <label class="csui-search-slice-name csui-selectlabel" for="'+this.escapeExpression(this.lambda(null!=e?e.nodeIdSO:e,e))+'"\r\n         title="'+this.escapeExpression(this.lambda(null!=e?e.select:e,e))+this.escapeExpression(this.lambda(null!=e?e.fromHere:e,e))+'">\r\n    <span class="cs-ellipsis">'+this.escapeExpression(this.lambda(null!=e?e.fromHere:e,e))+"</span>\r\n  </label>\r\n</div>\r\n"}});return i.registerPartial("csui_dialogs_node.picker_impl_header_search.box_impl_search.slice.dropdown",s),s}),csui.define("css!csui/dialogs/node.picker/impl/header/search.box/impl/search.box",[],function(){}),csui.define("csui/dialogs/node.picker/impl/header/search.box/search.box.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/dialogs/node.picker/impl/search.list/search.query.model","csui/dialogs/node.picker/impl/header/search.box/impl/search.box.model","csui/behaviors/keyboard.navigation/tabable.region.behavior","i18n!csui/dialogs/node.picker/impl/header/search.box/impl/nls/lang","hbs!csui/dialogs/node.picker/impl/header/search.box/impl/search.box","hbs!csui/dialogs/node.picker/impl/header/search.box/impl/search.slice.dropdown","i18n","css!csui/dialogs/node.picker/impl/header/search.box/impl/search.box","csui/lib/jquery.ui/js/jquery-ui"],function(e,t,i,s,n,o,r,l,a,c,u){"use strict";var d=t.defaults({},e.config(),{"showInput":!1,"inputValue":"","nodeName":"","searchFromHere":!0});return s.ItemView.extend({"className":"csui-search-box","template":a,"templateHelpers":function(){return{"messages":{"placeholder":l.placeholder,"clearerTitle":l.clearerTitle,"searchIconTitle":l.searchIconTitle,"searchBoxTitle":l.searchBoxTitle,"searchOptionsTitle":l.searchOptionsTitle,"searchOptionsSelect":l.searchOptionsSelect,"startSearch":l.startSearch,"searchIconAria":l.searchIconAria}}},"sliceDropDownTemplate":c,"ui":{"input":".csui-input","clearer":".csui-clearer","searchIcon":".csui-header-search-icon"},"events":{"click .csui-header-search-icon":"searchIconClicked","focusin @ui.input":"hideStartLocations","click @ui.input":"hidePopover","keyup @ui.input":"inputTyped","paste @ui.input":"inputChanged","keydown @ui.clearer":"clearerClicked","change @ui.input":"inputChanged","click @ui.clearer":"clearerClicked","click .csui-searchbox-option":"selectSearchOption","keydown .csui-slice-checkbox":"changeSearchOption","focusout @ui.input":"hideSearchOptionsDropDown","focusout .csui-search-options-dropdown":"hideSearchOptionsDropDown","mouseleave .csui-search-options-dropdown":"hideSearchOptionsDropDown"},"behaviors":{"TabableRegion":{"behaviorClass":r}},"constructor":function(e){e||(e={}),e.data=t.defaults({},e.data,d),this.direction=u.settings.rtl?"left":"right",s.ItemView.prototype.constructor.apply(this,arguments),this.model=new n(void 0,e),this.searchboxModel=new o(void 0,e),this.listenTo(this.searchboxModel,"change",this.prepareTargetBrowsedropdown),this.listenTo(this.searchboxModel,"change",this.searchIconToggle),this.listenTo(this.searchboxModel,"change",this.hideSearchBar),this.model.get("where")&&i(document).bind("click."+this.cid+" keydown."+this.cid,this,this._hideSearchBar)},"isSearchbarVisible":function(){return this.$(".search-bar").is(":visible")},"onRender":function(){var e=this.options.data.inputValue||this.model.get("where");e&&(this._setInputValue(e),this.$el.find(".search-bar").show()),(this.options.data.showInput||e)&&(this.triggerMethod("before:show:input",this),this.ui.input.show(),this.triggerMethod("show:input",this)),this.ui.searchIcon.removeClass("icon-header-search_enabled").addClass("icon-header-search");var t=this;this.$el.find("*[data-cstabindex]").on("focus",function(){t._updateFocusables(this)})},"_updateFocusables":function(e){var t=i(e);this.focusedElement&&this.focusedElement.removeClass(r.accessibilityActiveElementClass),t.addClass(r.accessibilityActiveElementClass),this.focusedElement=t},"currentlyFocusedElement":function(e){if(this.$el){var t=this.$el.find("*[data-cstabindex=-1]");t.length&&t.prop("tabindex",0);!(!!e&&e.shiftKey)&&this.$el.find(".search-bar").length&&this.$el.find(".search-bar").is(":visible")?this.focusElement=this.$el.find(".csui-input"):this.$el.find("a.csui-acc-focusable").length&&(this.focusElement=this.$el.find("a.csui-acc-focusable"))}return this.focusElement},"onLastTabElement":function(e){var t=this.$("[data-cstabindex=-1]"),s=t.length-1,n=this;if(this.$el.find("*[data-cstabindex]").on("focus",function(){n._updateFocusables(this)}),t.length){var o=e?t[0]:t[s];return this.$(".csui-focus").removeClass("csui-focus"),i(o).hasClass(r.accessibilityActiveElementClass)}return!0},"resetPageDefaults":function(e){this.model.resetDefaults=!0},"searchIconClicked":function(e){if(i(document).bind("click."+this.cid+" keydown."+this.cid,this,this._hideSearchBar),this.ui.input.toggleClass(r.accessibilityFocusableClass),this.resetPageDefaults(e),this.searchboxModel.nodeId&&this.$el.find(".csui-searchbox-option").length>0&&(this.$el.find(".csui-searchbox-option")[0].checked=this.options.data.searchFromHere),this.$el.find(".search-bar").is(":visible")){this.$el.find("a.icon-global-search").attr("aria-expanded","true");var t=this.ui.input.val().trim();t&&(this._setInputValue(t),i(e.currentTarget).attr("title",l.startSearch).attr("aria-label",l.startSearch));var s="",n=this.$el.find(".csui-searchbox-option:checked");if(n&&(s=n.val()),history.state&&history.state.search&&(this.previousState=history.state.search),t){this.model.clear({"silent":!0});var o={};o.location_id1=s,t&&(o.where=t),this.model.set(o),this.trigger("change:searchterm",this.model),this._updateInput(e)}this.previousState&&(this.model.prevSearchState=this.previousState)}else if(this.$el&&this.$el.parents()){var a=this.$el.parents(".target-browse ").find("div[class='load-container']");if(a&&!a.hasClass("binf-hidden")){this.$el.find("a.icon-global-search").attr("aria-expanded","true");var c=this;this.hideStartLocations(),this.$el.find(".search-bar").show("blind",{"direction":this.direction},"200",function(){c.ui.input.focus()}),""===this.model.attributes.where&&(i(e.currentTarget).title="",i(e.currentTarget).addClass("icon-header-search-nohover"))}}},"showStartLocations":function(e){this.trigger("show:startLocation")},"hideStartLocations":function(e){this.trigger("hide:startLocation")},"inputTyped":function(e){var t=this.ui.input.val().trim();13===e.which?(e.preventDefault(),e.stopPropagation(),this._setInputValue(t),t&&this.searchIconClicked(e),this.previousValue!=t&&(this.previousValue=t)):27==e.keyCode?this.ui.searchIcon.is(":focus")?(e.preventDefault(),e.stopImmediatePropagation()):(this.hideSearchBar(),this.ui.searchIcon.focus(),e&&e.stopPropagation()):40===e.which&&i(".csui-search-options-dropdown").is(":visible")?this.$el.find(".csui-selected-checkbox").focus().focus():this.inputChanged(e)},"inputChanged":function(e){var t=this.ui.input.val();this.searchIconToggle(),this.ui.clearer.toggle(!!t.length),this.showOptionsDropdown(e)},"showOptionsDropdown":function(e){var t=e||window.event;this.searchboxModel.nodeId&&27!==t.which&&(this.$el.find(".csui-search-options-dropdown").show(),this.$el.find(".csui-searchbox-option").length>0&&(this.$el.find(".csui-searchbox-option")[0].checked=this.options.data.searchFromHere))},"prepareTargetBrowsedropdown":function(e){if(this.searchboxModel.nodeId){this.searchOptions={},this.searchOptions.nodeId=this.searchboxModel.nodeId,this.searchOptions.nodeIdSO=t.uniqueId("csui-so-"+this.searchboxModel.nodeId),this.searchOptions.select=l.searchOptionsSelect,this.searchOptions.fromHere=l.searchFromHere,this.searchOptions.selectFromHereAria=l.searchFromHereAria;var i=this.sliceDropDownTemplate(this.searchOptions);this.$el.find(".csui-search-options-dropdown").html(i),this.hideSearchOptionsDropDown(),this.ui.searchIcon.show(),this.ui.searchIcon.removeClass("icon-header-search_enabled").addClass("icon-header-search")}else this.destroyOptionspopover()},"destroyOptionspopover":function(e){this.$el.find(".csui-search-options-dropdown").html(""),this.$el.find(".csui-search-options-dropdown").hide()},"changeSearchOption":function(e){if(13===e.keyCode||32===e.keyCode){this.$el.find(".csui-searchbox-option:checked").length>0?this.$el.find(".csui-searchbox-option")[0].checked=!1:this.$el.find(".csui-searchbox-option")[0].checked=!0,this.selectSearchOption(e)}},"selectSearchOption":function(e){this.$el.find(".csui-searchbox-option:checked").length>0?this.options.data.searchFromHere=!0:this.options.data.searchFromHere=!1},"hideSearchOptionsDropDown":function(){var e=this;e.$el.find(".csui-searchbox-option").attr("tabindex",-1),setTimeout(function(){if(e.$el.find(".csui-selected-checkbox")[0]===document.activeElement)return!1;var t=e;return e.popoverTimer&&clearTimeout(e.popoverTimer),e.popoverTimer=setTimeout(function(){t.showSearchOptionDropDown()},800),!0},100)},"showSearchOptionDropDown":function(){this.$el.find(".csui-search-options-dropdown").is(":hover")?this.popoverTimer&&clearTimeout(this.popoverTimer):i(".csui-search-options-dropdown").hide()},"clearerClicked":function(e){"click"!==e.type&&13!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this._setInputValue(""),this.ui.searchIcon.removeClass("icon-header-search_enabled").addClass("icon-header-search"),this.hidePopover(e),this.ui.input.focus())},"setSlices":function(e){e.preventDefault(),e.stopPropagation();var t=i(e.target).data("sliceid"),s=this.$el.find(".csui-search-popover-checked"),n=this.$el.find(".icon-listview-checkmark"),o=n.length>0&&n.attr("id")===i(e.target).data("sliceid")+"";this.options.sliceString="",i(s).removeClass("icon-listview-checkmark"),o||(i("#"+t).addClass("icon-listview-checkmark"),this.options.sliceString="{"+t+"}"),this.slice=this.options.sliceString},"hidePopover":function(e){"block"===i(".csui-search-box-slice-popover").css("display")&&i(".csui-search-box-slice-popover").binf_popover("hide"),this.showOptionsDropdown(e)},"hideSearchBar":function(e){var t=this.$el.find(".search-bar"),i=this;this.ui.input.val(""),t.hide("blind",{"direction":this.direction},"200",function(){i.showStartLocations()}),this.$el.find(".csui-header-search-icon").removeClass("icon-header-search_enabled").addClass("icon-header-search")},"_hideSearchBar":function(e){var t=e||window.event,s=i(".search-bar"),n=e.data;s.is(":visible")&&(("keydown"!==t.type||27!==t.keyCode&&27!==t.which)&&(i(t.target).closest(s).length||"click"!==t.type||i(t.target).closest(".csui-header-search-icon").length||i(t.target).closest(".esoc-activityfeed-invisiblebutton").length)||(i(this).find(".icon-header-search-nohover").removeClass("icon-header-search-nohover"),i(this).find(".csui-input").val(""),n.$el.find(s).hide("blind",{"direction":e.data.direction},"200",function(){n.showStartLocations(),n.focusedElement=void 0,n.currentlyFocusedElement().focus()}),i(this).find(".csui-search-box-slice-popover").binf_popover("hide"),i(this).find(".csui-search-box .csui-header-search-icon").attr("title",l.searchIconTitle),i(this).find(".csui-search-box .csui-header-search-icon").attr("aria-label",l.searchIconAria),i(this).find(".csui-search-box .csui-header-search-icon").attr("aria-expanded","false"),e.data.slice=e.data.model.get("slice"),e.data.options.data.searchFromHere=!0,this.$el&&this.$el.parents(".csui-navbar").find(".binf-navbar-brand").addClass("binf-navbar-collapse"),i(this).find(".csui-search-options-dropdown").hide(),i(this).find(".csui-search-box .csui-header-search-icon").removeClass("icon-header-search_enabled").addClass("icon-header-search"),i(document).unbind("click."+this.cid+" keydown."+this.cid)))},"_updateInput":function(e){if(this._isRendered){var t=this.model.get("where")||"";this._setInputValue(t)}},"_setInputValue":function(e){this.ui.input.val(e),this.ui.clearer.toggle(!!e.length),this.searchIconToggle()},"searchIconToggle":function(){this.ui.input.val().trim()?(this.ui.searchIcon.removeClass("icon-header-search").addClass("icon-header-search_enabled"),this.ui.input.addClass("csui-input-focus"),i(this.ui.searchIcon).attr("title",l.startSearch).attr("aria-label",l.startSearch),i(this.ui.searchIcon).removeClass("icon-header-search-nohover")):(this.ui.searchIcon.removeClass("icon-header-search_enabled").addClass("icon-header-search"),this.ui.input.removeClass("csui-input-focus"),this.$el.find(".search-bar").is(":visible")&&(i(this.ui.searchIcon).addClass("icon-header-search-nohover"),i(this.ui.searchIcon).attr("title",l.searchBoxTitle).attr("aria-label",l.searchBoxTitle)))}})}),csui.define("hbs!csui/dialogs/node.picker/impl/header/header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return'  <h2 id="nodePickerHeader" class="csui-title">'+(null!=(o=null!=(o=t.title||(null!=e?e.title:e))?o:t.helperMissing,n="function"==typeof o?o.call(e,{"name":"title","hash":{}}):o)?n:"")+"</h2>\r\n  <div class='csui-filtername-container'>\r\n    <span class=\"cs-icon-required category_required\" title=\"\"></span>\r\n    <input type='text' class='csui-filtername' placeholder=\""+this.escapeExpression((o=null!=(o=t.placeHolderName||(null!=e?e.placeHolderName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"placeHolderName","hash":{}}):o))+'" tabindex="-1"\r\n           data-cstabindex="-1" />\r\n    <span class="csui-filtername-error binf-hidden" title=""></span>\r\n  </div>\r\n'},"3":function(e,t,i,s){var n;return'  <h2 id="nodePickerHeader" class="csui-title">'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+'</h2><span class="csui-separator"></span>\r\n'},"5":function(e,t,i,s){return"csui-no-search"},"7":function(e,t,i,s){return'    <div class="csui-start-locations binf-dropdown" ></div>\r\n'},"9":function(e,t,i,s){var n;return'      <div class="csui-global-search '+(null!=(n=t.if.call(e,null!=e?e.saveFilter:e,{"name":"if","hash":{},"fn":this.program(10,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.propertiesSeletor:e,{"name":"if","hash":{},"fn":this.program(12,s,0),"inverse":this.program(14,s,0)}))?n:"")+'"></div>\r\n'},"10":function(e,t,i,s){return"csui-save-filter "},"12":function(e,t,i,s){return""},"14":function(e,t,i,s){return"csui-no-properties-selector for-shortcut"},"16":function(e,t,i,s){return'      <div class="apply-properties-selector"></div>\r\n'},"18":function(e,t,i,s){return"csui-no-properties-selector"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=e?e.saveFilter:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'\r\n<div class="csui-target-controls '+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.globalSearch !== false",{"name":"xif","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.locationSelector:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.noop}))?n:"")+'\r\n  <div class="csui-target-search-property-container">\r\n'+(null!=(n=(t.xif||e&&e.xif||t.helperMissing).call(e,"this.globalSearch !== false",{"name":"xif","hash":{},"fn":this.program(9,s,0),"inverse":this.noop}))?n:"")+"\r\n"+(null!=(n=t.if.call(e,null!=e?e.propertiesSeletor:e,{"name":"if","hash":{},"fn":this.program(16,s,0),"inverse":this.noop}))?n:"")+'    <span class="csui-separator '+(null!=(n=t.if.call(e,null!=e?e.propertiesSeletor:e,{"name":"if","hash":{},"fn":this.program(12,s,0),"inverse":this.program(18,s,0)}))?n:"")+'"></span>\r\n  </div>\r\n</div>\r\n'}});return i.registerPartial("csui_dialogs_node.picker_impl_header_header",s),s}),csui.define("css!csui/dialogs/node.picker/impl/header/header",[],function(){}),csui.define("csui/dialogs/node.picker/impl/header/header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/dialogs/node.picker/impl/header/apply.properties.selector/apply.properties.selector.view","csui/dialogs/node.picker/impl/header/start.location.selector/start.location.selector.view","csui/dialogs/node.picker/impl/header/search.box/search.box.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/dialogs/node.picker/impl/header/header","i18n!csui/dialogs/node.picker/impl/nls/lang","csui/lib/handlebars.helpers.xif","css!csui/dialogs/node.picker/impl/header/header"],function(e,t,i,s,n,o,r,l,a){return i.LayoutView.extend({"template":l,"className":"cs-header-control","regions":{"startLocations":".csui-start-locations","globalSearch":".csui-global-search","properties":".apply-properties-selector"},"ui":{"saveFilter":".csui-filtername","saveFilterError":".csui-filtername-error","startlocations":".csui-start-locations"},"events":{"keyup @ui.saveFilter":"onChangeFilterName","keydown @ui.startlocations":"onStartLoaction","focusout @ui.saveFilter":"onFocusoutFilterName"},"templateHelpers":function(){var e=this.options;return{"title":e.title,"locationSelector":e.locationSelector,"propertiesSeletor":e.propertiesSeletor,"saveFilter":e.saveFilter,"placeHolderName":a.placeHolderName,"globalSearch":e.globalSearch,"backButtonTooltip":a.backButtonTooltip}},"behaviors":{"TabableRegion":{"behaviorClass":r}},"initialize":function(){var e=this.options,t=s.KEEP_ORIGINAL_PROPERTIES;if(e.propertiesSeletor&&(this.propertiesView=new s({"selected":t,"includeCombineProperties":this.options.includeCombineProperties})),e.locationSelector&&(this.startLocationView=new n({"collection":this.options.locations,"title":this.options.dialogTitle,"selected":this.options.initialLocation})),!1!==e.globalSearch){var i,r;if(this.options.initialLocation){var l=this.options.initialLocation.get("factory");i=l&&l.options.container?l.options.container.get("id"):null,r=l&&l.options.container?l.options.container.get("name"):null}this.searchBoxView=new o({"targetBrowseSearch":!0,"locationID":i,"locationName":r}),this.searchboxModel=this.searchBoxView.searchboxModel,this.searchQueryModel=this.searchBoxView.model}},"onRender":function(){this.options;this.startLocationView&&this.startLocations.show(this.startLocationView),this.propertiesView&&this.properties.show(this.propertiesView),this.searchBoxView&&this.globalSearch.show(this.searchBoxView),this.searchBoxView.on("show:startLocation",this.showStartLocations,this),this.searchBoxView.on("hide:startLocation",this.hideStartLocations,this),this.searchBoxView.on("close:dialog",this.onApplyProperties,this);var e=this;this.$el.find("*[data-cstabindex]").on("focus",function(){var i=t(this);e.focusedElement&&e.focusedElement.removeClass(r.accessibilityActiveElementClass),i.addClass(r.accessibilityActiveElementClass),e.focusedElement=i})},"currentlyFocusedElement":function(e){if(this.$el){var i=this.$("*[tabindex]");i.length&&i.prop("tabindex",0);return!(!!e&&e.shiftKey)&&this.$el.find(".csui-filtername").length?this.$el.find(".csui-filtername"):!!i[0]&&t(i[0]).focus()}},"onLastTabElement":function(e,t){return e&&t.target===this.$("*[tabindex]")[0]},"onStartLoaction":function(e){27===e.keyCode&&(this.ui.startlocations.is(":focus")||e.stopImmediatePropagation())},"onApplyProperties":function(){this.trigger("parent:destroydialog")},"showStartLocations":function(){this.startLocationView.$el.removeClass("binf-hidden")},"hideStartLocations":function(){this.startLocationView.$el.addClass("binf-hidden")},"onDomRefresh":function(){this.startLocationView&&this.startLocationView.trigger("dom:refresh"),this.propertiesView&&this.propertiesView.trigger("dom:refresh"),this.searchBoxView&&this.searchBoxView.trigger("dom:refresh")},"hideStartLocationLabel":function(e){this.startLocationView.hideDropDownLabel(e)},"reset":function(){this.startLocationView.reset()},"onChangeFilterName":function(){this.trigger("change:filterName")},"onFocusoutFilterName":function(){this.trigger("focusout:filterName")},"showErrorMessage":function(e){this.$(this.ui.saveFilterError).html(e),this.ui.saveFilterError.removeClass("binf-hidden")},"removeErrorMessage":function(){this.$(this.ui.saveFilterError).html(""),this.ui.saveFilterError.addClass("binf-hidden")}})}),csui.define("hbs!csui/dialogs/node.picker/impl/footer/footer",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-selected-items"></div>\r\n<div class="csui-footer-buttons"></div>'}});return i.registerPartial("csui_dialogs_node.picker_impl_footer_footer",s),s}),csui.define("hbs!csui/dialogs/node.picker/impl/footer/selectedItems.info",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return this.escapeExpression((n=null!=(n=t.selectedItemsMessage||(null!=e?e.selectedItemsMessage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"selectedItemsMessage","hash":{}}):n))},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return"<span>"+(null!=(n=t.if.call(e,null!=e?e.isMultiSelectEnabled:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"</span>\r\n"}});return i.registerPartial("csui_dialogs_node.picker_impl_footer_selectedItems.info",s),s}),csui.define("css!csui/dialogs/node.picker/impl/footer/footer",[],function(){}),csui.define("csui/dialogs/node.picker/impl/footer/footer.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/dialog/impl/footer.view","hbs!csui/dialogs/node.picker/impl/footer/footer","hbs!csui/dialogs/node.picker/impl/footer/selectedItems.info","i18n!csui/dialogs/node.picker/impl/nls/lang","csui/lib/handlebars.helpers.xif","css!csui/dialogs/node.picker/impl/footer/footer"],function(e,t,i,s,n,o,r,l,a,c){var u=i.ItemView.extend({"template":a,"className":"csui-selectedItems-message","templateHelpers":function(){var t=this.selectedItemsCnt||this.options.selectedItemsCnt,i="";return i=1===t?e.str.sformat(c.SelectOneItemMessage,t):e.str.sformat(c.SelectManyItemsMessage,t),{"isMultiSelectEnabled":this.options.isMultiSelectEnabled,"selectedItemsMessage":i}},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.call(this,e)},"onRender":function(){this.selectedItemsCnt||this.options.selectedItemsCnt?this.$el.removeClass("binf-hidden"):this.$el.addClass("binf-hidden")}}),d=i.LayoutView.extend({"template":l,"className":"cs-footer-control","behaviors":{"TabablesBehavior":{"behaviorClass":o,"recursiveNavigation":!0,"containTabFocus":!0}},"regions":{"selectedItemsInfoRegion":".csui-selected-items","buttonsRegion":".csui-footer-buttons"},"isTabable":function(){return this.$("*[tabindex]").length>0},"constructor":function(e){i.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"initialize":function(){var t=this.options,i=t.buttons?t.buttons:[],n=this.footerView=new r({"collection":new s.Collection(i)});this.messageView=new u(e.extend({},{"selectedItemsCnt":0})),this.listenTo(n,"childview:click",this.onClickButton),this.listenTo(this,"selectedItems:updateCount",this.updateSelectedItems)},"onRender":function(){this.buttonsRegion.show(this.footerView)},"updateButton":function(e,t){this.footerView.updateButton(e,t)},"onClickButton":function(e){var t=e.model.attributes;t.click&&t.click({"dialog":this,"button":this.$el}),t.close&&this.destroy()},"updateSelectedItems":function(t){this.messageView=new u(e.extend({},{"selectedItemsCnt":t,"isMultiSelectEnabled":this.options.isMultiSelectEnabled})),this.selectedItemsInfoRegion.show(this.messageView)},"onBeforeDestroy":function(){this.footerView.destroy(),this.messageView.destroy()}});return e.extend(d.prototype,n),d}),csui.define("csui/dialogs/node.picker/impl/command.type",["module","csui/lib/underscore","i18n!csui/dialogs/node.picker/impl/nls/lang"],function(e,t,i){
var s=e.config();t.defaults(s,{"addable_types":{"899":[899,480,146]}});var n=function(e){var s=e.initialContainer;switch(this.actionNodes=e.initialSelection?t.isArray(e.initialSelection)?e.initialSelection:e.initialSelection.models:[],this.unselectableNodes=e.unselectableNodes,this.invalidNodes=e.invalidNodes,this.selectableTypes=e.selectableTypes||[],this.unselectableTypes=e.unselectableTypes||[],this.showAllTypes=e.showAllTypes||!1,this.multiSelect=!!e.selectMultiple,this.action=e.command,this.parentId=null!=s?s.get("id"):-1,this.selectButtonLabel=e.selectButtonLabel||i.selectButtonLabel,this.action){case"copy":this.selectButtonLabel=e.selectButtonLabel||i.copyButtonLabel;break;case"move":this.selectButtonLabel=e.selectButtonLabel||i.moveButtonLabel;break;case"addCategories":this.selectableTypes=e.selectableTypes||[131],this.multiSelect=!0,this.actionNodes=[];break;case"savefilter":this.selectButtonLabel=e.selectButtonLabel||i.saveFilterButtonLabel,this.actionNodes=[];break;case"collect":this.selectableTypes=e.selectableTypes,this.multiSelect=!0,this.actionNodes=[];break;default:this.actionNodes=[]}};return t.extend(n.prototype,{"getSelectableNodeTypes":function(){return this.showAllTypes?[]:this.selectableTypes},"validateTarget":function(e){var i=e.data?e.data.id:e.get("id"),n=e.get("type"),o=s.addable_types[n],r=t.every(this.unselectableNodes,function(e){return i!==e});if(this.browseAllowed(e)&&(r=t.every(this.unselectableTypes,function(e){return n!==e})),o&&(r=t.every(this.actionNodes,function(e){return t.contains(o,e.get("type"))})),r)switch(this.action){case"copy":r=!this.isVirtualNode(e)&&this.validateNode(e);break;case"move":r=!this.isVirtualNode(e)&&this.validId(e),r&&(r=this.validateAddableTypes(e));break;case"savefilter":r=!this.isVirtualNode(e)}return r},"validId":function(e){return(e.data?e.data.id:e.get("id"))!==this.parentId},"validateAddableTypes":function(e){var i=e.addable_types;return!i||t.every(this.actionNodes,function(e){return t.some(i,function(t){return t.type===e.get("type")})})},"isSelectableType":function(e){var i=e.get("type"),s=t.every(this.unselectableTypes,function(e){return i!==e});return s&&!t.isEmpty(this.selectableTypes)&&!(s=-1!==t.indexOf(this.selectableTypes,i))&&this.browseAllowed(e)&&t.indexOf(this.selectableTypes,-1)>-1&&(s=!0),s},"isSelectable":function(e){var i=e.data?e.data.id:e.get("id"),n=e.get("type"),o=s.addable_types[n];if(e.get("unselectable"))return!1;var r=this.isSelectableType(e);if(r&&o&&(r=t.every(this.actionNodes,function(e){return t.contains(o,e.get("type"))})),r&&(r=t.every(this.unselectableNodes,function(e){return i!==e})),r&&(r=!this.isActionNode(e)),r)switch(this.action){case"copy":r=!this.isVirtualNode(e)&&this.validateNode(e);break;case"move":r=!this.isVirtualNode(e)&&this.validId(e);break;case"addCategories":r=!this.browseAllowed(e);break;case"savefilter":r=!this.isVirtualNode(e)}return r},"browseAllowed":function(e){var i=e.actions&&t.find(e.actions.models,function(e){return"open"===e.id});return e.get("container")&&(!1!==e.get("perm_see_contents")||i)},"validateNode":function(e){var t=this._hasValidId(e);return t&&!this.showAllTypes&&(this.browseAllowed(e)?"move"!==this.action&&"copy"!==this.action||!this.isActionNode(e)||(t=!1):this.selectableTypes.length>0&&-1===this.selectableTypes.indexOf(e.get("type"))&&(t=!1)),t},"isActionNode":function(e){var i=e.get("id"),s=e.get("parent_id");return t.any(this.actionNodes,function(e){var t=e.get("id"),n=t===i;return n||t===s})},"isVirtualNode":function(e){var t=e.get("type"),i=!1;return 899===t&&(i=!0),i},"_hasValidId":function(e){return t.every(this.invalidNodes,function(t){return t.get("id")!==e.get("id")})},"shouldResolveShortcut":function(e){return 1===e.get("type")&&"number"==typeof e.get("original_id")}}),n}),csui.define("css!csui/dialogs/node.picker/impl/node.picker",[],function(){}),csui.define("csui/dialogs/node.picker/node.picker",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/dialog/dialog.view","csui/dialogs/node.picker/impl/node.picker.view","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/node","csui/models/node/node.model","csui/dialogs/node.picker/start.locations/start.location.collection","csui/dialogs/node.picker/impl/header/header.view","csui/dialogs/node.picker/impl/footer/footer.view","csui/dialogs/node.picker/impl/command.type","i18n!csui/dialogs/node.picker/impl/nls/lang","csui/utils/log","csui/controls/progressblocker/blocker","css!csui/dialogs/node.picker/impl/node.picker"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b,g){"use strict";function v(e){if(e||(e={}),this.options=t.defaults(e,y,{"pageSize":30}),this.options.connector||(this.options.connector=this._getConnector(this.options)),!this.options.connector){var i="Node Picker: insufficient options";throw f.error(i)&&console.error(i),new Error(i)}this.options.targetBrowseHistory=[],this.options.navigateFromHistory=!1,this.options.initialContainer=this._getInitalContainer(this.options),this.options.unselectableNodes=this._getArrayOfNodeIds(e.unselectableNodes),this.options.commandType=new p(this.options)}var w=t.extend({"initialLocationLookupOrder":["csui/dialogs/node.picker/start.locations/recent.containers","csui/dialogs/node.picker/start.locations/current.location","csui/dialogs/node.picker/start.locations/favorites"]},e.config()),y={"initialSelection":[],"selectMultiple":!1,"unselectableNodes":[],"dialogTitle":m.dialogTitle,"orderBy":"name asc"};return t.extend(v.prototype,{"show":function(){return this._locations=new u(this.options),this._locations.fetch({"connector":this.options.connector,"container":this.options.initialContainer,"removeInvalid":!1}).done(t.bind(this._showDialog,this)),this._deferred=i.Deferred(),this._deferred.promise()},"_showDialog":function(){this.recentLocations=this._locations.get("csui/dialogs/node.picker/start.locations/recent.containers");var e=this._locations.where({"invalid":!0});this._locations.remove(e);var t=this._getInitialLocation();this.searchLocation=t,this._headerControl=this._createHeaderControl(t),this._view=this._createNodePickerView(t),this._footerView=this._createFooterViewControl(),this._dialog=this._createDialog(),this._dialog.show()},"_createHeaderControl":function(e){var t=this.options,i=null==t.locationSelector||t.locationSelector;this.options.previousLocation=e;var s=new d({"locations":this._locations,"title":t.dialogTitle,"initialLocation":e,"includeCombineProperties":t.includeCombineProperties,"propertiesSeletor":t.propertiesSeletor,"saveFilter":t.saveFilter,"locationSelector":i,"initialSelection":t.initialSelection,"globalSearch":t.globalSearch});return s.startLocationView.on("change:location",this.onChangeLocation,this),s.on("change:filterName",this.onChangeFilterName,this),s.on("focusout:filterName",this.onFocusOutFilterName,this),s.searchBoxView&&s.searchBoxView.on("change:searchterm",this.onChangeSearchTerm,this),s},"_createNodePickerView":function(e){this.options.searchView=!1;var i=e.get("factory"),s=i.getLocationParameters(this.options);t.defaults(s,this.options);var n=new r(s);return n.on("change:complete",this.onSelectionChange,this).on("changing:selection",this._blockDialog,this).on("back:toSearch",this.onClickBackFromFolderToSearch,this).on("change:location",this.onChangeLocationFromBack,this).on("backto:folder",this.onClickBackFromSearch,this).on("close",this.forceClosed,this),n.selectViews.on("drill:up",this.onDrillUp,this),n},"_createFooterViewControl":function(){var e=this.options;return new h({"isMultiSelectEnabled":this.options.commandType.multiSelect,"buttons":[{"id":"select","label":e.selectButtonLabel||e.commandType.selectButtonLabel,"default":!0,"disabled":!0,"click":t.bind(this.onClickSelectButton,this)},{"id":"cancel","label":m.cancelButtonLabel,"close":!0,"click":t.bind(this.onClickCancelButton,this)}]})},"_blockDialog":function(){return this._dialog.blockWithoutIndicator(),!0},"dialogClassName":function(){var e="target-browse";return this.options&&this.options.view&&this.options.view.options&&this.options.view.options.saveFilter&&(e+=" csui-save-filter-browse"),e},"_createDialog":function(){var e=this.options,i=new o({"title":e.dialogTitle,"headerView":this._headerControl,"view":this._view,"className":this.dialogClassName,"attributes":{"aria-label":e.dialogTitle},"largeSize":!0,"footerView":this._footerView});return i.listenTo(i,"hide",t.bind(this.onHideDialog,this)),b.imbue(i),i},"onChangeLocation":function(e){this.options.targetBrowseHistory=[],this._view.destroy(),this.updateFooterSelectedList(),this._dialog.updateButton("select",{"disabled":!0}),this.options.previousLocation=e,this._view=this._createNodePickerView(e);var t=e.get("factory").container;this.updateSearch(t),this._dialog.showView(this._view)},"onChangeSearchTerm":function(e){if(this._headerControl.searchQueryModel=e,this._view.destroy(),this.updateFooterSelectedList(),this._dialog.updateButton("select",{"disabled":!0}),0===this.options.targetBrowseHistory.length&&this.options.targetBrowseHistory.push(["location",this.options.previousLocation.id]),!this._view.options.navigateFromHistory&&!this.options.searchView){var t=this._view.selectViews.leftView,i=this._view.selectViews.rightView,s=Math.floor((t.collection.skipCount||0)/t.collection.topCount)+1,n=parseInt(t.collection.topCount)*parseInt(s);if(t.container&&i){var o={"leftId":i&&i.container&&i.container.parent?i.container.parent.get("id"):void 0,"rightId":i&&i.container?i.container.get("id"):void 0,"pageSize":n};this.options.targetBrowseHistory.push(["node",o])}else if(t.container&&null===i&&["csui/dialogs/node.picker/start.locations/current.location","csui/dialogs/node.picker/start.locations/enterprise.volume"].indexOf(this.options.previousLocation.get("id"))<0){var r={"leftId":t.container.get("id"),"rightId":void 0,"pageSize":n};this.options.targetBrowseHistory.push(["node",r])}}this.options.locationID=this._view.breadcrumbNode?this._view.breadcrumbNode.get("id"):this.options.locationID,this.searchLocation=this.options.previousLocation;var l=this._locations.get("csui/dialogs/node.picker/start.locations/search.location");this._view=this._createSearchResultsView(l),this._dialog.showView(this._view)},"_createSearchResultsView":function(e,i){this._headerControl.searchQueryModel&&(this.options.query=this._headerControl.searchQueryModel),this.options.searchView=!0;var s=e.get("factory"),n=s.getLocationParameters(this.options);t.defaults(n,this.options);var o=new r(n);return o.on("change:complete",this.onSelectionChange,this).on("changing:selection",this._blockDialog,this).on("open:location",this.onClickLocationFromSearch,this).on("change:location",this.onChangeLocationFromBack,this).on("back:toSearch",this.onClickBackFromFolderToSearch,this).on("backto:folder",this.onClickBackFromSearch,this).on("close",this.forceClosed,this),o},"onChangeLocationFromBack":function(e){this.options.targetBrowseHistory=[];var t=this._locations.get(e[1]);this._view.destroy(),this.updateFooterSelectedList(),this._dialog.updateButton("select",{"disabled":!0}),this.options.previousLocation=t,this._view=this._createNodePickerView(t);var i=t.get("factory").container;this.updateSearch(i),this._dialog.showView(this._view),this._view.selectViews.options.backBtn=!0},"onClickBackFromSearch":function(){this._view.destroy(),this.updateFooterSelectedList(),this._dialog.updateButton("select",{"disabled":!0});var e=this.options.locationID?this.options.locationID:this.options.container?this.options.container.get("id"):this.options.nodes.models.length>0?this.options.nodes.models[0].get("id"):null,t=new c({"id":e},{"connector":this.options.connector});this.updateSearch(t,void 0,!0);var i=this._locations.get("csui/dialogs/node.picker/start.locations/search.location");if(0===this.options.locationID&&(i=this.options.previousLocation),i){i.get("factory").options.container=t,this._view=this._createNodePickerView(i),this._view&&this._dialog.showView(this._view)}this._view.selectViews.options.backBtn=!0},"onClickLocationFromSearch":function(e){this._view.destroy(),this.updateFooterSelectedList(),this._dialog.updateButton("select",{"disabled":!0});var t=this._locations.get("csui/dialogs/node.picker/start.locations/default.location");t.get("factory").options.container=e,this.options.targetBrowseHistory.push(["search",this.options.query.clone()]),this._view=this._createNodePickerView(t),this._view&&(this._dialog.showView(this._view),this._view.showBackButton())},"onClickBackFromFolderToSearch":function(e){this._view.destroy(),this._headerControl.searchQueryModel=e.requestedQueryModel,this.updateSearch(e.options.container,e.requestedQueryModel,!0),this.updateFooterSelectedList(),this._dialog.updateButton("select",{"disabled":!0});var t=this._locations.get("csui/dialogs/node.picker/start.locations/search.location");this._view=this._createSearchResultsView(t,!0),this._view.options.navigateFromHistory=e.options.navigateFromHistory,this._dialog.showView(this._view),this._view.selectViews.options.backBtn=!0},"onSelectionChange":function(e){var t,i=this._view.getNumberOfSelectItems()>0;e&&e.get("id")&&e.get("name")&&(this.options.locationID=e.get("id"),this.updateSearch(e),this.updateHeaderStartLocation(e)),this.updateFooterSelectedList(),this._dialog.destroyBlockingView(),this.options.saveFilter&&this._headerControl&&this._headerControl.ui.saveFilter?(t=!!this._headerControl.ui.saveFilter.val().trim(),t&&i?this._dialog.updateButton("select",{"disabled":!1}):this._dialog.updateButton("select",{"disabled":!0})):this._dialog.updateButton("select",{"disabled":!i}),this._view.selectViews.options.backBtn&&(this._view.selectViews.options.backBtn=!1,this._view.$el.find(".list-content li:first-child").focus())},"onChangeFilterName":function(){var e=this._dialog.$el.find("div[class='load-container']");if(this.options.saveFilter&&e&&0===e.length){var t,i,s=!0;this._headerControl.ui.saveFilter&&(s=this._headerControl.ui.saveFilter.val().trim().length<1),i=this._view.getNumberOfSelectItems()>0,this.updateFooterSelectedList(),this._headerControl&&this._headerControl.ui.saveFilter&&(t=!s),t&&i?this._dialog.updateButton("select",{"disabled":!1}):this._dialog.updateButton("select",{"disabled":!0})}},"onFocusOutFilterName":function(){this.isValidVirtualFolderName()},"isValidVirtualFolderName":function(){var e=!1,t=!1;return this._headerControl.ui.saveFilter&&1===this._headerControl.ui.saveFilter.length&&void 0!==this._headerControl.ui.saveFilter.val()&&null!==this._headerControl.ui.saveFilter.val()&&(e=this._headerControl.ui.saveFilter.val().trim().length<1,t=this._headerControl.ui.saveFilter.val().indexOf(":")>=0),e?this._headerControl.showErrorMessage(m.nameCannotBeEmpty):t?this._headerControl.showErrorMessage(m.nameCannotContainColon):this._headerControl.removeErrorMessage(),!e&&!t},"updateHeaderStartLocation":function(e){this.options.commandType.browseAllowed(e)&&this._headerControl.hideStartLocationLabel(e)},"updateSearch":function(e,t,i){var s=e?e.get("id"):void 0,n=e?e.get("name"):"";if(this._headerControl.searchBoxView&&this._headerControl.searchboxModel){if(i){var o=t?t.get("location_id1"):this._headerControl.searchBoxView.model.get("location_id1");this._headerControl.searchboxModel.nodeId=o}else this._headerControl.searchboxModel.nodeId=s;this._headerControl.searchboxModel.nodeName=n,this._headerControl.searchboxModel.trigger("change")}},"updateFooterSelectedList":function(){var e=this._view.getNumberOfSelectItems();this._footerView.trigger("selectedItems:updateCount",e)},"onClickSelectButton":function(){if(this&&this._view&&this._view.getSelection().length>0){var e,t=this._view.getSelection(),i=this._headerControl.propertiesView;if(this._headerControl.searchQueryModel&&this._headerControl.searchQueryModel.clear({"silent":!0}),!(this._headerControl.ui&&this._headerControl.ui.saveFilter&&this.isValidVirtualFolderName()))return;e=this._headerControl.ui.saveFilter.val(),this._result={"nodes":t,"applyProperties":i&&i.selected,"openSelectedProperties":i&&i.openSelectedProperties,"filterName":e},this._dialog.destroy()}else this._dialog.updateButton("select",{"disabled":!0})},"onHideDialog":function(){this._deferred&&(this._result?this._deferred.resolve(this._result):"pending"===this._deferred.state()&&this._deferred.reject({"cancelled":!0})),this._headerControl.searchQueryModel&&this._headerControl.searchQueryModel.clear({"silent":!0})},"onDrillUp":function(e){this.options.container=new c({"id":e},{"connector":this.options.connector}),this._locations.get("csui/dialogs/node.picker/start.locations/search.location").get("factory").options.container=this.options.container},"_getConnector":function(e){var i;if(e.context)i=e.context.getObject(l);else if(e.initialSelection||e.initialContainer){var s=e.initialSelection,n=s?t.isArray(s)?s:s.models:void 0,o=e.initialContainer||n[0];i=o&&o.connector}return i},"_getInitalContainer":function(e){var i=this.options.initialContainer;if(null==i||t.isEmpty(i)){var n=e.context&&e.context.getModel(a);i=null!=n&&null!=n.parent&&n.parent.isFetchable()?1===n.parent.get("id")||n.get("container")?n.clone():n.parent.clone():null}else i instanceof s.Model||(i=new c(i,{"connector":this.options.connector}));return i},"_getArrayOfNodeIds":function(e){return e&&!t.isEmpty(e)&&e[0]instanceof s.Model?t.map(e,function(e){return e.get("id")}):e},"_getInitialLocation":function(){var e,i=this.options.startLocation;if(i){i.lastIndexOf("/")<0&&(i="csui/dialogs/node.picker/start.locations/"+i),e=this._locations.get(i)}return e||(e=!t.isEmpty(this.options.initialContainer)&&this._locations.get("csui/dialogs/node.picker/start.locations/current.location"))||(t.find(w.initialLocationLookupOrder,function(t){return e=this._locations.get(t)},this),e||(e=this._locations.first())),e},"onClickCancelButton":function(){this._dialog.destroy()}}),v.defaults={"containers":{"selectableTypes":[-1],"dialogTitle":m.dialogTitleForContainers},"documents":{"selectableTypes":[144],"dialogTitle":m.dialogTitleForDocuments},"categories":{"initialContainer":{"id":"volume","type":133},"selectableTypes":[131],"dialogTitle":m.dialogTitleForCategories}},v}),csui.define("csui/dialogs/members.picker/members.picker.wizard",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/dialogs/members.picker/impl/members.picker.view","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/member","csui/models/member/member.model","csui/models/member/membercollection","csui/models/permission/nodepermission.model","csui/dialogs/members.picker/start.locations/start.location.collection","csui/dialogs/members.picker/impl/command.type","csui/dialogs/members.picker/impl/header/members.picker.header.view","i18n!csui/dialogs/members.picker/impl/nls/lang","csui/utils/log","csui/controls/progressblocker/blocker","csui/controls/wizard/wizard.view","csui/widgets/permissions/impl/edit/permission.level.selector/permission.level.selector.view","csui/widgets/permissions/impl/edit/permission.attributes/permission.attributes.view","csui/widgets/permissions/impl/edit/apply.permission/apply.permission.view","csui/utils/taskqueue","csui/controls/globalmessage/globalmessage","i18n","css!csui/dialogs/members.picker/impl/members.picker","csui/dialogs/node.picker/node.picker"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b,g,v,w,y,_,C,T){"use strict";function x(e){if(e||(e={}),this.options=t.defaults(e,I,{"pageSize":30}),this.options.connector||(this.options.connector=this._getConnector(this.options)),!this.options.connector){var i=m.missingConnector;throw f.error(i)&&console.error(i),new Error(i)}this.options.targetBrowseHistory=[],this.options.navigateFromHistory=!1,this.options.initialContainer=this._getInitalContainer(this.options),this.options.unselectableMembers=this._getArrayOfNodeIds(e.unselectableMembers),this.options.selectableMembers=this._getArrayOfNodeIds(e.selectableMembers),this.options.commandType=new h(this.options)}var S=t.extend({"initialLocationLookupOrder":["csui/dialogs/members.picker/start.locations/recent.groups","csui/dialogs/members.picker/start.locations/member.groups","csui/dialogs/members.picker/start.locations/acl.groups","csui/dialogs/members.picker/start.locations/all.members"]},e.config());t.defaults(S,{"parallelism":3});var I={"initialSelection":[],"dialogTitle":m.dialogTitle,"orderBy":"name asc"};return t.extend(x.prototype,{"show":function(){return this._locations=new d(this.options),this._locations.fetch({"connector":this.options.connector,"container":this.options.initialContainer,"nodeId":this.options.nodeModel?this.options.nodeModel.get("id"):void 0,"removeInvalid":!1}).done(t.bind(this._showWizard,this)),this._deferred=i.Deferred(),this._deferred.promise()},"_showWizard":function(){this._steps=this._createWizardSteps(),this._wizard=new g({"steps":this._steps}),b.imbue(this._wizard),this._wizard.options.editpermission=this.membersPickerView.options.edit_permission,this._wizard.options.groupId=this.membersPickerView.options.groupId,this._wizard.options.id=this.membersPickerView.options.groupId,this._wizard.options.add=this.membersPickerView.options.add,this._wizard.show(this._wizard.options),this._wizard.on("save:result",this.onClickFinishButton,this),this._wizard.on("add:member",this.onClickAddButton,this),this._wizard.currentView.headerView.on("show:selectItem",this.selectUsers,this),this._wizard.currentView.headerView.on("enable:add",this.enableAdd,this),this.options.selectedMember&&this.selectUsers(this.options.selectedMember)},"_createHeaderControl":function(e){var t=this.options,i=null==t.locationSelector||t.locationSelector,s=null!=t.displayStartLocation&&t.displayStartLocation,n=new p({"locations":this._locations,"headerViewoptions":this.options,"title":t.dialogTitle,"context":t.context,"authUser":this.options.authUser,"initialLocation":e,"displayStartLocation":s,"adduserorgroup":!!t.adduserorgroup&&t.adduserorgroup,"showUserPicker":t.showUserPicker,"locationSelector":i,"selectedMember":t.selectedMember,"initialSelection":t.initialSelection});return t.adduserorgroup&&n.startLocationView.on("change:location",this.onChangeLocation,this),n.on("hide:parentDialog",this.parentdialogdestroy,this),n},"parentdialogdestroy":function(e){this._wizard.destroy()},"_createPickerView":function(e){this.options.startLocation||(this.options.startLocation=this._locations.at(0));var i=this.options,s=e.get("factory"),n=s.getLocationParameters(this.options);t.defaults(n,this.options);var r=new o(n);return r.on("update:button",this.updateButton,this),r.on("changing:selection",this._blockDialog,this).on("change:location",this.onChangeLocation,this),i.adduserorgroup&&r.on("change:complete",this.onSelectionChange,this),this.membersPickerView=r,r},"_createPermissionLevelSelectorView":function(){var e=new v({"selected":1,"isContainer":!this.options.nodeModel||this.options.nodeModel.get("container")});return e.on("permission:level:selected",this.onPermissionLevelSelection,this),e},"_createPermissionLevelSubItemsView":function(){var e=new y({"selected":2,"context":this.options.context,"model":this.options.nodeModel,"applyTo":this.options.applyTo});return e.on("permission:level:selected",this.onPermissionLevelSelection,this),e},"dialogClassName":function(){var e="target-browse";return this.options&&this.options.userClassName&&(e=e+" "+this.options.userClassName),e},"_createWizardSteps":function(){var e,i,s,n=this.options,o=this._getInitialLocation(),r=this._createHeaderControl(o),l=this._createPickerView(o),a=!(!n.nodeModel||!n.nodeModel.get("container")||"advanced"!==n.nodeModel.get("permissions_model")),c=t.uniqueId("permissionLevel");if(n.adduserorgroup&&!n.showUserPicker&&a)return e={"title":n.dialogTitle,"adduserorgroup":!!n.adduserorgroup&&n.adduserorgroup,"headerView":r,"view":l,"className":this.dialogClassName,"nextButton":!0,"userClassName":this.options.dialogClass,"attributes":{"aria-labelledby":"memberPickerHeader"},"largeSize":!0},i={"title":n.dialogTitle,"headers":[{"label":m.selectPermissionLevel,"class":"csui-permission-level-select","id":c}],"nextButtonLabel":m.nextButtonLabel,"nextButton":!0,"disableNext":!1,"view":this._createPermissionLevelSelectorView(),"className":this.dialogClassName()+" csui-permissions-level","attributes":{"aria-labelledby":"memberPickerHeader","aria-describedby":c}},s={"title":n.dialogTitle,"doneButtonLabel":m.doneButtonLabel,"disableDone":!1,"doneButton":!0,"view":this._createPermissionLevelSubItemsView(),"className":this.dialogClassName()+" csui-permissions-apply-dialog","attributes":{"aria-labelledby":"memberPickerHeader"}},[e,i,s];if(!n.adduserorgroup||n.showUserPicker||a){return[{"title":n.dialogTitle,"adduserorgroup":!!n.adduserorgroup&&n.adduserorgroup,"showUserPicker":n.showUserPicker,"headerView":r,"view":l,"className":this.dialogClassName,"userClassName":this.options.dialogClass,"attributes":{"aria-labelledby":"memberPickerHeader"},"largeSize":!0,"buttons":n.buttons}]}return e={"title":n.dialogTitle,"adduserorgroup":!!n.adduserorgroup&&n.adduserorgroup,"headerView":r,"view":l,"className":this.dialogClassName,"nextButton":!0,"userClassName":this.options.dialogClass,"attributes":{"aria-labelledby":"memberPickerHeader"},"largeSize":!0},i={"title":n.dialogTitle,"headers":[{"label":m.selectPermissionLevel,"class":"csui-permission-level-select","id":c}],"doneButtonLabel":m.doneButtonLabel,"disableDone":!1,"doneButton":!0,"view":this._createPermissionLevelSelectorView(),"className":this.dialogClassName()+" csui-permissions-level","attributes":{"aria-labelledby":"memberPickerHeader","aria-describedby":c}},[e,i]},"_blockDialog":function(){return this._wizard.blockWithoutIndicator(),!0},"onHideDialog":function(){this._deferred&&(this._result?this._deferred.resolve(this._result):"pending"===this._deferred.state()&&this._deferred.reject({"cancelled":!0}))},"onChangeLocation":function(e){e.get||(e=this._locations.get("csui/dialogs/members.picker/start.locations/"+e)),this.options.targetBrowseHistory=[];var t=this.membersPickerView&&this.membersPickerView.selectedMemberList&&this.membersPickerView.selectedMemberList.collection.models;this._steps[0].view.destroy(),this.membersPickerView.trigger("change:complete"),this.options.previousLocation=e,this._steps[0].view=this._createPickerView(e);e.get("factory").container;this._wizard.currentView.showView(this._steps[0].view),t&&this.selectUsers(t)},"selectUsers":function(e){this.membersPickerView&&this.membersPickerView.selectedMemberList&&this.membersPickerView.selectedMemberList.trigger("show:selectItem",e)},"enableAdd":function(){var e=this._wizard.currentView.footerView.children._views;t.each(e,function(e){"Add"===e.model.get("id")&&e.$el.removeClass("binf-hidden")},this)},"updateButton":function(e){this._wizard.currentView.footerView&&this._wizard.currentView.footerView.trigger("update:button",e),this.locationId=!!this._wizard.currentView.headerView.options&&!!this._wizard.currentView.headerView.options.headerViewoptions&&this._wizard.currentView.headerView.options.headerViewoptions.locationID;var i=this._wizard.currentView.footerView.children._views;t.each(i,function(t){"Add"===t.model.get("id")&&(e.models.length>0&&this._wizard.options.add?this.options.selectedMember&&!this.locationId?t.$el.attr("disabled","disabled"):t.$el.removeAttr("disabled"):t.$el.attr("disabled","disabled"))},this);var s=e.models.length>0;this._wizard.currentView.headerView&&this._wizard.currentView.headerView.userSearchView&&this._wizard.currentView.headerView.userSearchView.updatePlaceHolder(s)},"onClickFinishButton":function(){var e,t,i,s;this&&this.getMemberPickerView()&&this.getMemberPickerView().getSelection()?(e=this.getMemberPickerView().getSelection(),t=this.getPermissionLevelView().getSelectedPermissions(),s=!(!this.options.nodeModel.get("container")||"advanced"!==this.options.nodeModel.get("permissions_model")),s&&(i=this.getPermissionsApplyView().getApplyToFlag()),this._result={"members":e,"permissions":t,"apply_to":s?i?2:3:0},this._wizard.destroy(),this.onHideDialog()):this._wizard.currentView.updateButton("next",{"disabled":!0})},"onClickAddButton":function(){var e=this._wizard.options.groupId,s=this.options.connector.connection.url;s=s.replace("v1","v2");var n=this,o=this.getMemberPickerView().getSelection()&&this.getMemberPickerView().getSelection().get("name_formatted")||this.membersPickerView.options.displayName,r={},l={},a=this.options.connector,c=!!this._wizard.currentView.headerView.options&&!!this._wizard.currentView.headerView.options.headerViewoptions&&this._wizard.currentView.headerView.options.headerViewoptions.locationID;e=c||e,n.groupName=o,n.failedUsers=[],n.passcount=0,n.failcount=0;var u=new _({"parallelism":S.parallelism}),d=0,h=this.membersPickerView&&this.membersPickerView.selectedMemberList&&this.membersPickerView&&this.membersPickerView.selectedMemberList.collection.models,p=t.map(h,function(t){var o=i.Deferred();return u.pending.add({"worker":function(){return r={"member_id":t.id},l=a.extendAjaxOptions({"type":"POST","id":e,"url":s+"/members/"+e+"/members","data":r}),n.userName=t.get("name_formatted")||t.get("name"),i.ajax(l).done(function(e){n.passcount+=1,o.resolve(t)},n).fail(function(e){n.failcount+=1,n.failedUsers.push(n.userName),o.resolve(t)},n),o.promise()}}),d++,o.promise(p)});i.whenAll.apply(i,p).then(function(e){1===n.passcount&&0===n.failcount?C.showMessage("success",t.str.sformat(m.singleUserText,n.userName,n.groupName)):0===n.passcount&&1===n.failcount?C.showMessage("error",t.str.sformat(m.singleUserFailureText,n.userName,n.groupName)):1===n.passcount&&n.failcount>0?C.showMessage("success",t.str.sformat(m.SinglePassMoreThanOneFail,n.userName,n.groupName,n.failcount)):n.passcount>0&&n.failcount>0?C.showMessage("success",t.str.sformat(m.manyUserText,n.passcount,n.failcount,n.groupName)):n.passcount>0&&0===n.failcount?C.showMessage("success",t.str.sformat(m.onlyAllSuccessText,n.passcount,n.groupName)):0===n.passcount&&n.failcount>0&&C.showMessage("error",t.str.sformat(m.onlyAllFailureText,n.failcount,n.groupName)),n._wizard.destroy()})},"_getArrayOfNodeIds":function(e){return e&&!t.isEmpty(e)&&e[0]instanceof s.Model?t.map(e,function(e){return e.get("right_id")}):e},"_getInitalContainer":function(e){var i=this.options.initialContainer;return null!=i&&!t.isEmpty(i)&&i instanceof s.Model||(i=new a({"groupId":e.groupId,"displayName":e.displayName},{"connector":e.connector})),i},"_getConnector":function(e){var i;if(e.context)i=e.context.getObject(r);else if(e.initialSelection||e.initialContainer){var s=e.initialSelection,n=s?t.isArray(s)?s:s.models:void 0,o=e.initialContainer||n[0];i=o&&o.connector}return i},"_getInitialLocation":function(){var e,t=this.options.startLocation;if(t){t.lastIndexOf("/")<0&&(t="csui/dialogs/members.picker/start.locations/"+t),e=this._locations.get(t)}return!t&&this.options.groupId&&(e=this._locations.get("csui/dialogs/members.picker/start.locations/current.group")),e},"onSelectionChange":function(e){var t,i=this.getMemberPickerView().getNumberOfSelectItems()>0;e&&e.get("id")&&(this.options.locationID=e.get("id")),this._wizard.options.add=e&&e.add,this._wizard.destroyBlockingView();var s=this.getMemberPickerHeader();if(this.options.saveFilter&&s&&s.ui.saveFilter?(t=!!s.ui.saveFilter.val().trim(),t&&i?this._wizard.updateButton("next",{"disabled":!1}):this._wizard.updateButton("next",{"disabled":!0})):(this._wizard.updateButton("next",{"disabled":!i}),this.membersPickerView&&this.membersPickerView.selectedMemberList.collection.models.length>0&&e&&e.get("id")&&e.add&&!e.get("deleted")?this._wizard.updateButton("Add",{"disabled":!1}):this._wizard.updateButton("Add",{"disabled":!0})),this.isCustom){this._steps[1].view=this._createPermissionLevelSelectorView();this._wizard.getStepViewByStepNumber(1).showView(this._steps[1].view),this.isCustom=!1}},"onPermissionLevelSelection":function(){
if(this.getPermissionLevelView().selected===u.PERMISSION_LEVEL_CUSTOM){var e=new w({"permissions":[],"readonly":!1,"showButtons":!1,"node":this.options.nodeModel});this._steps[1].view=e,this._wizard.currentView.showView(this._steps[1].view),this.isCustom=!0;for(var t,s,n,o=e.$el.find(".csui-permission-attribute-tree"),r=o.find(".csui-tree-split"),l=r.length-1,a=0;a<r.length;l--,a++)s=i(r[l]).width()*a,n=i(r[l]).closest(".csui-tree-child").find(".csui-separator"),r[l]===r[r.length-1]?t=o.outerHeight():(t=Math.round(i(r[l]).closest("li").position().top+i(r[l]).closest(".csui-tree-child").outerHeight()),s+=a),T&&T.settings.rtl?(i(r[l]).css({"height":t,"left":s}),n.css({"width":o.find(".csui-tree-container").width(),"left":s}),i(r[l]).closest(".csui-tree-child").css({"padding-left":s+i(r[l]).width()})):(i(r[l]).css({"height":t,"right":s}),n.css({"width":o.find(".csui-tree-container").width(),"right":s}),i(r[l]).closest(".csui-tree-child").css({"padding-right":s+i(r[l]).width()}))}this._wizard.updateButton("next",{"disabled":!1})},"getMemberPickerView":function(){return this._steps[0].view},"getMemberPickerHeader":function(){return this._steps[0].headerView},"getPermissionLevelView":function(){return this._steps[1].view},"getPermissionsApplyView":function(){return this._steps[2].view}}),x}),csui.define("csui/controls/table/cells/user/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/user/impl/nls/root/localized.strings",{"publicAccess":"Public Access","noOwnerAssigned":"No owner assigned","noGroupAssigned":"No group assigned","addOwnerOrGroup":"Add owner or owner group","ownerAccessTitle":"Owner access","groupOwnerAccessTitle":"Group owner access","addButtonLabel":"Add","cancelButtonLabel":"Cancel","addButtonTooltip":"Add member to group","cancelButtonTooltip":"Close dialog"}),csui.define("hbs!csui/controls/table/cells/user/impl/user",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return'  <div class="csui-profileimg">\r\n    <span class="csui-icon-paceholder csui-icon icon_permmision_public"></span>\r\n  </div>\r\n  <div class="member-info csui-fadeout'+(null!=(n=t.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+' ">\r\n    <div class="">\r\n      <span class="csui-user-display-name csui-public"\r\n            aria-label="'+this.escapeExpression((o=null!=(o=t.ariaUserLabel||(null!=e?e.ariaUserLabel:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"ariaUserLabel","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.publicAccesslabel||(null!=e?e.publicAccesslabel:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"publicAccesslabel","hash":{}}):o))+"</span>\r\n    </div>\r\n  </div>\r\n"},"2":function(e,t,i,s){return" binf-disabled"},"4":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=e?e.showProfileImg:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+'  <div class="member-info csui-fadeout ">\r\n'+(null!=(n=t.if.call(e,null!=e?e.addOwnerOrGroup:e,{"name":"if","hash":{},"fn":this.program(22,s,0),"inverse":this.program(24,s,0)}))?n:"")+"  </div>\r\n"},"5":function(e,t,i,s){var n,o;return'    <div class="csui-profileimg'+(null!=(n=t.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+' binf-pull-left">\r\n    <span class="csui-icon '+(null!=(n=t.if.call(e,null!=e?e.isOwner:e,{"name":"if","hash":{},"fn":this.program(6,s,0),"inverse":this.program(8,s,0)}))?n:"")+'" title="'+this.escapeExpression((o=null!=(o=t.title||(null!=e?e.title:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"title","hash":{}}):o))+'"\r\n          aria-label="'+this.escapeExpression((o=null!=(o=t.ariaUserType||(null!=e?e.ariaUserType:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"ariaUserType","hash":{}}):o))+'">'+(null!=(n=t.if.call(e,null!=e?e.isUser:e,{"name":"if","hash":{},"fn":this.program(16,s,0),"inverse":this.noop}))?n:"")+"</span>\r\n"+(null!=(n=t.if.call(e,null!=e?e.isOwner:e,{"name":"if","hash":{},"fn":this.program(18,s,0),"inverse":this.program(20,s,0)}))?n:"")+"    </div>\r\n"},"6":function(e,t,i,s){return" icon_permmision_owner "},"8":function(e,t,i,s){var n;return"\r\n      "+(null!=(n=t.if.call(e,null!=e?e.isOwnerGroup:e,{"name":"if","hash":{},"fn":this.program(9,s,0),"inverse":this.program(11,s,0)}))?n:"")},"9":function(e,t,i,s){return" icon_permmision_owner_group "},"11":function(e,t,i,s){var n;return" csui-icon-paceholder\r\n      "+(null!=(n=t.if.call(e,null!=e?e.isGroup:e,{"name":"if","hash":{},"fn":this.program(12,s,0),"inverse":this.program(14,s,0)}))?n:"")},"12":function(e,t,i,s){return" image_group_placeholder_permission\r\n      "},"14":function(e,t,i,s){return" image_user_placeholder_permission"},"16":function(e,t,i,s){var n;return" "+this.escapeExpression((n=null!=(n=t.initials||(null!=e?e.initials:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"initials","hash":{}}):n))},"18":function(e,t,i,s){return""},"20":function(e,t,i,s){var n;return'        <img class="csui-icon-user csui-icon binf-img-circle binf-hidden" src="'+this.escapeExpression((n=null!=(n=t.usrImgSrc||(null!=e?e.usrImgSrc:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"usrImgSrc","hash":{}}):n))+'"\r\n             alt="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.ariaUserType||(null!=e?e.ariaUserType:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"ariaUserType","hash":{}}):n))+'">\r\n'},"22":function(e,t,i,s){var n;return'      <div class="csui-add-owner-or-group">\r\n        <span class="csui-user-display-name binf-disabled"\r\n              aria-label="'+this.escapeExpression((n=null!=(n=t.ariaUserLabel||(null!=e?e.ariaUserLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"ariaUserLabel","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n        <span class="csui-icon"></span>\r\n      </div>\r\n'},"24":function(e,t,i,s){var n,o;return'      <div class="">\r\n        <span class="csui-user-display-name  '+(null!=(n=t.if.call(e,null!=e?e.disabled:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+'"\r\n              aria-label="'+this.escapeExpression((o=null!=(o=t.ariaUserLabel||(null!=e?e.ariaUserLabel:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"ariaUserLabel","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+"</span>\r\n      </div>\r\n"},"26":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=e?e.isOwnerOrOwnerGroup:e,{"name":"if","hash":{},"fn":this.program(27,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.unless.call(e,null!=e?e.addOwnerOrGroup:e,{"name":"unless","hash":{},"fn":this.program(29,s,0),"inverse":this.noop}))?n:"")},"27":function(e,t,i,s){return'    <div class="csui-inline-owner-change"></div>\r\n'},"29":function(e,t,i,s){var n;return'    <div class="'+this.escapeExpression((n=null!=(n=t.inlineToolBarPlaceholderClass||(null!=e?e.inlineToolBarPlaceholderClass:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"inlineToolBarPlaceholderClass","hash":{}}):n))+' binf-hidden"></div>\r\n'},"31":function(e,t,i,s){var n;return'  <div class="csui-selected-user-ingroup">\r\n    <span class="icon icon-toolbar-more"></span>\r\n    <span class="csui-selected-username">'+this.escapeExpression((n=null!=(n=t.selectedUsername||(null!=e?e.selectedUsername:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"selectedUsername","hash":{}}):n))+"</span>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-user-container">\r\n'+(null!=(n=t.if.call(e,null!=e?e.isPublicPermission:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(4,s,0)}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.includeInlineToolBarPlaceholder:e,{"name":"if","hash":{},"fn":this.program(26,s,0),"inverse":this.noop}))?n:"")+"</div>\r\n"+(null!=(n=t.if.call(e,null!=e?e.selectedUsername:e,{"name":"if","hash":{},"fn":this.program(31,s,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("csui_controls_table_cells_user_impl_user",s),s}),csui.define("csui/controls/table/cells/user/user.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/base","csui/utils/commands","csui/utils/url","csui/dialogs/members.picker/members.picker.wizard","csui/utils/contexts/factories/connector","csui/utils/user.avatar.color","i18n!csui/controls/table/cells/user/impl/nls/localized.strings","hbs!csui/controls/table/cells/user/impl/user"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m){var f=o.extend({"template":m,"ui":{"personalizedImage":".csui-icon-user","defaultImage":".csui-icon-paceholder","userDisplayName":".csui-user-display-name","addOwnerOrGroup":".csui-add-owner-or-group","addOwnerOrGroupIcon":".csui-add-owner-or-group .icon-edit","userPlaceHolder":".image_user_placeholder_permission"},"events":function(){var e=l.isTouchBrowser()?{"click @ui.addOwnerOrGroup":"addOwnerOrGroupIconClicked"}:{"mouseover @ui.personalizedImage":"showMiniProfilePopup","mouseover @ui.defaultImage":"showMiniProfilePopup","mouseover @ui.userDisplayName":"showMiniProfilePopup","mouseover @ui.addOwnerOrGroup":"showAddOwnerOrGroupIcon","mouseleave @ui.personalizedImage":"removeUnderline","mouseleave @ui.defaultImage":"removeUnderline","mouseleave @ui.userDisplayName":"removeUnderline","mouseleave @ui.addOwnerOrGroup":"removeAddOwnerOrGroupIcon","click @ui.addOwnerOrGroupIcon":"addOwnerOrGroupIconClicked","keydown":"onKeyInView"};return i.extend(e,{"click @ui.userDisplayName":"showUserProfileDialog","click @ui.personalizedImage":"showUserProfileDialog","click @ui.defaultImage":"showUserProfileDialog"}),e},"getValueData":function(){var e=this.model.get("type"),t=this.model.get("right_id_expand");return{"includeInlineToolBarPlaceholder":this.options.includeInlineToolBarPlaceholder,"inlineToolBarPlaceholderClass":this.options.inlineToolBarPlaceholderClass,"name":this.getDispalyName(),"disabled":this.hasPermissions(),"showProfileImg":!this.options.showOnlyUserName,"isPublicPermission":"public"===e,"publicAccesslabel":p.publicAccess,"isOwner":"owner"===e,"ariaUserLabel":this.prepareUserName(),"ariaUserType":this.prepareUserType(),"isOwnerGroup":"group"===e,"isOwnerOrOwnerGroup":"owner"===e||"group"===e,"initials":t?t.initials:"","isUser":"owner"!==e&&"group"!==e&&t&&0===t.type,"title":"owner"===e?p.ownerAccessTitle:"group"===e?p.groupOwnerAccessTitle:"","isGroup":this.model.get("right_id_expand")&&1===this.model.get("right_id_expand").type,"addOwnerOrGroup":this.addOwnerOrGroup,"usrImgSrc":"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=","selectedUsername":this.model.selectedUser&&this.model.selectedUser.get("name")}},"constructor":function e(t){e.__super__.constructor.apply(this,arguments);var i=this.options.column.attributes;this.options.connector=this.options.context.getModel(d),void 0===this.options.includeInlineToolBarPlaceholder&&(this.options.includeInlineToolBarPlaceholder=i&&i.containsInlineActions),this.options.inlineToolBarPlaceholderClass||(this.options.inlineToolBarPlaceholderClass="csui-inlinetoolbar"),this.noOwnerOrGroup="owner"===this.model.get("type")&&this.hasPermissions(),this.noOwnerOrGroup&&(this.commands=a,this.addOwnerOrGroupCommand=this.commands.findWhere({"signature":"addownerorgroup"}),this.status={"context":this.options.context,"permissionCollection":this.model.collection,"connector":this.options.connector,"applyTo":this.options.applyTo,"nodeId":this.model.collection.options.nodeId,"nodeModel":this.model.collection.options.node},this.addOwnerOrGroup=this.noOwnerOrGroup&&this.addOwnerOrGroupCommand&&this.addOwnerOrGroupCommand.enabled(this.status)),this.listenTo(this,"render",this._assignUserColor)},"onRender":function(){var e=this.model.get("right_id_expand");e?(this.isGroup=1===e.type,this.userId=e.id):(this.isGroup=!0,this.userId=-1);var t=this.options.showOnlyUserName,i="owner"===this.model.get("type")||"group"===this.model.get("type");t||i||this._displayProfileImage()},"onDestroy":function(){this._releasePhotoUrl()},"prepareUserName":function(){var e=!!this.model.attributes&&!!this.model.attributes.right_id_expand&&this.model.attributes.right_id_expand.name;return!!e&&e},"prepareUserType":function(){return!!this.model&&this.model.get("type")},"hasPermissions":function(){var e=!1;return this.model.get("permissions")||(e=!0),e},"getDispalyName":function(){var e;return this.model.get("right_id_expand")?e=l.formatMemberName(this.model.get("right_id_expand")):"owner"===this.model.get("type")&&this.hasPermissions()?e=this.addOwnerOrGroup?p.addOwnerOrGroup:p.noOwnerAssigned:"group"===this.model.get("type")&&this.hasPermissions()&&(e=p.noGroupAssigned),e},"_displayProfileImage":function(){var e=this._getUserPhotoUrl();if(this.ui.personalizedImage.addClass("esoc-userprofile-img-"+this.userId),this.ui.defaultImage.addClass("esoc-user-default-avatar-"+this.userId),e){var s=this.options.connector.extendAjaxOptions({"url":e,"dataType":"binary"});this._releasePhotoUrl(),t.ajax(s).always(i.bind(function(e,t,i){200===i.status?this._showPersonalizedImage(e):this._showDefaultImage()},this))}else this._showDefaultImage()},"_getUserPhotoUrl":function(){var e=this.options.connector.connection,t=new c(e.url).getCgiScript(),i=this.model.get("right_id_expand")?this.model.get("right_id_expand").photo_url:null;if(i&&i.indexOf("?")>0)return c.combine(t,i)},"_showPersonalizedImage":function(e){this._releasePhotoUrl(),this._photoUrl=URL.createObjectURL(e),"object"==typeof this.ui.personalizedImage&&(this.ui.personalizedImage.attr("src",this._photoUrl),this.ui.personalizedImage.removeClass("binf-hidden")),"object"==typeof this.ui.defaultImage&&this.ui.defaultImage.addClass("binf-hidden")},"_showDefaultImage":function(e){this._releasePhotoUrl(),"object"==typeof this.ui.personalizedImage&&this.ui.personalizedImage.addClass("binf-hidden"),"object"==typeof this.ui.defaultImage&&this.ui.defaultImage.removeClass("binf-hidden")},"showAddOwnerOrGroupIcon":function(){this.addOwnerOrGroupCommand&&this.addOwnerOrGroupCommand.enabled(this.status)&&this.ui.addOwnerOrGroup.find(".csui-icon").addClass("icon-edit")},"removeAddOwnerOrGroupIcon":function(){this.ui.addOwnerOrGroup.find(".csui-icon").removeClass("icon-edit")},"addOwnerOrGroupIconClicked":function(){var e=this;this.addOwnerOrGroupCommand&&this.addOwnerOrGroupCommand.enabled(this.status)&&this.addOwnerOrGroupCommand.execute(this.status).done(i.bind(function(t){t.get("addOwnerGroup")&&e.model&&e.model.collection&&e.model.collection.addOwnerOrGroup(t)}))},"_releasePhotoUrl":function(){this._photoUrl&&(URL.revokeObjectURL(this._photoUrl),this._photoUrl=void 0)},"removeUnderline":function(e){this.isGroup||-3===this.userId||(this.ui.personalizedImage.removeClass("cs-user-photo-hover"),this.ui.defaultImage.removeClass("cs-user-photo-hover"),this.ui.userDisplayName.removeClass("cs-user-container-hover").addClass("cs-user-container-no-hover"))},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||this.showUserProfileDialog(e)},"showUserProfileDialog":function(e){if(this.userId<0);else{if(this.isGroup){var i=this,s=this;return void new u({"context":i.options.context,"connector":i.options.connector,"groupId":i.model.attributes.right_id,"edit_permission":i.options.column.attributes.containsInlineActions,"dialogClass":"cs-permission-group-picker","startLocations":["current.group"],"authUser":i.options.originatingView.user,"selectedGroup":i.model,"displayName":l.formatMemberName(this.model.get("right_id_expand")),"unselectableTypes":[0,1],"add":!0,"buttons":[{"id":"Add","label":p.addButtonLabel,"default":!0,"hidden":!0,"disabled":!0,"toolTip":p.addButtonTooltip},{"id":"Cancel","label":p.cancelButtonLabel,"disabled":!1,"close":!0,"toolTip":p.cancelButtonTooltip}]}).show().always(function(){s.$el.focus()}).done()}e.preventDefault(),e.stopPropagation(),this.userWidgetView?(this.dialogOpen=!0,this.ui.personalizedImage.addClass("cs-user-photo-hover"),this.ui.defaultImage.addClass("cs-user-photo-hover"),this.ui.userDisplayName.removeClass("cs-user-container-no-hover").addClass("cs-user-container-hover"),t(".popover.esoc-mini-profile-popover").hide(),this.userWidgetView.showUserProfileDialog(e)):this.setUserWidget("showUserProfileDialog",e)}},"showMiniProfilePopup":function(e){this.isGroup||-3===this.userId||(this.userWidgetView?(this.ui.personalizedImage.addClass("cs-user-photo-hover"),this.ui.defaultImage.addClass("cs-user-photo-hover"),this.ui.userDisplayName.removeClass("cs-user-container-no-hover").addClass("cs-user-container-hover"),this.userWidgetView.showMiniProfilePopup(e)):this.setUserWidget("showMiniProfilePopup",e))},"setUserWidget":function(e,t){var i=this;csui.require(["esoc/controls/userwidget/userwidget.view"],function(s){i.userWidgetView=new s({"userid":i.userId,"context":i.options.context,"baseElement":i.ui.userDisplayName,"showUserProfileLink":!0,"showMiniProfile":!0,"loggedUserId":i.userId,"connector":i.options.connector}),i[e](t)})},"_assignUserColor":function(){var e=this.model.get("right_id_expand"),t=h.getUserAvatarColor(e);this.ui.userPlaceHolder.css("background",t)}},{"hasFixedWidth":!1,"widthFactor":2});return r.registerByColumnKey("right_id",f),f}),csui.define("csui/controls/table/cells/permission/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/permission/impl/nls/root/localized.strings",{"FullControl":"Full control","Write":"Write","Read":"Read","Custom":"Custom","None":"None","see":"See","see_contents":"See contents","modify":"Modify","edit_attributes":"Edit attributes","add_items":"Add items","reserve":"Reserve","delete_versions":"Delete version","delete":"Delete","permissionfor":"{0} Permission for {1}","publicaccess":"Public Access","edit_permissions":"Edit permissions"}),csui.define("hbs!csui/controls/table/cells/permission/impl/permission.level",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <div class="csui-permission-level-container csui-fadeout">\r\n    <span class="csui-permission-level" aria-label="'+this.escapeExpression((n=null!=(n=t.permissionLevelAria||(null!=e?e.permissionLevelAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"permissionLevelAria","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.value||(null!=e?e.value:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'</span>\r\n    <div class="csui-tree"></div>\r\n  </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.value:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return i.registerPartial("csui_controls_table_cells_permission_impl_permission.level",s),s}),csui.define("csui/controls/table/cells/permission/permission.level.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","i18n!csui/controls/table/cells/permission/impl/nls/localized.strings","hbs!csui/controls/table/cells/permission/impl/permission.level"],function(e,t,i,s,n,o,r,l){"use strict";var a=n.extend({"template":l,"ui":{"permissionLevel":".csui-permission-level","permissionTree":".csui-tree"},"events":{"click @ui.permissionLevel":"onClickPermissionLevel","keydown":"onKeyInView"},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||this.$el.find(".csui-permission-level").click()},"getValueData":function(){var e,i=this.model.get("permissions"),s=this.getPermissionLevel(i);return e="public"===this.model.get("type")?r.publicaccess:this.model&&this.model.get("right_id_expand")?this.model.get("right_id_expand").name:"",null===s?n.prototype.getValueData.apply(this,arguments):{"value":s,"permissionLevelAria":t.str.sformat(r.permissionfor,s,e),"formattedValue":s}},"getPermissionLevel":function(e){var t=null;return e&&e.length>0?t=e.indexOf("edit_permissions")>=0&&e.length===(this.model.collection.isContainer?10:9)?r.FullControl:e.indexOf("edit_permissions")<0&&e.indexOf("delete")>=0&&e.length===(this.model.collection.isContainer?9:8)?r.Write:e.indexOf("see_contents")>=0&&2===e.length?r.Read:r.Custom:("public"===this.model.get("type")||this.model.get("right_id"))&&(t=r.None),t},"constructor":function t(i){t.__super__.constructor.apply(this,arguments),this.$=e},"onClickPermissionLevel":function(e){[0,1].indexOf(this.options.model.get("right_id_expand")&&this.options.model.get("right_id_expand").type)<0&&"custom"===this.options.model.get("type")?this.options.originatingView&&this.options.originatingView.trigger("permission:level:focus",{"cellView":this}):(this.options.originatingView&&this.options.originatingView.trigger("permission:level:clicked",{"cellView":this}),this.trigger("cell:content:clicked",this))}},{"hasFixedWidth":!1,"columnClassName":"csui-permission-level","widthFactor":1});return o.registerByColumnKey("permissions",a),a}),csui.define("csui/controls/table/cells/add.permission/add.permission.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry"],function(e,t,i,s,n,o){"use strict";var r=n.extend({"className":"csui-row-inlinetoolbar","events":{"keydown":"onKeyInView"},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||document.activeElement===this.el&&(this.options.originatingView&&this.options.originatingView.trigger("permission:inlineaction:clicked",{"cellView":this}),this.$el.find("a.binf-dropdown-toggle").click(),e.preventDefault(),e.stopPropagation())},"renderValue":function(){var e=t.result(this,"className");e&&this.$el.addClass(e)},"constructor":function e(t){e.__super__.constructor.apply(this,arguments)}},{"hasFixedWidth":!0,"noTitleInHeader":!0,"isToolbar":!0,"columnClassName":"csui-add-permission","widthFactor":1/3});return o.registerByColumnKey("addpermissions",r),r}),csui.define("css!csui/controls/table/cells/versionnumber/impl/versionnumber",[],function(){}),csui.define("csui/controls/table/cells/versionnumber/versionnumber.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/base","css!csui/controls/table/cells/versionnumber/impl/versionnumber"],function(e,t,i){"use strict";var s=e.extend({"className":"csui-nowrap","needsAriaLabel":!0},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-version_number_name"});return t.registerByColumnKey("version_number_name",s),s}),csui.define("csui/controls/table/cells/cell.factory",["csui/lib/underscore","csui/controls/table/cells/cell.registry","csui/controls/table/cells/text/text.view","csui/controls/table/cells/name/name.view","csui/controls/table/cells/date/date.view","csui/controls/table/cells/datetime/datetime.view","csui/controls/table/cells/duedate/duedate.view","csui/controls/table/cells/member/member.view","csui/controls/table/cells/node.state/node.state.view","csui/controls/table/cells/parent/parent.view","csui/controls/table/cells/priority/priority.view","csui/controls/table/cells/select/select.view","csui/controls/table/cells/toggledetails/toggledetails.view","csui/controls/table/cells/size/size.view","csui/controls/table/cells/status/status.view","csui/controls/table/cells/favorite/favorite.view","csui/controls/table/cells/favorite/favorite.name.view","csui/controls/table/cells/type.icon/type.icon.view","csui/controls/table/cells/user/user.view","csui/controls/table/cells/permission/permission.level.view","csui/controls/table/cells/add.permission/add.permission.view","csui/controls/table/cells/versionnumber/versionnumber.view","csui-ext!csui/controls/table/cells/cell.factory"],function(e,t,i,s){function n(){}return e.extend(n.prototype,{"hasCellViewByOtherKey":function(e){return t.hasCellViewByOtherKey(e)},"getCellView":function(e){return!0===e.get("isNaming")?s:t.getCellView(e)||i}}),new n}),csui.define("hbs!csui/controls/table/cells/searchbox/searchbox",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'class="search-box csui-table-searchbox" '},"3":function(e,t,i,s){return'class="search-box csui-table-searchbox\r\nbinf-hidden"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return"<div "+(null!=(n=t.if.call(e,null!=e?e.show_input:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'>\r\n  <input type="search" class="csui-table-search-input" placeholder="'+this.escapeExpression((o=null!=(o=t.search_placeholder||(null!=e?e.search_placeholder:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"search_placeholder","hash":{}}):o))+'"\r\n         title="'+this.escapeExpression((o=null!=(o=t.search_placeholder||(null!=e?e.search_placeholder:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"search_placeholder","hash":{}}):o))+'" value="'+this.escapeExpression((o=null!=(o=t.search_value||(null!=e?e.search_value:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"search_value","hash":{}}):o))+'">\r\n         <span class="fadeout csui-icon" title="'+this.escapeExpression((o=null!=(o=t.search_placeholder||(null!=e?e.search_placeholder:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"search_placeholder","hash":{}}):o))+'" style="display: inline-block;"></span>\r\n  <span class="sbclearer formfield_clear" role="button" aria-expanded="false"\r\n        title="'+this.escapeExpression((o=null!=(o=t.search_clear_icon_tooltip||(null!=e?e.search_clear_icon_tooltip:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"search_clear_icon_tooltip","hash":{}}):o))+'" aria-label="'+this.escapeExpression((o=null!=(o=t.search_clear_icon_tooltip||(null!=e?e.search_clear_icon_tooltip:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"search_clear_icon_tooltip","hash":{}}):o))+'"></span>\r\n</div>\r\n<div class="csui-table-search-icon" role="button" aria-expanded="false"\r\n     aria-label="'+this.escapeExpression((o=null!=(o=t.search_icon_tooltip||(null!=e?e.search_icon_tooltip:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"search_icon_tooltip","hash":{}}):o))+'" title="'+this.escapeExpression((o=null!=(o=t.search_icon_tooltip||(null!=e?e.search_icon_tooltip:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"search_icon_tooltip","hash":{}}):o))+'">\r\n  <span class="icon icon-search"></span>\r\n</div>\r\n\r\n'}});return i.registerPartial("csui_controls_table_cells_searchbox_searchbox",s),s}),csui.define("css!csui/controls/table/cells/searchbox/searchbox",[],function(){}),csui.define("csui/controls/table/cells/searchbox/searchbox.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!csui/controls/table/impl/nls/lang","hbs!csui/controls/table/cells/searchbox/searchbox","css!csui/controls/table/cells/searchbox/searchbox"],function(e,t,i,s,n){return i.ItemView.extend({"className":"csui-table-column-search","template":n,"templateHelpers":function(){return{"search_value":this.lastFilterValue,"show_input":void 0!==this.lastFilterValue,"search_icon_tooltip":t.str.sformat(s.searchIconTooltip,this.options.columnTitle.toLowerCase()),"search_placeholder":t.str.sformat(s.searchPlaceholder,this.options.columnTitle.toLowerCase()),"search_clear_icon_tooltip":s.searchClearIconTooltip}},"ui":{"searchBox":".csui-table-searchbox","searchInput":".csui-table-search-input","clearer":".sbclearer","searchGlass":".icon-search","searchGlassContainer":".csui-table-search-icon"},"events":{"keyup @ui.searchInput":"filterChanged","keydown":"onKeyInView","paste @ui.searchInput":"filterChanged","change @ui.searchInput":"filterChanged","click @ui.searchInput":"_searchFieldInputClicked","click @ui.clearer":"_searchFieldClearerClicked","click @ui.searchGlassContainer":"_searchFieldGlassClicked","click":"_searchBoxClicked"},"constructor":function(e,t){this.options=t||{},i.ItemView.prototype.constructor.apply(this,arguments),this.lastFilterValue=e,this.lastFocused="I"},"onRender":function(){this.ui.searchBox.hasClass("binf-hidden")||(this.showClearerIfFilterHasValue(),this.triggerMethod("opened"),this.triggerMethod("changed:focus",this.lastFocused),this.setIconAndState())},"onDestroy":function(){this.filterTimeout&&(clearTimeout(this.filterTimeout),this.filterTimeout=void 0)},"onKeyInView":function(e){if(this.getShown()){if(27===e.keyCode)return void this.hideAndClear();switch(this.lastFocused){case"I":var t=this.ui.searchInput[0].selectionStart,i=this.ui.searchInput.val();switch(e.keyCode){case 13:e.stopPropagation(),e.preventDefault(),i.length>0&&this.triggerMethod("change:filterValue",{"column":this.options.column,"keywords":i});break;case 37:t>0&&e.stopPropagation();break;case 39:i.length>0&&t<i.length?e.stopPropagation():(this._moveFocusRight(),e.stopPropagation(),e.preventDefault());break;case 35:this.ui.searchInput[0].selectionStart=i.length,this.ui.searchInput[0].selectionEnd=i.length,e.stopPropagation(),e.preventDefault();break;case 36:this.ui.searchInput[0].selectionStart=0,this.ui.searchInput[0].selectionEnd=0,e.stopPropagation(),e.preventDefault()}break;case"C":switch(e.keyCode){case 13:case 32:this._searchFieldClearerClicked(e);break;case 37:this.lastFocused="I",this.triggerMethod("changed:focus",this.lastFocused),e.stopPropagation(),e.preventDefault();break;case 39:this.lastFocused="G",this.triggerMethod("changed:focus",this.lastFocused),e.stopPropagation(),e.preventDefault()}break;case"G":switch(e.keyCode){case 13:case 32:this.hideAndClear(),e.stopPropagation(),e.preventDefault();break;case 37:this._moveFocusLeft(),e.stopPropagation(),e.preventDefault();break;case 39:e.preventDefault()}}}else 13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this.showSearchInput())},"currentlyFocusedElement":function(){if(!this.getShown())return this.ui.searchGlassContainer;switch(this.lastFocused){case"I":return this.ui.searchInput;case"C":return this.ui.clearer;case"G":return this.ui.searchGlassContainer;default:return e()}},"setFocusToInput":function(){this.lastFocused="I",this.triggerMethod("changed:focus",this.lastFocused),this.ui.searchInput.focus()},"setFocusToGlass":function(){this.lastFocused="G",this.triggerMethod("changed:focus",this.lastFocused)},"showSearchInput":function(){this.ui.searchBox.removeClass("binf-hidden"),this.$el.addClass("csui-searchbox-shown"),this.setIconAndState(),this.setFocusToInput(),this.triggerMethod("opened")},"setIconAndState":function(){this.ui.searchGlassContainer.attr("title",s.collapseSearch),this.ui.searchGlassContainer.attr("aria-label",s.collapseSearch),this.ui.searchGlassContainer.attr("aria-expanded","true"),this.ui.searchGlass.addClass("icon-search-hide")},"hideAndClear":function(e){this.ui.searchBox.addClass("binf-hidden"),this.$el.removeClass("csui-searchbox-shown"),this.ui.searchGlassContainer.attr("title",this.templateHelpers().search_icon_tooltip),this.ui.searchGlassContainer.attr("aria-label",this.templateHelpers().search_icon_tooltip),this.ui.searchGlassContainer.attr("aria-expanded","false"),this.ui.searchGlass.removeClass("icon-search-hide"),
this.lastFocused="I",this.filterTimeout&&(clearTimeout(this.filterTimeout),this.filterTimeout=void 0),this.ui.searchInput.val().length&&!e&&(this.ui.searchInput.val(""),this.triggerMethod("change:filterValue",{"column":this.options.column,"keywords":""})),this.lastFilterValue=void 0,this.triggerMethod("closed")},"toggleSearch":function(){this.ui.searchBox.hasClass("binf-hidden")?this.showSearchInput():this.hideAndClear()},"showClearerIfFilterHasValue":function(){var e=this.ui.searchInput.val(),t=!!e.length;return this.ui.clearer.toggle(t),e},"getColumn":function(){return this.options.column},"getValue":function(){return this.ui.searchInput.val()},"setValue":function(e){e&&e.length&&(this.ui.searchInput.val(e),this.lastFilterValue=e)},"getShown":function(){return!this.ui.searchBox.hasClass("binf-hidden")},"setFocus":function(){var e=this.ui.searchInput.val().length;this.lastFocused="I",setTimeout(t.bind(function(){this.ui.searchInput[0].setSelectionRange&&(this.ui.searchInput.focus(),this.ui.searchInput[0].setSelectionRange(e,e))},this),200)},"filterChanged":function(){var e=this.showClearerIfFilterHasValue();if(this.lastFilterValue!=e){this.lastFilterValue=e;var t=this;this.filterTimeout&&clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(function(){t.filterTimeout=void 0,t.triggerMethod("change:filterValue",{"column":t.options.column,"keywords":t.ui.searchInput.val()})},1e3)}},"_hasFilterValue":function(){return!!this.ui.searchInput.val().length},"_moveFocusLeft":function(){this._hasFilterValue()?(this.lastFocused="C",this.triggerMethod("changed:focus",this.lastFocused)):(this.lastFocused="I",this.triggerMethod("changed:focus",this.lastFocused))},"_moveFocusRight":function(){this._hasFilterValue()?(this.lastFocused="C",this.triggerMethod("changed:focus",this.lastFocused)):(this.lastFocused="G",this.triggerMethod("changed:focus",this.lastFocused))},"_searchFieldInputClicked":function(e){e.stopPropagation(),this.setFocusToInput()},"_searchFieldClearerClicked":function(e){e.preventDefault(),e.stopPropagation(),this.ui.searchInput.val(""),this.ui.clearer.hide(),this.lastFilterValue="",this.setFocusToInput(),this.triggerMethod("change:filterValue",{"column":this.options.column,"keywords":""})},"_searchFieldGlassClicked":function(e){e.stopPropagation(),this.toggleSearch()},"_searchBoxClicked":function(e){e.stopPropagation(),this.getShown()||this.toggleSearch()}})}),csui.define("csui/controls/table/inlineforms/inlineform.registry",["csui/lib/underscore"],function(e){function t(){this._addableTypes={}}return e.extend(t.prototype,{"getInlineFormView":function(e){return this._addableTypes[e]},"registerByAddableType":function(t,i){if(!e.isNumber(t))throw new Error("addableType key must be a number");this._addableTypes[t]=i}}),new t}),csui.define("csui/controls/table/inlineforms/folder/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/inlineforms/folder/impl/nls/root/lang",{"CancelButtonLabel":"Cancel","NewNamePlaceholder":"Enter name"}),csui.define("csui/controls/table/inlineforms/inlineform/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/inlineforms/inlineform/impl/nls/root/lang",{"EditCancelTooltip":"Cancel","CancelButtonLabel":"Cancel","SaveButtonLabel":"Save","AddButtonLabel":"Add","ExtendedAdd":"Extended add dialog","ExtendedAddAria":"Open extended add dialog","ActionFailedMessage":"Action failed"}),csui.define("css!csui/controls/table/inlineforms/inlineform/impl/inlineform",[],function(){}),csui.define("csui/controls/table/inlineforms/inlineform/impl/inlineform.view",["csui/lib/jquery","csui/lib/underscore","csui/utils/base","csui/utils/log","i18n!csui/controls/table/inlineforms/inlineform/impl/nls/lang","csui/lib/marionette","csui/models/nodechildren","csui/utils/commands/add.item.metadata","csui/utils/commands/properties","csui/models/nodes","csui/utils/commandhelper","csui/behaviors/keyboard.navigation/tabkey.behavior","csui/lib/jsonpath","css!csui/controls/table/inlineforms/inlineform/impl/inlineform"],function(e,t,i,s,n,o,r,l,a,c,u,d,h){return o.ItemView.extend({"className":"csui-inlineform","ui":{"inputFieldName":".csui-inlineform-input-name","cancelButton":".csui-btn-cancel","editCancelButton":".csui-btn-edit-cancel","saveButton":".csui-btn-save","metadataButton":".csui-btn-metadata"},"events":{"keyup @ui.inputFieldName":"keyReleased","paste @ui.inputFieldName":"mouseRightCicked","cut @ui.inputFieldName":"mouseRightCicked","focusin @ui.inputFieldName":"onFocusInWrite","keydown @ui.editCancelButton":"cancelEditKeyPressed","submit form":"saveClicked","click @ui.saveButton":"saveClicked","click @ui.cancelButton":"cancelClicked","click @ui.editCancelButton":"cancelClicked","click @ui.metadataButton":t.debounce(function(e){this.metadataIconClicked(e)},500),"keydown":"onKeyInView"},"behaviors":{"TabKeyBehavior":{"behaviorClass":d}},"_templateHelpers":function(){var e=this.model.get("csuiInlineFormErrorMessage"),t=!1;this.model.get("type");t=!this.model.get("name"),t=t||this.checkCustomFieldsModel();var i={"name":this.model.get("name"),"EditCancelTooltip":n.EditCancelTooltip,"CancelButtonLabel":n.CancelButtonLabel,"disableSavebtn":t,"SaveButtonLabel":this._isEditMode()?n.SaveButtonLabel:n.AddButtonLabel,"formModeIsEdit":this._isEditMode(),"haveErrorMessage":!!e,"extendedAdd":n.ExtendedAdd,"extendedAddAria":n.ExtendedAddAria};return i.haveErrorMessage&&(i.errorMessage=e),i},"constructor":function(e){this.options=e||{},o.ItemView.prototype.constructor.apply(this,arguments)},"onDomRefresh":function(){this.refershTabableElements();var e=this.model.get("csuiInlineFormErrorMessage");!!this.tabableElements&&!!this.tabableElements[0]&&this.tabableElements[0].focus(),this.ui.metadataButton.length&&(this.ui.metadataButton.attr("title",this.options.ExtendedAdd||n.ExtendedAdd),this.ui.metadataButton.attr("aria-label",this.options.ExtendedAddAria||n.ExtendedAddAria),void 0===this.options.AriaHasPopUp?this.ui.metadataButton.attr("aria-haspopup",!0):this.ui.metadataButton.attr("aria-haspopup",this.options.AriaHasPopUp)),!!e&&this.addInlineRole(e)},"cancelClicked":function(e){e.preventDefault(),e.stopPropagation(),this.cancel()},"onKeyInView":function(e){if(this.clearInlineRole(),9===e.keyCode)return this._moveTab(e),!0},"refershTabableElements":function(){this.tabableElements=this.$el.find("input:not([disabled]),  button:not([disabled])").filter(":visible").toArray()},"_moveTab":function(t){this.currentlyFocusedElementIndex=this.tabableElements.indexOf(t.target),t.shiftKey?this.currentlyFocusedElementIndex>0?(this.currentlyFocusedElementIndex-=1,e(this.tabableElements[this.currentlyFocusedElementIndex]).focus()):(this.currentlyFocusedElementIndex=this.tabableElements.length-1,e(this.tabableElements[this.currentlyFocusedElementIndex]).focus()):this.currentlyFocusedElementIndex<this.tabableElements.length-1?(this.currentlyFocusedElementIndex+=1,e(this.tabableElements[this.currentlyFocusedElementIndex]).focus()):(this.currentlyFocusedElementIndex=0,e(this.tabableElements[this.currentlyFocusedElementIndex]).focus()),t.stopPropagation(),t.preventDefault()},"saveClicked":function(e){if(e.preventDefault(),e.stopPropagation(),this.clearInlineRole(),this.model.get("id"))this._saveIfOk();else{var t=this;t.required=!1,t._getCategoryID().done(function(){t.required?t._openMetadataPage():t._saveIfOk()})}},"_getCategoryID":function(){var i=this,s=i.options.model.collection.node.get("id"),n=this.model.get("type"),o=i.options.model.connector,r=o.connection.url+"/forms/nodes/create?parent_id="+s+"&type="+n,l=e.Deferred(),a={"type":"GET","url":r};o.extendAjaxOptions(a);var c=e.ajax(a).done(t.bind(function(e){t.any(e.forms,function(e){if("categories"==e.role_name){var s=i._checkForAlpacaRequiredFields(e),n=h(e.schema.properties,"$..[?(@.required===true)]");t.isArray(n)&&n.length>0&&!s&&(i.required=!0)}}),i.model.attributes.forms=e,i.model.attributes.xhr=c,l.resolve()})).fail(function(e){l.reject()});return l.promise()},"_checkForAlpacaRequiredFields":function(e){var i=!0,s=e.data||e.get("data"),n=e.options||e.get("options"),o=e.schema||e.get("schema"),r=[],l=h(o,"$..[?(@.required===true)]",{"resultType":"PATH"}),a=h(n,"$..[?(@.validate===false)]",{"resultType":"PATH"}),c=[];t.each(a,function(e){var t=e.toString().match(/(\'[\w]*\')/g);t&&c.push(t[t.length-1].replace(/'/g,""))});var u=[];t.each(l,function(e){var t=e.toString().match(/(\'[\w]*\')/g);t&&u.push(t[t.length-1].replace(/'/g,""))});var d=function(e,t){var i=e.filter(function(e){return-1!=t.indexOf(e)});return i.length>0?i:t}(c,u);if(d){var p=!1;t.each(d,function(e){if(r=h(s,"$.."+e.toString(),{"resultType":"PATH"}.toArray),t.each(r,function(e){var s=function(e){if(e instanceof Array&&(null!==e||""!==e))t.each(e,function(e){s(e)});else if(null===e||""===e)return void(p=!0)};if(p)return void(i=!1);s(e)}),p)return void(i=!1)})}return i},"_openMetadataPage":function(){var e=this;e.viewToModelData();var i=new c;i.push(e.options.model);var s={"nodes":i,"container":e.options.model.collection.node,"collection":e.options.model.collection},n={"context":e.options.context};n=t.extend(n,{"addableType":e.constructor.CSSubType}),(new l).execute(s,n).then(function(t){if(delete e.model.inlineFormView,e.model.unset("csuiInlineFormErrorMessage",{"silent":!0}),e.trigger("editEnded",this),t.name)return e.model.fetch()}).fail(function(t){e.cancel()})},"cancelEditKeyPressed":function(e){this.clearInlineRole(),9===e.keyCode&&(e.shiftKey||(e.preventDefault(),e.stopPropagation(),this._saveIfOk()))},"onFocusInWrite":function(t){var i=e(t.target)[0],s=i.value,n=s?s.length:0;144===this.model.get("type")&&s.lastIndexOf(".")>0&&s.lastIndexOf(".")<s.length-1&&(n=s.lastIndexOf(".")),i.selectionEnd=n},"toggleButton":function(e){if(this.ui.saveButton.length){var t=this.ui.inputFieldName.val().trim(),i=!1;i=0!==t.length,i=i&&this.checkCustomFieldsInputVal(),i?this.ui.saveButton.removeAttr("disabled").addClass("binf-btn-default"):this.ui.saveButton.attr("disabled","disabled").removeClass("binf-btn-default")}this.refershTabableElements()},"checkCustomFieldsModel":function(){return!1},"checkCustomFieldsInputVal":function(){return!0},"mouseRightCicked":function(e){this.clearInlineRole();var t=this;setTimeout(function(){t.toggleButton(e)},100)},"keyReleased":function(e){if(this.leftInputFieldTimer&&clearTimeout(this.leftInputFieldTimer),27===e.keyCode)return this.cancel(),e.preventDefault(),void e.stopPropagation();this.toggleButton(e)},"cancel":function(e){e||(e={}),this.destroy(),void 0===this.model.get("id")?this.model.destroy():(delete this.model.inlineFormView,this.model.set("csuiInlineFormErrorMessage","dummy",{"silent":!0}),this.model.unset("csuiInlineFormErrorMessage",{"silent":e.silent}))},"_isEditMode":function(){return void 0!==this.model.get("id")},"viewToModelData":function(){this._viewToModelData(),this._viewToModelDataExtended()},"_viewToModelData":function(){this.model.set("name",this._getInputName(),{"silent":!0})},"_viewToModelDataExtended":function(){},"_getInputName":function(){var e=this.ui.inputFieldName,t=e.val();return t=t.trim()},"_saveIfOk":function(){},"_save":function(e){var i=this.options.originatingView;i&&i.blockActions&&i.blockActions();var s=void 0===this.model.get("id")?"_saveNewModel":"_updateModel",n=this[s](e);return i&&i.unblockActions&&n.always(t.bind(i.unblockActions,i)),n.done(t.bind(this.destroy,this)),n},"_updateModel":function(e){var i=this.model.inlineFormView;delete this.model.inlineFormView;var n=!1!==this.model.mustRefreshAfterPut?e:void 0,o=!1!==this.model.mustRefreshAfterPut?void 0:e,r=this,l=r.options.originatingView&&r.options.originatingView.thumbnailView;return this.model.save(o,{"data":n,"patch":!0,"wait":!0,"silent":!0,"skipSetValue":l}).then(function(){if(r.model.set(e,{"silent":!0}),!1!==r.model.mustRefreshAfterPut)return r.model.fetch();r.model.set("csuiInlineFormErrorMessage","dummy",{"silent":!0}),r.model.unset("csuiInlineFormErrorMessage")}).fail(function(n){r.model.inlineFormView=i;var o=t.keys(e),l=t.pick(t.clone(r.model.attributes),o);r.model.set(e,{"silent":!0});var a=r._getErrorMessageFromResponse(n);r.model.set("csuiInlineFormErrorMessage",a),s.error("Saving failed. ",a)&&console.error(s.last),r.model.set(l,{"silent":!0})})},"_saveNewModel":function(e){var i=this.model.inlineFormView;delete this.model.inlineFormView,this.model.set(e,{"silent":!0});var n=t.clone(this.model.attributes);delete n.hasMetadataRow,delete n.csuiInlineFormErrorMessage;var o=this;return this.model.save(void 0,{"data":n,"wait":!0,"silent":!0}).then(function(){if(!1!==o.model.mustRefreshAfterPut)return o.model.fetch();o.model.set("csuiInlineFormErrorMessage","dummy",{"silent":!0}),o.model.unset("csuiInlineFormErrorMessage")}).fail(function(e){o.model.inlineFormView=i,o.model.trigger("error",o.model);var t=o._getErrorMessageFromResponse(e);o.model.set("csuiInlineFormErrorMessage",t),s.error("Saving failed. ",t)&&console.error(s.last)})},"_getErrorMessageFromResponse":function(t){var s;if(t&&t.responseJSON&&t.responseJSON.error)s=t.responseJSON.error;else{var n=i.MessageHelper.toHtml();i.MessageHelper.reset(),s=e(n).text()}return s},"metadataIconClicked":function(e){e.preventDefault(),e.stopPropagation(),this.clearInlineRole(),this.viewToModelData();var i=this,s=new c;s.push(this.model);var n={"nodes":s,"container":this.model.collection.node,"collection":this.model.collection},o={"context":this.options.context};if(void 0===this.model.get("id")){o=t.extend(o,{"addableType":this.constructor.CSSubType});(new l).execute(n,o).then(function(e){if(delete i.model.inlineFormView,i.model.unset("csuiInlineFormErrorMessage",{"silent":!0}),i.trigger("editEnded",this),e.name)return i.model.fetch()}).done(function(){i.options.originatingView.$el.find(".csui-nodetable .csui-new-item a.csui-table-cell-name-value").first().focus()}).fail(function(e){i.cancel(),i.options.originatingView.$el.find(".csui-addToolbar .binf-dropdown-toggle").focus()})}else{n=t.extend(n,{"originatingView":this.options.originatingView});(new a).execute(n,o).always(function(e){i.cancel()})}},"addInlineRole":function(e){this.ui.inputFieldName.attr("title",n.ActionFailedMessage+e),this.ui.inputFieldName.attr("role","alert")},"clearInlineRole":function(){!!this.model.get("csuiInlineFormErrorMessage")&&(this.ui.inputFieldName.attr("title",""),this.ui.inputFieldName.removeAttr("role"))}},{"CSSubType":void 0})}),csui.define("hbs!csui/controls/table/inlineforms/folder/impl/folder",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return"csui-inlineform-error"},"3":function(e,t,i,s){var n;return this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"\r\n  "},"5":function(e,t,i,s){var n;return this.escapeExpression((n=null!=(n=t.namePlaceholder||(null!=e?e.namePlaceholder:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"namePlaceholder","hash":{}}):n))},"7":function(e,t,i,s){var n;return'    <button type="button" class="csui-btn-edit-cancel binf-btn">\r\n      <span class="icon edit-cancel" title="'+this.escapeExpression((n=null!=(n=t.EditCancelTooltip||(null!=e?e.EditCancelTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"EditCancelTooltip","hash":{}}):n))+'"></span>\r\n    </button>\r\n'},"9":function(e,t,i,s){var n;return'    <button type="button" class="csui-btn-metadata binf-btn"><span\r\n        class="icon icon-toolbar-metadata"></span></button>\r\n    <div class="csui-inline-action-container">\r\n      <button type="submit" class="csui-btn-save csui-btn binf-btn"\r\n              disabled>'+this.escapeExpression((n=null!=(n=t.SaveButtonLabel||(null!=e?e.SaveButtonLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"SaveButtonLabel","hash":{}}):n))+'</button>\r\n      <button type="button" class="csui-btn-cancel csui-btn binf-btn">'+this.escapeExpression((n=null!=(n=t.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"CancelButtonLabel","hash":{}}):n))+"</button>\r\n    </div>\r\n"},"11":function(e,t,i,s){var n;return'  <div class="csui-inlineform-group csui-inlineform-group-error" role="alert">\r\n    <div class="binf-text-danger">'+this.escapeExpression((n=null!=(n=t.errorMessage||(null!=e?e.errorMessage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+"</div>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<form class="csui-inlineform-group csui-inlineform-group-folder-name">\r\n  <input type="text" value="'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=t.namePlaceholder||(null!=e?e.namePlaceholder:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"namePlaceholder","hash":{}}):o))+'"\r\n         class="binf-form-control csui-inlineform-input-name '+(null!=(n=t.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'"\r\n         aria-label="'+(null!=(n=t.if.call(e,null!=e?e.name:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)}))?n:"")+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.formModeIsEdit:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:"")+"</form>\r\n"+(null!=(n=t.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("csui_controls_table_inlineforms_folder_impl_folder",s),s}),csui.define("css!csui/controls/table/inlineforms/folder/impl/folder",[],function(){}),csui.define("csui/controls/table/inlineforms/generic/generic.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!csui/controls/table/inlineforms/folder/impl/nls/lang","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/inlineform/impl/inlineform.view","hbs!csui/controls/table/inlineforms/folder/impl/folder","css!csui/controls/table/inlineforms/folder/impl/folder"],function(e,t,i,s,n,o,r){var l=o.extend({"className":function(){var e="csui-inlineform-generic";return o.prototype.className&&(e+=" "+t.result(o.prototype,"className")),e},"template":r,"templateHelpers":function(){var e=this._templateHelpers();return t.extend(e,{"namePlaceholder":s.NewNamePlaceholder})},"ui":{},"events":{},"constructor":function(e){this.options=e||{},this.ui=t.extend({},this.ui,o.prototype.ui),this.events=t.extend({},this.events,o.prototype.events),i.ItemView.prototype.constructor.apply(this,arguments)},"_saveIfOk":function(){var e=this._getInputName(),t=this.model.get("name");e.length>0&&e===t?this.cancel():e.length>0&&this._save({"name":e})}},{"CSSubType":-1});return n.registerByAddableType(l.CSSubType,l),l}),csui.define("csui/controls/table/inlineforms/folder/folder.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!csui/controls/table/inlineforms/folder/impl/nls/lang","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/inlineform/impl/inlineform.view","hbs!csui/controls/table/inlineforms/folder/impl/folder","css!csui/controls/table/inlineforms/folder/impl/folder"],function(e,t,i,s,n,o,r){var l=o.extend({"className":function(){var e="csui-inlineform-folder";return o.prototype.className&&(e+=" "+t.result(o.prototype,"className")),e},"template":r,"templateHelpers":function(){var e=this._templateHelpers();return t.extend(e,{"namePlaceholder":s.NewNamePlaceholder})},"ui":{},"constructor":function(e){this.options=e||{},this.ui=t.extend({},this.ui,o.prototype.ui),this.events=t.extend({},this.events,o.prototype.events),i.ItemView.prototype.constructor.apply(this,arguments)},"_saveIfOk":function(){var e=this._getInputName(),t=this.model.get("name");e.length>0&&e===t?this.cancel():e.length>0&&this._save({"name":e}).fail(function(e){this.model.set({"name":t},{"silent":!0})}.bind(this))}},{"CSSubType":0});return n.registerByAddableType(l.CSSubType,l),l}),csui.define("csui/controls/table/inlineforms/shortcut/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/inlineforms/shortcut/impl/nls/root/lang",{"ShortcutPickerTitle":"Shortcut","ShortcutNamePlaceholder":"Enter a new Shortcut name","NameMustNotBeEmpty":"Shortcut name cannot be empty.","NoShortcutSelected":"No Shortcut target selected."}),csui.define("hbs!csui/controls/table/inlineforms/shortcut/impl/shortcut",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'    <button type="button" class="csui-btn-edit-cancel binf-btn">\r\n      <span class="icon edit-cancel" title="'+this.escapeExpression((n=null!=(n=t.EditCancelTooltip||(null!=e?e.EditCancelTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"EditCancelTooltip","hash":{}}):n))+'"></span>\r\n    </button>\r\n'},"3":function(e,t,i,s){var n;return'    <button type="button" class="csui-btn-metadata binf-btn"><span\r\n        class="icon icon-toolbar-metadata"></span></button>\r\n    <div class="csui-inline-action-container">\r\n      <button type="submit" class="csui-btn-save csui-btn binf-btn\r\n    binf-btn-default">'+this.escapeExpression((n=null!=(n=t.SaveButtonLabel||(null!=e?e.SaveButtonLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"SaveButtonLabel","hash":{}}):n))+'</button>\r\n      <button type="button" class="csui-btn-cancel csui-btn binf-btn">'+this.escapeExpression((n=null!=(n=t.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"CancelButtonLabel","hash":{}}):n))+"</button>\r\n    </div>\r\n"},"5":function(e,t,i,s){var n;return'  <div class="csui-inlineform-group csui-inlineform-group-error" role="alert">\r\n    <div class="binf-text-danger">'+this.escapeExpression((n=null!=(n=t.errorMessage||(null!=e?e.errorMessage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+"</div>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<form class="csui-inlineform-group csui-inlineform-group-url-name">\r\n  <input type="text" value="'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=t.namePlaceholder||(null!=e?e.namePlaceholder:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"namePlaceholder","hash":{}}):o))+'"\r\n         class="binf-form-control csui-inlineform-input-name">\r\n'+(null!=(n=t.if.call(e,null!=e?e.formModeIsEdit:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+"</form>\r\n"+(null!=(n=t.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("csui_controls_table_inlineforms_shortcut_impl_shortcut",s),s}),csui.define("css!csui/controls/table/inlineforms/shortcut/impl/shortcut",[],function(){}),csui.define("csui/controls/table/inlineforms/shortcut/shortcut.view",["csui/lib/underscore","csui/lib/marionette","i18n!csui/controls/table/inlineforms/shortcut/impl/nls/lang","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/inlineform/impl/inlineform.view","hbs!csui/controls/table/inlineforms/shortcut/impl/shortcut","css!csui/controls/table/inlineforms/shortcut/impl/shortcut"],function(e,t,i,s,n,o){var r=n.extend({"className":function(){var t="csui-inlineform-shortcut";return n.prototype.className&&(t+=" "+e.result(n.prototype,"className")),t},"template":o,"templateHelpers":function(){var t=this._templateHelpers();return e.extend(t,{"namePlaceholder":i.ShortcutNamePlaceholder})},"ui":{"inputFieldName":".csui-inlineform-input-name"},"events":{},"constructor":function(i){this.options=i||{},this.ui=e.extend({},this.ui,n.prototype.ui),this.events=e.extend({},this.events,n.prototype.events),t.ItemView.prototype.constructor.apply(this,arguments)},"_saveIfOk":function(){var e=this._getInputName();if(e&&e.length>0)if(void 0===this.model.get("original_id"))this.model.set("csuiInlineFormErrorMessage",i.NoShortcutSelected);else{var t;t=void 0===this.model.get("id")?{"name":e,"original_id":this.model.get("original_id")}:{"name":e},this._save(t)}else this.model.set("csuiInlineFormErrorMessage",i.NameMustNotBeEmpty)}},{"CSSubType":1});return s.registerByAddableType(r.CSSubType,r),r}),csui.define("csui/controls/table/inlineforms/url/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/inlineforms/url/impl/nls/root/lang",{"UrlNamePlaceholder":"Enter website name","UrlAddressPlaceholder":"Web address","UrlInvalidFormat":"The format of the Web address is invalid."}),csui.define("hbs!csui/controls/table/inlineforms/url/impl/url",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return"hasError"},"3":function(e,t,i,s){return"csui-inlineform-error"},"5":function(e,t,i,s){return'      <span class="formfield_error csui-inlineform-input-error"></span>\r\n'},"7":function(e,t,i,s){return" "},"9":function(e,t,i,s){return"binf-btn-default "},"11":function(e,t,i,s){return" disabled "},"13":function(e,t,i,s){var n;return'  <div class="csui-inlineform-group csui-inlineform-group-error" role="alert">\r\n    <div class="binf-text-danger">'+this.escapeExpression((n=null!=(n=t.errorMessage||(null!=e?e.errorMessage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+"</div>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<form>\r\n  <div class="binf-hidden-md binf-hidden-lg hidden-xl hidden-xxl\r\n       csui-inlineform-vertical-spacer"></div>\r\n  <div class="csui-inlineform-group csui-inlineform-group-url">\r\n    <input type="text" value="'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=t.namePlaceholder||(null!=e?e.namePlaceholder:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"namePlaceholder","hash":{}}):o))+'"\r\n           class="binf-form-control csui-inlineform-input-name '+(null!=(n=t.if.call(e,null!=e?e.validationFailed_Name:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'">\r\n    <input type="text" value="'+this.escapeExpression((o=null!=(o=t.url||(null!=e?e.url:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"url","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=t.urlPlaceholder||(null!=e?e.urlPlaceholder:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"urlPlaceholder","hash":{}}):o))+'"\r\n           class="binf-hidden-xs binf-hidden-sm binf-form-control csui-inlineform-input-url '+(null!=(n=t.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+'    <button type="button" class="binf-hidden-xs\r\n    binf-hidden-sm csui-btn-metadata binf-btn">\r\n      <span class="icon icon-toolbar-metadata"></span></button>\r\n    <div class="csui-inline-action-container">\r\n      <button type="submit" class="binf-hidden-xs\r\n    binf-hidden-sm csui-btn-save csui-btn binf-btn\r\n            '+(null!=(n=t.if.call(e,null!=e?e.disableSavebtn:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:"")+'"\r\n        '+(null!=(n=t.if.call(e,null!=e?e.disableSavebtn:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")+">"+this.escapeExpression((o=null!=(o=t.SaveButtonLabel||(null!=e?e.SaveButtonLabel:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"SaveButtonLabel","hash":{}}):o))+'</button>\r\n      <button type="button" class="binf-hidden-xs binf-hidden-sm csui-btn-cancel csui-btn binf-btn\r\n            binf-btn-default">'+this.escapeExpression((o=null!=(o=t.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"CancelButtonLabel","hash":{}}):o))+'</button>\r\n    </div>\r\n\r\n  </div>\r\n  <div class="binf-hidden-md binf-hidden-lg hidden-xl hidden-xxl\r\n       csui-inlineform-vertical-spacer"></div>\r\n  <div class="binf-hidden-md binf-hidden-lg hidden-xl hidden-xxl csui-inlineform-group\r\ncsui-inlineform-group-url-wrapped">\r\n    <input type="text" value="'+this.escapeExpression((o=null!=(o=t.url||(null!=e?e.url:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"url","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=t.urlPlaceholder||(null!=e?e.urlPlaceholder:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"urlPlaceholder","hash":{}}):o))+'"\r\n           class="binf-form-control csui-inlineform-input-url '+(null!=(n=t.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+'">\r\n    <button type="button" class="csui-btn-metadata binf-btn">\r\n      <span class="icon icon-toolbar-metadata"></span></button>\r\n    <div class="csui-inline-action-container">\r\n      <button type="submit" class="csui-btn-save csui-btn binf-btn\r\n            '+(null!=(n=t.if.call(e,null!=e?e.disableSavebtn:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:"")+'"\r\n        '+(null!=(n=t.if.call(e,null!=e?e.disableSavebtn:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:"")+">"+this.escapeExpression((o=null!=(o=t.SaveButtonLabel||(null!=e?e.SaveButtonLabel:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"SaveButtonLabel","hash":{}}):o))+'</button>\r\n      <button type="button"\r\n              class="csui-btn-cancel csui-btn binf-btn binf-btn-default">'+this.escapeExpression((o=null!=(o=t.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"CancelButtonLabel","hash":{}}):o))+'</button>\r\n    </div>\r\n  </div>\r\n  <div class="binf-hidden-md binf-hidden-lg hidden-xl hidden-xxl\r\n       csui-inlineform-vertical-spacer"></div>\r\n</form>\r\n'+(null!=(n=t.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(13,s,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("csui_controls_table_inlineforms_url_impl_url",s),s}),csui.define("css!csui/controls/table/inlineforms/url/impl/url",[],function(){}),csui.define("csui/controls/table/inlineforms/url/url.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!csui/controls/table/inlineforms/url/impl/nls/lang","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/inlineform/impl/inlineform.view","hbs!csui/controls/table/inlineforms/url/impl/url","css!csui/controls/table/inlineforms/url/impl/url"],function(e,t,i,s,n,o,r,l){var a=r.extend({"className":function(){var e="csui-inlineform-url";return r.prototype.className&&(e+=" "+i.result(r.prototype,"className")),e},"template":l,"templateHelpers":function(){var e=this._templateHelpers(),t=this.model.get("url");return i.extend(e,{"url":t,"namePlaceholder":n.UrlNamePlaceholder,"urlPlaceholder":n.UrlAddressPlaceholder})},"ui":{"urlFieldName":".csui-inlineform-input-url"},"events":{"keyup @ui.urlFieldName":"keyReleased"},"constructor":function(e){this.options=e||{},this.ui=i.extend({},this.ui,r.prototype.ui),this.events=i.extend({},this.events,r.prototype.events),this.relativeUrlRegexp=this.options.relativeUrlRegexp||/^\?func=[a-z0-9]/i,
s.ItemView.prototype.constructor.apply(this,arguments)},"checkCustomFieldsInputVal":function(){return 0!==this._getInputUrl().trim().length},"checkCustomFieldsModel":function(){return!this.model.get("url")},"_viewToModelDataExtended":function(){this.model.set("url",this._getInputUrl(),{"silent":!0})},"_getInputUrl":function(){var e="";return this.ui.urlFieldName.each(i.bind(function(i,s){s.offsetHeight>0&&(e=t(s).val().trim(),e.match(this.relativeUrlRegexp)||(e=e.match(/^[a-zA-Z]+:\/\//)?e:"http://"+e))},this)),e},"_saveIfOk":function(){var e=this._getInputName(),t=this._getInputUrl();if(e.length>0&&t.length>0)if(t.match(this.relativeUrlRegexp))this._save({"name":e,"url":t});else{var i=this;csui.require(["csui/lib/alpaca/js/alpaca"],function(s){var o=s.regexps.url;t.match(o)?i._save({"name":e,"url":t}):(i.model.set({"name":e,"url":t},{"silent":!0}),i.model.set("csuiInlineFormErrorMessage",n.UrlInvalidFormat))},function(e){i.model.set("csuiInlineFormErrorMessage",e.message)})}}},{"CSSubType":140});return o.registerByAddableType(a.CSSubType,a),a}),csui.define("csui/controls/table/inlineforms/collection/collection.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/folder/folder.view"],function(e,t,i,s,n){var o=n.extend({"className":function(){var e="csui-inlineform-collection";return n.prototype.className&&(e+=" "+t.result(n.prototype,"className")),e}},{"CSSubType":298});return s.registerByAddableType(o.CSSubType,o),o}),csui.define("csui/controls/table/inlineforms/inlineform.factory",["csui/lib/underscore","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/generic/generic.view","csui/controls/table/inlineforms/folder/folder.view","csui/controls/table/inlineforms/shortcut/shortcut.view","csui/controls/table/inlineforms/url/url.view","csui/controls/table/inlineforms/collection/collection.view","csui-ext!csui/controls/table/inlineforms/inlineform.factory"],function(e,t,i,s,n,o,r){function l(){}return e.extend(l.prototype,{"getInlineFormView":function(e){return t.getInlineFormView(e)}}),new l}),csui.define("hbs!csui/controls/table/rows/metadata/impl/metadatarow",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return'      <div class="binf-form-group binf-col-xs-12"\r\n           data-csui-attribute="'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.isRegion:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(4,s,0)}))?n:"")+"      </div>\r\n"},"2":function(e,t,i,s){return'              <div title="'+this.escapeExpression(this.lambda(null!=e?e.label:e,e))+'" id="'+this.escapeExpression(this.lambda(null!=e?e.regionLabelId:e,e))+'"\r\n                     class="binf-col-xs-4 binf-col-sm-3 binf-col-md-2 binf-control-label">'+this.escapeExpression(this.lambda(null!=e?e.label:e,e))+'</div>\r\n\r\n              <div id="'+this.escapeExpression(this.lambda(null!=e?e.id:e,e))+'" class="binf-col-xs-8 binf-col-sm-9 binf-col-md-10\r\n              binf-form-control-static csui-content-view" aria-labelledby="'+this.escapeExpression(this.lambda(null!=e?e.regionLabelId:e,e))+'"></div>\r\n'},"4":function(e,t,i,s){var n;return'              <label for="'+this.escapeExpression(this.lambda(null!=e?e.id:e,e))+'" title="'+this.escapeExpression(this.lambda(null!=e?e.label:e,e))+'"\r\n                     class="binf-col-xs-4 binf-col-sm-3 binf-col-md-2 binf-control-label">'+this.escapeExpression(this.lambda(null!=e?e.label:e,e))+'</label>\r\n              <input id="'+this.escapeExpression(this.lambda(null!=e?e.id:e,e))+'" type="text" readonly value="'+this.escapeExpression(this.lambda(null!=e?e.value:e,e))+'"\r\n                     '+(null!=(n=t.if.call(e,null!=e?e.tooltip:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")+'\r\n                     class="binf-col-xs-8 binf-col-sm-9 binf-col-md-10 binf-form-control-static">\r\n'},"5":function(e,t,i,s){return'title="'+this.escapeExpression(this.lambda(null!=e?e.tooltip:e,e))+'"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="binf-row">\r\n  <div class="cs-form binf-form-horizontal">\r\n'+(null!=(n=t.each.call(e,null!=e?e.meta:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"  </div>\r\n</div>"}});return i.registerPartial("csui_controls_table_rows_metadata_impl_metadatarow",s),s}),csui.define("css!csui/controls/table/rows/metadata/impl/metadatarow",[],function(){}),csui.define("csui/controls/table/rows/metadata/metadatarow.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","hbs!csui/controls/table/rows/metadata/impl/metadatarow","css!csui/controls/table/rows/metadata/impl/metadatarow","css!csui/controls/form/impl/form"],function(e,t,i,s){"use strict";return i.ItemView.extend({"className":"csui-table-metadata-view binf-container-fluid","template":s,"templateHelpers":function(){var e,i=this,s=[];return t.each(this.options.columns,function(t){e=new t.CellView({"context":this.options.context,"column":t,"model":this.options.model,"nameEdit":!1}),s=s.concat(this._getColumnAttributes(t,e))},this),this._contentViews=[],t.each(s,function(e){e.id=t.uniqueId(e.name),e.contentView&&(e.id=t.uniqueId(e.name),e.isRegion=!0,e.regionLabelId=t.uniqueId("rl_"+e.id),i._contentViews.push({"view":e.contentView,"regionElementId":e.id}))}),{"meta":s}},"_getColumnAttributes":function(e,i){var s=[];if(t.isFunction(i.getAttributes))s=i.getAttributes();else{var n=i.getValueText(),o=t.isFunction(i.getTooltipValueText)?i.getTooltipValueText():n;s.push({"label":e.title,"value":n,"tooltip":o,"name":e.name,"contentView":t.isFunction(i.getContentView)?i.getContentView():void 0})}return s},"constructor":function(e){i.ItemView.prototype.constructor.apply(this,arguments)},"onRender":function(){t.each(this._contentViews,function(e){var t=this.$el.find("#"+e.regionElementId);new i.Region({"el":t}).show(e.view)},this)},"currentlyFocusedElement":function(){return e()}})}),csui.define("hbs!csui/controls/table/rows/error/impl/errorrow",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="binf-text-danger">'+this.escapeExpression((n=null!=(n=t.errorMessage||(null!=e?e.errorMessage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+"</div>\r\n"}});return i.registerPartial("csui_controls_table_rows_error_impl_errorrow",s),s}),csui.define("css!csui/controls/table/rows/error/impl/errorrow",[],function(){}),csui.define("csui/controls/table/rows/error/errorrow.view",["csui/lib/underscore","csui/lib/marionette","hbs!csui/controls/table/rows/error/impl/errorrow","css!csui/controls/table/rows/error/impl/errorrow"],function(e,t,i){return t.ItemView.extend({"className":"csui-table-error-view binf-container-fluid","template":i,"templateHelpers":function(){return{"errorMessage":this.options.errorMessage?this.options.errorMessage:""}},"ui":{},"events":{},"constructor":function(e){this.options=e||{},t.ItemView.prototype.constructor.apply(this,arguments)}})}),csui.define("csui/controls/table/impl/table.header.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/base"],function(e,t,i,s){"use strict";function n(){this.accFocusedColumn>=this.displayedColumns.length&&(this.displayedColumns>0?this.accFocusedColumn=this.displayedColumns.length-1:this.accFocusedColumn=0)}return i.View.extend({"constructor":function t(i){t.__super__.constructor.apply(this,arguments),this._getActiveInlineForm=i._getActiveInlineForm,this.searchBoxes=i.searchBoxes,this.alternativeHeaderView=i.alternativeHeaderView,this.displayedColumns=i.displayedColumns,this.accFocusedColumn=i.accFocusedColumn||0,this.accSearchFocused=i.accSearchFocused||!1,this.alternativeHeaderView&&(this.listenTo(this.alternativeHeaderView,"focusout",function(i){var s,n,o=this.$(">tr>th:not(.csui-alternative-table-header)"),r=-1;if("left"===i.direction){for(s=0;s<o.length;s++)if(n=e(o[s]),n.hasClass(t.ClassNameColumnForAlternativeHeader)){r=s-1;break}}else for(s=o.length-1;s>0;s--)if(n=e(o[s]),n.hasClass(t.ClassNameColumnForAlternativeHeader)&&s+1<o.length){r=s+1;break}r>=0&&(this.accFocusedColumn=r),this._accSetFocusToCurrentlyFocusedElement()}),this.listenTo(this.alternativeHeaderView,"changed:focus",this._accSetFocusToCurrentlyFocusedElement))},"events":{"keydown":"onKeyInView"},"render":function(){this.triggerMethod("before:render",this);var e=this.$(">tr>th"),t=this.$(">tr>th>.csui-table-column-search");this._columnCount=e.length,this._searchBoxCount=t.length,this.triggerMethod("render",this)},"remove":function(){return this.stopListening(),this.undelegateEvents(),this},"currentlyFocusedElement":function(){n.call(this);var t=this._getColumnSelector(this.displayedColumns[this.accFocusedColumn]),i=this.$(t);if(i.is(":visible"))if(this.accSearchFocused){var s=this._findActiveSearchBoxView();i=s?s.currentlyFocusedElement():e()}else{var o=e(i[0]).find(".csui-focusable-table-column-header");o.length>0&&(i=o)}return i},"_getColumnSelector":function(e){return'tr>th[data-csui-attribute="'+e.attributes.column_key+'"]'},"_rightIsNextColumn":function(){var e=this.displayedColumns[this.accFocusedColumn],t=this._getColumnSelector(e),i=t+" .csui-table-column-search",s=this.$(i);return this.accSearchFocused||0===s.length},"onKeyInView":function(e){function t(){for(r=this.accFocusedColumn-1;r>=0;){if(i=this._getColumnSelector(this.displayedColumns[r]),s=this.$(i),s.is(":visible")&&s.find(".csui-focusable-table-column-header").length>0){this.accFocusedColumn=r,o=s.find(".csui-table-column-search"),this.accSearchFocused=o.length>0,this.accSearchFocused&&(l=this._findActiveSearchBoxView())&&l.getShown()&&l.setFocusToGlass();break}r--}}var i,s,n,o,r,l;if(!this._getActiveInlineForm())switch(e.keyCode){case 32:case 13:e.ctrlKey||e.metaKey||this.accSearchFocused||this.options.displayedColumns[this.accFocusedColumn].bSortable&&(e.preventDefault(),e.stopPropagation(),this.trigger("sorting:toggle",this.accFocusedColumn));break;case 37:this.accSearchFocused?(l=this._findActiveSearchBoxView(),l&&l.getShown()?t.call(this):this.accSearchFocused=!1):t.call(this),e.preventDefault(),e.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated();break;case 39:if(this._rightIsNextColumn()){for(n=this.accFocusedColumn+1;n<this.displayedColumns.length;){if(i=this._getColumnSelector(this.displayedColumns[n]),s=this.$(i),this._isHeaderCellFocusable(s)){this.accFocusedColumn=n,this.accSearchFocused=!1;break}n+=1}l=this._findActiveSearchBoxView(),l&&l.getShown()&&(this.accSearchFocused=!0,l.setFocusToInput())}else this.accSearchFocused=!0,(l=this._findActiveSearchBoxView())&&l.getShown()&&l.setFocusToInput();e.preventDefault(),e.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated();break;case 35:this.accFocusedColumn=this.displayedColumns.length-1,n=this.accFocusedColumn+1,o=this.$(">tr>th:nth-child("+n+") .csui-table-column-search"),this.accSearchFocused=o.length>0,this.accSearchFocused&&(l=this._findActiveSearchBoxView())&&l.getShown()&&l.setFocusToInput(),e.preventDefault(),e.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated();break;case 36:this.accFocusedColumn=0,this.accSearchFocused=!1,e.preventDefault(),e.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated();break;case 121:e.shiftKey&&(this.searchBoxes&&this.searchBoxes.length>0&&(l=this.searchBoxes[0],l.showSearchInput(),this.listenToOnce(l,"closed",this._accSetFocusAfterTabableRegionActivated)),e.stopPropagation(),e.preventDefault())}},"_accSetFocusToCurrentlyFocusedElement":function(){var t=this.currentlyFocusedElement();t.length>0&&(t=e(t[0]),this.trigger("changed:focus",this),s.isVisibleInWindowViewport(t)&&t.focus())},"_accSetFocusAfterTabableRegionActivated":function(){if(!this._getActiveInlineForm()){var e=this._findActiveSearchBoxView();e&&e.getShown()||this._accSetFocusToCurrentlyFocusedElement()}},"_accSearchBoxFocused":function(e){this.accFocusedColumn=e.columnIndex,this.accSearchFocused=!0,this._accSetFocusToCurrentlyFocusedElement()},"_findActiveSearchBoxView":function(){var e=this.searchBoxes,i=this.displayedColumns,s=i[this.accFocusedColumn].name.toLowerCase();return t.find(e,function(e){return e.options.column===s})},"_isHeaderCellFocusable":function(e){return e.is(":visible")&&e.find(".csui-focusable-table-column-header").length>0}},{"ClassNameColumnForAlternativeHeader":"csui-undefined"})}),csui.define("csui/controls/table/impl/table.body.view",["csui/lib/jquery","csui/lib/marionette","csui/utils/focusable"],function(e,t,i){"use strict";function s(e){var t;return e&&(t=this._detailRowViewsByModelId[e.id||e.get("id")]),t||{"views":[]}}return t.View.extend({"constructor":function e(t){e.__super__.constructor.apply(this,arguments),this._getActiveInlineForm=t._getActiveInlineForm,this.startInlineFormForEdit=t.startInlineFormForEdit,this.collection=t.collection,this.displayedColumns=t.displayedColumns,this.nameColumnIndex=e.getNameColumnIndex(t.displayedColumns)||0,this.accFocusedCell=t.accFocusedCell||{"column":this.nameColumnIndex,"row":0},this.tableView=t.tableView},"ui":{"description":".csui-details-row-description"},"events":{"keydown":"onKeyInView","focus @ui.description":"descriptionRowFocus"},"render":function(){this.triggerMethod("before:render",this);var e=this.$el.parent().find("thead>tr>th");this._columnCount=e.length,this.triggerMethod("render",this)},"remove":function(){return this.stopListening(),this.undelegateEvents(),this},"currentlyFocusedElement":function(){if(!this.tableView.table)return e();if(this.accFocusedCell){var t=this.collection.at(this.accFocusedCell.row),n=s.call(this.tableView,t);if(void 0!==n.accFocusedViewIndex){var o=n.views[n.accFocusedViewIndex];return o.$el.is(":visible")?o.currentlyFocusedElement():e()}var r=e(this.tableView.table.row(this.accFocusedCell.row).node()),l=r.children()[this.accFocusedCell.column],a=i.findFocusables(l);return e(1===a.length?a[0]:l)}return e()},"onClickedCell":function(e){this.accFocusedCell.row=e.rowIndex,this.accFocusedCell.column=e.colIndex,this._accSetFocusAfterTabableRegionActivated()},"_findDetailRowFromEnd":function(){var e=this.collection.at(this.accFocusedCell.row),t=s.call(this.tableView,e);if(t.views.length>0)for(void 0===t.accFocusedViewIndex&&(t.accFocusedViewIndex=t.views.length-1);;){var i=t.views[t.accFocusedViewIndex];if(i.$el.is(":visible")){var n=i.currentlyFocusedElement();if(n.length>0)break}if(!(t.accFocusedViewIndex>0)){delete t.accFocusedViewIndex;break}t.accFocusedViewIndex--}},"onKeyInView":function(t){var i,n,o=e();if(!this._getActiveInlineForm())if(37===t.keyCode){for(;this.accFocusedCell.column>0&&(this.accFocusedCell.column--,!this._isCurrentBodyCellFocusable()););t.preventDefault(),t.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated()}else if(38===t.keyCode){if(t.preventDefault(),t.stopPropagation(),this.trigger("closeOtherControls"),i=this.collection.at(this.accFocusedCell.row),n=s.call(this.tableView,i),void 0===n.accFocusedViewIndex){if(!(this.accFocusedCell.row>0))return;this.accFocusedCell.row--,this._findDetailRowFromEnd()}else n.accFocusedViewIndex>0?(n.accFocusedViewIndex--,this._findDetailRowFromEnd()):delete n.accFocusedViewIndex;this._accSetFocusAfterTabableRegionActivated()}else if(39===t.keyCode){for(;this.accFocusedCell.column<this.displayedColumns.length-1&&(this.accFocusedCell.column++,!this._isCurrentBodyCellFocusable()););t.preventDefault(),t.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated()}else if(40===t.keyCode){i=this.collection.at(this.accFocusedCell.row),n=s.call(this.tableView,i);var r=n.accFocusedViewIndex;for(void 0===n.accFocusedViewIndex&&n.views.length>0&&(n.accFocusedViewIndex=-1);0===o.length;){if(void 0!==n.accFocusedViewIndex&&n.accFocusedViewIndex+1<n.views.length)n.accFocusedViewIndex=n.accFocusedViewIndex+1;else{if(!(this.accFocusedCell.row+1<this.collection.length)){n.accFocusedViewIndex=r;break}delete n.accFocusedViewIndex,this.accFocusedCell.row++,(i=this.collection.at(this.accFocusedCell.row))&&(n=s.call(this.tableView,i))}o=this.currentlyFocusedElement()}t.preventDefault(),t.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated()}else 33===t.keyCode?(this.accFocusedCell.row=0,i=this.collection.at(this.accFocusedCell.row),n=s.call(this.tableView,i),delete n.accFocusedViewIndex,t.preventDefault(),t.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated()):34===t.keyCode?(this.collection.length>0?(this.accFocusedCell.row=this.collection.length-1,i=this.collection.at(this.accFocusedCell.row),n=s.call(this.tableView,i),delete n.accFocusedViewIndex,this._findDetailRowFromEnd()):this.accFocusedCell.row=0,t.preventDefault(),t.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated()):35===t.keyCode?(this.accFocusedCell.column=this.displayedColumns.length-1,t.preventDefault(),t.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated()):36===t.keyCode?(this.accFocusedCell.column=0,t.preventDefault(),t.stopPropagation(),this.trigger("closeOtherControls"),this._accSetFocusAfterTabableRegionActivated()):113===t.keyCode&&(i=this.collection.at(this.accFocusedCell.row),i&&this.startInlineFormForEdit(i),t.preventDefault(),t.stopPropagation())},"descriptionRowFocus":function(t){e(t.target).find(".description-readmore, .description-showless").focus()},"_accSetFocusAfterTabableRegionActivated":function(){if(!this._getActiveInlineForm()){var t=this.currentlyFocusedElement();if(t.length>0){var i=e(t);this.trigger("changed:focus",this),this._isVisible(i)&&i.focus()}}},"_isVisible":function(t){return e(t).is(":visible")},"_isCurrentBodyCellFocusable":function(){return!("description"===this.displayedColumns[this.accFocusedCell.column].name&&!this.hasCustomDescriptionColumn)}},{"getNameColumnIndex":function(e){if(e)for(var t=0;t<e.length;t++){var i=e[t];if(i.isNaming)return t}}})}),csui.define("css!csui/controls/table/impl/table",[],function(){}),csui.define("csui/controls/table/table.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/lib/jquery.dataTables.bootstrap/js/dataTables.bootstrap","csui/lib/jquery.dataTables.tableTools/js/dataTables.tableTools","i18n!csui/controls/table/impl/nls/lang","csui/utils/log","csui/utils/base","csui/utils/focusable","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/table/cells/cell.factory","csui/models/nodechildrencolumn","csui/controls/progressblocker/blocker","csui/utils/contexts/factories/connector","csui/behaviors/default.action/impl/defaultaction","csui/controls/checkbox/checkbox.view","csui/controls/table/cells/select/select.view","csui/controls/table/cells/searchbox/searchbox.view","csui/controls/table/inlineforms/inlineform.factory","csui/controls/table/rows/metadata/metadatarow.view","csui/controls/table/rows/error/errorrow.view","csui/controls/table/impl/table.header.view","csui/controls/table/impl/table.body.view","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/controls/toolbar/toolitems.filtered.model","csui/controls/toolbar/toolbar.command.controller","csui/controls/mixins/global.alert/global.alert.mixin","csui/models/mixins/v2.fields/v2.fields.mixin","i18n!csui/controls/table/cells/toggledetails/impl/nls/lang","css!csui/controls/table/impl/table","csui/lib/perfect-scrollbar","csui/lib/jquery.mousehover","csui/lib/jquery.scrollbarwidth","csui/lib/jquery.renametag"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b,g,v,w,y,_,C,T,x,S,I,k,V,A,E){"use strict";function M(t,i,s){var n=0,o=this.$el.find("thead th"),r=o.length;if(0===this.wrappedColumns.length&&o.last().hasClass("csui-table-cell-_toggledetails")&&(r-=1),s&&s.firstColumnIndex>=0){if(r>0&&s.firstColumnIndex<r){var l=e(i.children()[0]);s.lastColumnIndex&&s.lastColumnIndex>=s.firstColumnIndex&&(n=s.lastColumnIndex-s.firstColumnIndex+1,n>1&&l.attr("colspan",n),i.attr("style",""));for(var a=0;a<s.firstColumnIndex;a++)i.prepend("<td></td>");var c=r-s.firstColumnIndex-n;if(c>0)for(var u=0;u<c;u++)i.append("<td></td>")}}else{var d=e(t).children(),h=i.children();1===h.length&&d.length>1&&(n=d.length,0===this.wrappedColumns.length&&n>0&&(n-=1),h.attr("colspan",n))}}function D(e,t){var i=e.id||e.get("id"),s=this._detailRowViewsByModelId[i];s||(s={"views":[]},this._detailRowViewsByModelId[i]=s),s.views.push(t)}function F(t,i,s,n){var o,r=n.get("csuiErrorMessage");if(r){var l=new C({"errorMessage":r});l.render(),t.row(i).child(l.el,"csui-details-row").show(),e(s).addClass("csui-has-details-row"),o=t.row(i).child(),n.isLocallyCreated&&o.addClass("csui-new-item"),void 0!==n.get("id")&&o.addClass("csui-saved-item")}else{var a,c,u=[];if(ue)o=e();else{if(this.options.descriptionRowView&&n.get("description")&&n.get("description").length>0){var d=!1;this.options.descriptionRowViewOptions&&this.options.descriptionRowViewOptions.collapsedHeightIsOneLine&&(d=!0);var h=new this.options.descriptionRowView({"model":n,"collapsedHeightIsOneLine":d,"tableView":this});h.render(),c=e('<td class="csui-details-row"></td>'),a=e('<tr class="csui-details-row csui-details-row-description"></tr>'),c.appendTo(a),h.triggerMethod("before:show"),h.$el.appendTo(c),h.triggerMethod("show"),M.call(this,s,a,this.options.descriptionRowViewOptions),this.options.descriptionRowViewOptions&&(this.options.descriptionRowViewOptions.showDescriptions||a.addClass("binf-hidden")),this._detailRowsDescriptionTRs.push({"rowEl":a,"view":h}),D.call(this,n,h),u.push(a[0])}if(this.wrappedColumns.length>0){var p=new _({"context":this.context,"model":n,"columns":this.wrappedColumns});p.render(),c=e('<td class="csui-details-row"></td>'),a=e('<tr class="csui-details-row csui-details-row-metadata"></tr>'),c.appendTo(a),this.options.haveDetailsRowExpandCollapseColumn&&this.options.haveToggleAllDetailsRows?this.detailsRowsAreExpanded||this.expandedDetailRows[n.id||n.get("id")]?a.addClass("binf-collapse binf-in"):a.addClass("binf-collapse"):a.addClass("binf-collapse binf-in"),a.attr("id","csui-details-row-"+n.cid),p.triggerMethod("before:show"),p.$el.appendTo(c),p.triggerMethod("show"),M.call(this,s,a),n.set("hasMetadataRow",!0,{"silent":!0}),D.call(this,n,p),u.push(a[0])}else n.set("hasMetadataRow",!1,{"silent":!0});t.row(i).child(u,"csui-details-row").show(),o=t.row(i).child()}}return o.length>0&&e(s).addClass("csui-has-details-row"),o}function P(){function i(){this.res=this.collection.state.split("_"),this.order=this.order||[[]],n.foundcolumn=!1;var e=this.collection.state.substring(this.collection.state.indexOf("_")+1,this.collection.state.length).trim();return this.displayedColumns.some(function(t,i){if(t.name==e)return n.index=i,!0},this)?(this.order[0].push(this.index),this.order[0].push(this.res[0]),this.foundcolumn=!0):this.foundcolumn=!1,this.order}if(R.call(this),Q.call(this),this.allColumns.length){this.trigger("creatingTable",{"sender":this});var n=this;n.hoveredRowDataId=void 0,this._detailRowsDescriptionTRs=[],this._detailRowViewsByModelId={};ie.call(this),this.updateCollectionParameters();var o=new a.Url(this.connector.connection.url).getOrigin(!0),c=a.Url.combine(o,this.connector.connection.supportPath),u=O.call(this);this.csuiDestroyRowCallbacks=[];var d=t.extend({"columns":t.map(this.displayedColumns,function(e){return e.attributes.initialSortingDescending&&(e.asSorting=["desc","asc"]),e}),"jQueryUI":!1,"autoWidth":!1,"deferRender":!0,"serverSide":!0,"language":n.localizableLabels,"ajax":function(e,t,i){if(!1!==this.refreshEnabled){var s=this.api();s.context.length>0&&(n.options.clientSideDataOperation?re.call(n,s,e,i,t):oe.call(n,s,e,i,t))}},"initComplete":function(e,t){n.trigger("tableFrameRendered",{"sender":n,"target":this[0]})},"drawCallback":function(i){var s=e(this);if(n.collection&&(0===n.collection.length||1===n.collection.length&&n.collection.at(0).inlineFormView?s.addClass("csui-table-empty"):s.removeClass("csui-table-empty")),ue&&(s.css("display","table"),s.find("thead").css("display","table-header-group"),s.find("tbody").css("display","table-row-group"),s.find("tr").css("display","table-row"),s.find("td,th").css("display","table-cell"),s.find("thead > tr").children().each(function(){var t=e(this);if(t.find(".csui-table-column-search").length){var i=e("<div>",{"style":"display: flex"});t.wrapInner(i)}}),s.parent().css({"display":"block","width":"100%","overflow-x":"auto"})),n.hoveredRowDataId=void 0,n.hoveredRow=void 0,n.options.haveDetailsRowExpandCollapseColumn&&n.options.haveToggleAllDetailsRows&&!s.find("td.csui-table-cell-_toggledetails > .expand-details-row-toggle").length&&n.collection.length){n.displayedColumns=t.filter(n.displayedColumns,function(e){return"_toggledetails"!==e.sName});s.find(".csui-table-cell-_toggledetails").remove()}s.find("thead th").each(function(){var t=e(this).attr("aria-label");t||(t=e(this).text()),t&&e(this).attr({"title":t});var i=e(this).find("> div").attr("aria-label");!e(this).attr("aria-label")&&i&&e(this).attr("aria-label",i)}),s.find("th[aria-sort]").each(function(){e(this).removeAttr("aria-sort")}),s.find("tr:not(.csui-details-row)").each(function(){e(this).find("> *").last().addClass("csui-table-cell-last-visible")}),n.trigger("tableBodyRendered",{"sender":n,"target":e("tbody",this)[0]}),n._plugHeaderBodyViews(),n.table&&setTimeout(function(){n.trigger("update:scrollbar")})},"headerCallback":function(i,s,o,l,a){var c=[v.columnClassName,"csui-table-cell-_toggledetails"];e(i).find(">th").each(function(i){var s=e(this);if(n.displayedColumns.length>i){var o=n.displayedColumns[i],l=o.title,a=l;if(!0===o.noTitleInHeader&&(a=""),s.attr("data-csui-attribute",o.name),void 0===t.find(c,function(e){return s.hasClass(e)})){e(this).empty();var u,d;if(""===a)u=e('<div class="csui-focusable-table-column-header csui-empty"></div>').attr("aria-label",l),d=e('<div class="csui-table-column-text"></div>'),u.append(d),e(this).append(u);else{var h=a;n.displayedColumns[i].bSortable&&(h=t.str.sformat(r.NodeTableSortByAria,a)),u=e('<div class="csui-focusable-table-column-header"></div>').attr("aria-label",h),o.attributes.sort&&u.attr("role","button"),d=e('<div class="csui-table-column-text"></div>').text(a),u.append(d),e(this).append(u)}}}}),U.call(n,i),j.call(n,i);var u=this.api().order();if(u&&u.length>0&&u[0].length>1){var d=u[0],h=d[0],p=d[1],m="icon-sortArrowUnknown",f=n.displayedColumns.some(function(e){return e===n.allColumns[h]});"asc"===p?m="icon-sortArrowUp":"desc"===p&&(m="icon-sortArrowDown");var b='<span class="csui-sort-arrow '+m+'"></span>',g=n.$("th:eq("+h+")>.csui-focusable-table-column-header");f&&g.append(b)}q.call(n),n.trigger("tableHeaderRendered",{"sender":n,"target":i})},"footerCallback":function(e,t,i,s,o){n.trigger("tableFooterRendered",{"sender":n,"target":e})},"rowCallback":function(i,r,l){function a(){var e=n._detailRowViewsByModelId||{};Object.keys(e).forEach(function(t){e[t].views.forEach(function(e){n.stopListening(e),e.destroy()})}),n._detailRowsDescriptionTRs=[],n._detailRowViewsByModelId={},n.hoveredRowDataId=void 0}function u(){t.each(f,function(e){n.stopListening(e),e.destroy()}),f=null}function d(t,i){void 0===i&&(i=e());var s=!0,o=t._DT_RowIndex;if(n.hoveredRowDataId&&n.hoveredRowDataId===o&&(s=!1),n.hoveredRowDataId=o,s){if(n.hoveredRow){e(n.hoveredRow).removeClass("csui-state-hover");n.table.row(n.hoveredRow).child().removeClass("csui-state-hover")}var r=n.table.row(t).data();if(r){if(void 0!==(r.id||r.get("id"))){var l={"sender":n,"targets":[t],"nodes":K.call(n,[t])};n.trigger("selectingTableRow",l),l.cancel||(n.hoveredRow=t,e(t).addClass("csui-state-hover"),i.addClass("csui-state-hover"))}}}}function h(t,i){void 0===i&&(i=e()),e(t).removeClass("csui-state-hover"),i.removeClass("csui-state-hover"),n.hoveredRowDataId=void 0,n.hoveredRow=void 0}var p=e(i),m=F.call(n,this.api(),l,i,r);r.get(v.isSelectedModelAttributeName)?(p.addClass("binf-active"),t.each(m,function(t){e(t).addClass("binf-active")})):(p.removeClass("binf-active"),t.each(m,function(t){e(t).removeClass("binf-active")})),r.isLocallyCreated&&(p.addClass("csui-new-item"),m.addClass("csui-new-item")),void 0!==r.get("id")?(p.addClass("csui-saved-item"),m.addClass("csui-saved-item"),r.set("inactive",!n.checkModelHasAction(r),{"silent":!0})):r.set("inactive",!0,{"silent":!0}),!0===r.get("isCut")&&(p&&p.addClass("csui-cut-row"),m&&m.addClass("csui-cut-row"));var f=[],b=void 0!==r.inlineFormView;b&&p.addClass("csui-table-row-shows-inlineform");var g,w=0,y=[];if(n.csuiDestroyRowCallbacks.push(u,a),t.each(n.displayedColumns,function(s,a){if(s.CellView){var u=e(p.children()[a]);if(n.cachedColumnWidths&&n.cachedColumnWidths[s.className]){var d=n.cachedColumnWidths[s.className];u.css(d)}var h={"el":u,"tableView":n,"column":s,"model":r,"context":n.context,"originUrl":o,"supportUrl":c,"nameEdit":n.options.nameEdit,"favoritesTableOptions":n.options.favoritesTableOptions,"rowIndex":l};"_toggledetails"===s.name&&(h.rowIsExpanded=n.detailsRowsAreExpanded||n.expandedDetailRows[r.id||r.get("id")]);var m=new s.CellView(h);"_toggledetails"===s.name&&n.listenTo(m,"toggle:detailsrow",function(e){delete n.detailsRowsAreExpanded,z.call(n),n.expandedDetailRows[e.model.id||e.model.get("id")]=e.detailsRowIsExpanded,n.trigger("update:scrollbar")}),b?"type"===s.name?(m.render(),n.listenTo(m,"type:clicked",function(){n.triggerMethod("type:clicked")})):!s.isNaming&&"name"!==s.name||g?"_select"!==s.name&&(w++,y.push(u)):(w=1,g=u):m.render(),n.listenTo(m,"cellCloseOther",function(){n.cancelAnyExistingInlineForm(),n.trigger("closeOther",m),n.lockedForOtherContols=!0,t.each(f,function(e){e!==m&&e.triggerMethod("closeOther")})}),n.listenTo(m,"cellAllowOther",function(){n.trigger("allowOther",m),n.lockedForOtherContols=!1,t.each(f,function(e){e!==m&&e.triggerMethod("allowOther")})}),n.listenTo(m,"cancelEdit",function(){var e=n.collection.at(0);e&&void 0===e.get("id")&&(e.csuiIsRemoved=!0,n.collection.remove(e))}),n.listenTo(m,"show:add:favorite:form",function(){n._destroyInlineBar(),n.lockedForOtherContols=!0}),n.listenTo(m,"close:add:favorite:form",function(){n.lockedForOtherContols=!1}),l>=0&&(n.listenTo(m,"clicked:cell",function(e){n.trigger("clicked:cell",{"cellView":m,"rowIndex":l,"colIndex":a,"model":r})}),n.listenTo(m,"clicked:checkbox",function(e){if(!1!==r.get("selectable")){var t=L.call(n);"false"===e.checked?t.fnSelect(i):t.fnDeselect(i)}})),f.push(m)}}),b&&g&&w>1){t.each(y,function(e){e.remove()}),g.attr("colspan",w),g.addClass("csui-inlineform-parent"),n.trigger("closeOther"),r.inlineFormView&&(n.activeInlineForm&&n.activeInlineForm.destroy(),n.activeInlineForm=new r.inlineFormView({"model":r,"originatingView":n.options.originatingView,"context":n.context})),n.activeInlineForm.listenTo(n.activeInlineForm,"destroy",function(){n.lockedForOtherContols=!1,n.activeInlineForm.model.get("id")&&setTimeout(function(){n.accFocusedState.focusView="tableBody",n.trigger("changed:focus"),n.currentlyFocusedElement().focus()},1),delete n.activeInlineForm});new s.Region({"el":g}).show(n.activeInlineForm)}else p.mousehover(function(){var e={"sender":n,"target":i,"node":n.table.row(i).data()};n.trigger("enterTableRow",e)},function(){var e={"sender":n,"target":i,"node":n.table.row(i).data()};n.trigger("leaveTableRow",e)},{"namespace":n.cid}),p.mousehover(function(){
d.call(n,i,m)},function(){h.call(n,i,m)},{"namespace":n.cid}),m.mousehover(function(){d.call(n,i,m)},function(){},{"namespace":n.cid});n.trigger("tableRowRendered",{"sender":n,"target":i,"node":r})}},u);this.collection.state&&t.extend(d,{"order":i.call(this),"ordering":!0});var h=e("<table></table>").addClass("binf-table");if(ue||this.$el.addClass("csui-not-ready"),h.appendTo(this.el),this.table=h.DataTable(d),e(this.$el.children()[0]).attr("tabindex","-1"),G.call(this,u.selectedNodesById),this.collection.length>0&&void 0!==u.currentScollPosition&&this.$("tbody").scrollTop(u.currentScollPosition),this.$("tbody").on("scroll",function(){n.trigger("scroll")}),this.table.on("click",".csui-table-cell-default-action",function(e){le.call(n,e,"DefaultPre")}).on("click","a#parentAction",function(e){le.call(n,e,"Parent")}).on("click","a#menuAction",function(e){le.call(n,e,"Menu")}).on("click","input[id^='selectAction']",function(t){t.stopPropagation(),e(t.target).closest("td,th").click()}).on("processing",function(e,t,i){B.call(n,t,i)}).on("destroy",function(e,t){N.call(n,t),te.call(n),n._destroyTableHeaderAndBodyViews()}).on("preDraw",function(e,t){t.oFeatures.bServerSide&&!t.bDrawing||(te.call(n),n.activeInlineForm&&n.activeInlineForm.destroy(),n._destroyTableHeaderAndBodyViews())}),h.on("order.dt",function(){n.table.order();if(n.displayedColumns){var e=[];t.each(n.table.order(),function(t){var i=t[0],s=n.displayedColumns[i].data(void 0,"orderBy");s&&(t[1]?e.push(s+" "+t[1]):e.push(s))}),e.length?n.collection.setOrder(e.join()):n.collection.resetOrder()}}),this.options.alternativeHeader){l.warn("Using of options.alternativeHeader with table.view is deprecated. Please use csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view instead and render this view ouside of table.view. The behavior csui/behaviors/table.rowselection.toolbar/table.rowselection.toolbar.behavior might help using it.")&&console.log(l.last),this.$el.find(".csui-table-alternative-header").remove();var p=e('<div class="csui-table-alternative-header"></div>');this.$el.prepend(p),this._alternativeHeaderRegion=new s.Region({"el":p});var m=this._createAlternativeHeaderView();this._alternativeHeaderRegion.show(m),this.triggerMethod("alternativeHeader:show",m),this.listenTo(m,"childview:toolitem:action",this._toolbarItemClicked)}this.trigger("tableCreated",{"sender":this})}}function R(){var e=this.getOption("customLabels")||this.getOption("tableTexts")||{};t.isFunction(e)&&(e=e.call(this)),this.localizableLabels=this._fillDefaultLocalizableLabels(e)}function B(t,i){this.disablingOverlay||(this.disablingOverlay=e("<div id='disabling_overlay'></div>").hide().prependTo(this.table)),i?this.disablingOverlay.show():this.disablingOverlay.hide()}function N(e){this.disablingOverlay&&(this.disablingOverlay.remove(),this.disablingOverlay=void 0)}function L(){return this.tableTools||(this.tableTools=o.fnGetInstance(this.table.table().node()))}function O(){var i;switch(this.options.paginationStyle){case"all_buttons":i={"pagingType":"full_numbers"};break;case"two_buttons":i={"pagingType":"two_button"};break;case"infinite_scrolling":i={"scrollCollapse":!0,"scrollY":this.options.pageSize?25*this.options.pageSize-1+"px":"249px"};break;default:i={"paging":!1}}this.recreated||(this.recreated=this.columns.length||this.columns.fetched),i.order=$.call(this,this.collection.orderBy),i.ordering=H.call(this);var n;switch(this.options.selectRows){case"single":n="single";break;case"multiple":n="multi";break;default:n="none",this.options.selectAllColumnHeader=!1,this.options.selectColumn=!1}if("none"===n)i.dom='<"H"lfr>t<"F"ip>';else{i.dom='<"H"lTfr>t<"F"ip>';var o=this;i.tableTools={"aButtons":[],"sRowSelect":n,"fnPreRowSelect":function(t,i,n){function r(){var e=K.call(o,i),t={"sender":o,"targets":i,"nodes":e};return o.trigger(n?"selectingTableRow":"unselectingTableRow",t),!t.cancel}if(!o._rebuildingTable){if(s.triggerMethodOn(o.tableBodyView,"before:render"),i&&i.length>0){if(function(){var e=o.table.row(i[0]).data();if(!e.inlineFormView){var t={"sender":o,"target":i[0],"node":e};return o.triggerMethod("row:clicked",t),!t.cancel}}()){if(o.options.selectColumn&&o.options.selectAllColumnHeader){return!!(!(t&&t.target)||e(t.target).hasClass(v.columnClassName))&&r()}return r()}return!1}return!0}},"fnRowSelected":function(i){o._rebuildingTable||t.isArray(i)&&i.length>0&&(t.each(i,function(t){var i=o.table.row(t).data();e(t);i.set(v.isSelectedModelAttributeName,!0)}),W.call(o),s.triggerMethodOn(o.tableBodyView,"render"),o.trigger("closeOther"),o.selectedChildren.reset(o.getSelectedChildren()),o.trigger("tableRowSelected",{"sender":o,"targets":i,"nodes":K.call(o,i)}))},"fnRowDeselected":function(i){o._rebuildingTable||t.isArray(i)&&i.length>0&&(t.each(i,function(t){var i=o.table.row(t).data();e(t);i.set(v.isSelectedModelAttributeName,!1)}),W.call(o),s.triggerMethodOn(o.tableBodyView,"render"),o.selectedChildren.reset(o.getSelectedChildren()),o.trigger("tableRowUnselected",{"sender":o,"targets":i,"nodes":K.call(o,i)}))}}}return i.searching||i.lengthChange||(i.dom=i.dom.replace('"H"',"").replace("l","").replace("f","")),i.info||i.pagingType||(i.dom=i.dom.replace('"F"',"").replace("i","").replace("p","")),ne.call(this,i),i}function $(e){var i=[];return e&&(i=t.map(e.split(","),function(e){e=e.split(" ");var t=e[0],i=J.call(this,t);if(void 0!==i&&(t=this.displayedColumns[i].attributes.column_key,this.columns.findWhere({"column_key":t}).get("sort")))return[i,e[1]||"asc"]},this)),t.filter(i,function(e){return!!e})}function H(){return!0===this.options.enableSorting&&!!t.find(this.displayedColumns,function(e){return e.attributes&&!0===e.attributes.sort})}function z(){this.toggleExpandDetailsRowEl&&(this.detailsRowsAreExpanded?(this.toggleExpandDetailsRowEl.removeClass("icon-expandArrowDown"),this.toggleExpandDetailsRowEl.addClass("icon-expandArrowUp"),this.toggleExpandDetailsRowEl.attr("title",E.collapseAllTooltip),this.toggleExpandDetailsRowEl.attr("aria-label",E.collapseAllAria)):(this.toggleExpandDetailsRowEl.removeClass("icon-expandArrowUp"),this.toggleExpandDetailsRowEl.addClass("icon-expandArrowDown"),this.toggleExpandDetailsRowEl.attr("title",E.expandAllTooltip),this.toggleExpandDetailsRowEl.attr("aria-label",E.expandAllAria)))}function U(i){function s(e){e.stopPropagation(),e.preventDefault(),this.detailsRowsAreExpanded=!this.detailsRowsAreExpanded,this._clearExpandedRows(),this._detailRowsDescriptionTRs=[],z.call(this),this.table.draw(),this.options.descriptionRowViewOptions&&this.options.descriptionRowViewOptions.showDescriptions?this.showDetailRowDescriptions(!0):this.trigger("dom:refresh"),this._adjustColumns()}var n,o,r=this;this.options.haveDetailsRowExpandCollapseColumn&&this.options.haveToggleAllDetailsRows&&(n=e("th.csui-table-cell-_toggledetails",i),n.length>0&&(o=e("a",n),o.length?(this.toggleExpandDetailsRowEl=o.find(".csui-button-icon"),z.call(this)):this.collection.length?(n.addClass("csui-table-cell-_toggledetails"),o=e('<a class="csui-focusable-table-column-header expand-details-row-toggle" title="'+E.expandAllTooltip+'" aria-label="'+E.expandAllAria+'" href="#" aria-expanded="false"><span class="csui-button-icon icon-expandArrowDown"></span></a>'),this.toggleExpandDetailsRowEl=o.find(".csui-button-icon"),z.call(this),o.prependTo(n),n.click(t.bind(s,this)),o.click(t.bind(s,this)),n.keypress(function(e){var t=e.keyCode||e.charCode;e.ctrlKey||e.metaKey||32!==t&&13!==t||s.call(r,e)})):o.remove()))}function j(t){function n(){var e,t,s=[],n=[],o=[],r=[];if(l._selectAllCheckboxRegion&&l._selectAllCheckboxRegion.currentView){i.trigger("closeToggleAction");switch(l._selectAllCheckboxRegion.currentView.model.get("checked")){case"true":l.collection.each(function(i){i.get(v.isSelectedModelAttributeName)&&(e=l.collection.indexOf(i),t=l.table.row(e),r.push(i),o.push(t.node())),i.set(v.isSelectedModelAttributeName,!1)});break;default:l.collection.each(function(i){!1!==i.get("selectable")?(i.get(v.isSelectedModelAttributeName)||(e=l.collection.indexOf(i),t=l.table.row(e),n.push(i),s.push(t.node())),i.set(v.isSelectedModelAttributeName,!0)):(i.get(v.isSelectedModelAttributeName)&&(e=l.collection.indexOf(i),t=l.table.row(e),r.push(i),o.push(t.node())),i.set(v.isSelectedModelAttributeName,!1))})}l.selectedChildren.reset(l.getSelectedChildren()),W.call(this),o.length>0&&l.trigger("tableRowUnselected",{"sender":l,"targets":o,"nodes":r}),s.length>0&&l.trigger("tableRowSelected",{"sender":l,"targets":s,"nodes":n}),l.trigger("dom:refresh")}}function o(){var t=c.findFocusables(u.el);e(t).addClass("csui-focusable-table-column-header")}var l=this,a=e("th:first-child",t);if(0!==a.length&&this.options.selectColumn&&this.options.selectAllColumnHeader){if(!this._selectAllCheckboxRegion){var u=new g({"checked":!1,"disabled":!1,"ariaLabel":r.selectAllAria,"title":r.selectAll});this.listenTo(u,"clicked",function(e){e.cancel=!0,n.call(l)}),this.listenTo(u,"render",function(){o()}),this._selectAllCheckboxRegion=new s.Region({"el":a}),this._selectAllCheckboxRegion.show(u),o()}if(this.collection.length){this._selectAllCheckboxRegion.currentView.setDisabled(!1);this.collection.where({"csuiIsSelected":!0}).length>0&&W.call(this)}else this._selectAllCheckboxRegion.currentView.setDisabled(!0)}}function q(){var i=this;i.searchBoxes=[],this.$("thead th").each(function(s){if(0===e(this).find(".csui-table-column-search").length&&i.displayedColumns.length>s){var n=i.displayedColumns[s].name.toLowerCase(),o=i.displayedColumns[s].title;!0===i.displayedColumns[s].noTitleInHeader&&(o="");if(t.indexOf(i.columnsWithSearch,n)>-1||!0===i.displayedColumns[s].filterable){var l=i.displayedColumns[s].data&&i.displayedColumns[s].data(void 0,"filterBy"),a=new w(i.collection.filters&&i.collection.filters[n],{"column":l,"columnTitle":o});i.searchBoxes.push(a),a.on("change:filterValue",function(e){i.applyFilter(e)});var c=e(this).find(".csui-table-column-search"),u=e(this).find(".csui-table-column-text"),d=e(this).find(".csui-sort-arrow");a.on("opened",function(){u.addClass("binf-hidden"),d.addClass("binf-hidden"),i.searchColumn=n}),a.on("closed",function(){u.removeClass("binf-hidden"),d.removeClass("binf-hidden"),i.collection.filters[n]=void 0}),a.on("changed:focus",function(){i.tableCaptionView&&i.tableCaptionView._accSearchBoxFocused({"columnName":n,"columnIndex":s})}),a.render(),e(this).append(a.el),n===i.searchColumn&&a.setFocus(),c=e(this).find(".csui-table-column-search"),c&&c.attr("aria-label",t.str.sformat(r.searchIconTooltip,o.toLowerCase()))}}})}function G(e){this.table&&e&&t.each(this.table.rows(),function(i){t.each(i,function(t){var i=this.table.row(t).data(),s=i.id||i.get("id");if(e[s]){var n=L.call(this),o=this.table.row(t).node();n.fnSelect(o)}},this)},this)}function W(){if(this._selectAllCheckboxRegion&&this._selectAllCheckboxRegion.currentView){var e=this._selectAllCheckboxRegion.currentView,t=this.collection.filter(function(e){return e.get(v.isSelectedModelAttributeName)}),i=this.table?this.table.rows().nodes():this.collection,s=t.length===i.length;t.length>0&&!s?e.setChecked("mixed"):e.setChecked(t.length>0)}}function K(e){return t.map(e,function(e){var t=this.table.row(e).index();return this.table.row(t).data()},this)}function J(e){e=e.toLowerCase();var i;return t.find(this.displayedColumns,function(t,s){if(t.attributes.sort_key===e||t.name.toLowerCase()===e||t.attributes.column_key===e)return i=s,!0}),i}function X(){var i,s,n=0,o=0,r=this.$el.find("table.binf-table");if(r.length>0&&this.collection.length>0){var l=e(r[0]),a=l.width();t.each(this.allColumns,function(e){e.attributes&&!0===e.attributes.permanentColumn&&(i=e.attributes&&e.attributes.widthFactor,s=i?he*i:he,o+=s,n++)},this);for(var c=0;c<this.allColumns.length;c++){var u,d,h=this.allColumns[c];if(h.attributes&&!h.attributes.permanentColumn){if(i=h.attributes&&h.attributes.widthFactor,u=he,h.CellView.flexibleWidth&&(d=l.find(">tbody>tr>:nth-child("+(c+1)+")>*"),u=d.length>0?he:0),s=i?u*i:u,(o+=s)>a)break;n++}}n>this.options.maxColumnsDisplayed&&(n=this.options.maxColumnsDisplayed),n<1&&(n=1)}else n=void 0;return n}function Q(){this.trigger("buildingColumnDefinitions",{"sender":this});var e=[];if(this.options.tableColumns){var i,s,n=this.options.tableColumns.deepClone(),o={};this.columns.each(function(e){var r=e.get("column_key"),l=e.get("definitions_order");if(!0===e.get("isNaming")&&(s=r,e.unset("isNaming",{"silent":!0})),o[r]=e,e.get("type")&&l){var a=n.findWhere({"key":r});if(a){!0===a.get("isNaming")&&(i=a.get("key"));var c=a.get("sequence"),u=t.extend({"sequence":c},e.attributes);a.set(u)}else{h.hasCellViewByOtherKey(r)||n.add({"key":r,"sequence":l,"permanentColumn":!1})}}},this);var r=i||s||"name",l=[];n.each(function(e){var i=e.get("key");if(i===r&&e.set("isNaming",!0),o[i]){var s=o[i];i===r&&s.set("isNaming",!0);var n=h.getCellView(s),a=["permanentColumn","noTitleInHeader","title","align","widthFactor","isNaming"];t.each(a,function(t){var i=e.get(t);i?s.set(t,i,{"silent":!0}):n[t]&&s.set(t,n[t],{"silent":!0})}),l.push(s)}},this),l.length>0&&(l=Y(this,l)),e=t.map(l,function(e){var i=e.get("column_key"),s=h.getCellView(e),n={"CellView":s,"name":i,"noTitleInHeader":e.get("noTitleInHeader"),"isNaming":e.get("isNaming"),"title":e.get("title")||e.get("name"),"orderable":!!e.get("sort"),"filterable":!!e.get("filter"),"className":s.columnClassName,"defaultAction":e.get("default_action"),"contextualMenu":e.get("contextual_menu"),"data":function(t,i){if("orderBy"===i)return e.get("sort_key")||e.get("column_key");if("filterBy"===i)return e.get("filter_key")||e.get("column_key");if("set"===i)throw new Error("Setting column value not implemented");return s.getValue(t,n)},"render":function(){return""}},o=e.get("align");return o&&(window.csui&&window.csui.rtl&&("left"===o&&(o="right")||"right"===o&&(o="left")),n.className+=" csui-align-"+o),e.attributes&&(n.attributes=n.attributes||{},t.extend(n.attributes,e.attributes)),n},this)}this.allColumns=e,this.displayedColumns=[],this.wrappedColumns=[],t.each(e,function(e){e.attributes&&!0===e.attributes.permanentColumn&&(e.columnWrapped=!1,this.displayedColumns.push(e))},this),this.allColumns.length&&Z.call(this),this.trigger("columnDefinitionsBuilt",{"sender":this,"columns":e})}function Z(){if(this.maxColumnsDisplayed||this.options.maxColumnsDisplayed){var e=this.maxColumnsDisplayed||this.options.maxColumnsDisplayed;this.displayedColumns=[],this.wrappedColumns=[];var i=0;t.each(this.allColumns,function(e){e.attributes&&!0===e.attributes.permanentColumn&&(e.columnWrapped=!1,i++)},this),ue?(this.displayedColumns=t.clone(this.allColumns),this.wrappedColumns=[]):(t.each(this.allColumns,function(t){t.attributes&&!0===t.attributes.permanentColumn||(i++,t.columnWrapped=!!e&&i>e)},this),this.displayedColumns=t.where(this.allColumns,{"columnWrapped":!1}),this.wrappedColumns=t.where(this.allColumns,{"columnWrapped":!0}))}}function Y(e,i){var s=e.options;if(s.selectColumn&&i.unshift(new p({"column_key":"_select","name":"","sortable":!1,"alignment":"center","permanentColumn":!0})),s.additionalColumns&&s.additionalColumns.length>0&&t.each(s.additionalColumns,function(e,t){i.push(new p(e))}),ue){i.some(function(e){return"description"===e.get("column_key")})||i.push(new p({"column_key":"description","name":r.descriptionColumnTitle,"sortable":!1,"permanentColumn":!0}))}return s.haveDetailsRowExpandCollapseColumn&&i.push(new p({"column_key":"_toggledetails","name":"","sortable":!1,"alignment":"center","permanentColumn":!0})),i}function ee(){this.table&&(this.trigger("destroyingTable",{"sender":this}),this._inlineBarShouldDestroy(),t.each(this.searchBoxes,function(e){e.destroy()}),this.searchBoxes.splice(0,this.searchBoxes.length),this._alternativeHeaderRegion&&(this._alternativeHeaderRegion.empty(),delete this._alternativeHeaderRegion),this._selectAllCheckboxRegion&&(this._selectAllCheckboxRegion.empty(),delete this._selectAllCheckboxRegion),delete this._detailRowsDescriptionTRs,delete this._detailRowViewsByModelId,this.table.destroy(),ie.call(this),delete this.table,delete this.tableTools,this.trigger("tableDestroyed",{"sender":this}))}function te(){t.each(this.csuiDestroyRowCallbacks,function(e){e()}),this.csuiDestroyRowCallbacks=[]}function ie(){e("> table , > #message",this.$el).remove()}function se(){var e=this.collection,i=this.table.rows(".selected").data(),s={};t.each(i,function(e){s[e.id||e.get("id")]=!0}),this.stateBeforeRebuild={"pageLength":e?e.topCount:this.options.pageSize,"selectedNodesById":s,"currentScollPosition":this.$("tbody").scrollTop()}}function ne(e){this.stateBeforeRebuild&&(t.extend(e,this.stateBeforeRebuild),delete this.stateBeforeRebuild)}function oe(e,t,i,s){if(!1!==this.refreshEnabled&&(this.columns.length||this.columns.fetched)){ae.call(this,t,i)&&this.collection.fetch();var n={"sEcho":ce(t,"sEcho"),"data":this.collection.models};this.trigger("settingServerData",{"sender":this,"result":n}),s(n)}}function re(e,t,i,s){if(this.options.clientSideDataOperation){ae.call(this,t,i);var n={"sEcho":ce(t,"sEcho"),"data":this.collection.models};this.trigger("settingServerData",{"sender":this,"result":n}),s(n)}}function le(t,i){t.preventDefault(),t.stopPropagation();var s=e(t.target),n=s.closest("tr"),o=n[0]._DT_RowIndex;if(void 0!==o){var r=this.table.row(o).data();this.trigger("click"+i+"Action",{"sender":this,"target":s[0],"node":r,"event":t})}}function ae(e,i){var s=i.aoColumns,n=[],o=i.oInstance.api(),r=o.table();return t.each(r.order(),function(e){var t=e[0],i=s[t].data(void 0,"orderBy");i&&(e[1]?n.push(i+" "+e[1]):n.push(i))}),!!n.length&&this.collection.setOrder(n.join(),!1)}function ce(e,t){return e?e[t]:void 0}var ue=/\baccessibleTable\b(?:=([^&]*)?)?/i.exec(location.search);ue=ue&&"false"!==ue[1];var de=s.View.extend({"constructor":function(n){if(this.accFocusedState={"focusView":"tableBody","headerColumn":0,"body":{"column":0,"row":0}},n||(n={}),this.context=n.context,this.expandedDetailRows={},this._showEmptyViewText=!0,this.columnHeadersVisible=!0,this.columnsWithSearch=n.columnsWithSearch||[],t.each(this.columnsWithSearch,t.bind(function(e,t){this.columnsWithSearch[t]=this.columnsWithSearch[t].toLowerCase()},this)),this.searchBoxes=[],n.filterBy&&t.each(n.filterBy,t.bind(function(e,t){n.collection.filters&&(n.collection.filters[t]=e)},this)),n.actionItems&&n.commands?(this.defaultActionController=new b({"actionItems":n.actionItems,"commands":n.commands}),this.checkModelHasAction=this.defaultActionController.hasAction.bind(this.defaultActionController)):this.checkModelHasAction=function(){return!0},this.additionalColumns=n.additionalColumns||[],!n.collection)throw new Error("table.view options require a collection to be set");if(s.View.prototype.constructor.apply(this,arguments),t.defaults(this.options,{"orderBy":"name asc","enableSorting":!0,"selectColumn":!0,"haveToggleAllDetailsRows":!0,"haveDetailsRowExpandCollapseColumn":!0,"selectRows":"multiple","selectAllColumnHeader":!0,"nameEdit":!0,"maxColumnsDisplayed":25}),ue&&(this.options.haveToggleAllDetailsRows=!1,this.options.haveDetailsRowExpandCollapseColumn=!1),this.collection.setOrder(this.options.orderBy,!1),delete this.options.orderBy,this.options.blockingParentView?m.delegate(this,this.options.blockingParentView):m.imbue(this),this.connector=this.options.connector,this.connector||(this.connector=this.context.getObject(f)),this.columns=this.options.columns,!this.columns&&(this.columns=this.collection.columns,!this.columns))throw new Error("table.view options require columns or collection.columns to be set");this._ViewCollection=i.Collection.extend({"model":this.collection.model}),this.selectedChildren=new this._ViewCollection,this.listenTo(this.selectedChildren,"reset",function(){this._showOrHideAlternativeHeaderView()}),this.listenTo(this.collection,"reset",this._handleModelsReset).listenTo(this.collection,"update",this._handleModelsUpdate).listenTo(this.collection,"remove",this._handleModelRemove).listenTo(this.collection,"change",this.updateRow).listenTo(this.collection,"request",this.blockActions).listenTo(this.collection,"sync",this.unblockActions).listenTo(this.collection,"sync",this._handlePendingFilter).listenTo(this.collection,"new:page",this.resetScrollToTop).listenTo(this.collection,"reset",this._updateSelectedChildren).listenTo(this.collection,"remove",this._updateSelectedChildren).listenTo(this.collection,"destroy",this.unblockActions).listenTo(this.collection,"error",this.unblockActions).listenTo(this.columns,"reset",this._handleColumnsReset),this.options.tableColumns&&this.listenTo(this.options.tableColumns,"reset update",this._handleTableColumnsReset),this.context&&this.listenTo(this.context,"request",this._handleContextRequest).listenTo(this.context,"sync error",this._handleContextFinish).listenTo(this.context,"sync",this._handleContextSync),this.listenTo(this.collection,"reset",function(){this._isRendered&&this.table&&W.call(this)}),this.listenTo(this.collection,"reset",this.setFocusToFirstRow).listenTo(this.collection,"add",this.setFocusToFirstRow).listenTo(this.collection,"remove",this.setFocusToFirstRow).listenTo(this.collection,"destroy",this.setFocusToFirstRow),this.collection.fetching&&(this.blockActions(),this.disableEmptyViewText()),this.disableEmptyViewText(),this.listenTo(this,"dom:refresh",this._onDomRefresh),this.listenTo(this,"clickDefaultPreAction",function(e){this.triggerMethod("execute:defaultAction",e.node)}),this.collection.node&&(this.listenTo(this.collection.node,"change:id",this.setFocusToFirstRow),this.listenTo(this.collection.node,"change:id",this._clearSearchBoxes),this.listenTo(this.collection.node,"change:id",this._clearExpandedRows),this.listenTo(this.collection.node,"change:id",function(){}));var o=this;e(window).bind("resize.tableview",t.debounce(function(){o.triggerMethod("dom:refresh")},200)),this.options.inlineBar&&this._setInlineBarEvents(),this.prepareForGlobalAlert()},"behaviors":{"PerfectScrolling":{"behaviorClass":u,"contentParent":"tbody","suppressScrollX":!0},"TabableRegion":{"behaviorClass":d,"initialActivationWeight":100}},"events":{"keydown":"onKeyInView"},"destroy":function(){return e(window).unbind("resize.tableview"),ee.call(this),s.View.prototype.destroy.apply(this,arguments)},"enableEmptyViewText":function(){this._showEmptyViewText=!0},"disableEmptyViewText":function(){this._showEmptyViewText=!1},"_updateSelectedChildren":function(e){if(this._isRendered&&!this.deletingNodes&&this.table){var i=L.call(this),s=this.getSelectedChildren();this.selectedChildren.reset(s),t.each(this.selectedChildren.models,function(e){var t=this.collection.indexOf(e),s=this.table.row(t).node();s&&e.get(v.isSelectedModelAttributeName)&&!1===i.fnIsSelected(s)&&i.fnSelect(s)},this)}},"_setInlineBarEvents":function(){this.listenTo(this,"closeOther",this._inlineBarShouldDestroy),this.options.inlineBar.options.forceInlineBarOnClick?this.listenTo(this,"row:clicked",function(e){if(this.inlineBarView){if(this.inlineBarView.model.get("id")===e.node.get("id"))return}this.options.inlineBar.viewClass&&this._destroyOldAndCreateNewInlineBarWithoutDelay(e)}):this.options.inlineBar.options.showInlineBarOnHover&&(this.listenTo(this,"enterTableRow",this._destroyOldAndCreateNewInlineBarWithDelay),this.listenTo(this,"leaveTableRow",this._inlineBarShouldDestroy)),this.listenTo(this.collection,"reset",this._destroyInlineBar),this.collection.node&&this.listenTo(this.collection.node,"change:id",this._destroyInlineBar)},"_showInlineBar":function(e){if(!(this.getSelectedChildren().length>0))if(this.inlineBarView)this._savedHoverEnterArgs=e;else{this._savedHoverEnterArgs=null,this.inlineBarView=new this.options.inlineBar.viewClass(t.extend({"context":this.options.context,"originatingView":this.options.originatingView,"commands":this.defaultActionController.commands,"model":e.node},this.options.inlineBar.options)),this.listenToOnce(this.inlineBarView,"destroy",function(){this.inlineBarView&&this.stopListening(this.inlineBarView),this._savedHoverEnterArgs&&this._destroyOldAndCreateNewInlineBarWithDelay(this._savedHoverEnterArgs)},this);var i=this.getNameCell(e.target);if(i&&1===i.length){var n=i.find(".csui-table-cell-name-appendix"),o=new s.Region({"el":n});o.show(this.inlineBarView),this.inlineBarView.$el.parent().length>0&&n.addClass("csui-table-cell-name-appendix-full"),i.addClass("csui-table-actionbar-shown")}}},"_destroyOldAndCreateNewInlineBarWithDelay":function(e){this._inlineBarShouldDestroy(),this._showInlineBarTimeout&&clearTimeout(this._showInlineBarTimeout);var t=this;this._showInlineBarTimeout=setTimeout(function(){t._showInlineBarTimeout=null,t.lockedForOtherContols||t._showInlineBar.call(t,e)},200)},"_inlineBarShouldDestroy":function(){this._showInlineBarTimeout&&(clearTimeout(this._showInlineBarTimeout),this._showInlineBarTimeout=null),this._destroyInlineBar()},"_destroyOldAndCreateNewInlineBarWithoutDelay":function(e){this._inlineBarShouldDestroy(),this.lockedForOtherContols||this._showInlineBar.call(this,e)},"_destroyInlineBar":function(){if(this.inlineBarView){var e=this.inlineBarView.$el.parent();e.removeClass("csui-table-cell-name-appendix-full"),e.closest(".csui-table-actionbar-shown").removeClass("csui-table-actionbar-shown"),this.inlineBarView.destroy(),this.inlineBarView=null}},"_clearExpandedRows":function(){this._isRendered&&(this.expandedDetailRows={})},"_adjustColumnsAfterWindowResize":function(){if(!ue&&this.columns.length){var e=!0;if(this.$el.is(":visible")){var i=X.call(this);if(i&&i!==this.maxColumnsDisplayed&&(this.maxColumnsDisplayed=i,!this._rebuildingTable))return e=!1,setTimeout(t.bind(this.rebuild,this))}e&&this._adjustColumns(),this.$el.removeClass("csui-not-ready")}},"onKeyInView":function(e){if(9===e.keyCode){if(this.activeInlineForm)return e.preventDefault(),void e.stopPropagation();e.shiftKey?"tableBody"===this.accFocusedState.focusView&&(e.preventDefault(),e.stopPropagation(),this.accFocusedState.focusView="tableHeader",this.trigger("changed:focus"),this.currentlyFocusedElement().focus()):"tableHeader"===this.accFocusedState.focusView&&(e.preventDefault(),e.stopPropagation(),this.accFocusedState.focusView="tableBody",this.trigger("changed:focus"),this.currentlyFocusedElement().focus())}},"currentlyFocusedElement":function(){if("tableHeader"===this.accFocusedState.focusView){if(this.tableCaptionView)return this.tableCaptionView.currentlyFocusedElement()}else if(this.tableBodyView)return this.tableBodyView.currentlyFocusedElement()},"setFocusToFirstRow":function(){this._isRendered&&(this.accFocusedState.body.row=0,this.accFocusedState.body.column=x.getNameColumnIndex(this.displayedColumns)||0)},"renderError":function(){this.table||(ie.call(this),e("<div></div>",{"id":"message"}).html(a.MessageHelper.toHtml()).appendTo(this.$el))},"rebuild":function(){if(this._rebuildingTable)throw new Error("Rebuild called recursively");this._rebuildingTable=!0,this.$el.addClass("csui-nodetable"),this.table&&(se.call(this),ee.call(this)),this.triggerMethod("before:render",this),P.call(this),this.table?(this.accFocusedState.body.row=0,this.accFocusedState.body.column=x.getNameColumnIndex(this.displayedColumns)||0):this.accFocusedState.body.row=this.accFocusedState.body.column=0,this.showOrHideZeroRecordsMessage(),this.triggerMethod("render",this),this._rebuildingTable=!1},"_plugHeaderBodyViews":function(){var e=this;this.tableCaptionView=new T({"el":this.$("thead"),"displayedColumns":this.displayedColumns,"searchBoxes":this.searchBoxes,"_getActiveInlineForm":t.bind(function(){return this.activeInlineForm},this),"accFocusedColumn":this.accFocusedState.headerColumn,"accSearchFocused":this.accFocusedState.accSearchFocused}),this.propagateEventsToViews(this.tableCaptionView),this.tableCaptionView.listenTo(this.tableCaptionView,"closeOtherControls",function(){e.trigger("closeOther")}),this.tableCaptionView.listenTo(this.tableCaptionView,"sorting:toggle",function(i){if(e.displayedColumns[i].bSortable){var s="asc",n=e.table.order();if(t.isArray(n)&&n.length>0){var o=n[0][0],r=n[0][1];o===i&&r===s&&(s="desc")}e.table.order([i,s]).draw()}}),this.tableCaptionView.listenTo(this.tableCaptionView,"changed:focus",function(){e.accFocusedState.focusView="tableHeader",e.trigger("changed:focus")}),this.tableCaptionView.render(),s.triggerMethodOn(this.tableCaptionView,"before:show"),s.triggerMethodOn(this.tableCaptionView,"show"),this.tableBodyView=new x({"el":this.$("tbody"),"collection":this.collection,"displayedColumns":this.displayedColumns,"_getActiveInlineForm":t.bind(function(){return this.activeInlineForm},this),"startInlineFormForEdit":t.bind(this.startInlineFormForEdit,this),"accFocusedCell":this.accFocusedState.body,"tableView":this}),this.propagateEventsToViews(this.tableBodyView),this.tableBodyView.listenTo(this.tableBodyView,"closeOtherControls",function(){e.trigger("closeOther")}),this.tableBodyView.listenTo(this.tableBodyView,"changed:focus",function(){e.accFocusedState.focusView="tableBody",e.trigger("changed:focus")}),this.tableBodyView.render(),s.triggerMethodOn(this.tableBodyView,"before:show"),this.tableBodyView.triggerMethod("show")},"_destroyTableHeaderAndBodyViews":function(){this.tableCaptionView&&(this.accFocusedState.headerColumn=this.tableCaptionView.accFocusedColumn,this.accFocusedState.accSearchFocused=this.tableCaptionView.accSearchFocused,this.tableCaptionView.destroy(),this.tableCaptionView=null),this.tableBodyView&&(this.tableBodyView.destroy(),this.tableBodyView=null)},"render":function(){return this._ensureViewIsIntact(),this.$el.addClass("csui-nodetable"),this.triggerMethod("before:render",this),te.call(this),this.table?this.table.draw():P.call(this),this.showOrHideZeroRecordsMessage(),this.triggerMethod("render",this),this},"setDeletingNodesState":function(e){this.deletingNodes=e},"_handleContextRequest":function(){this._fetchingContext=!0,this._columnsReset=!1,this._collectionReset=!1},"_handleContextSync":function(){this._isRendered&&(this._columnsReset?this.rebuild():this._collectionReset&&this.render())},"_handleContextFinish":function(){this._fetchingContext=!1},"_handleTableColumnsReset":function(){this._isRendered&&(this._fetchingContext?this._columnsReset=!0:this.rebuild())},"_handleColumnsReset":function(){this._isRendered&&(this._fetchingContext?this._columnsReset=!0:this.rebuild())},"_handleModelsReset":function(){this._isRendered&&(this.enableEmptyViewText(),this._fetchingContext?this._collectionReset=!0:this.render())},"_handleModelsUpdate":function(e,i){if(this._isRendered){var s=i.changes.added;s.length>0&&this.table&&t.each(s,function(e){e.unset(v.isSelectedModelAttributeName)}),this.render()}},"_handleModelRemove":function(t){if(this._isRendered)if(!0===this.deletingNodes){if(t){var i;this.table.rows(function(e,s,n){return s.get("id")===t.get("id")&&(i=e,!0)}).data(),void 0!==i&&e(this.$el.find(this.table.row(i).node())).hide()}}else this.render()},"updateRow":function(i){if(this._isRendered){var s=this.collection.indexOf(i);if(this.childWithBlockingView&&(this.childWithBlockingView.updateRowIndex=s),void 0!==s){if(this.table){var n=e(this.table.row(s).node()),o=this.table.row(s).child();if(1===t.keys(i.changed).length&&null!=i.changed[v.isSelectedModelAttributeName]){i.get(v.isSelectedModelAttributeName)?(n.addClass("binf-active"),t.each(o,function(t){e(t).addClass("binf-active")})):(n.removeClass("binf-active"),t.each(o,function(t){e(t).removeClass("binf-active")}))}!0===i.get("isCut")?(n&&n.addClass("csui-cut-row"),o&&o.addClass("csui-cut-row")):(n&&n.removeClass("csui-cut-row"),o&&o.removeClass("csui-cut-row"))}if((1!==t.keys(i.changed).length||null==i.changed[v.isSelectedModelAttributeName]&&null==i.changed.csuiDelayedActionsRetrieved)&&this.table){this.activeInlineForm&&this.activeInlineForm.model!==i&&this.cancelAnyExistingInlineForm({"silent":!0});var r=this.$("tbody").scrollTop();if(this.triggerMethod("before:render"),this.table.row(s).invalidate(),this.table.draw(),this.$("tbody").scrollTop(r),
this.triggerMethod("render"),!this.table)return;L.call(this),this._updateSelectedChildren(i),this.activeInlineForm&&this.activeInlineForm.triggerMethod("dom:refresh",this.activeInlineForm),this._adjustColumns()}}}},"_onDomRefresh":function(){if(this.$el.parent().length>0){this.$el.parent().css("display").indexOf("flex")<0&&this.$el.addClass("csui-not-in-flex-container")}this.$el.is(":visible")&&(this.activeInlineForm&&this.activeInlineForm.triggerMethod("dom:refresh",this.activeInlineForm),this._adjustColumnsAfterWindowResize())},"onAfterShow":function(){this._adjustColumnsAfterWindowResize()},"getNameCell":function(t){var i=x.getNameColumnIndex(this.displayedColumns);if(void 0!==i){var s=e(t).children()[i];return e(s)}},"updateCollectionParameters":function(){var e=this.collection,i=this.context,s=e.makeFieldsV2,n=e.makeExpandableV2,o={},r={};this.collection.setFields&&((s||n)&&e.getResourceScope&&e.setResourceScope&&(this._originalCollectionScope?e.setResourceScope(this._originalCollectionScope):this._originalCollectionScope=e.getResourceScope()),t.each(this.allColumns,function(t){var l=t.CellView;if(l){if(s&&l.getModelFields){var a=l.getModelFields({"collection":e,"context":i,"column":t});a&&A.mergePropertyParameters(o,a)}if(n&&l.getModelExpand){var c=l.getModelExpand({"collection":e,"context":i,"column":t});c&&A.mergePropertyParameters(r,c)}l.updateCollectionParameters&&l.updateCollectionParameters({"collection":e,"context":i,"column":t})}},this),t.isEmpty(o)||e.setFields(o),t.isEmpty(r)||e.setExpand(r))},"clearFilter":function(i,s){return this.table&&(s&&!e.isEmptyObject(this.options.filter)&&(this.options.filter=t.omit(this.options.filter,s.split(","))),this.options.filter&&delete this.options.filter.name,this.table.search("").columns().search("").draw()),this},"setFilter":function(i){this.table&&(e.isEmptyObject(this.options.filter)?this.options.filter=i:this.options.filter=t.extend(this.options.filter,i),this.table.draw())},"resetOrder":function(e){return this.collection.resetOrder(),this},"getScreenRowCount":function(t){var i=this.table&&L.call(this);if(i){var s=e("#"+i.dom.table.id),n=s&&s[0].childNodes[1]&&s[0].childNodes[1].clientHeight||0,o=s&&s.dataTable().$("tbody tr"),r=o[0]&&o[0].clientHeight||0;return r>0?Math.floor(n/r):0}return 0},"getSelectedChildren":function(){var e={};return e[v.isSelectedModelAttributeName]=!0,this.collection.where(e)},"clearChildrenSelection":function(){var e=this.table&&L.call(this);e&&e.fnSelectNone()},"getFocusedChild":function(){return this.accFocusedState.body.row?this.collection.at(this.accFocusedState.body.row):void 0},"cancelFetch":function(){this.table&&this.table.clear()},"showDetailRowDescriptions":function(e){this.options.descriptionRowView&&(this.options.descriptionRowViewOptions.showDescriptions=e,t.each(this._detailRowsDescriptionTRs,function(t){e?t.rowEl.removeClass("binf-hidden"):t.rowEl.addClass("binf-hidden"),t.view.trigger("dom:refresh")}),this.trigger("dom:refresh"))},"enableLocationColumn":function(e){this.options.locationColumn!==e&&(this.options.locationColumn=e)},"enableRefresh":function(e){this.refreshEnabled=e},"applyFilter":function(e){if(this.options.clientSideDataOperation)this.clientSideSearch(e.column);else{var t={};t[e.column]=e.keywords,this.collection.fetching?this.filterValuePending=t:(this.collection.resetLimit(!1),this.collection.setFilter(t))}},"cancelAnyExistingInlineForm":function(e){this.activeInlineForm&&this.activeInlineForm.cancel(e)},"startCreateNewModel":function(e,t){this.cancelAnyExistingInlineForm(),this.collection&&this.collection.node&&(e.set("parent_id",this.collection.node.get("id")),e.isLocallyCreated=!0,e.inlineFormView=t,this.collection.add(e,{"at":0}))},"startInlineFormForEdit":function(e){if(this.collection.contains(e)){this.cancelAnyExistingInlineForm();var t=y.getInlineFormView(e.get("type"));t||(t=y.getInlineFormView(-1)),t&&(e.inlineFormView=t,e.set("csuiInlineFormErrorMessage","dummy",{"silent":!0}),e.unset("csuiInlineFormErrorMessage"))}},"showOrHideZeroRecordsMessage":function(){if(this.$el.find("div.csui-table-empty").remove(),0===this.collection.length){this.$el.find("tbody").empty(),this.$el.addClass("csui-table-empty");var t="";this._showEmptyViewText&&(t=this.collection.filters&&this.collection.filters.name?this.localizableLabels.emptyTable:this.localizableLabels.zeroRecords);var i=e("<div class='csui-table-empty'><p class='csui-no-result-message' title='"+t+"'>"+t+"</p></div>");this.$el.append(i)}else this.$el.removeClass("csui-table-empty")},"setCustomLabels":function(e){function i(e,s){return t.reduce(t.keys(e),function(n,o){var r=e[o];if(t.isObject(r)){var l=s[o]||(s[o]={});return n||i(r,l)}var a=s[o]!=r;return s[o]=r,n||a},!1)}var s=this.getOption("customLabels")||this.getOption("tableTexts")||{};if(t.isFunction(s)&&(s=s.call(this)),this.options.customLabels=this._fillDefaultLocalizableLabels(e,s),this.table){var o=t.deepClone(this.options.customLabels);n.camelToHungarian(n.defaults.oLanguage,o);i(o,this.table.settings()[0].oLanguage)&&this.table.draw()}},"_fillDefaultLocalizableLabels":function(){function e(i){t.each(t.keys(i),function(s){var n=i[s];t.isObject(n)?e(n):!1!==n&&null!==n||delete i[s]})}var i=Array.prototype.slice.call(arguments),s={"paginate":{},"aria":{}};return t.each(i,function(e){null!=e.zeroRecordsMsg&&null==e.zeroRecords&&(e.zeroRecords=e.zeroRecordsMsg,delete e.zeroRecordsMsg),t.defaults(s,e),t.defaults(s.paginate,e.paginate),t.defaults(s.aria,e.aria)}),e(s),t.defaults(s,{"emptyTable":r.NodeTableNoItems,"zeroRecords":r.NodeTableNoItems,"loadingRecords":r.NodeTableLoadingItems,"processing":r.NodeTableProcessingItems,"info":r.NodeTablePageInfo,"infoEmpty":r.NodeTableEmptyPageInfo,"infoFiltered":r.NodeTableFilteredPageInfo,"infoThousands":r.NodeTablePageThousandsSeparator,"infoPostFix":r.NodeTablePageInfoSuffix,"lengthMenu":r.NodeTablePageSizeSelector,"search":r.NodeTablePageFilterLabel}),t.defaults(s.paginate,{"first":r.NodeTablePagingFirst,"last":r.NodeTablePagingLast,"previous":r.NodeTablePagingPrevious,"next":r.NodeTablePagingNext}),t.defaults(s.aria,{"sortAscending":r.NodeTableSortAscending,"sortDescending":r.NodeTableSortDescending}),s},"_handlePendingFilter":function(){this._isRendered&&(t.isEmpty(this.filterValuePending)||(this.collection.resetLimit(!1),this.collection.setFilter(this.filterValuePending),this.filterValuePending={}))},"clientSideSearch":function(e){var i={};t.each(this.searchBoxes,function(e){var t=e.getColumn(),s=e.getValue();s.length&&(i[t]=s)}),this.collection.resetLimit(!1),this.collection.setFilter(i)},"resetScrollToTop":function(){if(this._isRendered){this.$("tbody").scrollTop(0)}},"_clearSearchBoxes":function(){this._isRendered&&t.each(this.searchBoxes,function(e){e.hideAndClear()})},"_adjustColumns":function(){if(!ue&&this.displayedColumns&&this.$el.is(":visible")){var i=this.$el.width();u.usePerfectScrollbar()||this.$el.find(".csui-normal-scrolling").hasScroll()&&(i-=e.scrollbarWidth());var s,n=0,o=0,r=this.$el.find("table>thead>tr>th");s=this.collection.length>0&&!this.activeInlineForm?this.$el.find("table>tbody>tr:first-child").children():r;var l,a={},c=[],d=this.displayedColumns,h=0,p=0,m=0,f=0;s.each(function(t){if(t<d.length){var i=e(this),s=Math.max(i.outerWidth(),e(r[t]).outerWidth()),u=d[t];if(u.CellView.hasFixedWidth)o+=s,n++;else{var b=u.attributes&&u.attributes.widthFactor||1;b&&1!==b?(a[t]=b,h+=b):u.CellView&&u.CellView.flexibleWidth?(m+=s,f++):(c.push(t),h+=1),b>p&&(p=b,l=t)}}});var b=i-o-m,g=d.length-n-f,v=g>0?b/g:0,w=0,y=h/g;t.each(a,function(e,t){var i=e/y,s=v*i;w+s>b&&(s=b-w)<0&&(s=0),s=Math.floor(s),a[t]=s,w+=s});var _;c.length>0?(v=(b-w)/c.length/y,v=Math.floor(v),_=b-w-v*c.length):(v=0,_=b-w),_=Math.floor(_);var C=this.$el.find("table>tbody"),T={};s.each(function(t){if(t<d.length){var i=e(this),s=d[t],n=Math.max(i.outerWidth(),e(r[t]).outerWidth()),o={"width":n+"px"};if(!s.CellView.hasFixedWidth){var c;c=a[t]&&a[t]>0?a[t]:v,t===l&&_&&(c+=_);var u=c+"px";s.CellView.flexibleWidth?e(r[t]).css(o):(o={"min-width":u,"max-width":u},e(r[t]).css(o))}C.find("tr:not(.csui-details-row)>:not(.csui-inlineform-parent):nth-child("+(t+1)+")").css(o),T[s.className]=o}}),this.cachedColumnWidths=T,this.accFocusedState.body.column>d.length-1&&(this.accFocusedState.body.column=d.length-1),this._showOrHideAlternativeHeaderView()}},"_showOrHideAlternativeHeaderView":function(){this._alternativeHeaderRegion&&(this.selectedChildren.length>0?this._alternativeHeaderRegion.$el.addClass("csui-table-alternative-header-visible"):this._alternativeHeaderRegion.$el.removeClass("csui-table-alternative-header-visible"))},"_createAlternativeHeaderView":function(){var e,i,s=this.options.alternativeHeader.options;if(s&&s.toolbarItems&&s.toolbarItems.tableHeaderToolbar){var n=s.toolbarItems.tableHeaderToolbar;e=n?n.options:void 0;var o={"nodes":this.selectedChildren,"container":this.collection.node,"context":this.context,"collection":this.collection};this._alternativeHeaderCommandController=s.toolbarCommandController||new k({"commands":s.commands}),i=new I(n,{"status":o,"commands":this._alternativeHeaderCommandController.commands,"delayedActions":this.collection.delayedActions,"mask":s.toolbarItemsMask})}var r=new this.options.alternativeHeader.viewClass(t.extend({"collection":i,"toolbarName":"tableHeader","originatingView":this.options.parentView,"keyboardNavigationEnabled":!0,"selectedNodes":this.selectedChildren},e));return this._alternativeHeaderCommandController&&(this.listenTo(this._alternativeHeaderCommandController,"before:execute:command",function(e){l.debug("command "+e.commandSignature+" is starting")&&console.log(l.last),this.lockedForOtherContols=!0,this._destroyInlineBar(),r.trigger("before:execute:command",e)}),this.listenTo(this._alternativeHeaderCommandController,"after:execute:command",function(e){l.debug("command is finished")&&console.log(l.last),this.lockedForOtherContols=!1,r.trigger("after:execute:command",e)})),r},"_toolbarItemClicked":function(e,t){var i=this.getSelectedChildren(),s={"context":this.context,"nodes":new this._ViewCollection(i),"container":this.collection.node,"collection":this.collection,"originatingView":this.options.originatingView,"toolItemView":e};this._alternativeHeaderCommandController.toolitemClicked(t.toolItem,s)}});de.version="1.0";var he=120;return t.extend(de.prototype,S),t.extend(de.prototype,V),de.prototype._eventsToPropagateToViews.push("clicked:cell"),de}),csui.define("hbs!csui/controls/table.list/impl/table.list.row",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'  <div class="csui-table-cell csui-table-cell-'+this.escapeExpression(this.lambda(null!=e?e.name:e,e))+" "+this.escapeExpression(this.lambda(null!=e?e.class:e,e))+'" role="cell"></div>\r\n'},"3":function(e,t,i,s){return'  <div class="csui-table-extra-cols csui-column-wrapped" role="cell"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return(null!=(n=t.each.call(e,null!=e?e.columns:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.hasWrappedColumns:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("csui_controls_table.list_impl_table.list.row",s),s}),csui.define("hbs!csui/controls/table.list/impl/table.list.header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.noTitleInHeader:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(7,s,0)}))?n:""},"2":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.isToolbar:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(5,s,0)}))?n:""},"3":function(e,t,i,s){var n;return'      <div class="csui-table-header-cell csui-table-header-toolbar" tabindex="-1"\r\n           data-cstabindex="-1" role="columnheader">\r\n        <span class="'+this.escapeExpression(this.lambda(null!=e?e.className:e,e))+'" title="'+this.escapeExpression((n=null!=(n=t.addTitle||(null!=e?e.addTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"addTitle","hash":{}}):n))+'"></span>\r\n      </div>\r\n'},"5":function(e,t,i,s){return'      <div class="csui-table-header-cell '+this.escapeExpression(this.lambda(null!=e?e.className:e,e))+'" role="columnheader"></div>\r\n'},"7":function(e,t,i,s){return'    <div class="csui-table-header-cell '+this.escapeExpression(this.lambda(null!=e?e.className:e,e))+'" title="'+this.escapeExpression(this.lambda(null!=e?e.title:e,e))+'" tabindex="-1"\r\n         data-cstabindex="-1" role="columnheader">\r\n      <div class="csui-table-header-cell-container csui-fadeout">\r\n        <span>\r\n          '+this.escapeExpression(this.lambda(null!=e?e.title:e,e))+"\r\n        </span>\r\n      </div>\r\n    </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return(null!=(n=t.each.call(e,null!=e?e.columns:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"\r\n\r\n"}});return i.registerPartial("csui_controls_table.list_impl_table.list.header",s),s}),csui.define("hbs!csui/controls/table.list/impl/table.list",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-table-list-header" role="rowgroup"></div>\r\n<div class="csui-table-list-body"></div>'}});return i.registerPartial("csui_controls_table.list_impl_table.list",s),s}),csui.define("hbs!csui/controls/table.list/impl/empty.table",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return this.escapeExpression((n=null!=(n=t.message||(null!=e?e.message:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"message","hash":{}}):n))}});return i.registerPartial("csui_controls_table.list_impl_empty.table",s),s}),csui.define("csui/controls/table.list/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table.list/impl/nls/root/lang",{"addTitle":"Add"}),csui.define("css!csui/controls/table.list/impl/table.list",[],function(){}),csui.define("csui/controls/table.list/table.list.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/utils/commands","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/table/cells/cell.factory","csui/controls/progressblocker/blocker","csui/controls/globalmessage/globalmessage","csui/controls/tableactionbar/tableactionbar.view","csui/controls/table/rows/metadata/metadatarow.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/controls/table.list/impl/table.list.row","hbs!csui/controls/table.list/impl/table.list.header","hbs!csui/controls/table.list/impl/table.list","hbs!csui/controls/table.list/impl/empty.table","i18n!csui/controls/table.list/impl/nls/lang","css!csui/controls/table.list/impl/table.list","csui/lib/jquery.mousehover"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b,g,v){"use strict";var w=s.ItemView.extend({"className":"csui-table-empty","template":g,"constructor":function(e){s.ItemView.prototype.constructor.apply(this,arguments)},"templateHelpers":function(){return{"message":this.options.emptyTableText}}}),y=s.LayoutView.extend({"className":"csui-table-row","attributes":function(){return{"role":"row"}},"tagName":"div","template":m,"events":{"focusin .csui-table-cell":"onFocusInTableCell","blur .csui-table-cell":"onFocusOutTableCell"},"templateHelpers":function(){return{"columns":this.options.columns,"hasWrappedColumns":this.options.wrappedColumns&&this.options.wrappedColumns.length>0}},"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.call(this,e)},"initialize":function(){var t=this;this.options.columns&&e.each(this.options.columns,function(e){if(e.CellView){var i=e.name;t.addRegion(i,".csui-table-cell-"+i)}},this),this.options.wrappedColumns&&this.options.wrappedColumns.length>0&&t.addRegion("csui-column-wrapped",".csui-column-wrapped")},"onRender":function(){var t=this;if(this.options.columns&&e.each(this.options.columns,function(e,i){if(e.CellView){var s=e.name,n=new e.CellView({"tagName":"DIV","model":t.model,"context":t.options.context,"applyTo":t.options.applyTo,"column":e,"originatingView":t.options.originatingView});t[s].show(n),t.listenTo(n,"clicked:cell",function(e){t.trigger("clicked:cell",{"cellView":n,"rowIndex":t._index,"colIndex":i,"model":t.model})})}},this),this.options.wrappedColumns&&this.options.wrappedColumns.length>0){var i=new d({"context":this.options.context,"model":this.model,"columns":this.options.wrappedColumns});this["csui-column-wrapped"].show(i)}!n.isTouchBrowser()&&this.options.showInlineToolbar&&this.$el&&this._subscribeEventHandlers(),n.isTouchBrowser()&&this.options.showInlineToolbar&&this._showInlineRowActions()},"_showInlineRowActions":function(){var t=this.$el.find(".csui-row-inlinetoolbar").removeClass("binf-hidden"),i=[0,1];(null===this.model.get("permissions")||!this.options.hasEditPermission||i.indexOf(this.model.get("right_id_expand")&&this.model.get("right_id_expand").type)<0&&"custom"===this.model.get("type"))&&this.$el.find(".csui-row-inlinetoolbar").addClass("binf-hidden"),0!==t.length&&void 0===this.inlineRowToolbarView&&(this.inlineRowToolbarView=new u(e.extend({"context":this.options.context,"commands":o,"collection":this.options.toolbarItems.inlineToolbar,"toolItemsMask":this.options.toolbarItemsMasks.toolbars.inlineToolbar,"originatingView":this.options.originatingView,"model":this.model,"applyTo":this.options.applyTo,"status":{"model":this.model,"targetView":this,"connector":this.options.connector,"applyTo":this.options.applyTo}},this.options.toolbarItems.inlineToolbar.options,{"maxItemsShown":1})),this.listenTo(this.inlineRowToolbarView,"before:execute:command",function(e){e&&e.status&&e.status.targetView&&e.status.targetView.$el&&e.status.targetView.$el.addClass("active-row"),this.trigger("before:execute:action",e)}),this.listenTo(this.inlineRowToolbarView,"after:execute:command",function(e){e&&e.status&&e.status.targetView&&e.status.targetView.$el&&e.status.targetView.$el.removeClass("active-row"),this.trigger("after:execute:action",e)}),this.options.originatingView&&(this.listenTo(this.options.originatingView,"block:view:actions",function(){this.trigger("before:execute:action")}),this.listenTo(this.options.originatingView,"unblock:view:actions",function(){this.trigger("after:execute:action")})),this.inlineRowToolbarView.render(),t.append(this.inlineRowToolbarView.$el),this.inlineRowToolbarView.triggerMethod("show"))},"_destroyInlineRowActionBar":function(){this.inlineRowToolbarView&&(this.inlineRowToolbarView.destroy(),this.inlineRowToolbarView=void 0,this.$el.find("active-row")&&this.$el.removeClass("active-row"))},"onBeforeRender":function(){!n.isTouchBrowser()&&this.options.showInlineToolbar&&this._unsubscribeEventHandlers()},"onBeforeDestroy":function(){this.options.showInlineToolbar&&(n.isTouchBrowser()?this._destroyInlineRowActionBar():this._unsubscribeEventHandlers())},"_subscribeEventHandlers":function(){this.$el&&this.$el.mousehover(this.showInlineActions.bind(this),this.hideInlineActions.bind(this),{"namespace":this.cid})},"_unsubscribeEventHandlers":function(){this._isRendered&&this.$el.mousehover("off",{"namespace":this.cid})},"showInlineActions":function(e){if([0,1].indexOf(this.model.get("right_id_expand")&&this.model.get("right_id_expand").type)<0&&"custom"===this.model.get("type"))this.$el.find(".csui-inlinetoolbar").addClass("binf-hidden");else{var t=this.$el.find(".csui-inlinetoolbar").removeClass("binf-hidden");if(t.length>0){var i=this,s={"sender":i,"target":t,"model":i.model};i.trigger("mouseenter:row",s)}}},"hideInlineActions":function(e){var t=this.$el.find(".csui-inlinetoolbar").addClass("binf-hidden");if(t.length>0){var i=this,s={"sender":i,"target":t,"model":i.model};i.trigger("mouseleave:row",s)}},"onFocusInTableCell":function(e){this.options.showInlineToolbar&&this._showInlineRowActions()},"onFocusOutTableCell":function(t){this.options.showInlineToolbar&&setTimeout(e.bind(function(){0!==this.$el.find(document.activeElement).length||n.isTouchBrowser()||this._destroyInlineRowActionBar()},this),50)}}),_=s.ItemView.extend({"className":"csui-table-header","attributes":function(){return{"role":"row"}},"tagName":"div","behaviors":{"TabableRegion":{"behaviorClass":p,"initialActivationWeight":100}},"events":{"keydown":"onKeyInView"},"template":f,"templateHelpers":function(){var t=this.options.userPermissionsModel&&this.options.userPermissionsModel.get("permissions"),i=e.contains(t,"edit_permissions");return{"columns":this.options.columns,"addTitle":v.addTitle,"isToolbar":this.options.admin_permissions||i}},"constructor":function(e){e||(e={}),s.ItemView.prototype.constructor.call(this,e)},"onRender":function(){this.focusIndex=0,this._columnCount=this.options.columns.length,this._toolbarHeaderColumnCount=0;var t=this.options.userPermissionsModel&&this.options.userPermissionsModel.get("permissions");if(this.options.admin_permissions||e.contains(t,"edit_permissions"))this._toolbarHeaderColumnCount=this._columnCount;else for(var i=0;i<this._columnCount;i++){var s=this.options.columns[i];s.isToolbar||this._toolbarHeaderColumnCount++,void 0!==s.attributes.containsInlineActions&&(s.attributes.containsInlineActions=!1)}},"currentlyFocusedElement":function(){return this.$el.find(".csui-table-header-cell").eq(this.focusIndex)},"onKeyInView":function(e){var t=!0;switch(e.keyCode){case 37:this.focusIndex>0&&this.focusIndex--;break;case 39:this.focusIndex<this._toolbarHeaderColumnCount-1&&this.focusIndex++;break;default:t=!1}t&&(e.preventDefault(),e.stopPropagation(),this.$el.find(".csui-table-header-cell").eq(this.focusIndex).focus())}}),C=s.CollectionView.extend({"className":"csui-table-body","attributes":function(){return{"role":"rowgroup"}},"childView":y,"childEvents":{"mouseenter:row":"onChildShowInlineActionBarWithDelay","mouseleave:row":"onChildActionBarShouldDestroy","clicked:cell":"onClickedCell"},"behaviors":{"TabableRegion":{"behaviorClass":p,"initialActivationWeight":100}},"events":{"keydown":"onKeyInView"},"childViewOptions":function(){return{"context":this.options.context,"columns":this.options.columns,"wrappedColumns":this.options.wrappedColumns,"showInlineToolbar":this.showInlineToolbar,"toolbarItems":this.options.toolbarItems,"toolbarItemsMasks":this.options.toolbarItemsMasks,"connector":this.options.collection.connector,"originatingView":this.options.originatingView,"applyTo":this.options.applyTo,"hasEditPermission":this.hasEditPermissionUser(this.collection)||this.options.admin_permissions}},"getEmptyView":function(){return this.options.emptyView?this.options.emptyView:w},"emptyViewOptions":function(){return this.options.emptyView?{"model":this.options.emptyViewModel}:this.options},"constructor":function(e){s.CollectionView.prototype.constructor.call(this,e),this.showInlineToolbar=this.options.toolbarItems&&this.options.toolbarItemsMasks,this.showInlineToolbar&&this.setInlineActionBarEvents()},"onRender":function(){if(this.nameColumnIndex=this.getNameColumnIndex(this.options.columns)||0,this.accFocusedCell=this.options.accFocusedCell||{"column":this.nameColumnIndex,"row":0},this.columnState=0,this._columnCount=this.options.columns.length,this._toolbarColumnCount=0,this.hasEditPermission=this.hasEditPermissionUser(this.collection)||this.options.admin_permissions,!this.hasEditPermission)for(var e=0;e<this._columnCount;e++){var t=this.options.columns[e];t.isToolbar&&this._toolbarColumnCount++}},"hasEditPermissionUser":function(t){var i=t.options&&t.options.authenticatedUserPermissions,s=i.get("permissions");return e.contains(s,"edit_permissions")},"setInlineActionBarEvents":function(){this.listenTo(this,"closeOther",this._destroyInlineActionBar),this.listenTo(this.collection,"reset",this._destroyInlineActionBar)},"_showInlineActionBar":function(i){this.inlineToolbarView?this._savedHoverEnterArgs=i:i&&(this._savedHoverEnterArgs=null,this.inlineToolbarView=new u(e.extend({"context":this.options.context,"commands":o,"collection":this.options.toolbarItems.inlineToolbar,"toolItemsMask":this.options.toolbarItemsMasks.toolbars.inlineToolbar,"originatingView":this.options.originatingView,"applyTo":this.options.applyTo,"model":i.model,"status":{"model":i.model,"targetView":i.sender,"connector":this.options.collection.connector,"filterId":this.options.memberFilter.get("id"),"applyTo":this.options.applyTo,"admin_permissions":this.options.admin_permissions},"customError":!0},this.options.toolbarItems.inlineToolbar.options)),this.listenTo(this.inlineToolbarView,"before:execute:command",function(e){this.lockedForOtherContols=!0,e&&e.status&&e.status.targetView&&e.status.targetView.$el&&e.status.targetView.$el.addClass("active-row"),this._destroyInlineActionBar()}),this.listenTo(this.inlineToolbarView,"after:execute:command",function(e){this.lockedForOtherContols=!1,e&&e.status&&e.status.targetView&&e.status.targetView.$el&&e.status.targetView.$el.removeClass("active-row"),this._toolbarActionTriggered(e)}),this.options.originatingView&&(this.listenTo(this.options.originatingView,"block:view:actions",function(){this.lockedForOtherContols=!0,this._destroyInlineActionBar()}),this.listenTo(this.options.originatingView,"unblock:view:actions",function(){this.lockedForOtherContols=!1})),this.inlineToolbarView.render(),this.listenTo(this.inlineToolbarView,"destroy",function(){this.inlineToolbarView=void 0,this._savedHoverEnterArgs&&this.onChildShowInlineActionBarWithDelay(this._savedHoverEnterArgs)},this),t(i.target).append(this.inlineToolbarView.$el),this.inlineToolbarView.triggerMethod("show"))},"onChildShowInlineActionBarWithDelay":function(e,t){this._showInlineActionbarTimeout&&clearTimeout(this._showInlineActionbarTimeout);var i=this;this._showInlineActionbarTimeout=setTimeout(function(){i._showInlineActionbarTimeout=void 0,i.lockedForOtherContols||i._showInlineActionBar.call(i,t)},200)},"onChildActionBarShouldDestroy":function(e,t){this._showInlineActionbarTimeout&&(clearTimeout(this._showInlineActionbarTimeout),this._showInlineActionbarTimeout=void 0),this.inlineToolbarView&&this.inlineToolbarView.destroy()},"onChildviewBeforeExecuteAction":function(){n.isTouchBrowser()&&this.children.each(function(e,t){e.inlineRowToolbarView&&e.inlineRowToolbarView.$el&&e.inlineRowToolbarView.$el.addClass("binf-disabled")})},"onChildviewAfterExecuteAction":function(){n.isTouchBrowser()&&this.children.each(function(e,t){e.inlineRowToolbarView&&e.inlineRowToolbarView.$el&&(e.inlineRowToolbarView.$el.removeClass("binf-disabled"),e.$el.find("active-row")&&e.$el.removeClass("active-row"))})},"_destroyInlineActionBar":function(){this.inlineToolbarView&&(this.inlineToolbarView.destroy(),this.inlineToolbarView=void 0)},"_toolbarActionTriggered":function(e){e&&e.commandSignature&&this.trigger("after:action:execute",e),this.currentlyFocusedElement().focus()},"currentlyFocusedElement":function(){if(this.collection.length>0&&null!=this.accFocusedCell.column){var e=this.children.findByIndex(this.accFocusedCell.row);return e&&e.$el.find(".csui-table-cell:nth-child("+(this.accFocusedCell.column+1)+")").children("DIV")}return t()},"onClickedCell":function(e,t){this.accFocusedCell.row=t.rowIndex,t.colIndex<this._columnCount-this._toolbarColumnCount?this.accFocusedCell.column=t.colIndex:this.accFocusedCell.column=this._columnCount-this._toolbarColumnCount-1,this._accSetFocusToCurrentlyFocusedElement()},"onKeyInView":function(e){var i,s,n,o=!0,r=this.currentlyFocusedElement();switch(e.keyCode){case 33:this.accFocusedCell.row=0;break;case 34:this.collection.length>0?this.accFocusedCell.row=this.collection.length-1:this.accFocusedCell.row=0;break;case 35:this.accFocusedCell.column=this._columnCount-this._toolbarColumnCount-1;break;case 36:this.accFocusedCell.column=0;break;case 37:if(this.accFocusedCell.column>0&&(i=this.accFocusedCell.column,this.accFocusedCell.column--,r=this.currentlyFocusedElement(),"true"===r.attr("data-csui-empty-cell")&&r.children().length<1)){var l=this._getNextFocusableElementIndex(37,--this.accFocusedCell.column);this.accFocusedCell.column=l>=0?l:i}break;case 38:if(this.$(".binf-dropdown-toggle").parent(".binf-dropdown").hasClass("binf-open")){s=this.$(".binf-dropdown-menu li").length-1,n=t(document.activeElement.parentElement).index(),s<=n&&(n-=1,this.$(this.$(".binf-dropdown-menu li a")[n]).focus().focus()),o=!1;break}this.accFocusedCell.row>0&&(i=this.accFocusedCell.column,this.accFocusedCell.row--,r=this.currentlyFocusedElement(),"true"===r.attr("data-csui-empty-cell")&&r.children().length<1&&(this.accFocusedCell.row=i));break;case 39:this.accFocusedCell.column<this._columnCount-this._toolbarColumnCount-1&&(i=this.accFocusedCell.column,this.accFocusedCell.column++,r=this.currentlyFocusedElement(),"true"===r.attr("data-csui-empty-cell")&&r.children().length<1&&(this.accFocusedCell.column=i));break;case 40:if(this.$(".binf-dropdown-toggle").parent(".binf-dropdown").hasClass("binf-open")){s=this.$(".binf-dropdown-menu li").length-1,n=t(document.activeElement.parentElement).index(),s>n&&(n+=1,this.$(this.$(".binf-dropdown-menu li a")[n]).focus().focus()),o=!1;break}this.accFocusedCell.row<this.collection.length-1&&(i=this.accFocusedCell.row,this.accFocusedCell.row++);break;default:o=!1}o&&(e.preventDefault(),e.stopPropagation(),this.trigger("closeOther"),this._accSetFocusToCurrentlyFocusedElement())},"_getNextFocusableElementIndex":function(e,t){var i=this.currentlyFocusedElement();switch(e){case 37:return this.accFocusedCell.column>=0&&"true"===i.attr("data-csui-empty-cell")?t:-1;default:return-1}},"_accSetFocusToCurrentlyFocusedElement":function(){var e=this.currentlyFocusedElement();e.length>0&&(e=t(e[0]),this.trigger("changed:focus",this),n.isVisibleInWindowViewport(e)&&e.focus())},"getNameColumnIndex":function(e){if(e)for(var t=0;t<e.length;t++){var i=e[t];if(i.isNaming)return t}}}),T=s.LayoutView.extend({"className":"csui-table-list","attributes":function(){return{"role":"table"}},"template":b,"regions":{"headerRegion":".csui-table-list-header","bodyRegion":".csui-table-list-body"},"behaviors":{"PerfectScrolling":{"behaviorClass":h,"contentParent":".csui-table-list-body","suppressScrollX":!0}},"constructor":function(i){i||(i={}),i.maxColumnsDisplayed||(i.maxColumnsDisplayed=10),i.tableColumns||(i.tableColumns=[]),s.LayoutView.prototype.constructor.call(this,i),this.context=i.context,this.collection=i.collection,this.listenTo(this.collection.delayedActions,"error",function(e,t,i){var s=new n.Error(t);c.showMessage("error",s.message)}),this.listenTo(this.collection,"sync",this._updateTable),this.listenTo(this.collection,"update",this.render),this.listenTo(this,"update:table",this._updateTable),this.onTableWinResize=e.bind(function(e){this._adjustColumnsAfterWindowResize(),this.trigger("resizetable",e)},this),t(window).bind("resize",this.onTableWinResize),t(window).bind("resize.tableview",this.onTableWinResize)},"onBeforeDestroy":function(){t(window).unbind("resize",this.onTableWinResize)},"_updateTable":function(e){if(this.tableBodyView&&this.tableBodyView.accFocusedCell){var t=this.tableBodyView.accFocusedCell.row,i=this.tableBodyView.accFocusedCell.column;e===this.collection?this.render():(this.tableBodyView.children.findByModel(e).render(),this.triggerMethod("dom:refresh")),this.tableBodyView.accFocusedCell.row=t,this.tableBodyView.accFocusedCell.column=i,this.tableBodyView.trigger("changed:focus",this.tableBodyView)}else this.render()},"onRender":function(){this.allColumns=this.getColumns(),this.displayedColumns=e.where(this.allColumns,{"columnWrapped":!1}),this.wrappedColumns=e.where(this.allColumns,{"columnWrapped":!0}),
this.tableHeaderView=new _({"columns":this.displayedColumns,"context":this.context,"admin_permissions":this.options.admin_permissions,"userPermissionsModel":this.collection.options.authenticatedUserPermissions,"hasPermissionAction":!!this.options.hasPermissionAction}),this.headerRegion.show(this.tableHeaderView),this.tableBodyView=new C(e.defaults({"columns":this.displayedColumns,"wrappedColumns":this.wrappedColumns,"context":this.context,"collection":this.collection,"toolbarItems":this.options.toolbarItems,"toolbarItemsMasks":this.options.toolbarItemsMasks,"emptyView":this.options.emptyView,"emptyViewModel":this.options.emptyViewModel},this.options)),this.bodyRegion.show(this.tableBodyView);var t=this;this.$el.find(".csui-table-list-body").bind("scroll",function(e){t.trigger("scroll",e)}),this._rebuildingTable=!1},"onBeforeRender":function(){this._rebuildingTable=!0},"onDomRefresh":function(e){this.$el.is(":visible")&&(this._adjustColumnsAfterWindowResize(),this.trigger("resizetable",e))},"getColumns":function(){var t=[];if(this.options.tableColumns){var i=this.options.tableColumns.deepClone(),s=[];i.each(function(e){var t=e,i=e.get("key");e.attributes.column_key=i,s.push(t)},this),t=e.map(s,function(t){var i=l.getCellView(t),s=t.get("column_key"),n=i.columnClassName;n||(n="csui-table-cell-"+s);var o=["permanentColumn","noTitleInHeader","title","align","widthFactor","isNaming","containsInlineActions"];e.each(o,function(e){i[e]&&t.set(e,i[e],{"silent":!0})});var r={"CellView":i,"name":s,"noTitleInHeader":t.get("noTitleInHeader"),"isToolbar":t.get("isToolbar"),"title":t.get("title")||t.get("name")||t.get("column_name"),"className":n},a=t.get("align");return a&&(window.csui&&window.csui.rtl&&("left"===a&&(a="right")||"right"===a&&(a="left")),r.className+=" csui-align-"+a),t.attributes&&(r.attributes=r.attributes||{},e.extend(r.attributes,t.attributes)),r})}if(this.options.maxColumnsDisplayed||this.maxColumnsDisplayed){var n=0;e.each(t,function(e){e.attributes&&!0===e.attributes.permanentColumn&&(n++,e.columnWrapped=!1)},this),this.maxColumnsDisplayed=this.calculateMaxColumnsDisplayed(t),e.each(t,function(e){e.attributes&&!0===e.attributes.permanentColumn||(n++,e.columnWrapped=n>this.maxColumnsDisplayed)},this)}return t},"_adjustColumns":function(){if(this.displayedColumns&&this.$el.is(":visible")){var i,s=this.$el.width()-5,n=0,o=0,r=this.$el.find(".csui-table-header-cell");i=this.collection.length>0?this.$el.find(".csui-table-body>div").first().find(".csui-table-cell"):r;var l,a={},c=[],u=this.displayedColumns,d=0,h=0,p=0,m=0;i.each(function(e){if(e<u.length){var i=t(this),s=u[e];if(s.CellView&&s.CellView.hasFixedWidth)o+=i.outerWidth(),n++;else{var r=s.attributes&&s.attributes.widthFactor||1;r&&1!==r?(a[e]=r,d+=r):s.CellView&&s.CellView.flexibleWidth?(p+=i.outerWidth(),m++):(c.push(e),d+=1),r>h&&(h=r,l=e)}}});var f=s-o-p-4*u.length,b=u.length-n-m,g=b>0?f/b:0,v=0,w=d/b;e.each(a,function(e,t){var i=e/w,s=g*i;v+s>f&&(s=f-v)<0&&(s=0),s=Math.floor(s),a[t]=s,v+=s});var y;c.length>0?(g=(f-v)/c.length/w,g=Math.floor(g),y=f-v-g*c.length):(g=0,y=f-v),y=Math.floor(y);var _={},C=this;i.each(function(e){if(e<u.length){var i=t(this),s=u[e],n=s.CellView&&s.CellView.hasFixedWidth,o={"width":i.outerWidth()+"px"};if(!n){var c;c=a[e]&&a[e]>0?a[e]:g,e===l&&y&&(c+=y);var d=c+"px";s.CellView.flexibleWidth?t(r[e]).css(o):(o={"min-width":d,"max-width":d},t(r[e]).css(o));C.$el.find(".csui-table-cell:nth-child("+(e+1)+")").css(o)}_[s.className]=o}}),this.cachedColumnWidths=_}},"calculateMaxColumnsDisplayed":function(t){if(t&&0!==t.length){var i,s,n=0,o=0;if(this.$el.length>0&&this.$el[0].children.length>0){var r=this.$el.width();e.each(t,function(e){e.attributes&&!0===e.attributes.permanentColumn&&(i=e.attributes.widthFactor,s=i?120*i:120,o+=s,n++)},this);for(var l=0;l<t.length;l++){var a,c=t[l];if(c.attributes&&!c.attributes.permanentColumn){if(i=c.attributes.widthFactor,a=120,s=i?a*i:a,(o+=s)>r)break;n++}}n>this.options.maxColumnsDisplayed&&(n=this.options.maxColumnsDisplayed),n<1&&(n=1)}else n=this.options.maxColumnsDisplayed;return n}},"_adjustColumnsAfterWindowResize":function(){if(this.allColumns.length){if(this.maxColumnsDisplayed&&this.$el.is(":visible")){var t=this.calculateMaxColumnsDisplayed(this.allColumns);if(t!==this.maxColumnsDisplayed&&(this.maxColumnsDisplayed=t,!this._rebuildingTable))return setTimeout(e.bind(this.render,this))}this._adjustColumns()}}});return e.extend(T.prototype,r),T}),csui.define("csui/controls/tabletoolbar/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/tabletoolbar/impl/nls/root/localized.strings",{"ToolbarItemFilter":"Filter","ToolbarItemOpen":"Open","ToolbarItemDownload":"Download","ToolbarItemBrowse":"Browse","ToolbarItemCopy":"Copy","ToolbarItemEmailLink":"Email link","ToolbarItemPaste":"Paste","ToolbarItemMove":"Move","ToolbarItemShare":"Share","ToolbarItemNavigate":"Visit","ToolbarItemViewProperties":"Properties","ToolbarItemVersionHistory":"Version history","ToolbarItemDelete":"Delete","ToolbarItemReserve":"Reserve","ToolbarItemUnreserve":"Unreserve","ToolbarItemEdit":"Edit","ToolbarItemRename":"Rename","ToolbarItemRenameFavorite":"Rename Favorite","ToolbarItemOpenSavedQuery":"Open","ToolbarItemExecuteSavedQuery":"Execute","ToolbarItemInfo":"Properties","ToolbarItemTimeline":"Timeline","ToolbarItemToggleTableLayout":"Toggle layout","ToolbarItemSettings":"Settings","ToolbarItemAddFolder":"Folder","ToolbarItemAddDocument":"Document","ToolbarItemAdd":"Add","ToolbarItemAddItem":"Add Item","ToolbarItemAddVersion":"Add version","ToolbarItemAddCategories":"Add Categories","ToolbarItemMore":"More actions","ToolbarItemPrint":"Print","ToolbarItemOriginalEdit":"Edit original","ToolbarItemOriginalShare":"Share original","ToolbarItemOriginalReserve":"Reserve original","ToolbarItemOriginalUnreserve":"Unreserve original","ToolbarItemOriginalCopy":"Copy original","ToolbarItemOriginalMove":"Move original","ToolbarItemOriginalDownload":"Download original","ToolbarItemOriginalDelete":"Delete original","ToolbarItemCopyLink":"Copy link","ToolbarItemOriginalCopyLink":"Copy link original","ToolbarItemPermissions":"View permissions","ToolbarItemDeletePermission":"Remove from list","ToolbarItemEditPermission":"Edit permissions","ToolbarItemApplyPermission":"Apply permissions to sub-items","ToolbarItemChangeOwnerPermission":"Change owner","ToolbarItemRemoveCollectionItems":"Remove from collection","ToolbarItemInformation":"Properties","ToolbarItemFilterAria":"Show filter panel ","ToolbarGoToLocation":"Go to location","MenuItemUploadFile":"Upload file","MenuItemAddNewFolder":"Add new Folder","MenuItemZipAndDownload":"Zip & Download","MenuItemCopy":"Copy","MenuItemMove":"Move","MenuItemEmailLink":"Email link","MenuItemShare":"Share","MenuItemReserve":"Reserve","MenuItemUnreserve":"Unreserve","MenuItemDelete":"Delete","MenuItemSendToDevice":"Send to device","MenuItemRename":"Rename","MenuItemTimeline":"Timeline","MenuItemInformation":"Properties","MenuItemCopyLink":"Copy link","ToolbarItemComment":"Comment","ToolbarItemShowDescription":"Show description","ToolbarItemConfiguration":"Configuration","ToolbarItemMaximizeWidgetView":"Maximize widget view","ToolbarItemRestoreWidgetViewSize":"Restore widget view size","AddUserOrGroups":"Add user or groups","AddOwnerOrGroup":"Add owner or owner group","RestorePublicAccess":"Restore public access","AddToolbarItemsTitle":"Add {0}","ToolbarItemThumbnail":"Grid view","ToolbarItemListView":"List view","ThumbnailTitle":"Grid view","ListViewTitle":"List view"}),csui.define("hbs!csui/controls/tabletoolbar/impl/tabletoolbar",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-tabletoolbar tile-nav" aria-label="Table menubar" role="menu">\r\n  <div class="csui-filterToolbar" ></div>\r\n  <div class="csui-addToolbar" role="menuitem"></div>\r\n  <div class="csui-leftToolbar" ></div>\r\n  <div class="csui-otherToolbar" ></div>\r\n  <div class="csui-toolbar-caption" ></div>\r\n  <div class="csui-rightToolbar" ></div>\r\n</div>\r\n'}});return i.registerPartial("csui_controls_tabletoolbar_impl_tabletoolbar",s),s}),csui.define("css!csui/controls/tabletoolbar/impl/tabletoolbar",[],function(){}),csui.define("csui/controls/tabletoolbar/tabletoolbar.view",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/models/nodes","csui/controls/toolbar/toolitem.model","csui/controls/toolbar/toolitems.filtered.model","csui/controls/toolbar/toolbar.view","csui/controls/item.title/item.title.view","csui/controls/toolbar/delayed.toolbar.view","csui/utils/commandhelper","csui/utils/commands/add","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/table/inlineforms/inlineform.factory","hbs!csui/controls/tabletoolbar/impl/tabletoolbar","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/mixins/global.alert/global.alert.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/toolbar/toolbar.state.behavior","csui/controls/toolbar/toolbar.command.controller","csui/utils/commands","csui-ext!csui/controls/tabletoolbar/tabletoolbar.view","csui/lib/jquery.when.all","css!csui/controls/tabletoolbar/impl/tabletoolbar"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b,g,v,w,y,_,C,T,x,S){"use strict";var I=o.LayoutView.extend({"template":v,"regions":{"filterToolbarRegion":".csui-filterToolbar","addToolbarRegion":".csui-addToolbar","leftToolbarRegion":".csui-leftToolbar","otherToolbarRegion":".csui-otherToolbar","toolbarCaptionRegion":".csui-toolbar-caption","rightToolbarRegion":".csui-rightToolbar"},"behaviors":{"TabableRegion":{"behaviorClass":_}},"toolbarItemSelector":"a."+_.accessibilityFocusableClass+",button."+_.accessibilityFocusableClass+",div."+_.accessibilityFocusableClass,"events":{"keydown":"onKeyInView"},"currentlyFocusedElement":function(){var e=this.$(this.toolbarItemSelector);return e.length?i(e[this.accNthToolbarItemFocused]):null},"constructor":function(e){e||(e={}),this.context=e.context,this.commandController=e.toolbarCommandController||new T({"commands":e.commands||x}),this.addableTypes=e.addableTypes,this.originatingView=e.originatingView||this,this.blockingParentView=e.blockingParentView,this.selectedNodes=new a,this.accNthToolbarItemFocused=0,this.toolbarNames=["filter","add","left","other","right"],o.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this,"before:regions:reinitialize",this.initialize)},"initialize":function(e){this.container=e.container||this.collection.node;var t={"context":this.context,"nodes":this.selectedNodes,"container":this.container,"collection":this.collection,"data":{"addableTypes":this.addableTypes}};s.each(this.toolbarNames,function(e){var i=e+"Toolbar",n=this.options.toolbarItems[i];if(n){var o=this.options.toolbarItemsMasks&&this.options.toolbarItemsMasks.toolbars[i],r="other"===e&&this.collection.delayedActions,l=new u(n,{"status":t,"commands":this.commandController.commands,"delayedActions":r,"mask":o}),a=r?p:d,c=new a(s.extend({"collection":l,"toolbarName":e,"toolbarCommandController":this.commandController,"toolbarItemsMask":o,"originatingView":this.originatingView,"blockingParentView":this.blockingParentView},n.options));this[e+"ToolbarView"]=c,c.closeDropdown&&c.listenTo(this,"changed:focus close:dropdown",c.closeDropdown),this.listenTo(c,"childview:toolitem:action",this._toolbarItemClicked).listenTo(c,"dom:refresh",function(){this.triggerMethod("refresh:tabindexes")}).listenTo(this.commandController,"after:execute:command",function(e){if(e&&e.cancelled){var t=this.$el.find("[data-csui-command="+e.commandSignature.toLowerCase()+"] a"),i=t.length?t.closest("ul.csui-more-dropdown-menu"):{};i.length?i.siblings("a.binf-dropdown-toggle").focus():t.focus()}}),r&&this.listenTo(this.selectedNodes,"reset",function(){c.actionState.set("showMessage",!!this.selectedNodes.length)})}},this),this.options.toolbarItems.addToolbar&&this.addableTypes&&(this._updateAddToolbar(),this.listenTo(this.addableTypes,"reset",this._updateAddToolbar,this)),this.options.headermenuItems&&this.options.headermenuItems.headerMenuToolbar&&this.container&&(this.captionView=new h({"model":this.container,"toolItems":this.options.headermenuItems.headerMenuToolbar,"toolItemsMask":this.options.headermenuItemsMask,"context":this.context,"commands":this.commandController.commands,"originatingView":this.originatingView}),this.captionView.listenTo(this,"changed:focus",this.captionView.closeMenu)),this.propagateEventsToRegions(),this.prepareForGlobalAlert();var i=this;S&&S.forEach(function(e){e(i)})},"_moveTo":function(e){e.preventDefault(),e.stopPropagation(),this.trigger("changed:focus",this),this.currentlyFocusedElement().focus()},"onKeyInView":function(e){var t;if(!i(e.target).is(":input")||i(e.target).hasClass(_.accessibilityFocusableClass))switch(e.keyCode){case 9:this.trigger("close:dropdown");break;case 37:t=this.$(this.toolbarItemSelector),this.accNthToolbarItemFocused>0&&this.accNthToolbarItemFocused--,this._moveTo(e);break;case 39:t=this.$(this.toolbarItemSelector),this.accNthToolbarItemFocused<t.length-1&&this.accNthToolbarItemFocused++,this._moveTo(e);break;case 35:i(e.target).closest("ul").hasClass("binf-dropdown-menu")||(t=this.$(this.toolbarItemSelector),this.accNthToolbarItemFocused=t.length-1,this._moveTo(e));break;case 36:i(e.target).closest("ul").hasClass("binf-dropdown-menu")||(this.accNthToolbarItemFocused=0,this._moveTo(e))}},"_updateAddToolbar":function(){var e=[];this.addableTypes.each(function(t){var i,n=t.get("type"),o=f.isAddableTypeWithoutInlineForm(n);if(o||(i=g.getInlineFormView(n)),o||i){var r=new c({"signature":"Add","name":t.get("type_name"),"title":s.str.sformat(b.AddToolbarItemsTitle,t.get("type_name")),"type":n,"group":"add","commandData":{"type":n,"addableTypes":this.addableTypes}});e.push(r)}},this);var t=[],n=this;this.triggerMethod("before:updateAddToolbar",{"context":this.context,"container":this.container,"addableTypes":this.addableTypes,"toolbarItems":e,"async":function(){var e=i.Deferred();return t.push(e),function(){e.resolve()}}}),i.whenAll.apply(i,t).always(function(){n.options.creationToolItemsMask&&(e=n.options.creationToolItemsMask.maskItems(e)),n.options.toolbarItems.addToolbar.reset(e)})},"_toolbarItemClicked":function(e,t){var i={"context":this.context,"nodes":this.selectedNodes,"container":this.container,"collection":this.collection,"originatingView":this.originatingView,"toolItemView":e};this.commandController.toolitemClicked(t.toolItem,i)},"updateForSelectedChildren":function(e){this.selectedNodes.reset(e)},"onRender":function(){this.options.height&&this.$el.height(this.options.height),s.each(this.toolbarNames,function(e){var t=this[e+"ToolbarView"];t&&(t.collection.refilter(),this[e+"ToolbarRegion"].show(t))},this),this.captionView&&this.toolbarCaptionRegion.show(this.captionView)}});return s.extend(I.prototype,w),s.extend(I.prototype,y),I}),csui.define("hbs!csui/controls/table.configuration.toolbar/impl/configuration.toolbar.dropdown",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="binf-dropdown">\r\n  <button id="'+this.escapeExpression((n=null!=(n=t.btnId||(null!=e?e.btnId:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"btnId","hash":{}}):n))+'" type="button" class="binf-dropdown-toggle csui-acc-focusable"\r\n          data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="false"\r\n          title="'+this.escapeExpression((n=null!=(n=t.configurationButtonTooltip||(null!=e?e.configurationButtonTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"configurationButtonTooltip","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.configurationButtonTooltip||(null!=e?e.configurationButtonTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"configurationButtonTooltip","hash":{}}):n))+'">\r\n    <span class="icon icon-toolbar-settings"></span>\r\n  </button>\r\n  <ul class="binf-dropdown-menu" role="menu"></ul>\r\n</div>\r\n'}});return i.registerPartial("csui_controls_table.configuration.toolbar_impl_configuration.toolbar.dropdown",s),s}),csui.define("csui/controls/table.configuration.toolbar/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table.configuration.toolbar/impl/nls/root/localized.strings",{"configurationButtonTooltip":"Settings"}),csui.define("css!csui/controls/table.configuration.toolbar/impl/configuration.toolbar.dropdown",[],function(){}),csui.define("csui/controls/table.configuration.toolbar/configuration.toolbar.dropdown.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/controls/toolbar/toolitem.view","csui/models/nodes","csui/controls/toolbar/toolitems.filtered.model","csui/utils/commands","csui/controls/toolbar/toolbar.command.controller","csui/behaviors/dropdown.menu/dropdown.menu.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","hbs!csui/controls/table.configuration.toolbar/impl/configuration.toolbar.dropdown","i18n!csui/controls/table.configuration.toolbar/impl/nls/localized.strings","css!csui/controls/table.configuration.toolbar/impl/configuration.toolbar.dropdown","csui/lib/binf/js/binf"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p){return s.CompositeView.extend({"className":"csui-configuration-view","template":h,"templateHelpers":function(){return{"btnId":t.uniqueId("configurationButton"),"configurationButtonTooltip":p.configurationButtonTooltip}},"childView":o,"childViewContainer":"ul.binf-dropdown-menu","childViewOptions":function(e){return{"renderTextOnly":!0,"role":"menuitem"}},"ui":{"dropdownDiv":".binf-dropdown","dropdownToggle":".binf-dropdown-toggle","dropdownMenu":".binf-dropdown-menu","loadingIconsDiv":".csui-loading-parent-wrapper"},"behaviors":{"DropdownMenuBehavior":{"behaviorClass":u},"PerfectScrolling":{"behaviorClass":d,"contentParent":".command-view-region"}},"constructor":function(e){e||(e={}),this.context=e.context,this.commands=e.commands||a,this.commandController=e.toolbarCommandController||new c({"commands":this.commands}),this.selectedNodes=e.status&&e.status.nodes||new r,this.container=e.container,this.status=e.status||{"context":this.context,"nodes":this.selectedNodes,"container":this.container},e.collection=new l(e.toolbarItems,{"status":this.status,"commands":this.commands,"mask":e.toolbarItemsMask}),s.CompositeView.prototype.constructor.apply(this,arguments),this.listenTo(this,"childview:toolitem:action",this._triggerMenuItemAction).listenTo(i,"closeToggleAction",this._closeToggle)},"enabled":function(){return!!this.options.context},"onRender":function(){this.collection.length<1?(this.$el.addClass("binf-hidden"),this.ui.dropdownToggle.attr("data-cstabindex","-1"),this.ui.dropdownToggle.removeClass("csui-acc-focusable")):(this.$el.find(".binf-dropdown").removeClass("binf-hidden"),this.$el.removeClass("binf-hidden"),this.ui.dropdownToggle.attr("data-cstabindex","0"),this.ui.dropdownToggle.addClass("csui-acc-focusable")),this.collection.length>0&&(this.ui.dropdownToggle.binf_dropdown(),this.ui.dropdownDiv.on("hide.binf.dropdown",t.bind(function(){this._showMenuItems()},this)))},"_closeToggle":function(){var e=this.$el.find(".binf-dropdown-toggle");e.parent().hasClass("binf-open")&&e.binf_dropdown("toggle",!1),this._showMenuItems()},"_triggerMenuItemAction":function(e,i){if(i&&i.toolItem&&!0===i.toolItem.get("menuWithMoreOptions"))this._toolitemClicked(e,i);else{this.$el.find(".binf-dropdown-toggle").binf_dropdown("toggle");var s=t.extend(this.status,{"originatingView":this.options.originatingView,"blockingParentView":this.options.blockingParentView,"configurationMenuView":this,"toolItemView":e});this.commandController.toolitemClicked(i.toolItem,s)}},"_toolitemClicked":function(e,i){var s=this,n=i.toolItem.get("signature"),o=this.commandController.commands.findWhere({"signature":n}),r=t.extend(this.status,{"originatingView":this.options.originatingView,"blockingParentView":this.options.blockingParentView,"configurationMenuView":this,"toolItemView":e}),l=t.extend({},r.data,i.toolItem.get("commandData"));r=t.defaults({"toolItem":i.toolItem,"data":l},r);var a={"status":r,"commandSignature":n,"command":o};this.commandController.trigger("before:execute:command",a);var c={"context":r.context};o.execute(r,c).done(function(e){e&&e.viewClass&&s._showCommandViewInDropdownMenu(e.viewClass,e.viewOptions||{}),s.commandController.trigger("after:execute:command",a)}).fail(function(e){void 0===e&&(e={"cancelled":!0,"commandSignature":n}),s.commandController.trigger("after:execute:command",e)})},"_showCommandViewInDropdownMenu":function(e,i){var s=new e(i);this.listenTo(s,"go:back",t.bind(function(){this._showMenuItemsWithAnimation()},this)),this.listenTo(s,"close:menu",t.bind(function(){this._showMenuItems(),this._closeToggle()},this)),this.listenTo(s,"dom:refresh",t.bind(function(){this.trigger("render"),this.trigger("update:scrollbar")},this)),this._ensureCommandViewRegion(),this.commandViewRegion.show(s),this._hideMenuItemsWithAnimation()},"_ensureCommandViewRegion":function(){if(!this.commandViewRegion){this.ui.dropdownMenu.append('<div class="command-view-region"></div>');var e=this.ui.dropdownMenu.find(".command-view-region");this.commandViewRegion=new s.Region({"el":e}),e.on("click",function(e){e.preventDefault(),e.stopPropagation()}),this.commandViewRegion.$el.hide()}},"_emptyCommandViewRegion":function(){this.commandViewRegion&&this.commandViewRegion.empty()},"_showMenuItems":function(){this.ui.dropdownMenu.find("> li").show(),this._emptyCommandViewRegion(),this.commandViewRegion&&this.commandViewRegion.$el.hide()},"_showMenuItemsWithAnimation":function(){var e=this,t=this.ui.dropdownMenu.find(".csui-icon-rightArrow");t.addClass("binf-hidden"),e.ui.dropdownMenu.css("overflow","hidden"),e.ui.dropdownMenu.animate({"width":e.dropdownMenuOriginalWidth,"height":e.dropdownMenuOriginalHeight},500),e.commandViewRegion.$el.css({"position":"absolute","top":e.ui.dropdownMenu.css("padding-top"),"background-color":e.ui.dropdownMenu.css("background-color"),"opacity":1}),e.ui.dropdownMenu.find("> li").show(),e.commandViewRegion.$el.hide("blind",{"direction":"right","complete":function(){e._emptyCommandViewRegion(),t.removeClass("binf-hidden"),e.commandViewRegion.$el.css({"position":"","top":"","background-color":"","opacity":""}),e.ui.dropdownMenu.css({"overflow":"","width":"","height":""})}},500)},"_hideMenuItemsWithAnimation":function(){var e=this,t=this.ui.dropdownMenu.find(".csui-icon-rightArrow");t.addClass("binf-hidden"),e.dropdownMenuOriginalWidth=e.ui.dropdownMenu.css("width"),e.dropdownMenuOriginalHeight=e.ui.dropdownMenu.css("height"),e.ui.dropdownMenu.css("overflow","hidden"),e.ui.dropdownMenu.animate({"width":e.commandViewRegion.$el.width(),"height":e.commandViewRegion.$el.height()},500),e.commandViewRegion.$el.css({"position":"absolute","top":e.ui.dropdownMenu.css("padding-top"),"background-color":e.ui.dropdownMenu.css("background-color"),"opacity":1}),e.commandViewRegion.$el.show("blind",{"direction":"right","complete":function(){e.ui.dropdownMenu.find("> li").hide(),t.removeClass("binf-hidden"),e.commandViewRegion.$el.css({"position":"","top":"","background-color":"","opacity":""}),e.ui.dropdownMenu.css({"width":"","height":""})}},500)}})}),csui.define("csui/controls/table/inlineforms/favorite/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/inlineforms/favorite/impl/nls/root/lang",{"CancelButtonLabel":"Cancel","NewNamePlaceholder":"Enter name"}),csui.define("hbs!csui/controls/table/inlineforms/favorite/impl/favorite",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'    <button type="button" class="csui-btn-edit-cancel binf-btn"><span class="icon edit-cancel"\r\n                                                                 title="'+this.escapeExpression((n=null!=(n=t.EditCancelTooltip||(null!=e?e.EditCancelTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"EditCancelTooltip","hash":{}}):n))+'"></span>\r\n    </button>\r\n'},"3":function(e,t,i,s){var n;return'    <button type="button" class="csui-btn-metadata binf-btn"><span\r\n        class="icon icon-toolbar-metadata"></span></button>\r\n    <button type="button"\r\n            class="csui-btn-save csui-btn binf-btn" disabled>'+this.escapeExpression((n=null!=(n=t.SaveButtonLabel||(null!=e?e.SaveButtonLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"SaveButtonLabel","hash":{}}):n))+'</button>\r\n    <button type="button" class="csui-btn-cancel csui-btn binf-btn">'+this.escapeExpression((n=null!=(n=t.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"CancelButtonLabel","hash":{}}):n))+"</button>\r\n"},"5":function(e,t,i,s){var n;return'  <div class="csui-inlineform-group csui-inlineform-group-error" role="alert">\r\n    <div class="binf-text-danger">'+this.escapeExpression((n=null!=(n=t.errorMessage||(null!=e?e.errorMessage:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"errorMessage","hash":{}}):n))+"</div>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<form class="csui-inlineform-group csui-inlineform-group-favorite-name">\r\n  <input type="text" value="'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=t.namePlaceholder||(null!=e?e.namePlaceholder:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"namePlaceholder","hash":{}}):o))+'"\r\n         class="binf-form-control csui-inlineform-input-name">\r\n'+(null!=(n=t.if.call(e,null!=e?e.formModeIsEdit:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+"</form>\r\n"+(null!=(n=t.if.call(e,null!=e?e.haveErrorMessage:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("csui_controls_table_inlineforms_favorite_impl_favorite",s),s}),csui.define("css!csui/controls/table/inlineforms/favorite/impl/favorite",[],function(){}),csui.define("csui/controls/table/inlineforms/favorite/favorite.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!csui/controls/table/inlineforms/favorite/impl/nls/lang","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/inlineform/impl/inlineform.view","hbs!csui/controls/table/inlineforms/favorite/impl/favorite","css!csui/controls/table/inlineforms/favorite/impl/favorite"],function(e,t,i,s,n,o,r){return o.extend({"className":function(){var e="csui-inlineform-favorite";return o.prototype.className&&(e+=" "+t.result(o.prototype,"className")),e},"template":r,"templateHelpers":function(){var e=this._templateHelpers(),i=!this.model.get("favorite_name");return t.extend(e,{"name":this.model.get("favorite_name"),"namePlaceholder":s.NewNamePlaceholder,"disableSavebtn":i})},"ui":{},"constructor":function e(i){this.options=i||{},this.ui=t.extend({},this.ui,o.prototype.ui),this.events=t.extend({},this.events,o.prototype.events),e.__super__.constructor.apply(this,arguments)},"_saveIfOk":function(){var e=this._getInputName(),t=this.model.get("favorite_name");e.length>0&&e===t?this.cancel():e.length>0&&this._save({"favorite_name":e})}},{"CSSubType":void 0})}),csui.define("csui/controls/table/inlineforms/permissions/user.picker/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/inlineforms/permissions/user.picker/impl/nls/root/lang",{"CancelButtonLabel":"Cancel","SaveButtonLabel":"Save","UserPickerPlaceHolder":"Enter name","InvalidUser":"Invalid user"}),csui.define("hbs!csui/controls/table/inlineforms/permissions/user.picker/impl/user.picker",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div id="csui-inline-permissions-user-picker" class="csui-inline-permissions-user-picker"></div>\r\n<div class="csui-user-picker-buttons csui-inlineform-group">\r\n  <button class="binf-btn csui-btn binf-btn-primary cs-save-button" tabindex="-1" disabled>'+this.escapeExpression(this.lambda(null!=e?e.SaveButtonLabel:e,e))+'</button>\r\n  <button class="binf-btn csui-btn binf-btn-default cs-cancel-button" tabindex="-1">'+this.escapeExpression(this.lambda(null!=e?e.CancelButtonLabel:e,e))+'</button>\r\n</div>\r\n<div class="csui-change-user-error"></div>'}});return i.registerPartial("csui_controls_table_inlineforms_permissions_user.picker_impl_user.picker",s),s}),csui.define("css!csui/controls/table/inlineforms/permissions/user.picker/impl/user.picker",[],function(){}),csui.define("csui/controls/table/inlineforms/permissions/user.picker/user.picker.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","i18n!csui/controls/table/inlineforms/permissions/user.picker/impl/nls/lang","hbs!csui/controls/table/inlineforms/permissions/user.picker/impl/user.picker","css!csui/controls/table/inlineforms/permissions/user.picker/impl/user.picker"],function(e,t,i,s,n,o){return i.ItemView.extend({"className":"cs-inline-user-lookup","template":o,"behaviors":{"TabableRegion":{"behaviorClass":s,"initialActivationWeight":100}},"ui":{"cancelButton":".cs-cancel-button","saveButton":".cs-save-button","inputBox":".cs-search"},"events":{"click @ui.saveButton":"saveClicked","click @ui.cancelButton":"cancelClicked","focus @ui.inputBox":"inputBoxFocus","click":"handleClick"},"handleClick":function(e){e.preventDefault(),e.stopPropagation()},"templateHelpers":function(){return{"SaveButtonLabel":n.SaveButtonLabel,"CancelButtonLabel":n.CancelButtonLabel}},"initialize":function(e){this.options=e},"constructor":function(e){e||(e={}),e.data||(e.data={}),this.options=e,i.ItemView.prototype.constructor.call(this,e)},"inputBoxFocus":function(){this.focusIndex=0},"onShow":function(){var e=this;this.focusIndex=0,csui.require(["csui/controls/userpicker/userpicker.view"],function(s){e.pickerView=new s({"context":e.options.context,"limit":5,"memberFilter":e.options.memberFilter,"widgetoptions":e.options,"placeholder":n.UserPickerPlaceHolder,"prettyScrolling":!0,"scrollContainerHeight":"auto","model":e.options.userPickerModel,"id_input":t.uniqueId("csui-inline-permissions-user-picker-input"),"lightWeight":!1}),new i.Region({"el":e.$el.find("#csui-inline-permissions-user-picker")}).show(e.pickerView),e.pickerView.$el.find("input")&&e.pickerView.$el.find("input").focus(),e.listenTo(e.pickerView,"item:change",e.processItemChange),e.listenTo(e.pickerView,"item:clear",e.processItemChange),e.$el.bind("keydown",t.bind(e.onKeyInView,e)),e.$el.find("input").focus().attr("tabindex","-1")})},"processItemChange":function(){var e=arguments.length>0&&arguments[0].item;this.param=e,e?this.options.currentRow.find(".cs-save-button").removeAttr("disabled"):(this.options.currentRow.find(".cs-save-button").attr("disabled",!0),this.$el.find("input").focus())},"currentlyFocusedElement":function(){return this.$el.find("input")},"cancelClicked":function(e){e.preventDefault(),e.stopPropagation(),this.options.currentRow.removeClass("csui-changeowner-permission"),this.options.currentRow.find(".member-info").removeClass("binf-hidden"),this.trigger("change:completed")},"saveClicked":function(e){e.preventDefault(),e.stopPropagation(),
this.$(".cs-search").val()===this.param.get("name_formatted")?this.trigger("member:selected:save",this.param):this.$(".csui-change-user-error").addClass("csui-change-user-error-display").html(n.InvalidUser)},"onKeyInView":function(e){var t=this,i=this.$el.find("[tabindex]").filter(function(e,i){return t.$(i).is(":visible")&&!t.$(i).is(":disabled")});i.length,i[this.focusIndex];switch(this.$(e.target).hasClass("cs-search")&&(this.focusIndex=0),e.keyCode){case 37:this.focusIndex>0&&(this.focusIndex--,i[this.focusIndex].focus(),e.preventDefault()),e.stopPropagation();break;case 9:e.shiftKey?(this.focusIndex--,this.focusIndex>=0&&this.focusIndex<=i.length-1&&i[this.focusIndex].focus(),e.preventDefault(),e.stopPropagation()):(this.focusIndex++,this.focusIndex<=i.length-1&&this.focusIndex>=0&&i[this.focusIndex].focus(),e.preventDefault(),e.stopPropagation());break;case 39:e.stopPropagation();break;case 38:case 40:e.preventDefault(),e.stopPropagation();break;case 32:e.stopPropagation();break;case 13:this.$(e.target).trigger("click"),e.preventDefault(),e.stopPropagation();break;default:e.stopPropagation()}}})}),csui.define("csui/controls/table/cells/celleditor/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/celleditor/impl/nls/root/lang",{"NewNamePlaceholder":"Enter name"}),csui.define("hbs!csui/controls/table/cells/celleditor/impl/celleditor",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'    <span class="csui-undo edit-cancel inline-edit-icon"></span>\r\n'},"3":function(e,t,i,s){var n;return'    <button class="csui-undo csui-btn-cancel binf-btn">'+this.escapeExpression((n=null!=(n=t.CancelButtonLabel||(null!=e?e.CancelButtonLabel:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"CancelButtonLabel","hash":{}}):n))+"</button>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="csui-td-content-edit">\r\n  <input type="text" value="'+this.escapeExpression((o=null!=(o=t.formattedValue||(null!=e?e.formattedValue:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"formattedValue","hash":{}}):o))+'" placeholder="'+this.escapeExpression((o=null!=(o=t.inputPlaceholder||(null!=e?e.inputPlaceholder:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"inputPlaceholder","hash":{}}):o))+'" class="binf-form-control">\r\n'+(null!=(n=t.if.call(e,null!=e?e.useEditCancelIcon:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+"</div>\r\n"}});return i.registerPartial("csui_controls_table_cells_celleditor_impl_celleditor",s),s}),csui.define("css!csui/controls/table/cells/celleditor/impl/celleditor",[],function(){}),csui.define("csui/controls/table/cells/celleditor/celleditor.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/controls/table/cells/templated/templated.view","i18n!csui/controls/table/cells/celleditor/impl/nls/lang","hbs!csui/controls/table/cells/celleditor/impl/celleditor","css!csui/controls/table/cells/celleditor/impl/celleditor"],function(e,t,i,s,n,o,r,l){return o.extend({"template":l,"ui":{"editCancel":".csui-td-content-edit .csui-undo","cancelButton":".csui-td-content-edit .csui-btn-cancel","inputField":".csui-td-content-edit > input"},"events":{"click @ui.editCancel":"iconUndoClicked","keyup @ui.inputField":"keyReleased","blur @ui.inputField":"leftInputField","click @ui.inputField":"inputFieldClicked"},"onRender":function(){this.ui.inputField.addClass("csui-input-full"),this.ui.inputField.select()},"endEdit":function(){this.editStarted=!1,this.saving=!1,delete this.model.csuiValueEdited;var t=this.$el.find(".csui-td-content-edit");t.length>0&&e(t[0]).remove(),this.model.unset("csuiErrorMessage"),this.trigger("closed",this)},"_cancelEdit":function(){this.leftInputFieldTimer&&clearTimeout(this.leftInputFieldTimer),this.trigger("cancelEdit",this),this.endEdit()},"_save":function(){if(this.editStarted){var e=this.ui.inputField,t=e.val();t=t.trim(),t.length>0?(this.saving=!0,this.trigger("cellEditorWantsSave",{"newName":t})):this._cancelEdit()}},"inputFieldClicked":function(e){e.preventDefault(),e.stopPropagation()},"iconUndoClicked":function(e){e.preventDefault(),e.stopPropagation(),this._cancelEdit()},"keyReleased":function(e){e.preventDefault(),e.stopPropagation(),this.leftInputFieldTimer&&clearTimeout(this.leftInputFieldTimer),27===e.keyCode?this._cancelEdit():13===e.keyCode&&this._save()},"leftInputField":function(e){if(!this.saving){var t=this;this.leftInputFieldTimer&&clearTimeout(this.leftInputFieldTimer),this.leftInputFieldTimer=setTimeout(function(){t.leftInputFieldTimer=void 0,t._save()},100)}},"renderValue":function(){var t;t=this.model.csuiValueEdited?{"value":this.model.csuiValueEdited,"formattedValue":this.model.csuiValueEdited}:this.getValueData(),t.useEditCancelIcon=void 0!==this.model.get("id"),t.CancelButtonLabel=r.CancelButtonLabel,t.inputPlaceholder=r.NewNamePlaceholder;var i=void 0!==this.model.get("csuiErrorMessage"),s=t?this.template(t):"",n=this.$el.find(".csui-td-content-edit");if(n.length>0)i&&e(n[0]).addClass("binf-has-error"),e(n[0]).replaceWith(s);else{var o=e(s);i&&o.addClass("binf-has-error"),o.appendTo(this.$el.find(".csui-td-container"))}this.editStarted=!0,this.saving=!1}})}),csui.define("hbs!csui/controls/table/cells/reservation/impl/reservation",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=e?e.canRevokeShare:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.isReservedByOther:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.canRevokeShare:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?n:"")},"2":function(e,t,i,s){var n;return'    <button type="button" aria-label="'+this.escapeExpression((n=null!=(n=t.reservedAria||(null!=e?e.reservedAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"reservedAria","hash":{}}):n))+'" class="csui-unreserve-cellview">\r\n'},"4":function(e,t,i,s){var n;return'      <span title="'+this.escapeExpression((n=null!=(n=t.reservedTooltip||(null!=e?e.reservedTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"reservedTooltip","hash":{}}):n))+'" class="icon icon-shared_collaborate_other"></span>\r\n'},"6":function(e,t,i,s){var n;return'      <span title="'+this.escapeExpression((n=null!=(n=t.reservedTooltip||(null!=e?e.reservedTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"reservedTooltip","hash":{}}):n))+'" class="icon icon-shared_collaborate_self"></span>\r\n'},"8":function(e,t,i,s){return"    </button>\r\n"},"10":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.reserved:e,{"name":"if","hash":{},"fn":this.program(11,s,0),"inverse":this.noop}))?n:""},"11":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=e?e.canUnreserve:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.isReservedByOther:e,{"name":"if","hash":{},"fn":this.program(12,s,0),"inverse":this.program(14,s,0)}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.canUnreserve:e,{"name":"if","hash":{},"fn":this.program(8,s,0),"inverse":this.noop}))?n:"")},"12":function(e,t,i,s){var n;return'      <span title="'+this.escapeExpression((n=null!=(n=t.reservedTooltip||(null!=e?e.reservedTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"reservedTooltip","hash":{}}):n))+'" class="icon icon-reserved_other"></span>\r\n'},"14":function(e,t,i,s){var n;return'      <span title="'+this.escapeExpression((n=null!=(n=t.reservedTooltip||(null!=e?e.reservedTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"reservedTooltip","hash":{}}):n))+'" class="icon icon-reserved_self"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.reservedSharedCollaboration:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(10,s,0)}))?n:""}});return i.registerPartial("csui_controls_table_cells_reservation_impl_reservation",s),s}),csui.define("csui/controls/table/cells/reservation/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/cells/reservation/impl/nls/root/lang",{"reservedTooltipPrefix":"Reserved by {0}\r\n{1}","reservedAria":"Reserved by {0} at {1}, click to unreserve","reservedSharedCollaborationTooltipPrefix":"Shared for collaboration by {0}\r\n{1}","reservedSharedCollaborationAria":"Shared for collaboration by {0} at {1}"}),csui.define("css!csui/controls/table/cells/reservation/impl/reservation",[],function(){}),csui.define("csui/controls/table/cells/reservation/reservation.view",["csui/lib/jquery","csui/lib/underscore","csui/utils/base","csui/utils/log","csui/utils/contexts/factories/user","csui/models/nodes","csui/models/nodechildren","csui/controls/table/cells/templated/templated.view","csui/utils/commands","csui/utils/commands/unreserve","csui/utils/commandhelper","csui/controls/table/cells/cell.registry","hbs!csui/controls/table/cells/reservation/impl/reservation","i18n!csui/controls/table/cells/reservation/impl/nls/lang","css!csui/controls/table/cells/reservation/impl/reservation"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p){"use strict";return l.extend({"template":h,"triggers":{"click .csui-unreserve-cellview":"remove:reservation"},"events":{"keydown":"onKeyInView"},"getValueData":function(){var e=this.model.get("reserved_user_id");e&&"object"==typeof e&&(e=e.id);var s,n=this.model.get("reserved")&&e,o=this.model.get("reserved_shared_collaboration"),r=!1;if(n){var l=this.model.get("reserved_user_id_expand")||this.model.get("reserved_user_id");s=i.formatMemberName(l),r=this.userId!==e}var a,c,u=i.formatExactDate(this.model.get("reserved_date"));i.formatMemberName(s);return o?(a=p.reservedSharedCollaborationTooltipPrefix,c=p.reservedSharedCollaborationAria):n&&(a=p.reservedTooltipPrefix,c=p.reservedAria),a&&(a=t.str.sformat(a,s,u),c=t.str.sformat(c,s,u)),{"reservedTooltip":a,"reservedAria":c,"canUnreserve":this.canUnreserve,"reserved":n,"isReservedByOther":r,"canRevokeShare":this.canRevokeShare,"reservedSharedCollaboration":o}},"initialize":function(){var e=this.options.context.getModel(n);this.userId=e.get("id"),this.unreserveCommand=new c,this.revokeShareCommand=a.get("RevokeShare"),this.commandStatus={"nodes":new o([this.model]),"context":this.options.context},this._checkEnabledAction();var t=this.model.collection.delayedActions;t&&this.listenTo(t,"sync",this._checkEnabledAction)},"_checkEnabledAction":function(){this.canUnreserve=this.unreserveCommand.enabled(this.commandStatus),this.canRevokeShare=!1,this.revokeShareCommand&&(this.canRevokeShare=this.revokeShareCommand.enabled(this.commandStatus)),this.isDestroyed||this.render()},"onRemoveReservation":function(e){var t;this.canUnreserve?(t=this.unreserveCommand.execute(this.commandStatus),u.handleExecutionResults(t,{"command":this.unreserveCommand,"suppressSuccessMessage":this.commandStatus.suppressSuccessMessage,"suppressFailMessage":this.commandStatus.suppressFailMessage})):this.canRevokeShare&&(t=this.revokeShareCommand.execute(this.commandStatus),u.handleExecutionResults(t,{"command":this.revokeShareCommand,"suppressSuccessMessage":this.commandStatus.suppressSuccessMessage,"suppressFailMessage":this.commandStatus.suppressFailMessage}))},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||this.onRemoveReservation()}},{"hasFixedWidth":!0,"columnClassName":"csui-table-cell-reservation","getModelExpand":function(e){return{"properties":["reserved_user_id"]}}})}),csui.define("csui/controls/table/cells/node.state/impl/node.state.icons",["csui/controls/table/cells/node.state/impl/reservation/reservation.view"],function(e){"use strict";return[{"sequence":50,"iconView":e}]}),csui.define("hbs!csui/controls/table/rows/description/impl/description",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <span class="description '+this.escapeExpression((n=null!=(n=t.truncate_fade_class||(null!=e?e.truncate_fade_class:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"truncate_fade_class","hash":{}}):n))+'"\r\n        title="'+this.escapeExpression((n=null!=(n=t.complete_description||(null!=e?e.complete_description:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"complete_description","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.current_description||(null!=e?e.current_description:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"current_description","hash":{}}):n))+"</span>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return(null!=(n=t.if.call(e,null!=e?e.current_description:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'<div class="description-caret-div">\r\n  <span class="description-readmore icon-expandArrowDown" role="button" aria-expanded="false" title="'+this.escapeExpression((o=null!=(o=t.showmore_tooltip||(null!=e?e.showmore_tooltip:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"showmore_tooltip","hash":{}}):o))+'"\r\n        aria-label="'+this.escapeExpression((o=null!=(o=t.showmore_aria||(null!=e?e.showmore_aria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"showmore_aria","hash":{}}):o))+'" tabindex="0"></span>\r\n  <span class="description-showless icon-expandArrowUp" role="button" aria-expanded="true" title="'+this.escapeExpression((o=null!=(o=t.showless_tooltip||(null!=e?e.showless_tooltip:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"showless_tooltip","hash":{}}):o))+'"\r\n        aria-label="'+this.escapeExpression((o=null!=(o=t.showless_aria||(null!=e?e.showless_aria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"showless_aria","hash":{}}):o))+'" tabindex="0"></span>\r\n</div>\r\n'}});return i.registerPartial("csui_controls_table_rows_description_impl_description",s),s}),csui.define("csui/controls/table/rows/description/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/table/rows/description/impl/nls/root/lang",{"showmore":"Show more","showmoreAria":"Show more description","showless":"Show less","showlessAria":"Show less description"}),csui.define("css!csui/controls/table/rows/description/impl/description",[],function(){}),csui.define("csui/controls/table/rows/description/description.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","hbs!csui/controls/table/rows/description/impl/description","i18n!csui/controls/table/rows/description/impl/nls/lang","css!csui/controls/table/rows/description/impl/description"],function(e,t,i,s,n,o){return i.ItemView.extend({"className":function(){return this._collapsedHeightIsOneLine?"cs-description csui-description-short-lines-1":"cs-description"},"template":n,"templateHelpers":function(){var e=this.model.get("instructions")||this.model.get("description")||"";return{"complete_description":e,"current_description":e,"more_description":this.has_more_desc&&!this.hideShowLess,"showmore_tooltip":o.showmore,"showmore_aria":o.showmoreAria,"showless_tooltip":o.showless,"showless_aria":o.showlessAria}},"ui":{"description":".description","readMore":".description-readmore","showLess":".description-showless"},"events":{"keydown @ui.readMore":"readMoreClicked","keydown @ui.showLess":"showLessClicked","click @ui.readMore":"readMoreClicked","click @ui.showLess":"showLessClicked"},"constructor":function(e){this._preinitializeFlags(e),i.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this,"dom:refresh",this._truncateIfNecessary).listenTo(this.options.tableView,"dom:refresh",this.triggerMethod.bind(this,"dom:refresh"))},"currentlyFocusedElement":function(){return this.has_more_desc?this.shortDescMode?this.ui.readMore:this.ui.showLess:t()},"_preinitializeFlags":function(e){this.shortDescMode=!0,this.hideShowLess=!1,this.has_more_desc=!1,this._collapsedHeightIsOneLine=e&&e.collapsedHeightIsOneLine},"_updateDescriptionAndCaret":function(){this._enableCaretState(),this.shortDescMode&&this.has_more_desc?this.$el.addClass("csui-description-collapsed"):this.$el.removeClass("csui-description-collapsed")},"_truncateIfNecessary":function(){var e=this.ui.description.height();if(e){var t=parseFloat(this.ui.description.css("line-height"));this._collapsedHeightIsOneLine||(t*=2),e>t&&(this.has_more_desc=!0),this._updateDescriptionAndCaret()}},"readMoreClicked":function(e){!e||13!==e.keyCode&&32!==e.keyCode&&"click"!==e.type||(e.preventDefault(),e.stopPropagation(),this.shortDescMode=!1,this._updateDescriptionAndCaret(),this.options.tableView&&this.options.tableView.trigger("update:scrollbar"),this.ui.showLess.focus())},"showLessClicked":function(e){!e||13!==e.keyCode&&32!==e.keyCode&&"click"!==e.type||(e.preventDefault(),e.stopPropagation(),this.shortDescMode=!0,this._updateDescriptionAndCaret(),this.options.tableView&&this.options.tableView.trigger("update:scrollbar"),this.ui.readMore.focus())},"_enableCaretState":function(){this.has_more_desc?(this.ui.readMore.toggleClass("caret-hide",!this.shortDescMode),this.ui.showLess.toggleClass("caret-hide",!!this.shortDescMode)):(this.ui.readMore.addClass("caret-hide"),this.ui.showLess.addClass("caret-hide"))}})}),csui.define("hbs!csui/controls/thumbnail/impl/metadata/thumbnail.metadata",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <span class="csui-thumbnail-metadata-label" title="'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'</span>\r\n  <span class="csui-thumbnail-metadata-spacer"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return(null!=(n=t.if.call(e,null!=e?e.displayHeader:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'<span class="csui-thumbnail-metadata-val">'+this.escapeExpression((o=null!=(o=t.value||(null!=e?e.value:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+"</span>"}});return i.registerPartial("csui_controls_thumbnail_impl_metadata_thumbnail.metadata",s),s}),csui.define("csui/controls/thumbnail/impl/metadata/thumbnail.metadata.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","hbs!csui/controls/thumbnail/impl/metadata/thumbnail.metadata"],function(e,t,i,s,n,o){"use strict";var r=s.ItemView.extend({"className":"csui-thumbnail-item-details binf-col-lg-12","template":o,"templateHelpers":function(){this.$el.attr("role","listitem");var e=this.getValueData();return{"displayHeader":this.model.get("noTitleHeader"),"label":this.model.get("key"),"value":e}},"getValueData":function(){var e=this.options.thumbnailItemModel,t=this.model.get("key"),i=this.model.get("column_type"),s=e.get(t);return"date"===i&&(s=n.formatExactDateTime(s)),s}});return s.CollectionView.extend({"className":"csui-thumbnail-metadata","childView":r,"childViewOptions":function(){return{"rowId":this.options.rowId,"thumbnailItemModel":this.model}},"filter":function(e,t,i){return"size"===e.get("key")?this.model.get(e.get("key"))&&""!==this.model.get(e.get("key")+"_formatted"):this.model.get(e.get("key"))&&""!==this.model.get(e.get("key"))},"onRender":function(){this.collection;this.bindUIElements()}})}),csui.define("csui/controls/thumbnail/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/impl/nls/root/lang",{"addTitle":"Add","searchIconTooltip":"Search by {0}","selectAll":"Select all","selectAllTitle":"Select all items","noResults":"No results found","dragAndDropMessage":"Drag and drop files here to add new content","items":"Items","formatForNone":"{0} items","formatForOne":"{0} item","formatForTwo":"{0} items","formatForFive":"{0} items","asc_name":"Name (A-Z)","desc_name":"Name (Z-A)","asc_modify_date":"Modified (new-old)","desc_modify_date":"Modified (old-new)","asc_size":"Size (small-large)","desc_size":"Size (large-small)","name":"Name","modified":"Modified","size":"Size","selectItem":"Select {0}","selectItemAria":"Select {0}. When selected an action bar of options can be reached per shift-tab"}),csui.define("hbs!csui/controls/thumbnail/impl/sort/impl/sort.menu",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'      <li role="presentation"><a role="menuitem" href="#" class="csui-sort-option"\r\n                                 data-binf-toggle="tab">                                \r\n'+(null!=(n=t.if.call(e,null!=e?e.selected:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(4,s,0)}))?n:"")+'        <span class="cs-label" title="'+this.escapeExpression(this.lambda(null!=e?e.value:e,e))+'" id="'+this.escapeExpression(this.lambda(null!=e?e.key:e,e))+'">'+this.escapeExpression(this.lambda(null!=e?e.value:e,e))+" </span></a></li>\r\n"},"2":function(e,t,i,s){return'          <span class="cs-icon icon-listview-checkmark"></span>\r\n'},"4":function(e,t,i,s){return'          <span class="cs-icon "></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="csui-search-sort-options">\r\n  <button id="'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" type="button" class="binf-btn binf-btn-default binf-dropdown-toggle"\r\n          data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\r\n    <span class="cs-label">'+this.escapeExpression((o=null!=(o=t.selectedValue||(null!=e?e.selectedValue:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"selectedValue","hash":{}}):o))+'</span>\r\n    <span class="csui-button-icon icon-caret-down"></span>\r\n  </button>\r\n  <span id="search-sort-btn" class="csui-sort-arrow  '+this.escapeExpression((o=null!=(o=t.selectedArrow||(null!=e?e.selectedArrow:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"selectedArrow","hash":{}}):o))+'"></span>\r\n  <ul class="binf-dropdown-menu" role="menu">\r\n'+(null!=(n=t.each.call(e,null!=e?e.sortListArray:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"  </ul>\r\n</div>"}});return i.registerPartial("csui_controls_thumbnail_impl_sort_impl_sort.menu",s),s}),csui.define("csui/controls/thumbnail/impl/sort/sort.view",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","i18n!csui/controls/thumbnail/impl/nls/lang","hbs!csui/controls/thumbnail/impl/sort/impl/sort.menu","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/lib/binf/js/binf"],function(e,t,i,s,n,o,r,l,a,c,u){return o.ItemView.extend({"className":"cs-sort-links","template":a,"constants":{"NAME_ASC":"asc_name","NAME_DESC":"desc_name","MODIFIED_ASC":"asc_modify_date","MODIFIED_DESC":"desc_modify_date","SIZE_ASC":"asc_size","SIZE_DESC":"desc_size"},"templateHelpers":function(){var e=this,t=[];s.each(this.constants,function(e,i){t.push({"key":e,"value":l[e],"selected":!1})});s.any(t,function(t){return t.value===e.actualValue?t.selected=!0:t.selected=!1},e);return{"id":s.uniqueId("sortButton"),"selectedValue":e.selectedValue,"selectedArrow":e.selectedArrow,"sortListArray":t}},"ui":{"sortOrderBtn":"#search-sort-btn"},"events":{"click .binf-dropdown-menu > li > a":"onSortOptionClick"},"constructor":function(e){o.ItemView.prototype.constructor.call(this,e);var t=e.collection.sorting.sort[0].value,i=t||this.constants.NAME_ASC,s=this.OverlapDisplayText(i);this.selectedValue=s,this.actualValue=l[t]||l[this.constants.NAME_ASC],this.selectedArrow=this.options.collection.orderstate||"icon-sortArrowDown",this.config=this.options.config||{}},"onSortOptionClick":function(e){e.preventDefault(),e.stopPropagation(),this.$el.find(".csui-search-sort-options li>a").removeClass("binf-active"),this.$el.find(".csui-search-sort-options li>a>span").removeClass("icon-listview-checkmark"),this.$(e.currentTarget).addClass("binf-active"),this.resetSelection(e.currentTarget.children[1].id)},"resetSelection":function(e){switch(e){case this.constants.NAME_ASC:this.collection.setOrder("name asc"),this.selectedValue=l[e],this.actualValue=l.name,this.selectedArrow="icon-sortArrowDown",this.options.collection.state=this.constants.NAME_ASC,this.options.collection.sorting.sort[0].value=this.constants.NAME_ASC,this.options.collection.orderstate=this.selectedArrow;break;case this.constants.NAME_DESC:this.collection.setOrder("name desc"),this.selectedValue=l[e],this.actualValue=l.name,this.selectedArrow="icon-sortArrowUp",this.options.collection.state=this.constants.NAME_DESC,this.options.collection.sorting.sort[0].value=this.constants.NAME_DESC,this.options.collection.orderstate=this.selectedArrow;break;case this.constants.MODIFIED_ASC:this.collection.setOrder("modify_date asc"),this.selectedValue=l[e],this.actualValue=l.modified,this.selectedArrow="icon-sortArrowDown",this.options.collection.state=this.constants.MODIFIED_ASC,this.options.collection.sorting.sort[0].value=this.constants.MODIFIED_ASC,this.options.collection.orderstate=this.selectedArrow;break;case this.constants.MODIFIED_DESC:this.collection.setOrder("modify_date desc"),this.selectedValue=l[e],this.actualValue=l.modified,this.selectedArrow="icon-sortArrowUp",this.options.collection.state=this.constants.MODIFIED_DESC,this.options.collection.sorting.sort[0].value=this.constants.MODIFIED_DESC,this.options.collection.orderstate=this.selectedArrow;break;case this.constants.SIZE_ASC:this.collection.setOrder("size asc"),this.selectedValue=l[e],this.actualValue=l.size,this.selectedArrow="icon-sortArrowDown",this.options.collection.state=this.constants.SIZE_ASC,this.options.collection.sorting.sort[0].value=this.constants.SIZE_ASC,this.options.collection.orderstate=this.selectedArrow;break;case this.constants.SIZE_DESC:this.collection.setOrder("size desc"),this.selectedValue=l[e],this.actualValue=l.size,this.selectedArrow="icon-sortArrowUp",this.options.collection.state=this.constants.SIZE_DESC,this.options.collection.sorting.sort[0].value=this.constants.SIZE_DESC,this.options.collection.orderstate=this.selectedArrow}var t=this;this.options.collection.fetch({"silent":!0}).then(function(){t.trigger("render:sortmenu",e),t.$el.find(".binf-dropdown-toggle >span").innerText=l[e],t.$el.find(".csui-sort-option.binf-active >span.cs-icon").addClass("icon-listview-checkmark");var i=t.OverlapDisplayText(e);t.$el.find(".binf-dropdown-toggle >span.cs-label").html(i),t.$el.find(".csui-sort-arrow").removeClass("icon-sortArrowDown"),t.$el.find(".csui-sort-arrow").removeClass("icon-sortArrowUp"),t.$el.find(".csui-sort-arrow").addClass(t.selectedArrow),t.$el.find(".csui-search-sort-options").removeClass("binf-open")},t)},"OverlapDisplayText":function(e){var t="";switch(e){case this.constants.NAME_ASC:case this.constants.NAME_DESC:t=l.name;break;case this.constants.MODIFIED_ASC:case this.constants.MODIFIED_DESC:t=l.modified;break;case this.constants.SIZE_ASC:case this.constants.SIZE_DESC:t=l.size;break;default:t=l.name}return t},"onRender":function(){var e=this;e.$el.find(".csui-search-sort-options li>a span.cs-label").each(function(){i(this).text().trim()===e.selectedValue&&i(this).siblings().addClass("icon-listview-checkmark")},e)}})}),csui.define("csui/controls/thumbnail/content/content.registry",["csui/lib/underscore"],function(e){function t(){this._contentKeys={},this._dataTypes={}}return e.extend(t.prototype,{"getContentView":function(e){if("type"!==e.get("column_type_identifier")){var t=e.get("key"),i=t&&this._contentKeys[t];if(i)return i}var s=e.get("type");return s&&this._dataTypes[s.toString()]},"registerByKey":function(t,i){if(!e.isString(t)||!t)throw new Error("Key must be a non-empty string");this._registerContentView(this._contentKeys,t,i)},"registerByDataType":function(t,i){if(!e.isNumber(t)||!t)throw new Error("Data type must be a non-zero number");this._registerContentView(this._dataTypes,t.toString(),i)},"_registerContentView":function(e,t,i){if("function"!=typeof i)throw new Error("Column handler must be a function object");e[t]=i}}),new t}),csui.define("csui/controls/thumbnail/content/favorite/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/favorite/impl/nls/root/localized.strings",{"ColumnTitle":"Favorite"}),csui.define("hbs!csui/controls/thumbnail/content/favorite/impl/favorite",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<span class="csui-thumbnail-favorite"></span>'}});return i.registerPartial("csui_controls_thumbnail_content_favorite_impl_favorite",s),s}),csui.define("css!csui/controls/thumbnail/content/favorite/impl/favorite",[],function(){}),csui.define("csui/controls/thumbnail/content/favorite/favorite.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/widgets/favorites/favorite.star.view","csui/controls/thumbnail/content/content.registry","i18n!csui/controls/thumbnail/content/favorite/impl/nls/localized.strings","hbs!csui/controls/thumbnail/content/favorite/impl/favorite","css!csui/controls/thumbnail/content/favorite/impl/favorite"],function(e,t,i,s,n,o,r,l){"use strict";var a=s.LayoutView.extend({"template":l,"className":"csui-thumbnail-favorite-container","regions":{"favRegion":".csui-thumbnail-favorite"},"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.call(this,e)},"onRender":function(){this.favStarView||(this.favStarView=new n(t.extend({"checkVisible":!0,"popoverAtBodyElement":!0,"focusable":!0},this.options)),this.favRegion.show(this.favStarView)),this.listenTo(this.favStarView,"show:add:favorite:form",function(){this.triggerMethod("show:add:favorite:form")}),this.listenTo(this.favStarView,"close:add:favorite:form",function(){this.triggerMethod("close:add:favorite:form")}),this.favStarView.render(),this.$el.append(this.favStarView.el),this.listenTo(this.options.originatingView.thumbnail,"scroll",function(){this.favStarView&&this.favStarView.closePopover()})}});return o.registerByKey("favorite",a),a}),csui.define("csui/controls/thumbnail/content/node.state/node.state.icons",["csui/lib/underscore","csui/lib/backbone","csui-ext!csui/controls/table/cells/node.state/node.state.icons","csui-ext!csui/controls/thumbnail/content/node.state/node.state.icons"],function(e,t,i,s){"use strict";var n=t.Model.extend({"defaults":{"sequence":100,"iconView":null,"iconViewOptions":null},"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments)}}),o=t.Collection.extend({"model":n,"comparator":"sequence","constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments)}}),r=new o;return s&&(s=e.flatten(s,!0),r.add(s)),r}),csui.define("hbs!csui/controls/thumbnail/content/node.state/impl/node.state",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-thumbnail-nodestate"></div>'}});return i.registerPartial("csui_controls_thumbnail_content_node.state_impl_node.state",s),s}),csui.define("csui/controls/thumbnail/content/node.state/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/node.state/impl/nls/root/localized.strings",{"stateListAria":"List of states","someStateIconsAria":"State available","noStateIconsAria":"No state",
"bool_value_true":"true","bool_value_false":"false","reservedTooltip":"Reserved by {0}\r\n{1}","reservedAria":"Reserved by {0} at {1}, click to unreserve","reservedSharedCollaborationTooltip":"Shared for collaboration by {0}\r\n{1}","reservedSharedCollaborationAria":"Shared for collaboration by {0} at {1}, click to unshare","reserved_attribute_title":"Reserved","reserved_attribute_name":"reserved","reserved_shared_collaboration_attribute_title":"Shared for collaboration","reserved_shared_collaboration_attribute_name":"reserved_shared_collaboration","nodeStateTitle_thumbnail":"Open info panel to see status icons"}),csui.define("csui/controls/thumbnail/content/node.state/node.state.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/thumbnail/content/content.registry","csui/controls/thumbnail/content/node.state/node.state.icons","csui/models/mixins/v2.fields/v2.fields.mixin","hbs!csui/controls/thumbnail/content/node.state/impl/node.state","i18n!csui/controls/thumbnail/content/node.state/impl/nls/localized.strings"],function(e,t,i,s,n,o,r,l,a){"use strict";var c=s.CollectionView.extend({"tagName":"ul","attributes":{"aria-label":a.stateListAria},"getChildView":function(e){return e.get("iconView")},"childViewOptions":function(e){return t.extend({"context":this.options.context,"model":this.options.node,"originatingView":this.options.originatingView,"targetView":this.options.targetView},e.get("iconViewOptions"))}}),u=s.LayoutView.extend({"template":l,"className":"csui-thumbnail-nodestate-container","regions":{"nodeStateRegion":".csui-thumbnail-nodestate"},"constructor":function(e){e||(e={}),this.options=e,s.LayoutView.prototype.constructor.call(this,e)},"onRender":function(){var e=this._getEnabledNodeStateIcons(),t=e.length?a.someStateIconsAria:a.noStateIconsAria,i=this.options.displayTitle?a.nodeStateTitle_thumbnail:"";if(this.el.setAttribute("aria-label",t),this.el.setAttribute("title",i),e.length){var s=new c({"context":this.options.context,"node":this.model,"originatingView":this.options.originatingView,"targetView":this.options.targetView,"collection":e});this.nodeStateRegion.show(s),this.options.displayTitle&&s.$el.find("button").attr("tabindex","-1")}},"_getEnabledNodeStateIcons":function(){var e;return e=Object.getPrototypeOf(o),new e.constructor(o.filter(function(e){var t=e.get("iconView");return t&&(!t.enabled||t.enabled({"context":this.options.context,"node":this.model}))},this))}});return n.registerByKey("reserved",u),u}),csui.define("csui/controls/thumbnail/content/name/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/name/impl/nls/root/localized.strings",{"ColumnTitle":"Name","nameAria":"{0}","nameNoOpenAria":"{0}. Can not be opened."}),csui.define("hbs!csui/controls/thumbnail/content/name/impl/name",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'  <div class="csui-thumbnail-overview-icon"></div>\r\n'},"3":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.inactive:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:""},"4":function(e,t,i,s){var n;return'    <div class="csui-thumbnail-name csui-thumbnail-name-'+this.escapeExpression((n=null!=(n=t.cid||(null!=e?e.cid:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'">\r\n      <div class="csui-thumbnail-name-justify-div">\r\n        <p class="csui-thumbnail-name-value csui-thumbnail-no-default-action"\r\n           title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.nameNoOpenAria||(null!=e?e.nameNoOpenAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"nameNoOpenAria","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</p>\r\n      </div>\r\n    </div>\r\n"},"6":function(e,t,i,s){var n;return'    <div class="csui-thumbnail-name csui-thumbnail-name-'+this.escapeExpression((n=null!=(n=t.cid||(null!=e?e.cid:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'">\r\n      <a href="'+this.escapeExpression((n=null!=(n=t.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultActionUrl","hash":{}}):n))+'"\r\n         class="csui-thumbnail-name-value csui-thumbnail-default-action csui-thumbnail-name-justify-div"\r\n         title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.nameAria||(null!=e?e.nameAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"nameAria","hash":{}}):n))+'">\r\n        <span class="csui-thumbnail-name-link-text">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</span>\r\n      </a>\r\n    </div>\r\n"},"8":function(e,t,i,s){var n;return'  <div class="csui-thumbnail-name csui-thumbnail-name-'+this.escapeExpression((n=null!=(n=t.cid||(null!=e?e.cid:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'">\r\n    <div class="csui-thumbnail-name-justify-div">\r\n      <p class="csui-thumbnail-name-value csui-thumbnail-no-default-action"\r\n         title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.nameNoOpenAria||(null!=e?e.nameNoOpenAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"nameNoOpenAria","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+"</p>\r\n    </div>\r\n  </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return(null!=(n=t.if.call(e,null!=e?e.displayIcon:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+(null!=(n=t.if.call(e,null!=e?e.defaultAction:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(8,s,0)}))?n:"")}});return i.registerPartial("csui_controls_thumbnail_content_name_impl_name",s),s}),csui.define("css!csui/controls/thumbnail/content/name/impl/name",[],function(){}),csui.define("csui/controls/thumbnail/content/name/name.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/node-type.icon/node-type.icon.view","csui/utils/node.links/node.links","csui/controls/thumbnail/content/content.registry","i18n!csui/controls/thumbnail/content/name/impl/nls/localized.strings","hbs!csui/controls/thumbnail/content/name/impl/name","css!csui/controls/thumbnail/content/name/impl/name"],function(e,t,i,s,n,o,r,l,a){"use strict";var c=s.ItemView.extend({"template":a,"className":"csui-thumbnail-name-container","templateHelpers":function(){var e=this.options.column,i=this.model,s=i.get(e.name),n=o.getUrl(i);return{"cid":this.model.cid,"defaultAction":e.defaultAction,"defaultActionUrl":n,"contextualMenu":e.contextualMenu,"name":s,"nameAria":t.str.sformat(l.nameAria,s),"nameNoOpenAria":t.str.sformat(l.nameNoOpenAria,s),"inactive":i.get("inactive"),"displayIcon":this.options.displayIcon}},"constructor":function(e){e||(e={}),this.options=e,s.ItemView.prototype.constructor.apply(this,arguments),this.options.displayIcon&&this.listenTo(this,"render",this._createNodeTypeIcon).listenTo(this,"before:render",this._destroyNodeTypeIcon).listenTo(this,"before:destroy",this._destroyNodeTypeIcon)},"_createNodeTypeIcon":function(){var e=new n({"node":this.model});this.typeIconRegion=new s.Region({"el":this.$(".csui-thumbnail-overview-icon")}),this.typeIconRegion.show(e)},"_destroyNodeTypeIcon":function(){this.typeIconRegion&&(this.typeIconRegion.empty(),this.typeIconRegion=null)},"onRender":function(){var e=this;this.$el.find(".csui-thumbnail-default-action").on("click."+this.cid,function(t){e.model.inlineFormView||e.trigger("execute:defaultAction",t)})}});return r.registerByKey("name",c),c}),csui.define("hbs!csui/controls/thumbnail/content/member/impl/member",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-thumbnail-user csui-thumbnail-user-'+this.escapeExpression((n=null!=(n=t.cid||(null!=e?e.cid:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'">\r\n  <div class="csui-thumbnail-label csui-thumbnail-user-content-label" aria-label="'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'">\r\n    <span>'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'</span>\r\n  </div>\r\n  <div class="csui-thumbnail-value csui-thumbnail-user-content-justify-div">\r\n    <p class="csui-thumbnail-item-content-value" title="'+this.escapeExpression((n=null!=(n=t.value||(null!=e?e.value:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+'"\r\n       aria-label="'+this.escapeExpression((n=null!=(n=t.userNoOpenAria||(null!=e?e.userNoOpenAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"userNoOpenAria","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.value||(null!=e?e.value:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"value","hash":{}}):n))+"</p>\r\n  </div>\r\n</div>"}});return i.registerPartial("csui_controls_thumbnail_content_member_impl_member",s),s}),csui.define("csui/controls/thumbnail/content/member/member.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/thumbnail/content/content.registry","hbs!csui/controls/thumbnail/content/member/impl/member"],function(e,t,i,s,n,o,r){"use strict";var l=s.ItemView.extend({"template":r,"className":"csui-thumbnail-user-container","templateHelpers":function(){var e,i=this.options.column.name,s=this.model.get(i+"_expand")||this.model.get(i)||"",o=this.options.contentModel.get("name");return e=t.isObject(s)?n.formatMemberName(s):this.model.get(i+"_formatted")||s.toString(),{"label":o,"value":e}},"constructor":function(e){e||(e={}),this.options=e,s.ItemView.prototype.constructor.apply(this,arguments)}});return o.registerByDataType(14,l),o.registerByDataType(19,l),o.registerByKey("owner_id",l),l}),csui.define("csui/controls/thumbnail/content/size/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/size/impl/nls/root/localized.strings",{"sizeLabel":"Size","ColumnTitle":"Size","formatForNone":"{0} items","formatForOne":"{0} item","formatForTwo":"{0} items","formatForFive":"{0} items","sizeUnavailable":"Size unavailable for {0}"}),csui.define("hbs!csui/controls/thumbnail/content/size/impl/size",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'    <div class="csui-thumbnail-label csui-thumbnail-size-label" aria-label="'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'">\r\n      <span>'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+"</span>\r\n    </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="csui-thumbnail-size csui-thumbnail-size-'+this.escapeExpression((o=null!=(o=t.cid||(null!=e?e.cid:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"cid","hash":{}}):o))+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.displayLabel:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'  <div class="csui-thumbnail-value csui-thumbnail-size-justify-div">\r\n    <p class="csui-thumbnail-size-value" title="'+this.escapeExpression((o=null!=(o=t.value||(null!=e?e.value:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+'"\r\n       aria-label="'+this.escapeExpression((o=null!=(o=t.value||(null!=e?e.value:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.formattedValue||(null!=e?e.formattedValue:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"formattedValue","hash":{}}):o))+"</p>\r\n  </div>\r\n</div>"}});return i.registerPartial("csui_controls_thumbnail_content_size_impl_size",s),s}),csui.define("css!csui/controls/thumbnail/content/size/impl/size",[],function(){}),csui.define("csui/controls/thumbnail/content/size/size.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/thumbnail/content/content.registry","i18n!csui/controls/thumbnail/content/size/impl/nls/localized.strings","hbs!csui/controls/thumbnail/content/size/impl/size","css!csui/controls/thumbnail/content/size/impl/size"],function(e,t,i,s,n,o,r,l){"use strict";var a=s.ItemView.extend({"template":l,"className":"csui-thumbnail-size-container","templateHelpers":function(){var e,t=this.model,i=this.options.column,s=i.name,o=t.get(s),l=t.get("type");if(null==o)return"";if(t.get("container"))o=e=202!==l&&899!==l?n.formatMessage(o,r):"";else{if(144!==l&&749!==l&&736!==l&&30309!==l)return"";e=n.formatFriendlyFileSize(o),o=n.formatExactFileSize(o)}return{"value":o,"formattedValue":e,"displayLabel":this.options.displayLabel,"label":this.options.displayLabel?r.sizeLabel:"","cid":this.model.cid}},"constructor":function(e){e||(e={}),s.ItemView.prototype.constructor.apply(this,arguments)}});return o.registerByKey("size",a),a}),csui.define("hbs!csui/controls/thumbnail/content/select/impl/select",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n,o;return'  <div class="csui-focusable-table-column-header">\r\n    <div class="csui-selected-checkbox csui-checkbox-primary">\r\n      <input type="checkbox" class="selectAction" title="'+this.escapeExpression((o=null!=(o=t.selectItemName||(null!=e?e.selectItemName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"selectItemName","hash":{}}):o))+'"\r\n             '+(null!=(n=t.if.call(e,null!=e?e.checked:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.noop}))?n:"")+' >\r\n      <div class="csui-selectlabel"></div>\r\n    </div>\r\n  </div>\r\n'},"2":function(e,t,i,s){return"checked"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.selectable:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return i.registerPartial("csui_controls_thumbnail_content_select_impl_select",s),s}),csui.define("css!csui/controls/thumbnail/content/select/impl/select",[],function(){}),csui.define("csui/controls/thumbnail/content/select/select.view",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/thumbnail/content/content.registry","i18n!csui/controls/thumbnail/impl/nls/lang","hbs!csui/controls/thumbnail/content/select/impl/select","css!csui/controls/thumbnail/content/select/impl/select"],function(e,t,i,s,n,o){"use strict";var r=i.ItemView.extend({"template":o,"templateHelpers":function(){return{"selectable":!1!==this.model.get("selectable"),"checked":!0===this.model.get(r.isSelectedModelAttributeName),"selectItemName":e.str.sformat(n.selectItem,this.model.get("name")),"selectItemAria":e.str.sformat(n.selectItemAria,this.model.get("name"))}},"events":{"keydown":"onKeyInView"},"constructor":function(e){i.ItemView.prototype.constructor.apply(this,arguments),this.rowIndex=e.rowIndex,this.listenTo(this.model,"change:"+r.isSelectedModelAttributeName,this.render),this.listenTo(this,"before:render",this._detachClickHandler).listenTo(this,"before:destroy",this._detachClickHandler)},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||this._toggleCheckbox(e)},"_attachClickHandler":function(){var e=this,i=this.$el.find('input[type="checkbox"]');this.$el.find(".csui-selectlabel").on("click."+this.cid,function(t){t.preventDefault(),t.stopPropagation(),e.options.thumbnailView&&e.options.thumbnailView._isSelectCheckBoxBlocked||(i.prop("checked",!i.prop("checked")).change(),e.triggerMethod("clicked:checkbox",t))}),i.on("change."+this.cid,function(s){t.trigger("closeToggleAction");var n=i.prop("checked");e.triggerMethod("clicked:checkbox",{"view":e,"checked":n})})},"_detachClickHandler":function(){var e=this.$el.find('input[type="checkbox"]'),t=this.$el.find(".csui-selectlabel");e.off("change."+this.cid),t.off("click."+this.cid),this.$el.off("click."+this.cid)},"_toggleCheckbox":function(e){var t=this.$el.find('input[type="checkbox"]');return t.prop("checked",!t.prop("checked")).change(),this.$el.attr("aria-checked",t.prop("checked")),e.preventDefault(),e.stopPropagation(),t.prop("checked")},"onRender":function(){this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this.$el.attr("aria-label",n.selectItemAria),this.$el.attr("role","checkbox");var e=this.$el.find('input[type="checkbox"]'),t=e.prop("checked");return this.$el.attr("aria-checked",t),this._attachClickHandler(),this}},{"columnClassName":"csui-table-cell-_select","isSelectedModelAttributeName":"csuiIsSelected"});return s.registerByKey("_select",r),r}),csui.define("csui/controls/thumbnail/content/date/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/date/impl/nls/root/localized.strings",{"ColumnTitle":"Date","dateLabel":"Modified date"}),csui.define("hbs!csui/controls/thumbnail/content/date/impl/date",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'    <div class="csui-thumbnail-label csui-thumbnail-date-label" aria-label="'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'">\r\n      <span>'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+"</span>\r\n    </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="csui-thumbnail-date csui-thumbnail-date-'+this.escapeExpression((o=null!=(o=t.cid||(null!=e?e.cid:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"cid","hash":{}}):o))+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.displayLabel:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'  <div class="csui-thumbnail-value csui-thumbnail-date-justify-div">\r\n    <p class="csui-thumbnail-date-value" title="'+this.escapeExpression((o=null!=(o=t.value||(null!=e?e.value:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+'"\r\n       aria-label="'+this.escapeExpression((o=null!=(o=t.value||(null!=e?e.value:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.value||(null!=e?e.value:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+"</p>\r\n  </div>\r\n</div>"}});return i.registerPartial("csui_controls_thumbnail_content_date_impl_date",s),s}),csui.define("css!csui/controls/thumbnail/content/date/impl/date",[],function(){}),csui.define("csui/controls/thumbnail/content/date/date.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/thumbnail/content/content.registry","i18n!csui/controls/thumbnail/content/date/impl/nls/localized.strings","hbs!csui/controls/thumbnail/content/date/impl/date","css!csui/controls/thumbnail/content/date/impl/date"],function(e,t,i,s,n,o,r,l,a){"use strict";var c=i.extend({"multiValueSeparator":", "},e.config()),u=n.ItemView.extend({"template":a,"className":"csui-thumbnail-date-container","templateHelpers":function(){function e(e){return o.formatExactDateTime(e)}var t=this.model.get(this.options.column.name),i=this.getSingleOrMultipleValueData(t,e,e);return this.options.displayLabel&&(i.label=this.options.contentModel.get("name")?this.options.contentModel.get("name"):l.dateLabel),i.displayLabel=this.options.displayLabel,i.cid=this.model.cid,i},"getSingleOrMultipleValueData":function(e,t,i){var s,n;return Array.isArray(e)?(s=this.concatenateTextValues(e,t),n=this.concatenateTextValues(e,i)):(s=t(e),n=i(e)),{"value":s,"formattedValue":n}},"concatenateTextValues":function(e,t){return t=this._validateFormater(t),e.map(t).join(c.multiValueSeparator)},"_validateFormater":function(e){return e||function(e){return e}},"constructor":function(e){e||(e={}),n.ItemView.prototype.constructor.apply(this,arguments)}});return r.registerByDataType(-7,u),u}),csui.define("hbs!csui/controls/thumbnail/content/thumbnail.icon/impl/thumbnail.icon",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <div\r\n      class="csui-thumbnail-content-icon csui-thumbnail-content-no-default-action thumbnail-'+this.escapeExpression((n=null!=(n=t.cid||(null!=e?e.cid:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'"\r\n      aria-label="'+this.escapeExpression((n=null!=(n=t.typeAndNameAria||(null!=e?e.typeAndNameAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"typeAndNameAria","hash":{}}):n))+'" tabindex="0"></div>\r\n'},"3":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.inactive:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:""},"4":function(e,t,i,s){var n;return'    <div class="csui-thumbnail-content-icon csui-thumbnail-content-no-default-action inactive"\r\n         aria-label="'+this.escapeExpression((n=null!=(n=t.typeAndNameAria||(null!=e?e.typeAndNameAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"typeAndNameAria","hash":{}}):n))+'"></div>\r\n'},"6":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.inCreateMode:e,{"name":"if","hash":{},"fn":this.program(7,s,0),"inverse":this.program(9,s,0)}))?n:""},"7":function(e,t,i,s){var n;return'      <div class="csui-thumbnail-content-icon csui-thumbnail-content-default-action"\r\n           aria-label="'+this.escapeExpression((n=null!=(n=t.typeAndNameAria||(null!=e?e.typeAndNameAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"typeAndNameAria","hash":{}}):n))+'" tabindex="0"></div>\r\n'},"9":function(e,t,i,s){var n;return'      <a class="csui-thumbnail-content-icon csui-thumbnail-content-default-action thumbnail-'+this.escapeExpression((n=null!=(n=t.cid||(null!=e?e.cid:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"cid","hash":{}}):n))+'"\r\n         href="'+this.escapeExpression((n=null!=(n=t.defaultActionUrl||(null!=e?e.defaultActionUrl:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"defaultActionUrl","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.typeAndNameAria||(null!=e?e.typeAndNameAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"typeAndNameAria","hash":{}}):n))+'"></a>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.thumbnailAction:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:""}});return i.registerPartial("csui_controls_thumbnail_content_thumbnail.icon_impl_thumbnail.icon",s),s}),csui.define("csui/controls/thumbnail/content/thumbnail.icon/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/thumbnail.icon/impl/nls/root/localized.strings",{"typeAndNameAria":"{0} {1}","downloadTitle":"Download","hideTitle":"Hide filmstrip","showTitle":"Show filmstrip","nextTitle":"Next","previousTitle":"Previous","videoNotSupportMsg":"Your browser does not support the video tag."}),csui.define("hbs!csui/controls/thumbnail/content/thumbnail.icon/util/gallery",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="csui-current-total-items">'+this.escapeExpression((o=null!=(o=t.currentItem||(null!=e?e.currentItem:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"currentItem","hash":{}}):o))+" / "+this.escapeExpression((o=null!=(o=t.totalItems||(null!=e?e.totalItems:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"totalItems","hash":{}}):o))+'</div>\r\n<div class="csui-active-item-name">\r\n  <span class="item-name">'+this.escapeExpression((o=null!=(o=t.currentItemName||(null!=e?e.currentItemName:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"currentItemName","hash":{}}):o))+'</span>\r\n  <span title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.lang:e)?n.downloadTitle:n,e))+'" class="icon icon-download-white csui-download-gallery"\r\n        tabindex="0"></span>\r\n</div>\r\n<div class="csui-carousel-container">\r\n  <div class="csui-preview-carousal-container">\r\n    <div id="binf-carousel" class="binf-carousel binf-slide" data-binf-ride="carousel">\r\n      <div class="csui-preview-carousal"></div>\r\n      <a class="binf-left binf-carousel-control" href="#binf-carousel" role="binf_button"\r\n         data-binf-slide="binf-prev" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.lang:e)?n.previousTitle:n,e))+'" tabindex="0">\r\n        <span class="binf-glyphicon binf-glyphicon-menu-left" aria-hidden="true"></span>\r\n      </a>\r\n      <a class="binf-right binf-carousel-control" href="#binf-carousel" role="binf_button"\r\n         data-binf-slide="binf-next" title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.lang:e)?n.nextTitle:n,e))+'" tabindex="0">\r\n        <span class="binf-glyphicon binf-glyphicon-menu-right" aria-hidden="true"></span>\r\n      </a>\r\n    </div>\r\n  </div>\r\n  <div class="csui-carousel-film-strip">\r\n    <div class="binf-carousel binf-slide binf-filmstrip-container" data-interval="false"></div>\r\n    <a class="binf-left binf-carousel-control csui-thumb-toggle-control" href="javascript:void(0);"\r\n       role="binf_button">\r\n    <span class="binf-glyphicon binf-glyphicon-menu-down" aria-hidden="true"\r\n          title="'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.lang:e)?n.hideTitle:n,e))+'"></span>\r\n    </a>\r\n  </div>\r\n</div>'}});return i.registerPartial("csui_controls_thumbnail_content_thumbnail.icon_util_gallery",s),s}),csui.define("hbs!csui/controls/thumbnail/content/thumbnail.icon/util/gallery.item",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.activeItem:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(13,s,0)}))?n:""},"2":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.isVideo:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.program(8,s,0)}))?n:""},"3":function(e,t,i,s){var n,o;return'      <div class="binf-item binf-active binf-item-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.originalAvailable:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:"")+"      </div>\r\n"},"4":function(e,t,i,s){return'          <div class="csui-video">\r\n            <video preload="none" poster="" controls="controls">\r\n              <source src="'+this.escapeExpression(this.lambda(null!=e?e.contentURL:e,e))+"\" type='"+this.escapeExpression(this.lambda(null!=e?e.videoType:e,e))+"'>\r\n              </source>\r\n              "+this.escapeExpression(this.lambda(null!=e?e.videoNotSupportMsg:e,e))+"\r\n            </video>\r\n          </div>\r\n"},"6":function(e,t,i,s){return'          <div class="csui-video">\r\n            <video preload="none" poster="" controls="controls">\r\n              <source src="'+this.escapeExpression(this.lambda(null!=e?e.contentURL:e,e))+"\" type='"+this.escapeExpression(this.lambda(null!=e?e.videoType:e,e))+"'>\r\n              </source>\r\n              "+this.escapeExpression(this.lambda(null!=e?e.videoNotSupportMsg:e,e))+'\r\n            </video>\r\n            <div class="csui-img-loader">\r\n              <div class="csui-img-loader-inner"></div>\r\n            </div>\r\n          </div>\r\n'},"8":function(e,t,i,s){var n,o;return'      <div class="binf-item binf-active binf-item-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.originalAvailable:e,{"name":"if","hash":{},"fn":this.program(9,s,0),"inverse":this.program(11,s,0)}))?n:"")+"      </div>\r\n"},"9":function(e,t,i,s){return'          <div class="csui-img-box csui-gallery-original-icon">\r\n            <img src="'+this.escapeExpression(this.lambda(null!=e?e.contentURL:e,e))+'" tabindex="0">\r\n          </div>\r\n'},"11":function(e,t,i,s){return'          <div class="csui-img-box csui-gallery-thumbnail-icon">\r\n            <div>\r\n              <img src="'+this.escapeExpression(this.lambda(null!=e?e.contentURL:e,e))+'" tabindex="0">\r\n              <div class="csui-img-loader">\r\n                <div class="csui-img-loader-inner"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class="csui-img-box csui-gallery-original-icon binf-hidden">\r\n            <img src="'+this.escapeExpression(this.lambda(null!=e?e.contentURL:e,e))+'" tabindex="0">\r\n          </div>\r\n'},"13":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.isVideo:e,{"name":"if","hash":{},"fn":this.program(14,s,0),"inverse":this.program(16,s,0)}))?n:""},"14":function(e,t,i,s){var n,o;return'      <div class="binf-item binf-item-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.originalAvailable:e,{"name":"if","hash":{},"fn":this.program(4,s,0),"inverse":this.program(6,s,0)}))?n:"")+"      </div>\r\n"},"16":function(e,t,i,s){var n,o;return'      <div class="binf-item binf-item-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.originalAvailable:e,{"name":"if","hash":{},"fn":this.program(9,s,0),"inverse":this.program(11,s,0)}))?n:"")+"      </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.each.call(e,null!=e?e.data:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return i.registerPartial("csui_controls_thumbnail_content_thumbnail.icon_util_gallery.item",s),s}),csui.define("hbs!csui/controls/thumbnail/content/thumbnail.icon/util/filmstrip.item",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.activeItem:e,{"name":"if","hash":{},"fn":this.program(2,s,0),"inverse":this.program(9,s,0)}))?n:""},"2":function(e,t,i,s){var n,o;return'    <div class="binf-item binf-filmstrip-item-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+' binf-active" title="'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,
"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'" tabindex="0">\r\n      <div class="binf-thumb" data-binf-target="#binf-carousel" data-binf-slide-to= '+this.escapeExpression((o=null!=(o=t.index||(null!=e?e.index:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"index","hash":{}}):o))+'>\r\n        <div class="binf-thumb-caption">'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'</div>\r\n        <div class="binf-thumb-img-container">\r\n          <div class="binf-thumb-img '+(null!=(n=t.if.call(e,null!=e?e.isVideo:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.isVideo:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.program(7,s,0)}))?n:"")+"          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n"},"3":function(e,t,i,s){return"binf-video-container "},"5":function(e,t,i,s){return'              <div class="binf-play-arrow-container"><span\r\n                  class="binf-play-arrow"></span></div>\r\n'},"7":function(e,t,i,s){return'              <div>\r\n                <img src="'+this.escapeExpression(this.lambda(null!=e?e.thumbnailURL:e,e))+'">\r\n              </div>\r\n'},"9":function(e,t,i,s){var n,o;return'    <div class="binf-item binf-filmstrip-item-'+this.escapeExpression((o=null!=(o=t.id||(null!=e?e.id:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"id","hash":{}}):o))+'" title="'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'" tabindex="0">\r\n      <div class="binf-thumb" data-binf-target="#binf-carousel" data-binf-slide-to= '+this.escapeExpression((o=null!=(o=t.index||(null!=e?e.index:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"index","hash":{}}):o))+'>\r\n        <div class="binf-thumb-caption">'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"name","hash":{}}):o))+'</div>\r\n        <div class="binf-thumb-img-container">\r\n          <div class="binf-thumb-img '+(null!=(n=t.if.call(e,null!=e?e.isVideo:e,{"name":"if","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.isVideo:e,{"name":"if","hash":{},"fn":this.program(5,s,0),"inverse":this.program(7,s,0)}))?n:"")+"          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.each.call(e,null!=e?e.data:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:""}});return i.registerPartial("csui_controls_thumbnail_content_thumbnail.icon_util_filmstrip.item",s),s}),csui.define("css!csui/controls/thumbnail/content/thumbnail.icon/util/gallary",[],function(){}),csui.define("csui/controls/thumbnail/content/thumbnail.icon/util/gallery.view",["csui/lib/underscore","csui/lib/jquery","i18n","hbs!csui/controls/thumbnail/content/thumbnail.icon/util/gallery","hbs!csui/controls/thumbnail/content/thumbnail.icon/util/gallery.item","hbs!csui/controls/thumbnail/content/thumbnail.icon/util/filmstrip.item","css!csui/controls/thumbnail/content/thumbnail.icon/util/gallary"],function(e,t,i,s,n,o){"use strict";function r(e,i,r){u=e,m=e.length,f=e[i],b=f.name,d=t("<div />",{"class":"binf-gallery-container","html":s({"totalItems":e.length,"currentItem":f.index+1,"currentItemName":b,"lang":r})}),h=t("<div />",{"class":"binf-carousel-inner","html":n({"data":e})}),p=t("<div />",{"class":"csui-carousel-film-strip-inner","html":o({"data":e})}),d.find(".csui-carousel-film-strip .binf-carousel").html(p),d.find(".csui-preview-carousal").html(h),u.length<2&&(d.find("#binf-carousel").children(".binf-left").hide(),d.find("#binf-carousel").children(".binf-right").hide()),v=74;var g=v*u.length;return t(window).width()<g&&(d.find(".csui-carousel-film-strip-inner").css("width",g+"px"),d.find(".csui-carousel-film-strip-inner").addClass("csui-film-strip-adjust")),d.find("#binf-carousel").on("slid.binf.carousel",a),d.find(".csui-thumb-toggle-control").on("click",{"lang":r},c),d.find(".csui-download-gallery").on("click",l),p.find(".binf-item").on("keyup",function(e){32!==e.keyCode&&13!==e.keyCode||t(e.currentTarget)&&t(e.currentTarget).find(".binf-thumb").trigger("click")}),d}function l(e){f.downloadItem(e)}function a(e){v=t(d.find(".csui-carousel-film-strip-inner .binf-thumb-img")[0]).width()+10,g=d.find(".csui-carousel-film-strip-inner").find(".binf-item").removeClass("binf-active");var i=t(g[t(e.relatedTarget).index()]);i.addClass("binf-active"),f&&f.index>=0&&(f=u[t(e.relatedTarget).index()],u[f.index].model&&u[f.index].model.contentURL&&!u[f.index].model.addedOriginalImage&&(t(e.relatedTarget).addClass("csui-item-original"),u[f.index].addedOriginalImage=!0,t(e.relatedTarget).find("img").length>0&&t(e.relatedTarget).find("img").attr("src",u[f.index].model.contentURL),t(e.relatedTarget).find("video").length>0&&(t(e.relatedTarget).find("video").attr("src",u[f.index].model.contentURL),t(e.relatedTarget).find(".outer-border").addClass("binf-hidden"))),b=f.name,d.find(".csui-current-total-items").html(f.index+1+" / "+m),d.find(".csui-active-item-name .item-name").html(b),f.updateScroll(i))}function c(e){d.find(".csui-carousel-film-strip .binf-carousel").slideToggle(),d.find(".binf-glyphicon-menu-down").toggleClass("binf-glyphicon-menu-up"),d.find(".binf-glyphicon-menu-up").length>0?d.find(".binf-glyphicon-menu-up").attr("title",e.data.lang.showTitle):d.find(".binf-glyphicon-menu-down").attr("title",e.data.lang.hideTitle)}var u,d,h,p,m,f,b,g,v;return{"createGalleryContainer":r,"updateSlide":a,"thumbToggle":c,"downloadItem":l}}),csui.define("css!csui/controls/thumbnail/content/thumbnail.icon/impl/thumbnail.icon",[],function(){});csui.define("csui/controls/thumbnail/content/thumbnail.icon/thumbnail.icon.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/node-type.icon/node-type.icon.view","csui/utils/node.links/node.links","hbs!csui/controls/thumbnail/content/thumbnail.icon/impl/thumbnail.icon","i18n!csui/controls/thumbnail/content/thumbnail.icon/impl/nls/localized.strings","csui/controls/thumbnail/content/content.registry","csui/controls/dialog/dialog.view","csui/controls/thumbnail/content/thumbnail.icon/util/gallery.view","csui/utils/commands/impl/thumbnail/thumbnail.object","csui/models/nodes","csui/utils/url","csui/utils/taskqueue","csui/utils/commands/download","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/lib/exif","css!csui/controls/thumbnail/content/thumbnail.icon/impl/thumbnail.icon"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b,g,v,w){"use strict";var y=e.config();t.defaults(y,{"parallelism":3});var _=n.ItemView.extend({"ui":{"thumbnailIcon":".csui-thumbnail-content-icon","iconcloseGallery":".icon-close-gallery"},"events":{"keydown":"onKeyInView","keydown @ui.iconcloseGallery":"handleShiftKey","click @ui.thumbnailIcon":"showThumbCarousel","keyup @ui.thumbnailIcon":"showGalleryView"},"template":a,"templateHelpers":function(){var e=this.model,i=this.model.get("mime_type")&&this.model.get("mime_type").match(/^image|video\/*[-.\w\s]*$/g)||144===this.model.get("type"),s=l.getUrl(this.model),n=t.str.sformat(c.typeAndNameAria,e.get("type_name"),e.get("name"));return{"thumbnailAction":i,"cid":this.model&&this.model.cid||this.options.model.cid,"defaultActionUrl":s,"typeAndNameAria":n,"inactive":e.get("inactive"),"inCreateMode":!this.model.get("id")}},"constructor":function(e){n.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this,"render",this._createNodeTypeIcon).listenTo(this,"before:render",this._destroyNodeTypeIcon).listenTo(this,"before:destroy",this._destroyNodeTypeIcon).listenTo(this.model,"update:thumbnail",this.updateThumbnailImage).listenTo(this.model,"update:default:thumbnail",this.updateDefaultThumbnailImage)},"showGalleryView":function(e){13!==e.keyCode&&32!==e.keyCode||this.showThumbCarousel(e)},"showThumbCarousel":function(e){var i=this,s=!1;if((s=o.isSafari()||o.isMSBrowser()||o.isAppleMobile()?this.model.get("mime_type")&&(this.model.get("mime_type").match(/^image\/*[-.\w\s]*$/g)||this.model.get("mime_type").match(/^video\/(mp4|mov)$/g)):this.model.get("mime_type")&&(this.model.get("mime_type").match(/^image\/*[-.\w\s]*$/g)||this.model.get("mime_type").match(/^video\/(mp4|webm|ogg|mov)$/g)))&&s.length>0){this.options.originatingView.blockingView.enable();var n=t.filter(i.model.collection.models,function(e){return o.isSafari()||o.isMSBrowser()||o.isAppleMobile()?e.get("mime_type")&&(e.get("mime_type").match(/^image\/*[-.\w\s]*$/g)||e.get("mime_type").match(/^video\/(mp4|mov)$/g)):e.get("mime_type")&&(e.get("mime_type").match(/^image\/*[-.\w\s]*$/g)||e.get("mime_type").match(/^video\/(mp4|webm|ogg|mov)$/g))},this);this.fetchGalleryImageURL(n);var r=[],l=0;i.thumbNailCollection=n,t.each(n,function(e,t){var s={"name":e.get("name"),"contentURL":e.contentURL?e.contentURL:e.thumbnail?e.thumbnail.url:"","thumbnailURL":e.thumbnail&&e.thumbnail.url?e.thumbnail.url:e.contentURL?e.contentURL:"","id":e.cid,"index":t,"activeItem":e.get("id")===i.model.get("id"),"downloadItem":i.downloadItem.bind(null,e),"updateScroll":i.updateScroll.bind(null,i),"isVideo":e.get("mime_type").match(/^video\/*[-.\w\s]*$/g),"videoType":e.get("mime_type"),"model":e,"videoNotSupportMsg":c.videoNotSupportMsg,"originalAvailable":!!e.contentURL};e.get("id")===i.model.get("id")&&(l=t),r.push(s)},i);var a=h.createGalleryContainer(r,l,c),u=new C({"el":a[0]}),p=new d({"title":"","headerView":"","view":u,"className":"csui-thumbcarousel-dialog","userClassName":"","largeSize":!0});p.show(),p.headerView.$el.find(".cs-icon-cross").removeClass("cs-icon-cross").addClass("icon-close-gallery"),p.headerView.$el.bind("keydown",t.bind(this.handleShiftKey,this)),i.options.originatingView.blockingView.disable(),i.galleryView=u}else!this.model.get("inactive")&&this.model.get("id")&&this.trigger("execute:defaultAction",e)},"handleShiftKey":function(e){e.shiftKey;if(e.shiftKey&&9==e.keyCode){var t=this.thumbNailCollection[this.thumbNailCollection.length-1].cid;setTimeout(function(){i(".binf-filmstrip-item-"+t).focus()},200)}},"downloadItem":function(e,t){(new g).execute({"nodes":new m([e])})},"updateScroll":function(e,t){e.galleryView.updateScrollbar(t)},"fetchOriginalThumbNails":function(e){var t=this,s=e,n=i.Deferred();return t._fetchThumbNailObject(s).done(function(e){n.resolve(e)}).fail(function(e){n.reject(e)}),n.promise()},"_fetchThumbNailObject":function(e){var t=i.Deferred(),s=new p({"node":e});return s.load(),this.listenTo(s,"load",function(i){e.thumbnail={},e.thumbnail.url=i.url,e.attributes.thumbnailPreviewAvailable=!0,e.trigger("update:thumbnail",e),t.resolve(e)}).listenTo(s,"error",function(i){e.thumbnail={},e.thumbnail.url=void 0,e.attributes.thumbnailPreviewAvailable=!1,e.trigger("update:default:thumbnail",e),t.reject(e)}),t.promise()},"updateThumbnailImage":function(e){if(e&&e.thumbnail){var t=this.$el.find(".csui-thumbnail-content-icon.thumbnail-"+e.cid);if(t.find(".csui-icon-group").css("background-image","url("+e.thumbnail.url+")"),t.addClass("thumbnailPreview"),i(".binf-filmstrip-item-"+e.cid).length>0){var s=i(".binf-filmstrip-item-"+e.cid).find("img");s.length>0&&s.attr("src",e.thumbnail.url)}}},"updateDefaultThumbnailImage":function(e){if(e&&e.thumbnail&&e.thumbnail.url){var t=this.$el.find(".csui-thumbnail-content-icon.thumbnail-"+e.cid);t.find(".csui-icon-group").css("background-image","url("+e.thumbnail.url+")"),t.find(".csui-icon").addClass("binf-hidden")}},"fetchGalleryImageURL":function(e){var s=this,n=new b({"parallelism":y.parallelism}),o=t.map(e,function(e){var t=i.Deferred();return e.contentURL||n.pending.add({"worker":function(){return s._fetchImageOpenURL(e).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}),t.promise()}}),t.promise(o)});return i.whenAll.apply(i,o)},"_fetchImageOpenURL":function(e){var s=this,n=i.Deferred(),o=f.combine(e.connector.connection.url,"/nodes",e.get("id"),"/content?action=open&suppress_response_codes"),r=e.connector.extendAjaxOptions({"url":o,"dataType":"binary"});if(144===e.get("type")){var l=0,a=!1;i.ajax(r).always(t.bind(function(t,i,o){if(200===o.status){if(e.contentURL=URL.createObjectURL(t),e.addedOriginalImage=!0,e.get("mime_type").match(/^video\/!*[-.\w\s]*$/g)){var r=s.galleryView&&s.galleryView.$el.find(".binf-item-"+e.cid).find("video");r.length>0&&(r.attr("src",e.contentURL),s.galleryView.$el.find(".binf-item-"+e.cid).addClass("csui-item-original"),s.galleryView.$el.find(".binf-item-"+e.cid+" .csui-img-loader").addClass("binf-hidden"))}else{var c=s.galleryView&&s.galleryView.$el.find(".binf-item-"+e.cid),u=c.find(".csui-gallery-thumbnail-icon"),d=c.find(".csui-gallery-original-icon");w.getData(t,function(){var t=this,i=t&&t.exifdata&&t.exifdata.Orientation;l=7===i||8===i?-90:5===i||6===i?90:3===i||4===i?180:0,2!==i&&4!==i&&5!==i&&7!==i||(a=!0),u.length>0&&(d.find("img").attr("src",e.contentURL),d.find("img").addClass("csui-item-original"),d.removeClass("binf-hidden"),u.addClass("binf-hidden"),a&&d.find("img").css({"-webkit-transform":"scaleX(-1)","-moz-transform":"scaleX(-1)","-o-transform":"scaleX(-1)","transform":"scaleX(-1)","filter":"FlipH","-ms-filter":"FlipH"}),d.find("img").css({"-webkit-transform":"rotate("+l+"deg)","-moz-transform":"rotate("+l+"deg)","-ms-transform":"rotate("+l+"deg)","-o-transform":"rotate("+l+"deg)","transform":"rotate("+l+"deg)"}))})}n.resolve()}},this))}return n.promise()},"_createNodeTypeIcon":function(){var e=new r({"node":this.model});this.contentRegion=new n.Region({"el":this.$("> *")}),this.contentRegion.show(e),144!==this.model.get("type")||this.model.thumbnail&&this.model.thumbnail.url?144===this.model.get("type")&&this.model.thumbnail&&this.model.thumbnail.url?this.updateThumbnailImage(this.model):144===this.model.get("type")&&this.model.thumbnail&&!this.model.thumbnail.url&&this.updateDefaultThumbnailImage(this.model):this.fetchOriginalThumbNails(this.model)},"_destroyNodeTypeIcon":function(){this.contentRegion&&(this.contentRegion.empty(),this.contentRegion=null)},"onKeyInView":function(e){13!==e.keyCode&&32!==e.keyCode||this.$el.find("a.csui-thumbnail-content-default-action").click()}}),C=n.View.extend({"constructor":function(e){n.View.prototype.constructor.apply(this,arguments)},"behaviors":{"PerfectScrolling":{"behaviorClass":v,"contentParent":".binf-filmstrip-container","suppressScrollY":!0,"scrollXMarginOffset":2}},"updateScrollbar":function(e){this.trigger("update:scrollbar");var t,i=this.$(this.behaviors.PerfectScrolling.contentParent),s=this.$el.find(".binf-filmstrip-container").scrollLeft();e.offset().left+e.width()>=i.width()?t=e.offset().left-i.width()+s+e.width()+20:e.offset().left<=0&&(t=e.offset().left+s-5),this.$(this.behaviors.PerfectScrolling.contentParent).animate({"scrollLeft":t},"fast")}});return u.registerByKey("thumbnailIcon",_),_}),csui.define("csui/controls/thumbnail/content/overview/overview.content",["csui/lib/underscore","csui/lib/backbone","csui-ext!csui/controls/thumbnail/content/overview/overview.content"],function(e,t,i){var s=t.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),n=t.Collection.extend({"model":s,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new n(this.map(function(e){return e.attributes}))}}),o=[{"key":"type","sequence":2,"defaultAction":!1},{"key":"name","sequence":4,"displayLabel":!0,"defaultAction":!1,"displayIcon":!0},{"key":"properties","title":"properties","sequence":7},{"key":"reserved","sequence":100,"title":"State"}],r=["type","name","properties","reserved","wnd_comments"];i&&e.each(i,function(t){e.each(t,function(e,t){o.push(e)})});var l=new n(o);return l.fixedOrRemovedOverviewContent=r,l}),csui.define("hbs!csui/controls/thumbnail/content/impl/content",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'    <div class="csui-thumbnail-label csui-thumbnail-item-content-label" aria-label="'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'">\r\n      <span>'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+"</span>\r\n    </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="csui-thumbnail-item-content csui-thumbnail-item-content-'+this.escapeExpression((o=null!=(o=t.cid||(null!=e?e.cid:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"cid","hash":{}}):o))+'">\r\n'+(null!=(n=t.if.call(e,null!=e?e.displayLabel:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'  <div class="csui-thumbnail-value csui-thumbnail-item-content-justify-div">\r\n    <p class="csui-thumbnail-item-content-value" title="'+this.escapeExpression((o=null!=(o=t.value||(null!=e?e.value:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+'"\r\n       aria-label="'+this.escapeExpression((o=null!=(o=t.value||(null!=e?e.value:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+'">'+this.escapeExpression((o=null!=(o=t.value||(null!=e?e.value:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"value","hash":{}}):o))+"</p>\r\n  </div>\r\n</div>"}});return i.registerPartial("csui_controls_thumbnail_content_impl_content",s),s}),csui.define("csui/controls/thumbnail/content/content.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","hbs!csui/controls/thumbnail/content/impl/content"],function(e,t,i,s,n){"use strict";return s.ItemView.extend({"template":n,"className":"csui-thumbnail-content-item","templateHelpers":function(){var e=this.options.contentModel,t=e.get("name"),i=e.get("key");return{"value":this.model.get(i),"displayLabel":this.options.displayLabel,"label":this.options.displayLabel?t:"","cid":this.model.cid}},"constructor":function(e){e||(e={}),s.ItemView.prototype.constructor.apply(this,arguments)}})}),csui.define("hbs!csui/controls/thumbnail/content/properties/impl/properties",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-thumbnail-properties">\r\n  <button type="button" class="csui-btn-metadata binf-btn" title="'+this.escapeExpression((n=null!=(n=t.propertiesTitle||(null!=e?e.propertiesTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"propertiesTitle","hash":{}}):n))+'"><span\r\n    class="icon icon-toolbar-metadata"></span></button>\r\n</div>'}});return i.registerPartial("csui_controls_thumbnail_content_properties_impl_properties",s),s}),csui.define("csui/controls/thumbnail/content/properties/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/properties/impl/nls/root/localized.strings",{"propertiesTitle":"Properties"}),csui.define("csui/controls/thumbnail/content/properties/properties.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/controls/thumbnail/content/content.registry","csui/utils/commands/properties","csui/models/nodes","hbs!csui/controls/thumbnail/content/properties/impl/properties","i18n!csui/controls/thumbnail/content/properties/impl/nls/localized.strings"],function(e,t,i,s,n,o,r,l){"use strict";var a=i.LayoutView.extend({"template":r,"templateHelpers":function(){return{"propertiesTitle":l.propertiesTitle}},"className":"csui-thumbnail-properties-container","regions":{"propertiesRegion":".csui-thumbnail-properties"},"events":{"click .csui-btn-metadata":"showMetadataForm"},"constructor":function(e){e||(e={}),i.LayoutView.prototype.constructor.call(this,e)},"showMetadataForm":function(i){var s=new o([this.model]),r={"nodes":s,"data":{},"container":this.options.collection.node,"context":this.options.context,"collection":this.options.collection,"showThumbnails":!0};r=t.extend(r,{"originatingView":this.options.originatingView}),(new n).execute(r,this.options).always(function(t){e("body").addClass("csui-apply-zero-zindex")}),e("body").removeClass("csui-apply-zero-zindex")},"cancel":function(e){e||(e={}),this.destroy()}});return s.registerByKey("properties",a),a}),csui.define("hbs!csui/controls/thumbnail/content/overview/impl/properties.overview",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <div class="csui-thumbnail-properties csui-thumbnail-overview-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.attributes:e)?n.key:n,e))+'"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-thumbnail-properties csui-thumbnail-overview-name"></div>\r\n<div class="csui-thumbnail-metadata-container">\r\n'+(null!=(n=t.each.call(e,null!=e?e.columns:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'</div>\r\n<div class="csui-thumbnail-properties-actions">\r\n  <div class="csui-thumbnail-properties csui-thumbnail-overview-properties"></div>\r\n  <div class="csui-thumbnail-properties csui-thumbnail-overview-reserved"></div>\r\n</div>'}});return i.registerPartial("csui_controls_thumbnail_content_overview_impl_properties.overview",s),s}),csui.define("csui/controls/thumbnail/content/overview/properties.overview",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/thumbnail/content/overview/overview.content","csui/controls/thumbnail/content/content.view","csui/controls/thumbnail/content/name/name.view","csui/controls/thumbnail/content/properties/properties.view","csui/controls/thumbnail/content/node.state/node.state.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","hbs!csui/controls/thumbnail/content/overview/impl/properties.overview"],function(e,t,i,s,n,o,r,l,a,c,u,d){"use strict";return n.LayoutView.extend({"className":"csui-overview-container","template":d,"templateHelpers":function(){return{"columns":this.columnModels}},"regions":{"nameRegion":".csui-thumbnail-overview-name","propertiesRegion":".csui-thumbnail-overview-properties","nodeStateRegion":".csui-thumbnail-overview-reserved"},"events":{"keydown":"onKeyInView"},"behaviors":{"PerfectScrolling":{"behaviorClass":u,"contentParent":".csui-thumbnail-metadata-container","suppressScrollX":!0,"scrollYMarginOffset":15}},"initialize":function(){this.propertiesCollection=this.getColumns();var e=this,i=[];this.propertiesCollection&&this.propertiesCollection.models&&t.each(this.propertiesCollection.models,function(t,s){var n=t.get("key");e.model.get(n)&&i.push(t)}),this.columnModels=i},"constructor":function(e){e||(e={}),this.options=e,n.LayoutView.prototype.constructor.call(this,e);var i=this;this.columnModels&&t.each(this.columnModels,function(t,s){var n=t.get("key");e.ContentFactory.getContentView(t);i.addRegion(n,".csui-thumbnail-overview-"+n)},this)},"getColumns":function(){var e,i=this;if(o&&o.models){this.fixedContent=o.fixedOrRemovedOverviewContent,e=o.deepClone(),e.remove(e.findWhere({"key":"properties"}));var s,n,r={};this.options.columns.each(function(o){var l=o.get("column_key"),a=(o.get("name"),o.get("definitions_order"));if(!0===o.get("isNaming")&&(n=l,o.unset("isNaming",{"silent":!0})),r[l]=o,o.get("type")&&a){var c=e.findWhere({"key":l});if(c){!0===c.get("isNaming")&&(s=c.get("key"));var u=c.get("sequence"),d=t.extend({"sequence":u},o.attributes);c.set(d)}else o.attributes.sequence=a,e.add(o.attributes)}i.fixedContent.indexOf(l)>=0&&e.remove(e.findWhere({"key":l}))},this)}return e},"currentlyFocusedElement":function(e){return this.$el.find(":focusable")[0]},"onKeyInView":function(e){if(e&&27===e.keyCode){e.preventDefault(),e.stopPropagation();this.$el.parents("body").find(".binf-popover").parent().click()}},"onRender":function(e){var i=this,s=new l({"model":i.model,"context":i.options.context,"column":{"name":"name","defaultAction":!1},"displayIcon":!0});this.nameRegion.show(s),this.columnModels&&t.each(this.columnModels,function(e,t){var s=this.options.ContentFactory.getContentView(e);if(s=s||r){var n=e.get("key"),o=e.get("defaultAction"),l=e.get("displayIcon"),a=e.get("key"),c=new s({"tagName":"DIV","contentModel":e,"model":i.model,"context":i.options.context,"column":{"name":a,"defaultAction":o},"displayLabel":!0,"displayIcon":l});i[n].show(c),c.$el.find(".csui-thumbnail-value p").length>0&&""===c.$el.find(".csui-thumbnail-value p")[0].innerHTML&&c.$el.parent().addClass("binf-hidden"),i.listenTo(c,"clicked:content",function(e){i.trigger("clicked:content",{"contentView":c,"rowIndex":i._index,"colIndex":t,"model":i.model})})}},this);var n=new a({"model":i.model,"context":i.options.context,"column":{"name":"properties","defaultAction":!0},"displayIcon":!0,"selectedChildren":i.options.selectedChildren,"collection":i.options.collection,"originatingView":i.options.originatingView});this.propertiesRegion.show(n);var o=new c({"model":i.model,"context":i.options.context,"column":{"name":"reserved","defaultAction":!0},"displayTitle":!1,"selectedChildren":i.options.selectedChildren,"collection":i.options.collection,"originatingView":i.options.originatingView,"targetView":this});this.nodeStateRegion.show(o)}})}),csui.define("csui/controls/thumbnail/content/overview/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/thumbnail/content/overview/impl/nls/root/localized.strings",{"ColumnTitle":"Metadata","Modified":"Modified","Size":"Size"}),csui.define("hbs!csui/controls/thumbnail/content/overview/impl/overview",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'tabindex="0"\r\n        '},"3":function(e,t,i,s){return'tabindex="-1"'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<button type="button" class="csui-thumbnail-overview-icon" title="'+this.escapeExpression((o=null!=(o=t.overViewTitle||(null!=e?e.overViewTitle:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"overViewTitle","hash":{}}):o))+'"\r\n        aria-haspopup="dialog" aria-label="'+this.escapeExpression((o=null!=(o=t.overViewTitle||(null!=e?e.overViewTitle:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"overViewTitle","hash":{}}):o))+'" '+(null!=(n=t.if.call(e,null!=e?e.focusable:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'>\r\n  <span class="icon icon-thumbnail-metadata-overview"></span>\r\n</button>'}});return i.registerPartial("csui_controls_thumbnail_content_overview_impl_overview",s),s}),csui.define("css!csui/controls/thumbnail/content/overview/impl/overview",[],function(){}),csui.define("csui/controls/thumbnail/content/overview/overview.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/thumbnail/content/content.registry","csui/controls/thumbnail/content/content.factory","csui/controls/thumbnail/content/overview/properties.overview","csui/controls/mixins/keyboard.navigation/modal.keyboard.navigation.mixin","csui/utils/base","i18n","i18n!csui/controls/thumbnail/content/overview/impl/nls/localized.strings","hbs!csui/controls/thumbnail/content/overview/impl/overview","css!csui/controls/thumbnail/content/overview/impl/overview"],function(e,t,i,s,n,o,r,l,a,c,u,d){"use strict";var h=s.LayoutView.extend({"className":"csui-thumbnail-overview-container","template":d,"constructor":function(e){e||(e={}),s.LayoutView.prototype.constructor.call(this,e),t.defaults(e,{"formPopoverPlacement":"right"}),this.options=e},"templateHelpers":function(){return{"overViewTitle":u.ColumnTitle,"focusable":this.options.focusable||!0}},"events":{"keydown":"onKeyInView","click .csui-thumbnail-overview-icon":"_showPopover"},"onKeyInView":function(e){if(32===e.keyCode||13===e.keyCode){if(this.$el.find(".binf-popover").length>0)return void e.stopPropagation();e.preventDefault(),e.stopPropagation(),this._showPopover()}else 27===e.keyCode&&this.$el.find(".binf-popover").length>0&&(e.preventDefault(),e.stopPropagation(),this._closePopover())},"_capturePreviousFocusElement":function(){this._previousFocusElm=document.activeElement},"_restorePreviousFocusAfterClosingPopover":function(){if(this._previousFocusElm){var t=e(this._previousFocusElm);t.hasClass("csui-thumbnail-overview-icon")?this.$el.find("button.csui-thumbnail-overview-icon").focus():t.focus(),this._previousFocusElm=void 0}},"_showPopover":function(i){var s=this;if(!(this.$el.find(".binf-popover").length>0)){this._capturePreviousFocusElement();var n=this.options.formPopoverPlacement;c&&c.settings.rtl&&(this.rtl=!0),this.propertiesOverview=new r({"model":this.model,"context":this.options.context,"ContentFactory":this.options.ContentFactory,"originatingView":this.options.originatingView,"selectedChildren":this.options.selectedChildren,"collection":this.options.collection,"columns":this.options.columns}),this.propertiesOverview.render(),this.$popoverEl=this.$el.find(".csui-thumbnail-overview-icon"),this._previousTitle=this.$popoverEl.attr("title"),this.$popoverEl.attr("title","");this.$popoverEl.offset().left/e(window).width()*100>80&&(this.plcamentChanged=!0,n="right"===n?"left":"right"),this.$popoverEl.binf_popover({"content":t.bind(function(){return this.propertiesOverview.el},this),"html":!0,"placement":function(e,t){return n},"trigger":"manual"}),this.$popoverEl.binf_popover("show"),this.propertiesOverview.trigger("dom:refresh"),this.engageModalKeyboardFocusOnOpen(this.propertiesOverview.el),this.$popoverEl.on("shown.binf.popover",t.bind(function(t){e(document).on("click.popover",{"view":this},this._handleClickEvent),this.scrollEle=this.$el.closest(".csui-thumbnail-results"),this.scrollEle.on("scroll.popover",{"view":this},this._handleScrollEvent),s.onShowOverviewFlyout(t),s.triggerMethod("shown:overview:flyout"),this.propertiesOverview&&this.propertiesOverview.currentlyFocusedElement().focus()},this))}},"onShowOverviewFlyout":function(t){var i,n=this.$el,o=this.$el.parent().find(".binf-popover"),r=o.find(".binf-arrow"),l=parseInt(r.css("top")),c=(parseInt(r.css("height")),0===r.outerWidth()||r.outerWidth(),this.$el.closest(".csui-thumbnail-results")),u=c.closest(".ps-container").length>0?c.closest(".ps-container"):c.closest(".csui-normal-scrolling"),d=o.find(".csui-thumbnail-metadata-container"),h=o.find(".csui-thumbnail-overview-name"),p=o.find(".csui-thumbnail-properties-actions"),m=d.height()>window.innerHeight?window.innerHeight-(h.height()+p.height()+100):window.innerHeight<d.height()+h.height()+p.height()+100?d.height()-100:d.height();d.css({"height":m}),i=a.isIE11()?n.offset().top-parseInt(r.css("top"))+12:n.offset().top-(e("nav.csui-navbar").innerHeight()+e("#breadcrumb-wrap").innerHeight()+parseInt(r.css("top")))+11;var f=e(".cs-perspective-panel"),b=f.length>0?f[0].getBoundingClientRect().top:0;a.isIE11()&&i<b+e("#breadcrumb-wrap").innerHeight()&&(i=n.offset().top-(e("nav.csui-navbar").innerHeight()+e("#breadcrumb-wrap").innerHeight())+12,l=n.offset().top-i+12,r.css("top",l)),i<b&&!a.isIE11()&&(i=0,l=n.offset().top-(e("nav.csui-navbar").innerHeight()+e("#breadcrumb-wrap").innerHeight())+11,r.css("top",l)),o.css({"position":"fixed","top":i}),a.isTouchBrowser()&&u.css({"-webkit-overflow-scrolling":"auto"});var g;g=this.plcamentChanged?n.offset().left-o.outerWidth():n.offset().left+n.width(),o.css({"right":"auto","left":g}),this._adjustFlyOut();e(window).height(),o.offset().top,o.innerHeight(),parseInt(r.css("top")),n.offset().top;s.triggerMethodOn(this,"dom:refresh",this),n.focus()},"_adjustFlyOut":function(){this.propertiesOverview.trigger("update:scrollbar")
;var t=this.$el.closest(".csui-thumbnail-results"),i=e(window).height(),s=e("nav.csui-navbar").innerHeight()/2;this.currentNavbarIndex=e("nav.csui-navbar").css("z-index"),this.currentBreadcrumbIndex=e("#breadcrumb-wrap").css("z-index"),this.$el.height()>i&&this.$el.height(i-s),e("body").addClass("csui-apply-zero-zindex");var n=t.closest(".ps-container").length>0?t.closest(".ps-container"):t.closest(".csui-normal-scrolling");return e(n).on("scroll",function(){e(this).data("binf.popover")&&(e(this).binf_popover("destroy"),e("body").removeClass("csui-apply-zero-zindex"))}),!1},"_closePopover":function(){this.disengageModalKeyboardFocusOnClose(),this.$popoverEl.binf_popover("destroy"),this._previousTitle&&(this.$popoverEl.attr("title",this._previousTitle),this._previousTitle=void 0),e(document).off("click.popover",this._handleClickEvent),this.scrollEle.off("scroll.popover",this._handleScrollEvent),e("body").removeClass("csui-apply-zero-zindex"),this.triggerMethod("hide:overview:flyout"),this._restorePreviousFocusAfterClosingPopover()},"_handleClickEvent":function(t){if(!e(t.target).closest(".binf-popover").length){var i=t.data.view;e(document).off("click.popover",this._handleClickEvent),i._closePopover()}},"_handleScrollEvent":function(t){var i=t.data.view;e(t.target).closest(".binf-popover").length||(i.scrollEle.off("scroll.popover",i._handleScrollEvent),i&&i._closePopover())}});return n.registerByKey("overview",h),l.mixin(h.prototype),h}),csui.define("csui/controls/thumbnail/content/content.factory",["csui/lib/underscore","csui/controls/thumbnail/content/content.registry","csui/controls/thumbnail/content/favorite/favorite.view","csui/controls/thumbnail/content/node.state/node.state.view","csui/controls/thumbnail/content/name/name.view","csui/controls/thumbnail/content/member/member.view","csui/controls/thumbnail/content/size/size.view","csui/controls/thumbnail/content/select/select.view","csui/controls/thumbnail/content/date/date.view","csui/controls/thumbnail/content/thumbnail.icon/thumbnail.icon.view","csui/controls/thumbnail/content/overview/overview.view","csui/controls/thumbnail/content/properties/properties.view","csui-ext!csui/controls/thumbnail/content/content.factory"],function(e,t){function i(){}return e.extend(i.prototype,{"getContentView":function(e){return t.getContentView(e)}}),new i}),csui.define("csui/controls/thumbnail/thumbnail.content",["csui/lib/underscore","csui/lib/backbone","csui-ext!csui/controls/thumbnail/thumbnail.content"],function(e,t,i){var s=t.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),n=t.Collection.extend({"model":s,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new n(this.map(function(e){return e.attributes}))}}),o=[{"key":"name","sequence":4,"defaultAction":!0},{"key":"reserved","sequence":5,"displayTitle":!0,"title":"State"},{"key":"wnd_comments","sequence":900},{"key":"favorite","sequence":910},{"key":"overview","sequence":920,"showoverview":!0}];return i&&e.each(i,function(t){e.each(t,function(e,t){e.push(e)})}),new n(o)}),csui.define("hbs!csui/controls/thumbnail/impl/thumbnail.header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'      <div class="csui-selected-checkbox csui-checkbox-primary csui-checkbox-selectAll">\r\n        <input class="csui-selectAll-input" type="checkbox" disabled="" title="'+this.escapeExpression((n=null!=(n=t.selectAllTitle||(null!=e?e.selectAllTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"selectAllTitle","hash":{}}):n))+'" tabindex="-1">\r\n        <div class="csui-selectAll-header csui-selectlabel"></div>\r\n        <span>'+this.escapeExpression((n=null!=(n=t.selectAll||(null!=e?e.selectAll:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"selectAll","hash":{}}):n))+"</span>\r\n      </div>\r\n"},"3":function(e,t,i,s){var n;return'      <div class="csui-selected-checkbox csui-checkbox-primary csui-checkbox-selectAll">\r\n        <input class="csui-selectAll-input" type="checkbox" title="'+this.escapeExpression((n=null!=(n=t.selectAllTitle||(null!=e?e.selectAllTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"selectAllTitle","hash":{}}):n))+'" tabindex="-1">\r\n        <div class="csui-selectAll-header csui-selectlabel"></div>\r\n        <span>'+this.escapeExpression((n=null!=(n=t.selectAll||(null!=e?e.selectAll:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"selectAll","hash":{}}):n))+"</span>\r\n      </div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<div class="csui-thumbnail-header-data">\r\n  <div class="csui-thumbnail-select">\r\n'+(null!=(n=t.if.call(e,null!=e?e.isEmptyNode:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'  </div>\r\n  <div class="csui-thumbnail-itemcount">'+this.escapeExpression((o=null!=(o=t.items||(null!=e?e.items:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"items","hash":{}}):o))+'</div>\r\n  <div class="csui-thumbnail-sort-search-container">\r\n    <div id="csui-sorting-container" class="csui-sorting-container"></div>\r\n    <div id="csui-thumbnail-column-search" class="csui-thumbnail-column-search"></div>\r\n  </div>\r\n</div>'}});return i.registerPartial("csui_controls_thumbnail_impl_thumbnail.header",s),s}),csui.define("hbs!csui/controls/thumbnail/impl/thumbnail.item",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return" csui-checkbox "},"3":function(e,t,i,s){var n;return'    <div class="csui-thumbnail-content csui-thumbnail-'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.attributes:e)?n.key:n,e))+'"></div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-thumbnail-item-container">\r\n<div class="csui-thumbnail-icon-container">\r\n  <div class="csui-thumbnail-select '+(null!=(n=t.if.call(e,null!=e?e.isChecked:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+'"></div>\r\n  <div class="csui-thumbnail-actionbar"></div>\r\n  <div class="csui-thumbnail-thumbnailIcon"></div>\r\n</div>\r\n<div class="csui-thumbnail-content-container">\r\n'+(null!=(n=t.each.call(e,null!=e?e.columns:e,{"name":"each","hash":{},"fn":this.program(3,s,0),"inverse":this.noop}))?n:"")+"</div>\r\n</div>"}});return i.registerPartial("csui_controls_thumbnail_impl_thumbnail.item",s),s}),csui.define("hbs!csui/controls/thumbnail/impl/thumbnail",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div id="csui-thumbnail-header" class="csui-thumbnail-header"></div>\r\n<div id="csui-thumbnail-results" class="csui-thumbnail-results"></div>'}});return i.registerPartial("csui_controls_thumbnail_impl_thumbnail",s),s}),csui.define("hbs!csui/controls/thumbnail/impl/empty.thumbnail",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return"<p class='csui-no-result-message' title=\""+this.escapeExpression((n=null!=(n=t.noResults||(null!=e?e.noResults:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"noResults","hash":{}}):n))+'">\r\n  '+this.escapeExpression((n=null!=(n=t.noResults||(null!=e?e.noResults:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"noResults","hash":{}}):n))+"\r\n</p>\r\n"}});return i.registerPartial("csui_controls_thumbnail_impl_empty.thumbnail",s),s}),csui.define("css!csui/controls/thumbnail/thumbnail",[],function(){}),csui.define("csui/controls/thumbnail/thumbnail.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/utils/commands","csui/behaviors/default.action/default.action.behavior","csui/behaviors/default.action/impl/defaultaction","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/thumbnail/impl/metadata/thumbnail.metadata.view","csui/controls/thumbnail/impl/sort/sort.view","csui/controls/thumbnail/content/content.factory","csui/controls/thumbnail/thumbnail.content","csui/controls/thumbnail/content/thumbnail.icon/thumbnail.icon.view","csui/controls/thumbnail/content/select/select.view","csui/controls/table/cells/searchbox/searchbox.view","csui/controls/tableactionbar/tableactionbar.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/progressblocker/blocker","hbs!csui/controls/thumbnail/impl/thumbnail.header","hbs!csui/controls/thumbnail/impl/thumbnail.item","hbs!csui/controls/thumbnail/impl/thumbnail","hbs!csui/controls/thumbnail/impl/empty.thumbnail","i18n!csui/controls/thumbnail/impl/nls/lang","css!csui/controls/thumbnail/thumbnail","csui/lib/jquery.mousehover"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b,g,v,w,y,_,C,T,x,S){"use strict";var I=(t.extend({},e.config()),n.ItemView.extend({"className":"csui-thumbnail-empty","template":x,"templateHelpers":function(){return{"noResults":this.options.isFilterApplied||-1!==[298,899].indexOf(this._parent.collection.node.get("type"))?S.noResults:S.dragAndDropMessage}},"constructor":function(e){n.ItemView.prototype.constructor.apply(this,arguments)},"onRender":function(){this.options.$parentEl.addClass("csui-thumbnail-empty")},"onShow":function(){this.$el.addClass("icon-thumbnail-empty-page")},"onDestroy":function(){this.options.$parentEl.removeClass("csui-thumbnail-empty")}})),k=n.LayoutView.extend({"className":function(){var e="csui-thumbnail-item csui-thumbnail-item-"+this.model.cid;return this.model.inlineFormView&&(e+=" csui-thumbnail-item-form"),e},"template":C,"templateHelpers":function(){return{"columns":m.models,"isChecked":this.options.thumbnailView.collection.itemchecked}},"regions":{"selectContentRegion":".csui-thumbnail-select","thumbnailIconRegion":".csui-thumbnail-thumbnailIcon"},"initialize":function(){var e=this;m&&m.models&&t.each(m.models,function(t,i){if(p.getContentView(t)){var s=t.get("key");e.addRegion(s,".csui-thumbnail-"+s)}},this),!o.isTouchBrowser()&&this.options.showInlineToolbar&&this._subscribeEventHandlers(),this.model.set("inactive",!this.options.thumbnailView.checkModelHasAction(this.model),{"silent":!0}),e.ContentFactory=p},"constructor":function(e){e||(e={}),n.LayoutView.prototype.constructor.call(this,e),this.listenTo(this.model,"sync",this.render)},"_subscribeEventHandlers":function(){this.$el&&this.$el.mousehover(this.showInlineActions.bind(this),this.hideInlineActions.bind(this),{"namespace":this.cid})},"_unsubscribeEventHandlers":function(){this._isRendered&&this.$el.mousehover("off",{"namespace":this.cid})},"showInlineActions":function(e){if(0===this.$el.find(".csui-inlineform-group").length){var t=this.$el.find(".csui-thumbnail-actionbar");if(t.length>0&&!this.options.originatingView.lockedForOtherContols){var i=this,s={"sender":i,"target":t,"model":i.model};i.trigger("mouseenter:row",s)}}else this.$el.find(".csui-thumbnail-select").css({"display":"none"})},"hideInlineActions":function(e){var t=this.$el.find(".csui-thumbnail-actionbar");if(t.length>0){var i=this,s={"sender":i,"target":t,"model":i.model};i.trigger("mouseleave:row",s)}},"onRender":function(e){var i=this;i.model.isLocallyCreated&&!i.model.inlineFormView&&this.$el.find(".csui-thumbnail-content-container").addClass("csui-new-item"),this.selectContentView=new b({"tagName":"div","model":this.options.model,"thumbnailView":this.options.thumbnailView,"events":function(){return o.isFirefox()?t.extend({},b.prototype.events,{"keydown":i.onKeyInView}):b.prototype.events}}),this.selectContentRegion.show(this.selectContentView),this.options.model.get("csuiIsSelected")&&(this.selectContentRegion.$el.addClass("csui-checkbox"),this.$el.addClass("csui-thumbnail-item-selected")),this.options.model.get(b.isSelectedModelAttributeName)&&this.$el.addClass("csui-thumbnail-item-selected"),i.listenTo(this.selectContentView,"clicked:checkbox",function(e){if(this.options.thumbnailView.activeInlineForm&&e.checked&&this.options.thumbnailView.cancelAnyExistingInlineForm(),i.showToolBarActions(e),e.checked)this.options.thumbnailView.resultsView.inlineToolbarView&&this.options.thumbnailView.resultsView.inlineToolbarView.destroy(),i._parent.$el.find(".csui-thumbnail-select").addClass("csui-checkbox"),i.$el.addClass("csui-thumbnail-item-selected"),i.model.set(b.isSelectedModelAttributeName,!0),i.model.attributes.isSelected=!0;else{i.$el.removeClass("csui-thumbnail-item-selected"),i.model.set(b.isSelectedModelAttributeName,!1),i.model.attributes.isSelected=!1;var s=0;t.each(i._parent.collection.models,function(e){e.attributes.csuiIsSelected&&s++}),(0===s||i.model.get("selectAllThumbnailsEnabled")&&0===s)&&(i._parent.$el.find(".csui-thumbnail-select").removeClass("csui-checkbox"),i.$el.removeClass("csui-thumbnail-item-selected"))}this.options.thumbnailHeaderView.trigger("selectOrUnselect.mixed")}),this.thumbnailIconView=new f({"model":this.options.model,"context":this.options.context,"column":{"defaultAction":!0},"originatingView":this.options.originatingView}),this.thumbnailIconRegion.show(this.thumbnailIconView),this.listenTo(this.thumbnailIconView,"execute:defaultAction",function(e){e.preventDefault(),e.stopPropagation(),i.options.thumbnailView.trigger("execute:defaultAction",i.model)}),m&&m.models&&t.each(m.models,function(e,t){var s=p.getContentView(e);if(s){var n=e.get("key"),o=e.get("defaultAction"),r=e.get("showoverview")?p:void 0,l=e.get("key"),a=new s({"tagName":"DIV","model":i.model,"context":i.options.context,"column":{"name":l,"defaultAction":o},"ContentFactory":r,"displayLabel":e.get("displayLabel"),"displayTitle":e.get("displayTitle"),"displayIcon":!0,"originatingView":i.options.originatingView,"selectedChildren":this.options.thumbnailView.options.selectedChildren,"collection":this.options.thumbnailView.options.collection,"columns":this.options.columns});i.model.collection=this.options.thumbnailView.options.collection,i[n].show(a),i.listenTo(a,"clicked:content",function(e){i.trigger("clicked:content",{"contentView":a,"rowIndex":i._index,"colIndex":t,"model":i.model})}),i.listenTo(a,"execute:defaultAction",function(e){e.preventDefault(),e.stopPropagation(),i.options.thumbnailView.trigger("execute:defaultAction",i.model)}),i.listenTo(a,"show:add:favorite:form",function(){i.hideInlineActions(),i.options.originatingView.lockedForOtherContols=!0}),i.listenTo(a,"close:add:favorite:form",function(){i.options.originatingView.lockedForOtherContols=!1}),i.listenTo(a,"shown:overview:flyout",function(){i.hideInlineActions(),i.options.originatingView.lockedForOtherContols=!0}),i.listenTo(a,"hide:overview:flyout",function(){i.options.originatingView.lockedForOtherContols=!1})}},this)},"showToolBarActions":function(e){var t=this;e.checked?(t.model.set(b.isSelectedModelAttributeName,!0,{"silent":!0}),t.model.attributes.isSelected=!0):(this._subscribeEventHandlers(),t.model.set(b.isSelectedModelAttributeName,!1,{"silent":!0}),t.model.attributes.isSelected=!1),this.options.thumbnailView.showToolBarActions()},"getSelectedChildren":function(){return this.model.collection.where({"csuiIsSelected":!0})}}),V=n.CollectionView.extend({"className":"csui-thumbnail-collection","childView":k,"childViewOptions":function(){return{"context":this.options.context,"showInlineToolbar":this.showInlineToolbar,"toolbarItems":this.options.inlineBar.options.collection,"toolbarItemsMasks":this.options.inlineBar.options.toolItemsMask,"originatingView":this.options.originatingView,"thumbnailView":this.options.thumbnailView,"thumbnailHeaderView":this.options.thumbnailHeaderView,"tableColumns":this.options.tableColumns,"columns":this.options.columns}},"childEvents":{"mouseenter:row":"onChildShowInlineActionBarWithDelay","mouseleave:row":"onChildActionBarShouldDestroy"},"emptyView":I,"emptyViewOptions":function(){return{"isFilterApplied":t.some(this.collection.filters,function(e){return e&&e.trim().length>0}),"$parentEl":this.$el,"model":this.emptyModel}},"behaviors":{"DefaultAction":{"behaviorClass":l}},"constructor":function(e){e||(e={}),this.context=e.context,n.CollectionView.prototype.constructor.apply(this,arguments),this.showInlineToolbar=this.options.inlineBar.options.collection&&this.options.inlineBar.options.toolItemsMask,this.showInlineToolbar&&this.setInlineActionBarEvents(),i(window).bind("resize",t.bind(this._adjustThumbnailWidth,this))},"setInlineActionBarEvents":function(){this.listenTo(this,"closeOther",this._destroyInlineActionBar),this.listenTo(this.collection,"reset",this._destroyInlineActionBar)},"_destroyInlineActionBar":function(){this.inlineToolbarView&&(this.inlineToolbarView.destroy(),this.inlineToolbarView=void 0)},"_showInlineActionBar":function(e){this.inlineToolbarView?this._savedHoverEnterArgs=e:e&&(this._savedHoverEnterArgs=null,this.inlineToolbarView=new v(t.extend({"context":this.options.context,"commands":r,"collection":this.options.inlineBar.options.collection,"toolItemsMask":this.options.inlineBar.options.toolItemsMask,"originatingView":this.options.originatingView,"model":e.model,"status":{"targetView":e.sender,"connector":this.options.collection.connector}},this.options.inlineBar.options)),this.listenTo(this.inlineToolbarView,"before:execute:command",function(e){this.lockedForOtherContols=!0,e&&e.status&&e.status.targetView&&e.status.targetView.$el&&e.status.targetView.$el.addClass("active-row"),this._destroyInlineActionBar()}),this.listenTo(this.inlineToolbarView,"after:execute:command",function(e){this.lockedForOtherContols=!1,e&&e.status&&e.status.targetView&&e.status.targetView.$el&&e.status.targetView.$el.removeClass("active-row")}),this.options.originatingView&&(this.listenTo(this.options.originatingView,"block:view:actions",function(){this.lockedForOtherContols=!0,this._destroyInlineActionBar()}),this.listenTo(this.options.originatingView,"unblock:view:actions",function(){this.lockedForOtherContols=!1})),this.inlineToolbarView.render(),this.listenTo(this.inlineToolbarView,"destroy",function(){this.inlineToolbarView=void 0,this._savedHoverEnterArgs&&this.onChildShowInlineActionBarWithDelay(this._savedHoverEnterArgs)},this),i(e.target).append(this.inlineToolbarView.$el),this.inlineToolbarView.triggerMethod("show"))},"onChildShowInlineActionBarWithDelay":function(e,t){this._showInlineActionbarTimeout&&clearTimeout(this._showInlineActionbarTimeout);var i=this;i.isSelected=i.collection.where({"csuiIsSelected":!0}).length>0,i._showInlineActionbarTimeout=setTimeout(function(){i._showInlineActionbarTimeout=void 0,i.lockedForOtherContols=i.options.thumbnailView&&i.options.thumbnailView.lockedForOtherContols,i.lockedForOtherContols||i.isSelected||!i.isSelected&&i._showInlineActionBar.call(i,t)},200)},"onChildActionBarShouldDestroy":function(e,t){this._showInlineActionbarTimeout&&(clearTimeout(this._showInlineActionbarTimeout),this._showInlineActionbarTimeout=void 0),this.inlineToolbarView&&this.inlineToolbarView.destroy()},"showOrHideZeroRecordsMessage":function(){if(this.$el.find("div.csui-thumbnail-empty").remove(),0===this.collection.length){this.$el.addClass("csui-thumbnail-empty");var e,t="";this._showingEmptyView&&(e=this.collection.node.get("container")&&-1!==[298,899].indexOf(this.collection.node.get("type"))&&S.noResults,t=this.collection.filters&&this.collection.filters.name?S.noResults:S.dragAndDropMessage,t=e||t);var s=i("<div class='csui-thumbnail-empty  icon-thumbnail-empty-page'><p class='csui-no-result-message' title='"+t+"'>"+t+"</p></div>");this.$el.append(s)}else this.$el.removeClass("csui-thumbnail-empty"),this.$el.removeClass("icon-thumbnail-empty-page")},"onRender":function(){this.showOrHideZeroRecordsMessage(),this._adjustThumbnailWidth()},"_adjustThumbnailWidth":function(){for(var e=this.$el.find(".csui-thumbnail-item"),t=i(".csui-table-facetview .csui-facet-panel").length>0?i(".csui-facet-table-container").width()-i(".csui-table-facetview").width():i(".cs-thumbnail-wrapper").width(),s=190/t*100,n=1;n<=e.length;n++){if(n*s>100){n-=1,s=100/n;break}}e.css({"maxWidth":"calc("+s+"% - 4px)","minWidth":"calc("+s+"% - 4px)"})}}),A=n.LayoutView.extend({"className":"csui-thumbnail-header","tagName":"div","regions":{"sortRegion":"#csui-sorting-container","searchRegion":"#csui-thumbnail-column-search"},"behaviors":{"TabableRegion":{"behaviorClass":u,"initialActivationWeight":100}},"ui":{"selectAll":".csui-selectAll-input"},"events":{"keydown":"onKeyInView","click @ui.selectAll":"selectAllThumbnails"},"template":_,"templateHelpers":function(){return{"columns":this.options.thumbnailColumns,"addTitle":S.addTitle,"selectAll":S.selectAll,"selectAllTitle":S.selectAllTitle,"isEmptyNode":0===this.collection.models.length,"items":o.formatMessage(this.collection.length,S)}},"constructor":function(e){e||(e={}),n.LayoutView.prototype.constructor.call(this,e),this.columnsWithSearch=e.columnsWithSearch||[],this.listenTo(this,"selectOrUnselect.mixed",this.thumbnailItemClicked)},"sortmenurender":function(e){this.options.thumbnailView.resultsView.render(),this.sortRegion.$el.find("button.binf-dropdown-toggle").focus()},"thumbnailItemClicked":function(){var e=this.collection.filter(function(e){return e.get(b.isSelectedModelAttributeName)}),t=e.length===this.collection.length;e.length>0&&!t?this.$el.find(".csui-selected-checkbox").addClass("csui-checkbox-atleastone"):this.$el.find(".csui-selected-checkbox").removeClass("csui-checkbox-atleastone"),this.$(".csui-selectAll-input").prop("checked",t)},"selectAllThumbnails":function(e){this.options.thumbnailView.activeInlineForm&&this.options.thumbnailView.cancelAnyExistingInlineForm(),this.$el.find(".csui-checkbox-atleastone").removeClass("csui-checkbox-atleastone"),this.trigger("selectOrUnselect.all",e.target.checked),this.collection.where({"csuiIsSelected":!0}).length>0&&this.trigger("selectOrUnselect.mixed")},"onRender":function(e){var t=e||window.event,i=this.options.thumbnailView;this.focusIndex=0;var s=i.$el.find(".csui-thumbnail-item-selected").length;if(this.collection.where({"csuiIsSelected":!0}).length>0)this.trigger("selectOrUnselect.mixed");else if(s>0)i.$el.find(".csui-checkbox").removeClass(),this.trigger("selectOrUnselect.all",t.target&&t.target.checked);else if(0===s){var n=i.getSelectedChildren();i.options.selectedChildren&&i.options.selectedChildren.reset(n)}var o=new h({"collection":this.collection,"resultView":this});this.sortRegion.show(o),this.listenTo(o,"render:sortmenu",this.sortmenurender),this.ensureAllSearchBox()},"ensureAllSearchBox":function(){var e=this,s=(this.options.thumbnailView,this.$el.find(".csui-thumbnail-column-search")),n=this.$el.find(".csui-sorting-container");if(0===i(this).find(".csui-thumbnail-column-search").length){var o=new g(e.collection.filters.name,{"column":"name","columnTitle":S.name});e.searchBoxes=o,o.on("change:filterValue",function(t){e.applyFilter(t)}),o.on("opened",function(){n.addClass("binf-hidden"),e.searchColumn="name"}),o.on("closed",function(){n.removeClass("binf-hidden"),e.collection.filters.name=void 0}),this.searchRegion.show(e.searchBoxes),"name"===e.searchColumn&&o.setFocus(),s=i(this).find(".csui-table-column-search"),s&&s.attr("aria-label",t.str.sformat(S.searchIconTooltip,S.name))}},"applyFilter":function(e){var t={};t[e.column]=e.keywords,this.collection.fetching?this.filterValuePending=t:(this.collection.resetLimit(!1),this.collection.setFilter(t))}}),E=n.LayoutView.extend({"className":"csui-thumbnail-container","template":T,"regions":{"headerRegion":"#csui-thumbnail-header","resultsRegion":"#csui-thumbnail-results"},"behaviors":{"PerfectScrolling":{"behaviorClass":c,"contentParent":".csui-thumbnail-results","suppressScrollX":!0,"scrollYMarginOffset":15},"DefaultAction":{"behaviorClass":l}},"constructor":function(e){e||(e={}),this.options=e,e.actionItems&&e.commands?(this.defaultActionController=new a({"actionItems":e.actionItems,"commands":e.commands}),this.checkModelHasAction=this.defaultActionController.hasAction.bind(this.defaultActionController)):this.checkModelHasAction=function(){return!0},n.LayoutView.prototype.constructor.call(this,e),this.context=e.context,this.collection=e.collection;var i=this.collection.where({"csuiIsSelected":!0});this.collection.itemchecked=!1,i.length>0&&(this.collection.itemchecked=!0),y.imbue(this),this.listenTo(this.collection,"update",this._handleModelsUpdate),this.listenTo(this.collection,"change",t.debounce(this.updateRow,100)),this.context&&this.listenTo(this.context,"request",this._handleContextRequest).listenTo(this.context,"sync error",this._handleContextFinish).listenTo(this.context,"sync",this._handleContextSync),this.collection.node&&this.listenTo(this.collection.node,"change:id",this._clearSearchBoxes),this.listenTo(this.collection,"request",this.blockActions).listenTo(this.collection,"sync",this.unblockActions).listenTo(this.collection,"destroy",this.unblockActions).listenTo(this.collection,"error",this.unblockActions),this._ViewCollection=s.Collection.extend({"model":this.collection.model}),this.selectedChildren=new this._ViewCollection;var o=this;this.el.addEventListener("scroll",function(){o.trigger("scroll")},!0),this.listenTo(this.collection,"reset",this._updateSelectedChildren),this.listenTo(this.collection,"new:page",this.resetScrollToTop),this.listenTo(this.collection,"reset",function(){this._isRendered&&(this.resetScrollToTop(),this.thumbnailHeaderView&&this.thumbnailHeaderView.render())})},"_updateSelectedChildren":function(){this._isRendered},"_handleContextRequest":function(){this._fetchingContext=!0,this._columnsReset=!1,this._collectionReset=!1},"_handleContextSync":function(){this._isRendered&&(this._columnsReset?this.rebuild():this._collectionReset&&this.render())},"_handleContextFinish":function(){this._fetchingContext=!1},"resetScrollToTop":function(){this._isRendered&&this.resultsRegion&&this.resultsRegion.$el.scrollTop(0)},"onDestroy":function(){this._originalScope&&this.options.collection.setResourceScope(this._originalScope)},"_handleModelsUpdate":function(e,i){if(this._isRendered){var s=i.changes.added,o=this;if(s.length>0){t.each(s,function(e){e.unset(b.isSelectedModelAttributeName)}),this.triggerMethod("before:render",this);var r=null;if(t.each(s,function(e){r=e}),r.inlineFormView){o.activeInlineForm&&o.activeInlineForm.destroy(),o.activeInlineForm=new r.inlineFormView({"model":r,"originatingView":o.options.originatingView,"context":o.context});var l=".csui-thumbnail-name-"+r.cid,a=this.$el.find(l);o.activeInlineForm.listenTo(o.activeInlineForm,"destroy",function(){o.lockedForOtherContols=!1,delete o.activeInlineForm});new n.Region({"el":a}).show(o.activeInlineForm)}this.resultsView.showOrHideZeroRecordsMessage(),this._adjustThumbnailWidth(),this.trigger("dom:refresh"),t.each(s,function(e){e.isLocallyCreated&&!e.inlineFormView&&o.$el.find(".csui-thumbnail-item-"+e.cid).find(".csui-thumbnail-content-container").addClass("csui-new-item")})}this.thumbnailHeaderView&&this.thumbnailHeaderView.render()}},"_maintainNodeState":function(e){var t=e,i=this;if(!e||!e.inlineFormView)return!1;i.activeInlineForm=new t.inlineFormView({"model":t,"originatingView":i.options.originatingView,"context":i.context}),i.$el.find(".csui-thumbnail-item-"+t.cid).addClass("csui-thumbnail-item-form");var s=".csui-thumbnail-name-"+t.cid,o=this.$el.find(s);new n.Region({"el":o}).show(i.activeInlineForm)},"updateRow":function(e){if(e.isLocallyCreated&&this.$el.find(".csui-thumbnail-item-form")&&this.$el.find(".csui-thumbnail-item-form").find(".csui-thumbnail-content-container").addClass("csui-new-item"),this.isSelected=this.collection.where({"csuiIsSelected":!0}).length>0,e.inlineFormView){this.options.originatingView.updateRowIndex=this.collection.indexOf(e);var t=this;t.activeInlineForm&&t.activeInlineForm.model!==e&&(this.$el.find(".csui-thumbnail-item-form").removeClass("csui-thumbnail-item-form"),this.$el.find(".csui-thumbnail-item-form").removeClass("csui-thumbnail-item-rename-form"),this.activeInlineForm.model.trigger("sync"),this.cancelAnyExistingInlineForm({"silent":!0})),t.activeInlineForm=new e.inlineFormView({"model":e,"originatingView":t.options.originatingView,"context":t.context}),this.$el.find(".csui-thumbnail-item-"+e.cid).addClass("csui-thumbnail-item-rename-form");var i=".csui-thumbnail-name-"+e.cid,s=this.$el.find(i);t.activeInlineForm.listenTo(t.activeInlineForm,"destroy",function(){t.lockedForOtherContols=!1,t.activeInlineForm.model.trigger("sync"),delete t.activeInlineForm}),this.$el.find(".csui-thumbnail-item-"+e.cid).removeClass("csui-thumbnail-item-apply-transition"),t.$el.find(".csui-thumbnail-item-"+t.activeInlineForm.model.cid).addClass("csui-thumbnail-item-form");new n.Region({"el":s}).show(t.activeInlineForm),t.$el.find(".csui-thumbnail-item-"+t.activeInlineForm.model.cid).removeClass("csui-thumbnail-item-rename-form"),t.lockedForOtherContols=!0,t.$el.find(".csui-thumbnail-item-"+t.activeInlineForm.model.cid).find("div.csui-thumbnail-overview-icon").addClass("binf-hidden"),this.$el.find(".csui-thumbnail-item-form")&&this.$el.find(".csui-thumbnail-item-form").find(".csui-thumbnail-content-container .csui-inlineform-error").length>0&&(this.$el.find(".csui-thumbnail-item-form").find(".csui-thumbnail-content-container.csui-new-item").addClass("csui-new-item-error"),e.isLocallyCreated=!0)}else this.$el.find(".csui-thumbnail-item-"+e.cid).removeClass("csui-thumbnail-item-form"),this.$el.find(".csui-thumbnail-item-"+e.cid).addClass("csui-thumbnail-item-apply-transition"),this.activeInlineForm&&this.activeInlineForm.model.cid===e.cid&&(this.activeInlineForm.model.trigger("sync"),this.cancelAnyExistingInlineForm({"silent":!0})),this.collection&&this.collection.filters.name&&this.thumbnailHeaderView.searchBoxes.setFocus(),this.$el.find(".csui-thumbnail-content-container.csui-new-item.csui-new-item-error").length>0&&this.$el.find(".csui-thumbnail-content-container.csui-new-item.csui-new-item-error").removeClass("csui-new-item-error")},"onAfterShow":function(){this.thumbnailHeaderView.searchBoxes.setFocus()},"_adjustThumbnailWidth":function(){for(var e=this.$el.find(".csui-thumbnail-item"),t=i(".csui-table-facetview .csui-facet-panel").length>0?i(".csui-facet-table-container").width()-i(".csui-table-facetview").width():i(".cs-thumbnail-wrapper").width(),s=190/t*100,n=1;n<=e.length;n++){if(n*s>100){n-=1,s=100/n;break}}e.css({"maxWidth":"calc("+s+"% - 4px)","minWidth":"calc("+s+"% - 4px)"})},"cancelAnyExistingInlineForm":function(e){this.activeInlineForm&&this.activeInlineForm.cancel(e)},"startCreateNewModel":function(e,t){this.cancelAnyExistingInlineForm(),this.collection&&this.collection.node&&(e.set("parent_id",this.collection.node.get("id")),e.isLocallyCreated=!0,e.inlineFormView=t,this.collection.add(e,{"at":0}),this._adjustThumbnailWidth())},"_clearSearchBoxes":function(){this._isRendered&&t.each(this.searchBoxes,function(e){e.hideAndClear()})},"onRender":function(){this.thumbnailHeaderView=new A({"columns":this.displayedColumns,"context":this.context,"columnsWithSearch":this.options.columnsWithSearch,"filterBy":this.options.filterBy,"collection":this.options.collection,"thumbnailView":this}),this.headerRegion.show(this.thumbnailHeaderView);var e=this;this.listenTo(this.thumbnailHeaderView,"selectOrUnselect.all",function(i){i?(e.collection.models.length>0&&t.each(e.collection.models,function(e){e.set(b.isSelectedModelAttributeName,!0),e.attributes.selectAllThumbnailsEnabled=!0,e.attributes.isSelected=!0}),e.$el.find(".csui-thumbnail-results .csui-thumbnail-select").addClass("csui-checkbox"),e.$el.find(".csui-thumbnail-results .csui-thumbnail-item").addClass("csui-thumbnail-item-selected")):e.collection.models.length>0&&(t.each(e.collection.models,function(e){e.set(b.isSelectedModelAttributeName,!1),e.attributes.selectAllThumbnailsEnabled=!1,e.attributes.isSelected=!1}),
e.$el.find(".csui-thumbnail-select").removeClass("csui-checkbox"),e.$el.find(".csui-thumbnail-results .csui-thumbnail-item").removeClass("csui-thumbnail-item-selected")),e.showToolBarActions()}),this.resultsView=new V({"context":this.options.context,"collection":this.options.collection,"thumbnailView":this,"originatingView":this.options.originatingView,"inlineBar":this.options.inlineBar,"thumbnailHeaderView":this.thumbnailHeaderView,"tableColumns":this.options.tableColumns,"columns":this.options.columns}),this.showToolBarActions(),this.resultsRegion.show(this.resultsView)},"showToolBarActions":function(e){var t=this.getSelectedChildren();this.options.selectedChildren.reset(t)},"getSelectedChildren":function(){var e=[];return this.options.collection.each(function(t){t.get("csuiIsSelected")&&e.push(t)}),e}});return t.extend(E.prototype,w),E}),csui.define("hbs!csui/controls/thumbnail/content/node.state/impl/reservation/reservation",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return"other"},"3":function(e,t,i,s){return"self"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n,o;return'<button type="button" aria-label="'+this.escapeExpression((o=null!=(o=t.reservedAria||(null!=e?e.reservedAria:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"reservedAria","hash":{}}):o))+'">\r\n<span class="icon '+this.escapeExpression((o=null!=(o=t.iconPrefix||(null!=e?e.iconPrefix:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"iconPrefix","hash":{}}):o))+"_"+(null!=(n=t.if.call(e,null!=e?e.isReservedByOther:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:"")+'"\r\n        title="'+this.escapeExpression((o=null!=(o=t.reservedTooltip||(null!=e?e.reservedTooltip:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{"name":"reservedTooltip","hash":{}}):o))+'"></span>\r\n</button>\r\n\r\n'}});return i.registerPartial("csui_controls_thumbnail_content_node.state_impl_reservation_reservation",s),s}),csui.define("css!csui/controls/thumbnail/content/node.state/impl/reservation/reservation",[],function(){}),csui.define("csui/controls/thumbnail/content/node.state/impl/reservation/reservation.view",["csui/lib/underscore","csui/lib/marionette","csui/utils/base","csui/utils/contexts/factories/user","csui/models/nodes","csui/utils/commands","csui/utils/commandhelper","hbs!csui/controls/thumbnail/content/node.state/impl/reservation/reservation","i18n!csui/controls/thumbnail/content/node.state/impl/nls/localized.strings","css!csui/controls/thumbnail/content/node.state/impl/reservation/reservation"],function(e,t,i,s,n,o,r,l,a){"use strict";return t.ItemView.extend({"tagName":"li","className":"csui-node-state-reservation","template":l,"triggers":{"click button":"remove:reservation"},"constructor":function(){t.ItemView.prototype.constructor.apply(this,arguments);var e=this.options.context.getModel(s);this.userId=e.get("id"),this.unreserveCommand=o.get("UnreserveDoc"),this.revokeShareCommand=o.get("RevokeShare"),this.commandStatus={"nodes":new n([this.model]),"context":this.options.context};var i=this.model.actions;i&&this.listenTo(i,"update",function(){this._isDestroyed||this.render()})},"templateHelpers":function(){var t,s,n,o=this._getReservedStatus(),r=o.isReserved,l=o.isSharedCollaboration,c=o.reservedBy;if(r){var u=i.formatExactDate(this.model.get("reserved_date")),d=i.formatMemberName(c);l?(t=a.reservedSharedCollaborationTooltip,s=a.reservedSharedCollaborationAria):(t=a.reservedTooltip,s=a.reservedAria),t=e.str.sformat(t,d,u),s=e.str.sformat(s,d,u),n=l?"icon-shared_collaborate":"icon-reserved"}return this._reservedStatus={"isReserved":r,"isSharedCollaboration":l,"isReservedByOther":c&&this.userId!==c.id,"canUnreserve":o.canUnreserve,"reservedTooltip":t,"reservedAria":s,"iconPrefix":n},this._reservedStatus},"onRemoveReservation":function(e){if(!this.model.get("FromThumbnailStateIconView")&&this._reservedStatus.canUnreserve){var t=this._reservedStatus.isSharedCollaboration?this.revokeShareCommand:this.unreserveCommand,i=t.execute(this.commandStatus);r.handleExecutionResults(i,{"command":t,"suppressSuccessMessage":this.commandStatus.suppressSuccessMessage,"suppressFailMessage":this.commandStatus.suppressFailMessage})}},"_getReservedStatus":function(){var e=this.model.get("reserved"),t=this.model.get("reserved_shared_collaboration"),i=t?this.revokeShareCommand:this.unreserveCommand,s=this.model.get("reserved_user_id_expand");return s||(s=this.model.get("reserved_user_id"))&&"number"==typeof s&&(s={"id":s}),{"isReserved":e&&void 0!==s||t,"isSharedCollaboration":t,"reservedBy":s,"canUnreserve":i.enabled(this.commandStatus)}},"getAttributes":function(){var e,t,i=this.templateHelpers();return i.isSharedCollaboration?(e=a.reserved_shared_collaboration_attribute_title,t=a.reserved_shared_collaboration_attribute_name):(e=a.reserved_attribute_title,t=a.reserved_attribute_name),[{"label":e,"value":i.isReserved,"name":t,"tooltip":i.reservedTooltip,"aria":i.reservedAria}]}},{"enabled":function(e){var t=e.node,i=t.get("reserved"),s=t.get("reserved_shared_collaboration"),n=t.get("reserved_user_id");return i&&n||s},"getModelExpand":function(e){return{"properties":["reserved_user_id"]}}})}),csui.define("csui/controls/thumbnail/content/node.state/impl/node.state.icons",["csui/controls/thumbnail/content/node.state/impl/reservation/reservation.view"],function(e){"use strict";return[{"sequence":5,"iconView":e}]}),csui.define("csui/dialogs/node.picker/start.locations/location.base.factory",["csui/lib/underscore","csui/lib/backbone"],function(e,t){"use strict";function i(e){this.options=e||{}}return e.extend(i.prototype,{"updateLocationModel":function(e){},"getLocationParameters":function(){return{"container":null,"collection":null,"locationName":""}}}),i.extend=t.View.extend,i}),csui.define("csui/dialogs/node.picker/start.locations/node.base.factory",["csui/lib/jquery","csui/lib/underscore","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/node/node.model","csui/models/nodechildren","csui/utils/commands"],function(e,t,i,s,n,o){"use strict";return i.extend({"constructor":function(e){i.prototype.constructor.apply(this,arguments),this.container=new s(this.options.node,{"connector":this.options.connector})},"updateLocationModel":function(t){var i=this,s=e.Deferred();return this.container.fetch().then(function(){t.set({"name":i.container.get("name")||i.options.defaultName,"icon":i.options.icon,"invalid":!1,"selectable":i.options.selectable}),s.resolve()},function(){t.set({"invalid":!0}),s.reject()}),s.promise()},"getLocationParameters":function(){var e=new n(void 0,{"node":this.container,"autoreset":!0,"expand":["node"],"orderBy":"name asc","commands":o.getAllSignatures()});return this.container.set("unselectable",this.options.unselectable),{"container":this.container,"collection":e}}})}),csui.define("csui/dialogs/node.picker/start.locations/current.location/current.location.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/nodechildren","csui/utils/commands","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,t,i,s,n,o){"use strict";return i.extend({"updateLocationModel":function(e){var i=this.options.container;return e.set({"name":o.labelCurrentLocation,"icon":"location","invalid":!(i&&i.isFetchable())}),t.Deferred().resolve().promise()},"getLocationParameters":function(){var e=this.options.container,t=new s(void 0,{"node":this.options.container,"autoreset":!0,"expand":["node"],"orderBy":"name asc","commands":n.getAllSignatures()});return e.set("unselectable",!1),{"container":e,"collection":t,"locationName":o.labelCurrentLocation}}})}),csui.define("csui/dialogs/node.picker/start.locations/enterprise.volume/enterprise.volume.factory",["csui/lib/underscore","csui/dialogs/node.picker/start.locations/node.base.factory","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,t,i){"use strict";return t.extend({"constructor":function(s){s=e.defaults({"node":{"id":"volume","type":141},"icon":"enterprise","unselectable":!1,"defaultName":i.labelEnterpriseVolume},s),t.prototype.constructor.call(this,s)}})}),csui.define("csui/dialogs/node.picker/start.locations/favorites/impl/favorite.collection",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/node/node.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/client-side.mixin","csui/models/browsable/v2.response.mixin"],function(e,t,i,s,n,o,r,l){"use strict";var a=t.Collection.extend({"model":s,"constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments),this.makeConnectable(i).makeFetchable(i).makeClientSideBrowsable(i).makeBrowsableV2Response(i)},"url":function(){var e="";if(this.orderBy){var t=this.orderBy.split(",")[0].split(" ");e=(t[1]||"asc")+"_"+t[0]}var s=this.connector.connection.url.replace("/v1","/v2"),n=i.combineQueryString({"fields":["properties","versions.element(0)"],"expand":"properties{original_id}","orderBy":e,"actions":""});return i.appendQuery(i.combine(s,"members/favorites"),n)},"parse":function(e,t){return this.parseBrowsedState(e,t),this.parseBrowsedItems(e,t)}});return r.mixin(a.prototype),l.mixin(a.prototype),n.mixin(a.prototype),o.mixin(a.prototype),a}),csui.define("csui/dialogs/node.picker/start.locations/favorites/favorites.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang","csui/dialogs/node.picker/start.locations/favorites/impl/favorite.collection"],function(e,t,i,s,n){"use strict";return i.extend({"updateLocationModel":function(e){return e.set({"name":s.labelFavorites,"icon":"favorites"}),t.Deferred().resolve().promise()},"getLocationParameters":function(){return{"container":null,"collection":new n(void 0,{"connector":this.options.connector,"autoreset":!0,"expand":["node"]}),"locationName":s.labelFavorites}}})}),csui.define("csui/dialogs/node.picker/start.locations/personal.volume/personal.volume.factory",["csui/lib/underscore","csui/dialogs/node.picker/start.locations/node.base.factory","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,t,i){"use strict";return t.extend({"constructor":function(s){s=e.defaults({"node":{"id":"volume","type":142},"icon":"csui-icon-personal-volume","unselectable":!1,"defaultName":i.labelPersonalVolume},s),t.prototype.constructor.call(this,s)}})}),csui.define("csui/dialogs/node.picker/start.locations/category.volume/category.volume.factory",["csui/lib/underscore","csui/dialogs/node.picker/start.locations/node.base.factory","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,t,i){"use strict";return t.extend({"constructor":function(s){s=e.defaults({"node":{"id":"volume","type":133},"unselectable":!0,"icon":"csui-icon-category-volume","defaultName":i.labelCategoryVolume},s),t.prototype.constructor.call(this,s)}})}),csui.define("csui/dialogs/node.picker/start.locations/perspective.assets.volume/perspective.assets.volume.factory",["csui/lib/underscore","csui/dialogs/node.picker/start.locations/node.base.factory","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,t,i){"use strict";return t.extend({"constructor":function(s){s=e.defaults({"node":{"id":"volume","type":954},"unselectable":!0,"icon":"csui-icon-perspective-assets-volume","defaultName":i.labelPerspectiveAssetsVolume},s),t.prototype.constructor.call(this,s)}})}),csui.define("csui/dialogs/node.picker/start.locations/recent.containers/impl/recent.containers.collection",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/node/node.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/client-side.mixin","csui/models/browsable/v2.response.mixin"],function(e,t,i,s,n,o,r,l,a,c){"use strict";var u=s.Collection.extend({"model":o,"constructor":function(e,i){t.defaults(i,{"orderBy":""}),s.Collection.prototype.constructor.call(this,e,i),this.makeConnectable(i).makeFetchable(i).makeClientSideBrowsable(i).makeBrowsableV2Response(i)},"url":function(){var e="";if(this.orderBy){var t=this.orderBy.split(",")[0].split(" ");e=(t[1]||"asc")+"_"+t[0]}var i=this.connector.connection.url.replace("/v1","/v2"),s=n.combineQueryString({"fields":["properties","versions.element(0)"],"expand":"properties{original_id}","orderBy":e,"actions":""});return n.appendQuery(n.combine(i,"members/targets"),s)},"parse":function(e,t){return this.parseBrowsedState(e,t),this.parseBrowsedItems(e,t),e.results.reverse(),e.results}});return a.mixin(u.prototype),c.mixin(u.prototype),r.mixin(u.prototype),l.mixin(u.prototype),u}),csui.define("csui/dialogs/node.picker/start.locations/recent.containers/recent.containers.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang","csui/dialogs/node.picker/start.locations/recent.containers/impl/recent.containers.collection"],function(e,t,i,s,n){"use strict";return i.extend({"updateLocationModel":function(e){return e.set({"name":s.labelRecentContainers,"icon":"recent"}),t.Deferred().resolve().promise()},"getLocationParameters":function(){return{"container":null,"collection":new n(void 0,{"connector":this.options.connector,"autoreset":!0,"expand":["node"]}),"locationName":s.labelRecentContainers}}})}),csui.define("csui/dialogs/node.picker/start.locations/search.location/impl/search.collection",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/node/node.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/browsable.mixin","csui/models/browsable/v1.request.mixin","csui/models/browsable/v2.response.mixin","csui/utils/deepClone/deepClone"],function(e,t,i,s,n,o,r,l,a,c){"use strict";var u=i.Collection.extend({"model":n,"constructor":function(e,t){this.options=t||(t={}),i.Collection.prototype.constructor.call(this,e,t),this.makeConnectable(t).makeFetchable(t).makeBrowsable(t).makeBrowsableV1Request(t).makeBrowsableV2Response(t)},"clone":function(){return new this.constructor(this.models,{"connector":this.connector,"skip":this.skipCount,"top":this.topCount,"filter":e.deepClone(this.filters),"orderBy":e.clone(this.orderBy)})}});return l.mixin(u.prototype),a.mixin(u.prototype),c.mixin(u.prototype),o.mixin(u.prototype),r.mixin(u.prototype),e.extend(u.prototype,{"isFetchable":function(){return!0},"cacheId":"","url":function(){var e=this.connector.connection.url.replace("/v1","/v2"),t=this.options.query.toJSON();return t.where="OTName:"+t.where,this.orderBy="OTName",t=s.combineQueryString(this.getBrowsableUrlQuery(),{"actions":"open","expand":"properties{parent_id}"},t),s.combine(e,"search?"+t)},"parse":function(e,t){return this.parseBrowsedState(e.collection,t),e.results.sorting=e.collection.sorting,this.cacheId=e.collection&&e.collection.searching&&e.collection.searching.cache_id?e.collection.searching.cache_id:"",this.parseBrowsedItems(e,t)}}),u}),csui.define("csui/dialogs/node.picker/start.locations/search.location/search.location.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/dialogs/node.picker/start.locations/search.location/impl/search.collection","csui/utils/commands","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,t,i,s,n,o){"use strict";return i.extend({"updateLocationModel":function(e){this.options.container;return e.set({"hide":!0,"invalid":!1}),t.Deferred().resolve().promise()},"getLocationParameters":function(e){var t=this.options.container,i=new s(void 0,e);return t&&t.set("unselectable",!1),{"container":t,"collection":i}}})}),csui.define("csui/dialogs/node.picker/start.locations/default.location/default.location.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/nodechildren","csui/utils/commands","i18n!csui/dialogs/node.picker/start.locations/impl/nls/lang"],function(e,t,i,s,n,o){"use strict";return i.extend({"updateLocationModel":function(e){this.options.container;return e.set({"hide":!0,"invalid":!1}),t.Deferred().resolve().promise()},"getLocationParameters":function(){var e=this.options.container,t=new s(void 0,{"node":this.options.container,"autoreset":!0,"expand":["node"],"orderBy":"name asc","commands":n.getAllSignatures()});return e.set("unselectable",!1),{"container":e,"collection":t,"locationName":o.labelCurrentLocation}}})}),csui.define("csui/dialogs/members.picker/start.locations/location.base.factory",["csui/lib/underscore","csui/lib/backbone"],function(e,t){"use strict";function i(e){this.options=e||{}}return e.extend(i.prototype,{"updateLocationModel":function(e){},"getLocationParameters":function(){return{"container":null,"collection":null,"locationName":""}}}),i.extend=t.View.extend,i}),csui.define("csui/dialogs/members.picker/start.locations/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/dialogs/members.picker/start.locations/impl/nls/root/lang",{"labelNoSelection":"Go to...","labelAllMembersAndGroups":"All members and groups","labelRecentGroups":"Recent groups","labelGroupWhereIamMember":"Groups where I am member","labelAllGroups":"All Groups"}),csui.define("csui/dialogs/members.picker/start.locations/current.group/current.group.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/member/membercollection","i18n!csui/dialogs/members.picker/start.locations/impl/nls/lang"],function(e,t,i,s,n){"use strict";return i.extend({"updateLocationModel":function(e){this.options.container;return e.set({"hide":!0,"invalid":!1}),t.Deferred().resolve().promise()},"getLocationParameters":function(){var e=this.options.container,t=new s(void 0,{"connector":this.options.connector,"groupId":e.groupId,"member":e});return e.set("unselectable",!1),{"container":this.options.container,"collection":t,"locationName":n.labelCurrentLocation}}})}),csui.define("csui/dialogs/members.picker/start.locations/all.members/all.members.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/member/membercollection","i18n!csui/dialogs/members.picker/start.locations/impl/nls/lang"],function(e,t,i,s,n){"use strict";return i.extend({"updateLocationModel":function(e){var i=this.options.container;return e.set({"name":n.labelAllMembersAndGroups,"icon":"member","invalid":!(i&&i.isFetchable())}),t.Deferred().resolve().promise()},"getLocationParameters":function(){var e=(this.options.container,new s(void 0,{"connector":this.options.connector}));return{"container":this.options.container,"collection":e,"locationName":n.labelCurrentLocation}}})}),csui.define("csui/dialogs/members.picker/start.locations/member.groups/member.groups.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/member/membercollection","i18n!csui/dialogs/members.picker/start.locations/impl/nls/lang"],function(e,t,i,s,n){"use strict";return i.extend({"updateLocationModel":function(e){var i=this.options.container;return e.set({"name":n.labelGroupWhereIamMember,"icon":"location","invalid":!(i&&i.isFetchable())}),t.Deferred().resolve().promise()},"getLocationParameters":function(){var e=this.options.container,t=new s(void 0,{"connector":this.options.connector,"type":"GroupsOfCurrentUser"});return e.set("unselectable",!1),{"container":this.options.container,"collection":t,"locationName":n.labelCurrentLocation}}})}),csui.define("csui/dialogs/members.picker/start.locations/recent.groups/impl/recent.groups.collection",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/member/member.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/client-side.mixin","csui/models/browsable/v2.response.mixin"],function(e,t,i,s,n,o,r,l,a,c){"use strict";var u=s.Collection.extend({"model":o,"constructor":function(e,t){s.Collection.prototype.constructor.call(this,e,t),this.makeConnectable(t).makeFetchable(t).makeClientSideBrowsable(t).makeBrowsableV2Response(t)},"url":function(){var e=this.connector.connection.url.replace("/v1","/v2");return n.appendQuery(n.combine(e,"members/targets"))},"parse":function(e,t){return this.parseBrowsedState(e,t),this.parseBrowsedItems(e,t),e.results.reverse(),e.results}});return a.mixin(u.prototype),c.mixin(u.prototype),r.mixin(u.prototype),l.mixin(u.prototype),u}),csui.define("csui/dialogs/members.picker/start.locations/recent.groups/recent.groups.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/dialogs/members.picker/start.locations/recent.groups/impl/recent.groups.collection","csui/utils/commands","i18n!csui/dialogs/members.picker/start.locations/impl/nls/lang"],function(e,t,i,s,n,o){"use strict";return i.extend({"updateLocationModel":function(e){var i=this.options.container;return e.set({"name":o.labelRecentGroups,"icon":"recent","invalid":!(i&&i.isFetchable())}),t.Deferred().resolve().promise()},"getLocationParameters":function(){var e=this.options.container,t=new s(void 0,{"connector":this.options.connector});return e.set("unselectable",!1),{"container":this.options.container,"collection":t,"locationName":o.labelCurrentLocation}}})}),csui.define("csui/dialogs/members.picker/start.locations/all.groups/all.groups.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/member/membercollection","i18n!csui/dialogs/members.picker/start.locations/impl/nls/lang"],function(e,t,i,s,n){"use strict";return i.extend({"updateLocationModel":function(e){var i=this.options.container;return e.set({"name":n.labelAllGroups,"icon":"group","invalid":!(i&&i.isFetchable())}),t.Deferred().resolve().promise()},"getLocationParameters":function(){var e=(this.options.container,new s(void 0,{"connector":this.options.connector,"type":1}));return{"container":this.options.container,"collection":e,"locationName":n.labelCurrentLocation}}})}),csui.define("csui/dialogs/members.picker/start.locations/acl.groups/impl/acl.groups.collection",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/member/member.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/client-side.mixin","csui/models/browsable/v2.response.mixin"],function(e,t,i,s,n,o,r,l,a,c){"use strict";var u=s.Collection.extend({"model":o,"constructor":function(e,t){this.options=t||{},s.Collection.prototype.constructor.call(this,e,t),this.makeConnectable(t).makeFetchable(t).makeClientSideBrowsable(t).makeBrowsableV2Response(t)},"url":function(){var e,t=n.combine(this.connector.connection.url,"nodes",this.options.nodeId);return t=t.replace("/v1","/v2"),e=n.combineQueryString({"fields":["permissions{right_id, permissions, type}"],"expand":"permissions{right_id}"},e),e&&(t+="?"+e),t},"parse":function(e,t){return this.filterGroups(e),e.aclGroups},"filterGroups":function(e){var i=e.results.data&&e.results.data.permissions,s=[];return t.each(i,function(e){if(e.right_id_expand&&1===e.right_id_expand.type){var t={};t=e.right_id_expand,t.data={},t.data.properties=e.right_id_expand,s.push(t)}}),e.aclGroups=s,e}});return a.mixin(u.prototype),c.mixin(u.prototype),r.mixin(u.prototype),l.mixin(u.prototype),u}),csui.define("csui/dialogs/members.picker/start.locations/acl.groups/acl.groups.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/dialogs/members.picker/start.locations/acl.groups/impl/acl.groups.collection","csui/utils/commands","i18n!csui/dialogs/members.picker/start.locations/impl/nls/lang"],function(e,t,i,s,n,o){"use strict";return i.extend({"updateLocationModel":function(e){this.options.container;return e.set({"hide":!0,"invalid":!1}),t.Deferred().resolve().promise()},"getLocationParameters":function(){var e=this.options.container,t=new s(void 0,{"connector":this.options.connector,"nodeId":this.options.nodeId});return e.set("unselectable",!1),{"container":this.options.container,"collection":t,"locationName":o.labelCurrentLocation}}})}),csui.define("csui/widgets/nodestable/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/nodestable/impl/nls/root/lang",{"columnTitleLocation":"Location","dragAndDropMessage":"Drag and drop files here to add new content.","filterExpandAria":"Show filter panel ","filterCollapseAria":"Hide filter panel "}),csui.define("csui/utils/toolitem.masks/children.toolitems.mask",["csui/controls/toolbar/toolitems.mask","csui-ext!csui/utils/toolitem.masks/children.toolitems.mask"],function(e,t){"use strict";return t||(t=[]),e.extend({"constructor":function(t){e.prototype.constructor.apply(this),this.context=t.context,this.node=t.node,this._updateMask(),this.listenTo(this.node,"change:id",this._updateMask)},"_updateMask":function(){var e=this.restoreMask({"silent":!0});t.forEach(function(t){(t=t({"context":this.context,"node":this.node}))&&(e=this.extendMask(t,{"silent":!0})||e)},this),e&&this.trigger("update",this)}})}),csui.define("csui/utils/toolitem.masks/creation.toolitems.mask",["module","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask","csui-ext!csui/utils/toolitem.masks/creation.toolitems.mask"],function(e,t,i,s){"use strict";return s||(s=[]),t.extend({"constructor":function(s){var n=e.config(),o=new i;t.prototype.constructor.call(this,o,{"normalize":!1}),Object.keys(n).forEach(function(e){"extensions"!=e&&this.extendMask(n[e])},this),this.storeMask(),this.context=s.context,this.node=s.node,this._updateMask(),this.listenTo(this.node,"change:id",this._updateMask)},"_updateMask":function(){var e=this.restoreMask({"silent":!0});s.forEach(function(t){(t=t({"context":this.context,"node":this.node}))&&(e=this.extendMask(t,{"silent":!0})||e)},this),e&&this.trigger("update",this)},"_normalizeRule":function(e){return"object"!=typeof e&&(e="string"==typeof e?{"signature":e}:{"type":e}),e.commandData||(e={"commandData":e}),null!=e.type&&(e.commandData.type=e.type,delete e.type),e.signature||(e.signature="Add"),e}})}),csui.define("csui/controls/tabletoolbar/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/tabletoolbar/nls/root/localized.strings",{"ToolbarItemReserve":"Reserve","ToolbarItemUnreserve":"Unreserve","ToolbarItemOriginalReserve":"Reserve original","ToolbarItemOriginalUnreserve":"Unreserve original","MenuItemReserve":"Reserve","MenuItemUnreserve":"Unreserve","ToolbarItemThumbnail":"Grid view","ToolbarItemListView":"List view","ThumbnailTitle":"Grid view","ListViewTitle":"List view"}),csui.define("csui/widgets/nodestable/toolbaritems",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/nls/localized.strings","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui/widgets/favorites/favorite.star.view","csui-ext!csui/widgets/nodestable/toolbaritems"],function(e,t,i,s,n,o,r){"use strict";var l={"filterToolbar":new s({"filter":[{"signature":"Filter","name":i.ToolbarItemFilter,"icon":"icon icon-toolbarFilter","toolItemAria":i.ToolbarItemFilterAria,"toolItemAriaExpand":!1}]},{"maxItemsShown":2,"dropDownIcon":"icon icon-toolbar-more","dropDownText":i.ToolbarItemMore,"addTrailingDivider":!1}),"addToolbar":new s({"add":[]},{"maxItemsShown":0,"dropDownIcon":"icon icon-toolbarAdd","dropDownText":i.ToolbarItemAddItem,"addTrailingDivider":!1}),"leftToolbar":new s({"main":[{"signature":"CollectionCanCollect","name":i.ToolbarItemAddItem,"icon":"icon icon-toolbarAdd"}]},{"maxItemsShown":2,"dropDownIcon":"icon icon-toolbar-more","dropDownText":i.ToolbarItemMore,"addTrailingDivider":!1}),"tableHeaderToolbar":new s({"info":[{"signature":"Properties","name":i.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata"}],"share":[{"signature":"CopyLink","name":i.ToolbarItemCopyLink},{"signature":"Share","name":i.ToolbarItemShare,"flyout":"share","group":"share"},{"signature":"EmailLink","name":i.ToolbarItemEmailLink,"flyout":"share","promoted":!0,"group":"share"}],"edit":[{"signature":"Edit","name":i.ToolbarItemEdit,"flyout":"edit","promoted":!0},{"signature":"EditActiveX","name":"EditActiveX","flyout":"edit"},{"signature":"EditOfficeOnline","name":"EditOfficeOnline","flyout":"edit"},{"signature":"EditWebDAV","name":"EditWebDAV","flyout":"edit"}],"main":[{"signature":"InlineEdit","name":i.ToolbarItemRename,"onlyInTouchBrowser":!0},{"signature":"permissions","name":i.ToolbarItemPermissions},{"signature":"Download","name":i.ToolbarItemDownload},{"signature":"ReserveDoc","name":t.ToolbarItemReserve},{"signature":"UnreserveDoc","name":t.ToolbarItemUnreserve},{"signature":"Copy","name":i.ToolbarItemCopy},{"signature":"Move","name":i.ToolbarItemMove},{"signature":"AddVersion","name":i.ToolbarItemAddVersion},{"signature":"Delete","name":i.ToolbarItemDelete},{"signature":"RemoveCollectedItems","name":i.ToolbarItemRemoveCollectionItems}],"shortcut":[{"signature":"OriginalCopyLink","name":i.ToolbarItemOriginalCopyLink},{"signature":"OriginalEdit","name":i.ToolbarItemOriginalEdit},{"signature":"OriginalEmailLink","name":i.ToolbarItemOriginalShare},{"signature":"OriginalReserveDoc","name":t.ToolbarItemOriginalReserve},{"signature":"OriginalUnreserveDoc","name":t.ToolbarItemOriginalUnreserve},{"signature":"OriginalCopy","name":i.ToolbarItemOriginalCopy},{"signature":"OriginalMove","name":i.ToolbarItemOriginalMove},{"signature":"OriginalAddVersion","name":i.ToolbarItemAddVersion},{"signature":"OriginalDownload","name":i.ToolbarItemOriginalDownload},{"signature":"OriginalDelete","name":i.ToolbarItemOriginalDelete}]},{"maxItemsShown":15,"dropDownIcon":"icon icon-toolbar-more","dropDownText":i.ToolbarItemMore,"addGroupSeparators":!1,"lazyActions":!0}),"captionMenuToolbar":new s({"other":[{"signature":"Properties","name":i.MenuItemInformation},{"signature":"CopyLink","name":i.MenuItemCopyLink},{"signature":"EmailLink","name":i.MenuItemShare},{"signature":"permissions","name":i.ToolbarItemPermissions},{"signature":"Rename","name":i.MenuItemRename},{"signature":"Copy","name":i.MenuItemCopy},{"signature":"Move","name":i.MenuItemMove},{"signature":"Delete","name":i.MenuItemDelete}]},{"maxItemsShown":0,"dropDownIcon":"icon icon-expandArrowDown"}),"inlineActionbar":new s({"info":[{"signature":"Properties","name":i.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata"}],"share":[{"signature":"CopyLink","name":i.ToolbarItemCopyLink,"icon":"icon icon-toolbar-copylink"}],"edit":[{"signature":"Edit","name":i.ToolbarItemEdit,"icon":"icon icon-toolbar-edit"}],"other":[{"signature":"InlineEdit","name":i.ToolbarItemRename,"icon":"icon icon-toolbar-rename"},{"signature":"permissions","name":i.ToolbarItemPermissions,"icon":"icon icon-toolbar-permissions"},{"signature":"Download","name":i.ToolbarItemDownload,"icon":"icon icon-toolbar-download"},{"signature":"ReserveDoc","name":t.ToolbarItemReserve,"icon":"icon icon-toolbar-reserve"},{"signature":"UnreserveDoc","name":t.ToolbarItemUnreserve,"icon":"icon icon-toolbar-unreserve"},{"signature":"Copy","name":i.ToolbarItemCopy,"icon":"icon icon-toolbar-copy"},{"signature":"Move","name":i.ToolbarItemMove,"icon":"icon icon-toolbar-move"},{"signature":"AddVersion","name":i.ToolbarItemAddVersion,"icon":"icon icon-toolbar-add-version"},{"signature":"Delete",
"name":i.ToolbarItemDelete,"icon":"icon icon-toolbar-delete"},{"signature":"RemoveCollectedItems","name":i.ToolbarItemRemoveCollectionItems,"icon":"icon icon-toolbar-remove-collection-items"}]},{"maxItemsShown":5,"dropDownText":i.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more","addGroupSeparators":!1}),"rightToolbar":new s({"main":[{"signature":"Thumbnail","name":i.ToolbarItemThumbnail,"icon":"icon icon-switch_thumbnails24","commandData":{"useContainer":!0},"title":i.ThumbnailTitle},{"signature":"ToggleDescription","name":i.ToolbarItemShowDescription,"icon":"icon icon-description-toggle","commandData":{"useContainer":!0}},{"signature":"Comment","name":i.ToolbarItemComment,"icon":"icon icon-socialComment","className":"esoc-socialactions-comment","customView":!0,"commandData":{"useContainer":!0}},{"signature":"Favorite2","enabled":!0,"viewClass":o,"customView":!0,"commandData":{"useContainer":!0,"viewOptions":{"focusable":!1}}},{"signature":"RestoreWidgetViewSize","name":i.ToolbarItemRestoreWidgetViewSize,"icon":"icon icon-tileCollapse","commandData":{"useContainer":!0}},{"signature":"MaximizeWidgetView","name":i.ToolbarItemMaximizeWidgetView,"icon":"icon icon-tileExpand","commandData":{"useContainer":!0}}]},{"hAlign":"right","maxItemsShown":5,"dropDownIcon":"icon icon-toolbar-more","dropDownText":i.ToolbarItemMore,"addTrailingDivider":!1})};return r&&e.each(r,function(t){e.each(t,function(t,i){var s=l[i];if(s||"otherToolbar"!==i||(s=l.tableHeaderToolbar),!s)throw new Error("Invalid target toolbar: "+i);e.each(t,function(e){e=new n(e),s.addItem(e)})})}),l}),csui.define("csui/widgets/nodestable/toolbaritems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,t,i,s){"use strict";function n(){var n=e.config(),r=new s;this.toolbars=t.reduce(o,function(e,s){var o=new i(r,{"normalize":!1});return t.each(n,function(e,t){(e=e[s])&&o.extendMask(e)}),o.storeMask(),e[s]=o,e},{})}var o=["filterToolbar","leftToolbar","tableHeaderToolbar","inlineActionbar","rightToolbar"];return n.toolbars=o,n}),csui.define("csui/widgets/nodestable/headermenuitems",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/nodestable/headermenuitems"],function(e,t,i,s,n){var o={"headerMenuToolbar":new i({"other":[{"signature":"Properties","name":t.MenuItemInformation},{"signature":"CopyLink","name":t.MenuItemCopyLink},{"signature":"EmailLink","name":t.MenuItemShare},{"signature":"permissions","name":t.ToolbarItemPermissions},{"signature":"Rename","name":t.MenuItemRename},{"signature":"Copy","name":t.MenuItemCopy},{"signature":"Move","name":t.MenuItemMove},{"signature":"Delete","name":t.MenuItemDelete}]},{"maxItemsShown":0,"dropDownIcon":"icon icon-expandArrowDown"})};return n&&e.each(n,function(t){e.each(t,function(t,i){var n=o[i];if(!n)throw new Error("Invalid target toolbar: "+i);e.each(t,function(e){e=new s(e),n.addItem(e)})})}),o}),csui.define("csui/widgets/nodestable/headermenuitems.mask",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,t,i,s){"use strict";return i.extend({"constructor":function(){var n=e.config(),o=new s;i.prototype.constructor.call(this,o,{"normalize":!1}),t.each(n,function(e,t){this.extendMask(e)},this),this.storeMask()}})}),csui.define("hbs!csui/widgets/nodestable/impl/nodestable",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-alternating-toolbars">\r\n  <div class="csui-table-tabletoolbar"></div>\r\n  <div class="csui-table-rowselection-toolbar"></div>\r\n</div>\r\n<div class="csui-facet-table-container">\r\n  <div class="csui-table-facetview csui-facetview-hidden csui-facetview-visibility"></div>\r\n  \x3c!--outer div is needed in order to float table contents right to accommodate  facets--\x3e\r\n  <div class="csui-outertablecontainer">\r\n    \x3c!--inner div is needed in order to have tableview sized to remaining height of container--\x3e\r\n    <div class="csui-innertablecontainer">\r\n      <div class="csui-table-facetbarview"></div>\r\n      <div class="csui-table-tableview"></div>\r\n      <div class="cs-thumbnail-wrapper"></div>\r\n      <div class="csui-table-paginationview"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'}});return i.registerPartial("csui_widgets_nodestable_impl_nodestable",s),s}),csui.define("css!csui/widgets/nodestable/impl/nodestable",[],function(){}),csui.define("csui/widgets/nodestable/nodestable.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/models/utils/v1tov2","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/columns","csui/utils/contexts/factories/children","csui/utils/contexts/factories/columns2","csui/utils/contexts/factories/children2","csui/utils/contexts/factories/node","csui/models/node/node.addable.type.factory","csui/models/node/node.facet.factory","csui/models/node/node.model","csui/models/nodes","csui/controls/progressblocker/blocker","csui/controls/tabletoolbar/tabletoolbar.view","csui/controls/table/inlineforms/inlineform.factory","csui/controls/facet.panel/facet.panel.view","csui/controls/facet.bar/facet.bar.view","csui/controls/table/table.view","csui/controls/table/table.columns","csui/controls/table/rows/description/description.view","i18n!csui/widgets/nodestable/impl/nls/lang","i18n!csui/utils/commands/nls/localized.strings","i18n!csui/controls/table/impl/nls/lang","csui/controls/pagination/nodespagination.view","csui/behaviors/default.action/default.action.behavior","csui/utils/toolitem.masks/children.toolitems.mask","csui/utils/toolitem.masks/creation.toolitems.mask","csui/widgets/nodestable/toolbaritems","csui/widgets/nodestable/toolbaritems.masks","csui/widgets/nodestable/headermenuitems","csui/widgets/nodestable/headermenuitems.mask","csui/utils/commands","csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view","csui/controls/tableactionbar/tableactionbar.view","csui/controls/toolbar/toolbar.command.controller","csui/controls/draganddrop/draganddrop.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/globalmessage/globalmessage","csui/controls/thumbnail/thumbnail.view","csui/controls/thumbnail/thumbnail.content","hbs!csui/widgets/nodestable/impl/nodestable","csui/lib/jquery.redraw","css!csui/widgets/nodestable/impl/nodestable"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b,g,v,w,y,_,C,T,x,S,I,k,V,A,E,M,D,F,P,R,B,N,L,O,$,H,z,U,j,q,G){"use strict";var W=/\baccessibleTable\b(?:=([^&]*)?)?/i.exec(location.search);W=W&&"false"!==W[1];var K=e.config();i.defaults(K,{"defaultPageSize":30,"defaultPageSizes":[30,50,100],"showInlineActionBarOnHover":!W,"forceInlineActionBarOnClick":!1,"inlineActionBarStyle":"csui-table-actionbar-bubble","clearFilterOnChange":!0,"resetOrderOnChange":!1,"resetLimitOnChange":!0,"fixedFilterOnChange":!1,"useV2RestApi":!1});var J=n.LayoutView.extend({"className":function(){var e="csui-nodestable";return W&&(e+=" csui-no-animation"),e},"template":G,"ui":{"facetTableContainer":".csui-facet-table-container","outerTableContainer":".csui-outertablecontainer","innerTableContainer":".csui-innertablecontainer","tableView":".csui-table-tableview","thumbnail":".csui-thumbnail-wrapper","toolbarContainer":".csui-alternating-toolbars","facetView":".csui-table-facetview","paginationView":".csui-table-paginationview"},"regions":{"facetBarRegion":".csui-table-facetbarview","tableToolbarRegion":".csui-table-tabletoolbar","tableRowSelectionToolbarRegion":".csui-table-rowselection-toolbar","facetRegion":".csui-table-facetview","tableRegion":".csui-table-tableview","thumbnailRegion":".cs-thumbnail-wrapper","paginationRegion":".csui-table-paginationview"},"behaviors":{"DefaultAction":{"behaviorClass":E}},"constructor":function(e){e||(e={}),i.defaults(e,{"data":{},"pageSize":K.defaultPageSize,"ddItemsList":K.defaultPageSizes,"toolbarItems":F,"headermenuItems":R,"clearFilterOnChange":K.clearFilterOnChange,"resetOrderOnChange":K.resetOrderOnChange,"resetLimitOnChange":K.resetLimitOnChange,"fixedFilterOnChange":K.fixedFilterOnChange,"showDescriptions":!1});var s=e.data.pageSize||e.pageSize,o=e.data.pageSizes||e.ddItemsList;i.contains(o,s)||(o.push(s),e.data.pageSizes=o.sort()),this.context=e.context,this.tableColumns=x.deepClone(),this.commands=e.commands||N,this.commandController=new $({"commands":this.commands}),this.listenTo(this.commandController,"before:execute:command",this._beforeExecuteCommand),this.listenTo(this.commandController,"after:execute:command",this._toolbarActionTriggered),e.connector||(e.connector=this.context.getObject(a)),this.connector=e.connector,e.toolbarItemsMasks||(e.toolbarItemsMasks=new P),e.headermenuItemsMask||(e.headermenuItemsMask=new B),v.imbue({"parent":this,"focus":!0}),n.LayoutView.prototype.constructor.call(this,e),this.onWinRefresh=i.bind(this.windowRefresh,this),t(window).bind("resize.app",this.onWinRefresh),this.propagateEventsToRegions(),this.listenTo(this,"before:regions:reinitialize",this.initialize.bind(this,this.options)).listenTo(this,"dom:refresh",this._refreshTableToolbar).listenTo(this,"enable:blocking",this._rememberFocusInTable).listenTo(this,"disable:blocking",this._restoreFocusInTable)},"initialize":function(e){function t(){i.each(this.options.toolbarItemsMasks.toolbars,function(e,t){e.restoreAndResetMask(this.options.childrenToolItemsMask)},this)}var s=this.defaultActionController.commands,n=this.defaultActionController.actionItems;this.options.container?this.container=this.options.container:this.options.data.containerId&&(this.container=this.context.getModel(p,{"node":{"attributes":{"id":this.options.data.containerId}}})),this.collection||(this.collection=this.context.getCollection(u,{"options":{"commands":this.defaultActionController.commands,"defaultActionCommands":n.getAllCommandSignatures(s),"delayRestCommands":!0,"node":this.container},"attributes":this.options.data.containerId?{"id":this.options.data.containerId}:void 0})),this.options.data.containerId&&!this.collection.node.get("id")&&this.collection.node.set("id",this.options.data.containerId),this.container||(this.container=e.container||this.collection.node),this.collection.delayedActions&&this.listenTo(this.collection.delayedActions,"error",function(e,t,i){var s=new r.Error(t);U.showMessage("error",s.message)}),this.columns=e.columns||this.context.getCollection(c,{"options":{"node":this.container},"attributes":this.options.data.containerId?{"id":this.options.data.containerId}:void 0}),this.addableTypes=e.addableTypes||this.context.getCollection(m,{"options":{"node":this.container},"attributes":this.options.data.containerId?{"id":this.options.data.containerId}:void 0}),this.facetFilters=e.facetFilters||this.context.getCollection(f,{"options":{"node":this.container},"attributes":this.options.data.containerId?{"id":this.options.data.containerId}:void 0,"detached":!0}),this.listenToOnce(this.context,"request",function(){this.facetFilters.fetch()}),this.container&&(this.options.childrenToolItemsMask||(this.options.childrenToolItemsMask=new M({"context":this.context,"node":this.container})),t.call(this),this.listenTo(this.options.childrenToolItemsMask,"update",t),this.options.creationToolItemsMask||(this.options.creationToolItemsMask=new D({"context":this.context,"node":this.container})),this.listenTo(this.container,"change:id",function(){var e={"container":this.container};this.commands.get("Filter").enabled(e)?this.facetFilters.clearFilter()||this.facetFilters.fetch():this.showFilter&&this._completeFilterCommand(),this._showOrHideLocationColumn(!1)}),this._showOrHideLocationColumn()),this._setFacetBarView(),this._setToolBar(),this.setTableView(),this.setTableRowSelectionToolbar({"toolItemFactory":this.options.toolbarItems.tableHeaderToolbar,"toolbarItemsMask":this.options.toolbarItemsMasks.toolbars.tableHeaderToolbar,"showCondensedHeaderToggle":!0}),this._setTableRowSelectionToolbarEventListeners(),this.setPagination(),this.setDragNDrop()},"_setThumbnailView":function(){var e=new j({"originatingView":this,"context":this.context,"collection":this.collection,"columns":this.columns,"thumbnailColumns":this.tableView.columns,"columnsWithSearch":["name"],"orderBy":this.options.data.orderBy||this.options.orderBy,"filterBy":this.options.filterBy,"selectedChildren":new g,"actionItems":this.defaultActionController.actionItems,"commands":this.defaultActionController.commands,"tableColumns":q,"inlineBar":this.tableView.options.inlineBar,"displayedColumns":this.tableView.displayedColumns});return this.thumbnail=e,this.setThumbnailRowSelectionToolbar({"toolItemFactory":this.options.toolbarItems.tableHeaderToolbar,"toolbarItemsMask":this.options.toolbarItemsMasks.toolbars.tableHeaderToolbar,"selectedChildren":this.thumbnail.options.selectedChildren,"showCondensedHeaderToggle":!0}),this.listenTo(this.thumbnail,"execute:defaultAction",function(e){var t={"node":e};if(this.trigger("before:defaultAction",t),!t.cancel){var i=this;this.defaultActionController.executeAction(e,{"context":this.options.context,"originatingView":this}).done(function(){i.trigger("executed:defaultAction",t)})}}),!0},"setThumbnailRowSelectionToolbar":function(e){this._thumbnailRowSelectionToolbarView=new L({"toolItemFactory":e.toolItemFactory,"toolbarItemsMask":e.toolbarItemsMask,"toolbarCommandController":this.commandController,"showCondensedHeaderToggle":e.showCondensedHeaderToggle,"commands":this.defaultActionController.commands,"selectedChildren":this.thumbnail.options.selectedChildren,"container":this.collection.node,"context":this.context,"originatingView":this,"collection":this.collection})},"enableThumbnailView":function(){var e=(this.tableView,this);t.Deferred(),this.container,this.context,this.originatingView;this.dragNDrop&&this.dragNDrop.destroy(),this.thumbnailViewState?(this.tableView.selectedChildren&&this.tableView.selectedChildren.models.length>0&&(this.tableView.selectedChildren.models=[]),this._onSelectionUpdateCssClasses(this.tableView.selectedChildren.length,!0),this._setThumbnailView(),this._setThumbnailRowSelectionToolbarEventListeners()):(this._onSelectionUpdateCssClasses(this.thumbnail.options.selectedChildren.length,!0),this._setTableRowSelectionToolbarEventListeners()),this.setTableRowSelectionToolbar({"toolItemFactory":this.options.toolbarItems.tableHeaderToolbar,"toolbarItemsMask":this.options.toolbarItemsMasks.toolbars.tableHeaderToolbar,"showCondensedHeaderToggle":!0}),1!==this.tableView.options.inlineBar.options.maxItemsShown&&(this.collection.defaultInlineMaxItemsShown=this&&this.tableView.options.inlineBar.options.maxItemsShown),this.thumbnailViewState?(this.tableView.options.inlineBar.options.maxItemsShown=1,this.$el.find("table.dataTable").addClass("csui-thumbnail-view"),this.thumbnailView=!0):(this.thumbnailView=!1,this.tableView.options.inlineBar.options.maxItemsShown=this.collection.defaultInlineMaxItemsShown,this.$el.find("table.dataTable").removeClass("csui-thumbnail-view"));var i,s=this.$el.find(".csui-table-tableview");if(i=t(this.thumbnailRegion.el)[0],i=t(i),s.is(":visible")){var o=this.collection.orderBy;this.tableView.destroy(),this.res=o.split(" "),"asc"===this.res[1]?this.collection.orderstate="icon-sortArrowDown":"desc"===this.res[1]&&(this.collection.orderstate="icon-sortArrowUp"),this.thumbnailRegion.show(this.thumbnail),this.setDragNDrop(),this._assignDragArea(".cs-thumbnail-wrapper"),this.tableToolbarView.rightToolbarView&&this.tableToolbarView.rightToolbarView.collection.refilter();if(!this.thumbnail._maintainNodeState(this.collection.at(0))){var r=this.updateRowIndex;this.thumbnail._maintainNodeState(this.collection.at(r))}n.triggerMethodOn(this.thumbnail,"before:show"),this.collection&&this.collection.models&&this.collection.models.length>=0&&(0===i.length?(i=t(t(this.thumbnailRegion.el)[0]),n.triggerMethodOn(this.thumbnail,"before:show"),i.append(this.thumbnail.el),s.hide("blind",{"direction":"left","complete":function(){i.show("blind",{"direction":"right","complete":function(){n.triggerMethodOn(this.thumbnail,"show")}},100)}},100)):(s.hide("blind",{"direction":"left","complete":function(){i.show("blind",{"direction":"right","complete":function(){e.thumbnail.trigger("dom:refresh")}},100)}},100),e.thumbnail.onAfterShow()))}else{var l=this.collection.state,a=this.collection.orderBy;this.thumbnail.destroy(),this.res=a.split(" "),"asc"===this.res[1]?this.collection.orderstate="icon-sortArrowUp":"desc"===this.res[1]&&(this.collection.orderstate="icon-sortArrowDown"),this.setTableView(),this.collection.state=l,this.collection.sorting&&this.collection.sorting.sort.length>0&&this.collection.sorting.sort[0].value&&(this.collection.sorting.sort[0].value=l),this.setTableRowSelectionToolbar({"toolItemFactory":this.options.toolbarItems.tableHeaderToolbar,"toolbarItemsMask":this.options.toolbarItemsMasks.toolbars.tableHeaderToolbar,"showCondensedHeaderToggle":!0}),!this.thumbnailViewState&&this.tableToolbarView.filterToolbarView&&(this.tableToolbarView.filterToolbarView.collection.status.thumbnailViewState=this.tableView.thumbnailView),this.tableToolbarView.rightToolbarView&&this.tableToolbarView.rightToolbarView.collection.refilter(),this.tableView.collection&&0===this.tableView.collection.length&&(this.tableView._showEmptyViewText=!0),this._updateZeroRecordsMessage(),this.tableRegion.show(this.tableView),this.setDragNDrop(),this._assignDragArea(".csui-table-tableview"),this.tableView.render(),i.hide("blind",{"direction":"right","complete":function(){s.show("blind",{"direction":"left"},100),e.tableView.onAfterShow()}})}},"onDestroy":function(){t(window).unbind("resize.app",this.onWinRefresh),this.dragNDrop&&this.dragNDrop.destroy()},"windowRefresh":function(){this._isRendered&&this.isDisplayed&&this.facetView&&this.facetView.triggerMethod("dom:refresh")},"_refreshTableToolbar":function(){this.tableToolbarView&&this.tableToolbarView.rightToolbarView&&this.tableToolbarView.rightToolbarView.collection.refilter()},"onRender":function(){this.facetBarView&&this.facetBarRegion.show(this.facetBarView),this.tableToolbarRegion.show(this.tableToolbarView),this.tableRowSelectionToolbarRegion&&(!this.thumbnailView&&this._tableRowSelectionToolbarView?this.tableRowSelectionToolbarRegion.show(this._tableRowSelectionToolbarView):this._thumbnailRowSelectionToolbarView&&this.tableRowSelectionToolbarRegion.show(this._thumbnailRowSelectionToolbarView),this.tableRowSelectionToolbarRegion.$el.find("ul").attr("aria-label",V.selectedItemActionBarAria)),this.facetView&&this.facetRegion.show(this.facetView),this.tableRegion.show(this.tableView),this.paginationRegion.show(this.paginationView),this._assignDragArea(".csui-table-tableview"),this.listenTo(this,"csui.description.toggled",function(e){this.tableView.showDetailRowDescriptions(e.showDescriptions),this.tableView.trigger("update:scrollbar")}),this.addFilterCommandAria()},"onShow":function(){i.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.triggerMethod("show")})},"onAfterShow":function(){i.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.triggerMethod("after:show")})},"getSelectedNodes":function(){return new g(this.tableView.getSelectedChildren())},"setActionBarEvents":function(){o.warn("The method 'setActionBarEvents' has been deprecated and will be removed.")&&console.warn(o.last)},"_updateToolItems":function(){o.warn("The method '_updateToolItems' has been deprecated and will be removed.")&&console.warn(o.last)},"setDragNDrop":function(){this.container&&(this.dragNDrop=new H({"container":this.container,"collection":this.collection,"addableTypes":this.addableTypes,"context":this.options.context}),this.listenTo(this.dragNDrop,"drag:over",this._addDragDropBorder,this),this.listenTo(this.dragNDrop,"drag:leave",this._removeDragDropBorder,this),this.container&&(this.listenTo(this.container,"change:id",this._updateZeroRecordsMessage),this.listenTo(this.addableTypes,"reset",this._updateZeroRecordsMessage)))},"_updateZeroRecordsMessage":function(){this.tableView.setCustomLabels({"zeroRecords":(!this.container||899!==this.container.get("type"))&&this.dragNDrop&&this.dragNDrop.canAdd()&&I.dragAndDropMessage})},"_assignDragArea":function(e){this.dragNDrop&&this.dragNDrop.setDragParentView(this,e)},"_addDragDropBorder":function(e,t){var i=t&&t.disabled?"addClass":"removeClass";this.thumbnailViewState?this.ui.thumbnail.addClass("drag-over")[i]("csui-disabled"):this.ui.tableView.addClass("drag-over")[i]("csui-disabled")},"_removeDragDropBorder":function(){this.thumbnailViewState?this.ui.thumbnail.removeClass("drag-over"):this.ui.tableView.removeClass("drag-over")},"setTableView":function(e){e||(e={});var s=i.extend({"context":this.options.context,"connector":this.connector,"collection":this.collection,"columns":this.columns,"tableColumns":this.tableColumns,"descriptionRowView":S,"descriptionRowViewOptions":{"firstColumnIndex":2,"lastColumnIndex":2,"showDescriptions":!W&&this.options.showDescriptions,"collapsedHeightIsOneLine":!0},"pageSize":this.options.data.pageSize||this.options.pageSize,"originatingView":this,"columnsWithSearch":["name"],"orderBy":this.options.data.orderBy||this.options.orderBy,"filterBy":this.options.filterBy,"actionItems":this.defaultActionController.actionItems,"commands":this.defaultActionController.commands,"blockingParentView":this,"parentView":this,"inlineBar":{"viewClass":O,"options":i.extend({"collection":this.options.toolbarItems.inlineActionbar,"toolItemsMask":this.options.toolbarItemsMasks.toolbars.inlineActionbar,"delayedActions":this.collection.delayedActions,"container":this.container,"containerCollection":this.collection},this.options.toolbarItems.inlineActionbar.options,{"inlineBarStyle":K.inlineActionBarStyle,"forceInlineBarOnClick":K.forceInlineActionBarOnClick,"showInlineBarOnHover":K.showInlineActionBarOnHover})}},e);this.tableView=new T(s),this._ensureRequestingMetadata(),this.listenTo(this.tableView,"render",function(){this.tableView.$el.append(t("<div>")[0])}),this._setTableViewEvents()},"_ensureRequestingMetadata":function(){function e(){t.setFields("columns"),t.includeResources("metadata")}var t=this.container;t&&t.makeFieldsV2&&(e(),this.listenTo(this.tableView,"columnDefinitionsBuilt",e))},"_setTableViewEvents":function(){return this.listenTo(this.tableView,"tableRowSelected",function(){this.tableView.cancelAnyExistingInlineForm.call(this.tableView)}),this.container&&this.listenTo(this.container,"change:id",function(){this.options.fixedFilterOnChange?(this.collection.clearFilter(!1),this.collection.setFilter(this.options.fixedFilterOnChange,!1)):this.options.clearFilterOnChange&&this.collection.clearFilter(!1),this.options.resetOrderOnChange&&this.collection.resetOrder(!1),this.options.resetLimitOnChange&&this.collection.resetLimit(!1)}),this.listenTo(this.tableView.selectedChildren,"reset",function(){this.tableToolbarView&&(this.tableToolbarView.filterToolbarView.collection.status.thumbnailViewState=this.tableView.thumbnailView,this.tableToolbarView.updateForSelectedChildren(this.tableView.selectedChildren),this.tableRowSelectionToolbarRegion.show(this._tableRowSelectionToolbarView),this._onSelectionUpdateCssClasses(this.tableView.selectedChildren.length))}),this.listenTo(this.tableView,"execute:defaultAction",function(e){var t={"node":e};if(this.trigger("before:defaultAction",t),!t.cancel){var i=this;this.defaultActionController.executeAction(e,{"context":this.options.context,"originatingView":this}).done(function(){i.trigger("executed:defaultAction",t)})}}),!0},"_setToolBar":function(){return this.tableToolbarView=new w({"context":this.options.context,"toolbarItems":this.options.toolbarItems,"toolbarItemsMasks":this.options.toolbarItemsMasks,"headermenuItems":this.options.headermenuItems,"headermenuItemsMask":this.options.headermenuItemsMask,"creationToolItemsMask":this.options.creationToolItemsMask,"container":this.container,"collection":this.collection,"originatingView":this,"blockingParentView":this,"addableTypes":this.addableTypes,"toolbarCommandController":this.commandController}),!0},"setTableRowSelectionToolbar":function(e){this._tableRowSelectionToolbarView=new L({"toolItemFactory":e.toolItemFactory,"toolbarItemsMask":e.toolbarItemsMask,"toolbarCommandController":this.commandController,"showCondensedHeaderToggle":e.showCondensedHeaderToggle,"commands":this.defaultActionController.commands,"selectedChildren":this.tableView.selectedChildren,"container":this.collection.node,"context":this.context,"originatingView":this,"collection":this.collection});var t;t=this.thumbnailViewState?this._thumbnailRowSelectionToolbarView:this._tableRowSelectionToolbarView,this.listenTo(t,"toggle:condensed:header",function(){if(this.tableToolbarRegion.$el.hasClass("csui-table-rowselection-toolbar-visible")){this.ui.toolbarContainer&&this.ui.toolbarContainer.toggleClass("csui-show-header");var e=this.ui.toolbarContainer&&this.ui.toolbarContainer.hasClass("csui-show-header");e&&this.tableToolbarRegion.$el.removeClass("binf-hidden"),t.trigger("toolbar:activity",!0,e)}})},"_triggerToolbarActivityEvent":function(e,t){(this.thumbnailView?this._thumbnailRowSelectionToolbarView:this._tableRowSelectionToolbarView).trigger("toolbar:activity",e,t)},"_onSelectionUpdateCssClasses":function(e,t){function i(e,t){!0!==t&&n._triggerToolbarActivityEvent(n._tableRowSelectionToolbarVisible,e),n._tableRowSelectionToolbarVisible?e||n.tableToolbarRegion.$el.addClass("binf-hidden"):n.tableRowSelectionToolbarRegion.$el.addClass("binf-hidden")}var s,n=this,o=this.tableRowSelectionToolbarRegion.$el;W?e>0?this._tableRowSelectionToolbarVisible||(this._tableRowSelectionToolbarVisible=!0,this.tableToolbarRegion.$el.addClass("csui-table-rowselection-toolbar-visible"),o.removeClass("binf-hidden"),o.addClass("csui-table-rowselection-toolbar-visible"),s=this.ui.toolbarContainer&&this.ui.toolbarContainer.hasClass("csui-show-header"),i(s)):this._tableRowSelectionToolbarVisible&&(this._tableRowSelectionToolbarVisible=!1,this.ui.toolbarContainer&&this.ui.toolbarContainer.removeClass("csui-show-header"),this.tableToolbarRegion.$el.removeClass("binf-hidden"),this.tableToolbarRegion.currentView.trigger(this.tableToolbarRegion.currentView,"dom:refresh"),this.tableToolbarRegion.$el.removeClass("csui-table-rowselection-toolbar-visible"),o.removeClass("csui-table-rowselection-toolbar-visible"),i(!1,t)):e>0?this._tableRowSelectionToolbarVisible||(this._tableRowSelectionToolbarVisible=!0,s=this.ui.toolbarContainer&&this.ui.toolbarContainer.hasClass("csui-show-header"),o.removeClass("binf-hidden").redraw().one("transitionend",function(){i(s)}.bind(this)).addClass("csui-table-rowselection-toolbar-visible"),this.tableToolbarRegion.$el.addClass("csui-table-rowselection-toolbar-visible")):this._tableRowSelectionToolbarVisible&&(this._tableRowSelectionToolbarVisible=!1,this.ui.toolbarContainer&&this.ui.toolbarContainer.removeClass("csui-show-header"),this.tableToolbarRegion.$el.removeClass("binf-hidden").redraw(),this.tableToolbarRegion.currentView.trigger(this.tableToolbarRegion.currentView,"dom:refresh"),o.one("transitionend",function(){i(!1,t)}.bind(this)).removeClass("csui-table-rowselection-toolbar-visible"),this.tableToolbarRegion.$el.removeClass("csui-table-rowselection-toolbar-visible"))},"_setTableRowSelectionToolbarEventListeners":function(){this.listenTo(this.tableView.selectedChildren,"reset",function(){this.tableToolbarView.filterToolbarView.collection.status.thumbnailViewState=this.thumbnailView,this.tableRowSelectionToolbarRegion.show(this._tableRowSelectionToolbarView),this._onSelectionUpdateCssClasses(this.tableView.selectedChildren.length)})},"_setCommonRowSelectionToolbarEventListeners":function(e){this.listenTo(e,"reset",function(){this.tableToolbarView.filterToolbarView.collection.status.thumbnailViewState=this.thumbnailView,this.tableRowSelectionToolbarRegion.show(this._tableRowSelectionToolbarView),this._onSelectionUpdateCssClasses(e.length)})},"_setThumbnailRowSelectionToolbarEventListeners":function(){this.listenTo(this.thumbnail.options.selectedChildren,"reset",function(){this.tableToolbarView.filterToolbarView.collection.status.thumbnailViewState=this.thumbnailView,this.tableRowSelectionToolbarRegion.show(this._thumbnailRowSelectionToolbarView),this._onSelectionUpdateCssClasses(this.thumbnail.options.selectedChildren.length)})},"setPagination":function(){return this.paginationView=new A({"collection":this.collection,"pageSize":this.options.data.pageSize||this.options.pageSize,"defaultDDList":this.options.data.pageSizes||this.options.ddItemsList}),!0},"_handleFacetBarVisible":function(){this.facetBarView.$el.find(".csui-facet-list-bar .csui-facet-item:last a").focus()},"_handleFacetBarHidden":function(){},"_showOrHideLocationColumn":function(e){var t=this.container&&this.container.get("type");e=!!e||!!t&&(899===t||298===t);var i={"properties":["parent_id"]};this.useV2RestApi||(i=l.expandsV2toV1(i)),e?this.tableColumns.get("parent_id")||(this.tableColumns.add([{"key":"parent_id","title":I.columnTitleLocation,"sequence":800,"permanentColumn":!1}]),this.collection.setExpand(i)):(this.tableColumns.remove("parent_id"),this.collection.resetExpand(i))},"_ensureFacetPanelViewDisplayed":function(){void 0===this.facetView&&(this._setFacetPanelView(),this.facetRegion.show(this.facetView))},"_setFacetPanelView":function(){this.facetView=new _({"collection":this.facetFilters,"blockingLocal":!0}),this.listenTo(this.facetView,"remove:filter",this._removeFacetFilter).listenTo(this.facetView,"remove:all",this._removeAll).listenTo(this.facetView,"apply:filter",this._addToFacetFilter).listenTo(this.facetView,"apply:all",this._setFacetFilter)},"_removeFacetPanelView":function(){this.thumbnailViewState&&this.thumbnail._adjustThumbnailWidth(),this.facetRegion.empty(),this.facetView=void 0},"_setFacetBarView":function(){this.facetBarView=new C({"collection":this.facetFilters,"context":this.options.context,"showSaveFilter":!0}),this.listenTo(this.facetBarView,"remove:filter",this._removeFacetFilter).listenTo(this.facetBarView,"remove:all",this._removeAll).listenTo(this.facetBarView,"facet:bar:visible",this._handleFacetBarVisible).listenTo(this.facetBarView,"facet:bar:hidden",this._handleFacetBarHidden)},"_addToFacetFilter":function(e){this.facetFilters.addFilter(e);var t=this.facetFilters.getFilterQueryValue();this._showOrHideLocationColumn(!0),this.collection.resetLimit(),this.collection.setFilter({"facet":t})},"_setFacetFilter":function(e){this.facetFilters.setFilter(e);var t=this.facetFilters.getFilterQueryValue();this._showOrHideLocationColumn(!0),this.collection.resetLimit(),this.collection.setFilter({"facet":t})},"_removeFacetFilter":function(e){this.facetFilters.removeFilter(e);var t=this.facetFilters.getFilterQueryValue(),i=0!==t.length;this.collection.resetLimit(),this.collection.setFilter({"facet":t}),this._showOrHideLocationColumn(i)},"_removeAll":function(){this.facetFilters.clearFilter(),this.collection.resetLimit(),this.collection.setFilter({"facet":[]}),this._showOrHideLocationColumn(!1)},"_beforeExecuteCommand":function(e){e&&"Thumbnail"!==e.commandSignature&&!this.thumbnailViewState?this.tableView.cancelAnyExistingInlineForm.call(this.tableView):e&&"Thumbnail"!==e.commandSignature&&this.thumbnailViewState&&this.thumbnail.cancelAnyExistingInlineForm.call(this.thumbnail),"Delete"===e.commandSignature&&(this.deletingNodes=!0,this.tableView.setDeletingNodesState(!0))},"_toolbarActionTriggered":function(e){if(e&&!e.cancelled){if(e.status.forwardToTable){var t=y.getInlineFormView(e.addableType)
;t&&(e.newNodes[0].error||(this.thumbnailView?this.thumbnail.startCreateNewModel(e.newNodes[0],t):this.tableView.startCreateNewModel(e.newNodes[0],t)))}switch(e.command&&e.command.allowCollectionRefetch&&"Delete"!==e.commandSignature&&this.collection.fetch(),e.commandSignature){case"Delete":this.deletingNodes=!1,this.tableView.setDeletingNodesState(!1),this.collection.fetch();break;case"Filter":this._completeFilterCommand();break;case"MaximizeWidgetView":case"RestoreWidgetViewSize":this.tableToolbarView.rightToolbarView.collection.refilter();break;case"Thumbnail":this.thumbnailViewState=!this.thumbnailViewState||!this.thumbnailViewState,this.enableThumbnailView()}}},"_transitionEnd":i.once(function(){var e,t={"transition":"transitionend","WebkitTransition":"webkitTransitionEnd","MozTransition":"transitionend","OTransition":"oTransitionEnd otransitionend"},i=document.createElement("div");for(e in t)if(void 0!==i.style[e])return t[e]}),"_completeFilterCommand":function(){var e=this;this.showFilter=!this.showFilter,this.showFilter?(this._ensureFacetPanelViewDisplayed(),this.ui.facetView.removeClass("csui-facetview-visibility"),W?(this.ui.facetView.removeClass("csui-facetview-hidden"),this.triggerMethod("dom:refresh")):this.ui.facetView.one(this._transitionEnd(),function(){e.triggerMethod("dom:refresh"),e.thumbnailViewState&&e.thumbnail._adjustThumbnailWidth()}).removeClass("csui-facetview-hidden")):W?(this.ui.facetView.addClass("csui-facetview-hidden"),this.triggerMethod("dom:refresh"),this.ui.facetView.hasClass("csui-facetview-hidden")&&this.ui.facetView.addClass("csui-facetview-visibility"),this._removeFacetPanelView()):this.ui.facetView.one(this._transitionEnd(),function(){e.triggerMethod("dom:refresh"),e.ui.facetView.hasClass("csui-facetview-hidden")&&e.ui.facetView.addClass("csui-facetview-visibility"),e._removeFacetPanelView()}).addClass("csui-facetview-hidden"),this.addFilterCommandAria()},"addFilterCommandAria":function(){this.ui.facetView.hasClass("csui-facetview-hidden")&&this.tableToolbarView&&this.tableToolbarView.filterToolbarView?(this.tableToolbarView.filterToolbarView.$el.find(".csui-toolitem").attr("aria-label",I.filterExpandAria),this.tableToolbarView.filterToolbarView.$el.find(".csui-toolitem").attr("aria-expanded",!1)):(this.tableToolbarView.filterToolbarView.$el.find(".csui-toolitem").attr("aria-label",I.filterCollapseAria),this.tableToolbarView.filterToolbarView.$el.find(".csui-toolitem").attr("aria-expanded",!0))},"_rememberFocusInTable":function(){this.tableView.el.contains(document.activeElement)&&(this._tableFocused=!0)},"_restoreFocusInTable":function(){this._tableFocused&&this.tableView.currentlyFocusedElement()&&this.tableView.currentlyFocusedElement().focus()}},{"useV2RestApi":K.useV2RestApi});return i.extend(J.prototype,z),J.prototype._eventsToPropagateToRegions.push("global.alert.inprogress","global.alert.completed"),J.useV2RestApi&&(u=h,c=d),J}),csui.define("hbs!csui/integration/folderbrowser/impl/folderbrowser",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'\r\n<div id="csui-folderbrowser-core">\r\n\r\n  <div class="csui-fb-breadcrumbs"></div>\r\n  <div class="csui-fb-nodestable "></div>\r\n</div>'}});return i.registerPartial("csui_integration_folderbrowser_impl_folderbrowser",s),s}),csui.define("css!csui/integration/folderbrowser/impl/folderbrowser",[],function(){}),csui.define("csui/integration/folderbrowser/impl/folderbrowser.view",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/utils/contexts/page/page.context","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/node","csui/utils/contexts/factories/next.node","csui/utils/contexts/factories/user","csui/utils/contexts/factories/children","csui/utils/contexts/factories/children2","csui/models/node/node.model","csui/utils/connector","csui/utils/base","csui/utils/contexts/factories/ancestors","csui/controls/breadcrumbs/breadcrumbs.view","csui/widgets/nodestable/nodestable.view","csui/behaviors/default.action/default.action.behavior","csui/controls/table/table.columns","csui/controls/globalmessage/globalmessage","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/default.action/impl/defaultaction","csui/dialogs/modal.alert/modal.alert","hbs!csui/integration/folderbrowser/impl/folderbrowser","csui/controls/iconpreload/icon.preload.view","css!csui/integration/folderbrowser/impl/folderbrowser"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b,g,v,w,y,_,C,T,x,S,I){"use strict";function k(e){return e.get&&e.get("id")||e.id||e}v.useV2RestApi&&(d=h);var V=n.LayoutView.extend({"className":"binf-widgets csui-folderbrowser","template":S,"regions":{"breadcrumbRegion":"#csui-folderbrowser-core div.csui-fb-breadcrumbs","nodeTableRegion":"#csui-folderbrowser-core div.csui-fb-nodestable"},"behaviors":{"DefaultAction":{"behaviorClass":w}},"constructor":function(e){e||(e={}),this.setDefaultOptions(e);var t=e.connection,i=e.connector,o=e.context||new r({"factories":{"connector":i||t&&{"connection":t}||void 0}});i||(i=o.getObject(l)),this.context=o,this.connector=i,null==e.context&&s.extend(e,{"context":this.context}),n.LayoutView.prototype.constructor.call(this,e),this.container=this._initializeContainer(o,e),this.collection=this._initializeChildCollection(o,e),this.nodesTable=this._initializeNodesTable(o,e),this.tableView=this.nodesTable.tableView,this.breadcrumbs=this._initializeBreadCrumb(this.options),this._nextNode=o.getModel(c),this.listenTo(this._nextNode,"change:id",function(){this.enterContainer(this._nextNode.attributes),this._nextNode.clear({"silent":!0})}),o.getModel(u),this.prevNodeId=this.container.get("id"),null!=this.prevNodeId&&(this.contextPromise=this.container.isFetchableDirectly()?o.fetch():this.container.fetch({"silent":!0}).fail(s.bind(this.handleFetchError,this)).then(function(){return o.fetch()})),this.listenTo(o,"error",this.handleFetchError),this.propagateEventsToRegions()},"setDefaultOptions":function(e){s.defaults(e,{"breadcrumb":!0,"facetPanel":!0,"columnsFromDefinitionsOrder":!1})},"onDestroy":function(){this.nodesTable.destroy(),this.breadcrumbs&&this.breadcrumbs.destroy()},"onRender":function(){this.nodeTableRegion.show(this.nodesTable),null!=this.breadcrumbs&&(this.$el.addClass("csui-with-breadcrumb"),this.breadcrumbRegion.show(this.breadcrumbs)),I.ensureOnThePage(),_.setMessageRegionView(this,{"classes":"csui-globalMessenger"})},"updateOptions":function(e){e&&(this.breadcrumbs&&this._updateBreadcrumbs(e),e.start&&e.start.id&&this.enterContainer(e.start.id))},"enterContainer":function(e,t){var i={"id":k(e)};return i.id!=this.prevNodeId&&(this.trigger("openingContainer",i),i.cancel?null!=t&&(t.cancel=!0):this.fetchNode(i)),this},"fetchNode":function(e){var t=this.container;return this.prevNodeId=e.id,t.set(e),this.context.fetch(),!0},"_initializeContainer":function(e,t){var i=e.getObject(a);return t.start||(t.start={"type":141}),t.start.id?p.usesIntegerId&&"string"==typeof t.start.id?i.set({"id":parseInt(t.start.id,10)}):i.set({"id":t.start.id}):t.start.type&&i.set({"id":"volume","type":t.start.type}),this._setContainerEvents(i),i},"_setContainerEvents":function(e){return this.listenTo(e,"change:id",function(e,t){this.enterContainer(e.get("id"),t)}),!0},"_initializeChildCollection":function(e,t){var i=e.getCollection(d,{"options":{"commands":this.defaultActionController.commands,"defaultActionCommands":this.defaultActionController.actionItems.getAllCommandSignatures(this.defaultActionController.commands),"delayRestCommands":!0}});return i.setLimit(0,t.pageSize,!1),i.setFilter(t.filter,!1),this.listenTo(i,"sync",function(){this._containerOpened(this.container)}),i},"_initializeNodesTable":function(e,t){var i=new v({"context":e,"pageSize":t.pageSize,"ddItemsList":t.pageSizes,"tableColumns":t.tableColumns,"clearFilterOnChange":t.clearFilterOnChange,"resetOrderOnChange":t.resetOrderOnChange,"resetLimitOnChange":t.resetLimitOnChange,"fixedFilterOnChange":t.fixedFilterOnChange});return this.listenTo(i,"executed:defaultAction",function(e){"Browse"===e.signature&&this._containerOpened(e.node)}),this.listenTo(i.tableView,"tableBodyRendered",function(e){this.trigger("tableBodyRendered",{"sender":this,"target":e.target})}),this.listenTo(i,"before:defaultAction",function(e){this._beforeDefaultAction(e)}),i},"_beforeDefaultAction":function(e){var t={"sender":this,"node":e.node};return this.trigger("executingDefaultAction",t),e.cancel=t.cancel,!0},"_containerOpened":function(e){return this.trigger("containerOpened",{"sender":this,"node":e}),!0},"updateBreadcrumb":function(e){var t=k(e);this.breadcrumbs.updateStopId(t)},"_initializeBreadCrumb":function(e){var t=null;return this.options.breadcrumb&&(s.isObject(this.options.breadcrumb)||(this.options.breadcrumb={}),t=new g({"context":e.context,"collection":e.context.getCollection(b),"stop":e.breadcrumb.stop}),e.breadcrumb.isBreadcrumbsEmpty=!0,this._setBreadcrumbEvents(t)),t},"_setBreadcrumbEvents":function(e){return this.listenTo(e,"before:defaultAction",this._beforeDefaultAction),!0},"handleFetchError":function(e){var t=new f.Error(e);this.tableView.cancelFetch(),this.tableView.renderError(),x.showError(t.message)}});return s.extend(V.prototype,C),V}),csui.define("csui/integration/folderbrowser/folderbrowser.widget",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/integration/folderbrowser/impl/folderbrowser.view"],function(e,t,i,s){"use strict";function n(t){this.options=t||(t={}),this.folderView=new s(t),this.listenTo(this.folderView,"containerOpened",function(e){this.trigger("containerOpened",{"sender":this,"node":e.node.toJSON()})}),this.listenTo(this.folderView,"executingDefaultAction",function(e){var t={"sender":this,"node":e.node.toJSON()};this.trigger("executingDefaultAction",t),e.cancel=t.cancel}),this.listenTo(this.folderView,"tableBodyRendered",function(e){this.trigger("tableBodyRendered",{"sender":this,"target":e.target})});var i=this.folderView.nodesTable.getSelectedNodes(),n=i.clone();this.listenTo(i,"reset",function(){var t,s;i.length>n.length?(t="childSelected",s=i.reject(function(e){return n.findWhere({"id":e.get("id")})})):(t="childUnselected",s=n.reject(function(e){return i.findWhere({"id":e.get("id")})})),s.length&&this.trigger(t,{"sender":this,"nodes":e.invoke(s,"toJSON")}),n=i.clone()})}function o(t){var s=this.folderView.contextPromise,n=this;return t||(t={}),e.extend(t,this.options),this.region=new i.Region({"el":t.placeholder}),s?s.done(function(){n.region&&n.region.show(n.folderView)}):n.region.show(n.folderView),this}function r(){return this.region&&(this.folderView.destroy(),this.region.destroy(),this.region=null),this}var l=t.Events.listenTo;return e.extend(n.prototype,t.Events,{"constructor":n,"show":o,"display":o,"destroy":r,"close":r,"enterContainer":function(e,t){return t&&t.stop&&this.folderView.updateBreadcrumb(t.stop),this.folderView.enterContainer(e),this},"getContainer":function(){return this.folderView.container.toJSON()},"getSelectedChildren":function(){return this.folderView.nodesTable.selectedNodes.toJSON()},"listenTo":function(e,t,i){return"string"==typeof e?l.call(this,this,e,t):l.call(this,e,t,i)}}),n.version="1.0",n}),csui.define("csui/integration/target.picker/target.picker",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/dialogs/node.picker/node.picker","csui/utils/contexts/page/page.context"],function(e,t,i,s,n){"use strict";function o(t){this.options=e.defaults({},t,r)}var r={"start":{},"selectRows":"single","filter":{},"selectable":{},"ui":{}};return e.extend(o.prototype,t.Events,{"show":function(t){t=e.defaults({},t,this.options);var i=t.connector||{"connection":t.connection},o=new n({"factories":{"connector":i}}),r=e.isEmpty(t.start)?void 0:t.start.id?t.start:{"id":"volume","type":t.start.type},l=e.isEmpty(t.selectable.type)?t.filter.type:t.selectable.type,a=new s({"context":o,"initialContainer":r,"selectMultiple":"multiple"===t.selectRows,"selectableTypes":l,"globalSearch":!0,"dialogTitle":t.ui.TargetPickerDialogTitle}),c=a.show(),u=this;return c.done(function(i){var s=i.nodes[0],n=e.invoke(i.nodes,"toJSON");u.trigger("childSelected",{"sender":u,"nodes":e.invoke(i.nodes,"toJSON"),"ancestors":[]}),t.done&&t.done({"sender":u,"node":s&&s.toJSON(),"ancestors":[],"nodes":n})}).fail(function(){t.done&&t.done({"sender":u,"nodes":[]})}),this}}),o.defaults={"containers":{"selectable":{"type":s.defaults.containers.selectableTypes},"ui":{"TargetPickerDialogTitle":s.defaults.containers.dialogTitle}},"documents":{"selectable":{"type":s.defaults.documents.selectableTypes},"ui":{"TargetPickerDialogTitle":s.defaults.documents.dialogTitle}},"categories":{"start":s.defaults.categories.initialContainer,"selectable":{"type":s.defaults.categories.selectableTypes},"ui":{"TargetPickerDialogTitle":s.defaults.categories.dialogTitle}}},o}),csui.define("csui/integration/v1.widgets.wrapper",["csui/lib/underscore","csui/utils/connector","csui/integration/folderbrowser/folderbrowser.widget","csui/integration/target.picker/target.picker"],function(e,t,i,s){var n=window.csui;return e.extend(n,{"version":"2.0","util":{"Connector":t},"widget":{"FolderBrowserWidget":i,"TargetPickerDialogWidget":s},"Connector":t,"FolderBrowserWidget":i}),n}),csui.define("csui/integration/permission.header/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/integration/permission.header/impl/nls/root/lang",{"lblSecurityClearance":"Security clearance","lblSupplementalMarkings":"Supplemental markings"}),csui.define("hbs!csui/integration/permission.header/impl/permission.header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-permissions-rightbar-view">\r\n  <div class="csui-secuirity-clearance"><label>'+this.escapeExpression((n=null!=(n=t.lblSecurityClearance||(null!=e?e.lblSecurityClearance:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"lblSecurityClearance","hash":{}}):n))+'</label><span>Secret</span\r\n  ></div>\r\n  <div class="csui-supplimental-markings"><label>'+this.escapeExpression((n=null!=(n=t.lblSupplementalMarkings||(null!=e?e.lblSupplementalMarkings:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"lblSupplementalMarkings","hash":{}}):n))+"</label><span\r\n  >Contractor; For official use only\r\n  </span\r\n></div>\r\n</div>"}});return i.registerPartial("csui_integration_permission.header_impl_permission.header",s),s}),csui.define("css!csui/integration/permission.header/impl/permission.header",[],function(){}),csui.define("csui/integration/permission.header/permission.header.view",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","i18n!csui/integration/permission.header/impl/nls/lang","hbs!csui/integration/permission.header/impl/permission.header","css!csui/integration/permission.header/impl/permission.header"],function(e,t,i,s,n,o,r){"use strict";return n.ItemView.extend({"template":r,"templateHelpers":function(){return{"lblSecurityClearance":o.lblSecurityClearance,"lblSupplementalMarkings":o.lblSupplementalMarkings}},"constructor":function(e){e||(e={}),n.ItemView.prototype.constructor.call(this,e)}})}),csui.define("css!csui/integration/permission/table/cells/impl/security.permission.cell",[],function(){}),csui.define("csui/integration/permission/table/cells/security.permission.cell",["csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/cell.registry","css!csui/integration/permission/table/cells/impl/security.permission.cell"],function(e,t){"use strict";var i=e.extend({"renderValue":function(){var e=this.getValueText();"true"===e?this.$el.append('<span class="csui-icon icon-true icon-checkmark-green"></span>'):"false"===e?this.$el.append('<span class="csui-icon icon-false circle_delete"></span>'):this.$el.text(e)}},{"hasFixedWidth":!0});return t.registerByColumnKey("security_clearance",i),t.registerByColumnKey("supplemental_markings",i),i}),csui.define("csui/integration/permission/table/permission.table.columns",["csui/lib/underscore"],function(e){return[{"key":"security_clearance","sequence":31,"permanentColumn":!0},{"key":"supplemental_markings","sequence":32,"permanentColumn":!0}]}),csui.define("csui/integration/folderbrowser/impl/nls/folderbrowser.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/integration/folderbrowser/impl/nls/root/folderbrowser.manifest",{"BackButtonToolItem":"Go Back","PageWidgetToolItem":"Open Full Page Container"}),csui.define("css!csui/integration/folderbrowser/impl/icons",[],function(){}),csui.define("csui/integration/folderbrowser/impl/nodestable.toolitems",["csui/lib/underscore","csui/utils/base","csui/controls/toolbar/toolitems.factory","i18n!csui/integration/folderbrowser/impl/nls/folderbrowser.manifest","css!csui/integration/folderbrowser/impl/icons"],function(e,t,i,s){return{"leftToolbar":[{"signature":"Back","name":s.BackButtonToolItem,"icon":"icon arrow_back csui-icon-go-previous-node csui-no-hover-effect"}],"rightToolbar":[{"signature":"Page","name":s.PageWidgetToolItem,"icon":"icon csui-icon-open-full-page","group":"main","options":{"hAlign":"right"}}]}}),csui.define("csui/widgets/search.results/impl/search.results.factory",["csui/utils/contexts/factories/search.results.factory"],function(e){return e.extend({"constructor":function(t,i){e.prototype.constructor.apply(this,arguments),console.warn('warning: "csui/widgets/search.results/impl/search.results.factory" has been deprecated. Use "csui/utils/contexts/factories/search.results.factory')}})}),csui.define("json!csui/utils/contexts/perspective/impl/perspectives/metadata.json",{"type":"grid","options":{"rows":[{"columns":[{"sizes":{"md":12},"heights":{"xs":"full"},"widget":{"type":"csui/widgets/metadata","options":{}}}]}]}}),csui.define("json!csui/utils/contexts/perspective/impl/perspectives/metadata.navigation.json",{"type":"grid","options":{"rows":[{"columns":[{"sizes":{"md":12},"heights":{"xs":"full"},"widget":{"type":"csui/widgets/metadata.navigation","options":{}}}]}]}}),csui.define("json!csui/utils/contexts/perspective/impl/perspectives/document.overview.json",{"type":"grid","options":{"rows":[{"columns":[{"sizes":{"md":12},"heights":{"xs":"full"},"widget":{"type":"csui/widgets/document.overview","options":{}}}]}]}}),csui.define("csui/utils/testutils/async.test.utils",["module","csui/lib/underscore","csui/lib/jquery"],function(e,t,i){function s(e,s,n){var o,r,l=i.Deferred(),a={};return"number"==typeof n?a.interval=n:"boolean"==typeof n?a.removal=n:a=n,n=t.extend({"interval":50,"removal":!1,"length":0},a),e&&s?(o=i(e).find(s),(n.removal?o.length===n.length:o.length>n.length)?l.resolve(o):r=setInterval(function(){o=i(e).find(s),(n.removal?o.length===n.length:o.length>n.length)&&(clearInterval(r),l.resolve(o))},n.interval)):(console.warn("parent or child selector missing"),l.reject()),l.promise()}return{"asyncElement":s}}),csui.define("csui/widgets/favorites/toolbaritems",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/nls/localized.strings","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/favorites/toolbaritems"],function(e,t,i,s,n,o){"use strict";var r={"tableHeaderToolbar":new s({"info":[{"signature":"Properties","name":i.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata"}],"share":[{"signature":"CopyLink","name":i.ToolbarItemCopyLink},{"signature":"Share","name":i.ToolbarItemShare,"flyout":"share","group":"share"},{"signature":"EmailLink","name":i.ToolbarItemEmailLink,"flyout":"share","promoted":!0,"group":"share"}],"edit":[{"signature":"Edit","name":i.ToolbarItemEdit,"flyout":"edit","promoted":!0},{"signature":"EditActiveX","name":"EditActiveX","flyout":"edit"},{"signature":"EditOfficeOnline","name":"EditOfficeOnline","flyout":"edit"},{"signature":"EditWebDAV","name":"EditWebDAV","flyout":"edit"}],"main":[{"signature":"FavoriteRename","name":i.ToolbarItemRename,"onlyInTouchBrowser":!0},{"signature":"permissions","name":i.ToolbarItemPermissions},{"signature":"Download","name":i.ToolbarItemDownload},{"signature":"ReserveDoc","name":t.ToolbarItemReserve},{"signature":"UnreserveDoc","name":t.ToolbarItemUnreserve},{"signature":"Copy","name":i.ToolbarItemCopy},{"signature":"Move","name":i.ToolbarItemMove},{"signature":"AddVersion","name":i.ToolbarItemAddVersion}],"shortcut":[{"signature":"OriginalCopyLink","name":i.ToolbarItemOriginalCopyLink},{"signature":"OriginalEdit","name":i.ToolbarItemOriginalEdit},{"signature":"OriginalEmailLink","name":i.ToolbarItemOriginalShare},{"signature":"OriginalReserveDoc","name":t.ToolbarItemOriginalReserve},{"signature":"OriginalUnreserveDoc","name":t.ToolbarItemOriginalUnreserve},{"signature":"OriginalCopy","name":i.ToolbarItemOriginalCopy},{"signature":"OriginalMove","name":i.ToolbarItemOriginalMove},{"signature":"OriginalAddVersion","name":i.ToolbarItemAddVersion},{"signature":"OriginalDownload","name":i.ToolbarItemOriginalDownload}]},{"maxItemsShown":15,"dropDownText":i.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more","addGroupSeparators":!1,"lazyActions":!0}),"inlineActionbar":new s({"info":[{"signature":"Properties","name":i.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata"}],"share":[{"signature":"CopyLink","name":i.ToolbarItemCopyLink,"icon":"icon icon-toolbar-copylink"}],"edit":[{"signature":"Edit","name":i.ToolbarItemEdit,"icon":"icon icon-toolbar-edit"}],"other":[{"signature":"permissions","name":i.ToolbarItemPermissions,"icon":"icon icon-toolbar-permissions"},{"signature":"FavoriteRename","name":i.ToolbarItemRenameFavorite,"icon":"icon icon-toolbar-rename"},{"signature":"Download","name":i.ToolbarItemDownload,"icon":"icon icon-toolbar-download"},{"signature":"ReserveDoc","name":t.ToolbarItemReserve,"icon":"icon icon-toolbar-reserve"},{"signature":"UnreserveDoc","name":t.ToolbarItemUnreserve,"icon":"icon icon-toolbar-unreserve"},{"signature":"Copy","name":i.ToolbarItemCopy,"icon":"icon icon-toolbar-copy"},{"signature":"Move","name":i.ToolbarItemMove,"icon":"icon icon-toolbar-move"},{"signature":"AddVersion","name":i.ToolbarItemAddVersion,"icon":"icon icon-toolbar-add-version"}]},{"maxItemsShown":5,"dropDownText":i.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more","addGroupSeparators":!1}),"dropdownMenuListInProperties":new s({"main":[{"signature":"Properties","name":i.ToolbarItemInformation},{"signature":"CopyLink","name":i.ToolbarItemCopyLink},{"signature":"Edit","name":i.ToolbarItemEdit},{"signature":"EmailLink","name":i.ToolbarItemShare},{"signature":"Download","name":i.ToolbarItemDownload},{"signature":"ReserveDoc","name":t.ToolbarItemReserve},{"signature":"UnreserveDoc","name":t.ToolbarItemUnreserve},{"signature":"Copy","name":i.ToolbarItemCopy},{"signature":"Move","name":i.ToolbarItemMove},{"signature":"AddVersion","name":i.ToolbarItemAddVersion},{"signature":"permissions","name":i.ToolbarItemPermissions}],"shortcut":[{"signature":"OriginalCopyLink","name":i.ToolbarItemOriginalCopyLink},{"signature":"OriginalEdit","name":i.ToolbarItemOriginalEdit},{"signature":"OriginalEmailLink","name":i.ToolbarItemOriginalShare},{"signature":"OriginalReserveDoc","name":t.ToolbarItemOriginalReserve},{"signature":"OriginalUnreserveDoc","name":t.ToolbarItemOriginalUnreserve},{"signature":"OriginalCopy","name":i.ToolbarItemOriginalCopy},{"signature":"OriginalMove","name":i.ToolbarItemOriginalMove},{"signature":"OriginalAddVersion","name":i.ToolbarItemAddVersion},{"signature":"OriginalDownload","name":i.ToolbarItemOriginalDownload}]},{"maxItemsShown":0,"dropDownIcon":"icon icon-expandArrowDown"})};return o&&e.each(o,function(t){e.each(t,function(t,i){var s=r[i];if(s||"otherToolbar"!==i||(s=r.tableHeaderToolbar),!s)throw new Error("Invalid target toolbar: "+i);e.each(t,function(e){e=new n(e),s.addItem(e)})})}),r}),csui.define("csui/widgets/favorites/toolbaritems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,t,i,s){"use strict";function n(){var n=e.config(),r=new s;this.toolbars=t.reduce(o,function(e,s){var o=new i(r,{"normalize":!1});return t.each(n,function(e,t){(e=e[s])&&o.extendMask(e)}),o.storeMask(),e[s]=o,e},{})}var o=["tableHeaderToolbar","inlineActionbar"];return n.toolbars=o,n}),csui.define("csui/widgets/recentlyaccessed/toolbaritems",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/nls/localized.strings","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/recentlyaccessed/toolbaritems"],function(e,t,i,s,n,o){"use strict";var r={"filterToolbar":new s({"filter":[{"signature":"Filter","name":i.ToolbarItemFilter,"icon":"icon icon-toolbarFilter"}]},{"addTrailingDivider":!1}),"tableHeaderToolbar":new s({"info":[{"signature":"Properties","name":i.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata"}],"share":[{"signature":"CopyLink","name":i.ToolbarItemCopyLink}],"edit":[{"signature":"Edit","name":i.ToolbarItemEdit,"flyout":"edit","promoted":!0},{"signature":"EditActiveX","name":"EditActiveX","flyout":"edit"},{"signature":"EditOfficeOnline","name":"EditOfficeOnline","flyout":"edit"},{"signature":"EditWebDAV","name":"EditWebDAV","flyout":"edit"}],"main":[{"signature":"permissions","name":i.ToolbarItemPermissions},{"signature":"Download","name":i.ToolbarItemDownload},{"signature":"ReserveDoc","name":t.ToolbarItemReserve},{"signature":"UnreserveDoc","name":t.ToolbarItemUnreserve},{"signature":"Copy","name":i.ToolbarItemCopy},{"signature":"Move","name":i.ToolbarItemMove},{"signature":"AddVersion","name":i.ToolbarItemAddVersion}],"shortcut":[{"signature":"OriginalCopyLink","name":i.ToolbarItemOriginalCopyLink},{"signature":"OriginalEdit","name":i.ToolbarItemOriginalEdit},{"signature":"OriginalEmailLink","name":i.ToolbarItemOriginalShare},{"signature":"OriginalReserveDoc","name":t.ToolbarItemOriginalReserve},{"signature":"OriginalUnreserveDoc","name":t.ToolbarItemOriginalUnreserve},{"signature":"OriginalCopy","name":i.ToolbarItemOriginalCopy},{"signature":"OriginalMove","name":i.ToolbarItemOriginalMove},{"signature":"OriginalAddVersion","name":i.ToolbarItemAddVersion},{"signature":"OriginalDownload","name":i.ToolbarItemOriginalDownload}]},{"maxItemsShown":5,"dropDownIcon":"icon icon-toolbar-more","addGroupSeparators":!1}),"inlineActionbar":new s({"info":[{"signature":"Properties","name":i.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata"}],"share":[{"signature":"CopyLink","name":i.ToolbarItemCopyLink,"icon":"icon icon-toolbar-copylink"},{"signature":"Share","name":i.ToolbarItemShare,"flyout":"share","group":"share"},{"signature":"EmailLink","name":i.ToolbarItemEmailLink,"flyout":"share","promoted":!0,"group":"share"}],"edit":[{"signature":"Edit","name":i.ToolbarItemEdit,"icon":"icon icon-toolbar-edit"}],"other":[{"signature":"permissions","name":i.ToolbarItemPermissions,"icon":"icon icon-toolbar-permissions"},{"signature":"Download","name":i.ToolbarItemDownload,"icon":"icon icon-toolbar-download"},{"signature":"ReserveDoc","name":t.ToolbarItemReserve,"icon":"icon icon-toolbar-reserve"},{"signature":"UnreserveDoc","name":t.ToolbarItemUnreserve,"icon":"icon icon-toolbar-unreserve"},{"signature":"Copy","name":i.ToolbarItemCopy,"icon":"icon icon-toolbar-copy"},{"signature":"Move","name":i.ToolbarItemMove,"icon":"icon icon-toolbar-move"},{"signature":"AddVersion","name":i.ToolbarItemAddVersion,"icon":"icon icon-toolbar-add-version"}]},{"maxItemsShown":5,"dropDownText":i.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more","addGroupSeparators":!1}),"dropdownMenuListInProperties":new s({"main":[{"signature":"Properties","name":i.ToolbarItemInformation},{"signature":"CopyLink","name":i.ToolbarItemCopyLink},{"signature":"Edit","name":i.ToolbarItemEdit},{"signature":"EmailLink","name":i.ToolbarItemShare},{"signature":"Download","name":i.ToolbarItemDownload},{"signature":"ReserveDoc","name":t.ToolbarItemReserve},{"signature":"UnreserveDoc","name":t.ToolbarItemUnreserve},{"signature":"Copy","name":i.ToolbarItemCopy},{"signature":"Move","name":i.ToolbarItemMove},{"signature":"AddVersion","name":i.ToolbarItemAddVersion}],"shortcut":[{"signature":"OriginalCopyLink","name":i.ToolbarItemOriginalCopyLink},{"signature":"OriginalEdit","name":i.ToolbarItemOriginalEdit},{"signature":"OriginalEmailLink","name":i.ToolbarItemOriginalShare},{"signature":"OriginalReserveDoc","name":t.ToolbarItemOriginalReserve},{"signature":"OriginalUnreserveDoc","name":t.ToolbarItemOriginalUnreserve},{"signature":"OriginalCopy","name":i.ToolbarItemOriginalCopy},{"signature":"OriginalMove","name":i.ToolbarItemOriginalMove},{"signature":"OriginalAddVersion","name":i.ToolbarItemAddVersion},{"signature":"OriginalDownload","name":i.ToolbarItemOriginalDownload}]},{"maxItemsShown":0,"dropDownIcon":"icon icon-expandArrowDown"})};return o&&e.each(o,function(t){e.each(t,function(t,i){var s=r[i];if(s||"otherToolbar"!==i||(s=r.tableHeaderToolbar),!s)throw new Error("Invalid target toolbar: "+i);e.each(t,function(e){e=new n(e),s.addItem(e)})})}),r}),csui.define("csui/widgets/recentlyaccessed/toolbaritems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,t,i,s){"use strict";function n(){var n=e.config(),r=new s;this.toolbars=t.reduce(o,function(e,s){var o=new i(r,{"normalize":!1});return t.each(n,function(e,t){(e=e[s])&&o.extendMask(e)}),o.storeMask(),e[s]=o,e},{})}var o=["tableHeaderToolbar","inlineActionbar"];return n.toolbars=o,n}),csui.define("csui/widgets/favorites/tileview.toolbaritems",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/recentlyaccessed/tileview.toolbaritems"],function(e,t,i,s,n){"use strict";var o={"inlineActionbar":new i({"info":[{"signature":"Properties","name":t.ToolbarItemInfo,"commandData":{"dialogView":!0}}],"share":[{"signature":"CopyLink","name":t.ToolbarItemCopyLink}],"edit":[{"signature":"Edit","name":t.ToolbarItemEdit}],"other":[{"signature":"Download","name":t.ToolbarItemDownload},{"signature":"goToLocation","name":t.ToolbarGoToLocation}]},{"maxItemsShown":1,"dropDownText":t.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more"})};return n&&function(t){e.each(t,function(t){e.each(t,function(t,i){var n=o[i];if(!n)throw new Error("Invalid target toolbar: "+i);e.each(t,function(e){e=new s(e),n.addItem(e)})})})}(n),o}),csui.define("csui/widgets/recentlyaccessed/tileview.toolbaritems",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/recentlyaccessed/tileview.toolbaritems"],function(e,t,i,s,n){"use strict";var o={"inlineActionbar":new i({"info":[{"signature":"Properties","name":t.ToolbarItemInfo,"commandData":{"dialogView":!0}}],"share":[{"signature":"CopyLink","name":t.ToolbarItemCopyLink}],"edit":[{"signature":"Edit","name":t.ToolbarItemEdit}],"other":[{"signature":"Download","name":t.ToolbarItemDownload},{"signature":"goToLocation","name":t.ToolbarGoToLocation}]},{"maxItemsShown":1,"dropDownText":t.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more"})};return n&&function(t){e.each(t,function(t){e.each(t,function(t,i){var n=o[i];if(!n)throw new Error("Invalid target toolbar: "+i);e.each(t,function(e){e=new s(e),n.addItem(e)})})})}(n),o}),csui.define("hbs!csui/widgets/favorites/impl/favorites2.groups.header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n
;return'<button title="'+this.escapeExpression((n=null!=(n=t.groupAddButtonTitle||(null!=e?e.groupAddButtonTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"groupAddButtonTitle","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.groupAddButtonTitle||(null!=e?e.groupAddButtonTitle:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"groupAddButtonTitle","hash":{}}):n))+'" class="binf-btn csui-groups-header-plus">\r\n  <span class="icon icon-toolbarAdd"></span>\r\n</button><span class="csui-groups-header-text">'+this.escapeExpression((n=null!=(n=t.text||(null!=e?e.text:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"text","hash":{}}):n))+'</span>\r\n<button\r\n    class="binf-btn csui-groups-header-edit-mode csui-groups-header-edit-on">'+this.escapeExpression((n=null!=(n=t.startEditMode||(null!=e?e.startEditMode:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"startEditMode","hash":{}}):n))+'</button>\r\n<button\r\n    class="binf-btn csui-groups-header-edit-mode csui-groups-header-edit-off">'+this.escapeExpression((n=null!=(n=t.endEditMode||(null!=e?e.endEditMode:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"endEditMode","hash":{}}):n))+"</button>\r\n"}});return i.registerPartial("csui_widgets_favorites_impl_favorites2.groups.header",s),s}),csui.define("css!csui/widgets/favorites/impl/favorites2.groups.header.view",[],function(){}),csui.define("csui/widgets/favorites/impl/favorites2.groups.header.view",["module","csui/lib/marionette","i18n!csui/widgets/favorites/impl/nls/lang","hbs!csui/widgets/favorites/impl/favorites2.groups.header","css!csui/widgets/favorites/impl/favorites2.groups.header.view"],function(e,t,i,s){"use strict";return t.ItemView.extend({"className":"csui-favorite-groups-header","template":s,"initialize":function(e){this._useEditMode=e&&e.useEditMode,this._isGroupsEditing=!1},"ui":{"addButton":".csui-groups-header-plus","editModeOn":".csui-groups-header-edit-on","editModeOff":".csui-groups-header-edit-off"},"events":{"click @ui.addButton":"_addItem","click @ui.editModeOn":"_switchEditModeOn","click @ui.editModeOff":"_switchEditModeOff"},"templateHelpers":function(){return{"groupAddButtonTitle":i.groupAddButtonTitle,"text":i.groupAdd,"startEditMode":i.startEditMode,"endEditMode":i.endEditMode,"hasEditModeSwitch":this._useEditMode}},"_addItem":function(e){e.preventDefault(),e.stopPropagation(),this.triggerMethod("add:item")},"_switchEditModeOn":function(e){e.preventDefault(),e.stopPropagation(),this.triggerMethod("toggleEditMode:on")},"_switchEditModeOff":function(e){e.preventDefault(),e.stopPropagation(),this.triggerMethod("toggleEditMode:off")},"isAddEnabled":function(e){return void 0!==e&&(this._isAddEnabled=e,e?this.ui.addButton.removeClass("binf-disabled"):this.ui.addButton.addClass("binf-disabled")),!!this._isAddEnabled}})}),csui.define("hbs!csui/widgets/favorites/impl/favorites2.group",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){var n;return'  <input type="text" value="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'" placeholder="'+this.escapeExpression((n=null!=(n=t.namePlaceholder||(null!=e?e.namePlaceholder:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"namePlaceholder","hash":{}}):n))+'"\r\n         class="binf-flex-row binf-form-control csui-favorite-group-input-name">\r\n  <button type="button" class="binf-flex csui-btn-edit-cancel binf-btn">\r\n    <span class="icon edit-cancel" title="'+this.escapeExpression((n=null!=(n=t.EditCancelTooltip||(null!=e?e.EditCancelTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"EditCancelTooltip","hash":{}}):n))+'" aria-label="'+this.escapeExpression((n=null!=(n=t.EditCancelAria||(null!=e?e.EditCancelAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"EditCancelAria","hash":{}}):n))+'"></span>\r\n  </button>\r\n'},"3":function(e,t,i,s){var n;return'  <div class="csui-favorite-group-selection-marker"></div>\r\n  <div class="csui-favorite-group-draggable-handle">\r\n    <span class=" icon icon-draggable-handle"></span>\r\n  </div>\r\n  <a role="button" href="#" class="binf-flex-row csui-favorite-group-name-link" aria-label="'+this.escapeExpression((n=null!=(n=t.groupNameAria||(null!=e?e.groupNameAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"groupNameAria","hash":{}}):n))+'" title="'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'"\r\n     tabindex="'+this.escapeExpression((n=null!=(n=t.tabindex||(null!=e?e.tabindex:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"tabindex","hash":{}}):n))+'">\r\n    <span class="csui-favorite-group-name">'+this.escapeExpression((n=null!=(n=t.name||(null!=e?e.name:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"name","hash":{}}):n))+'</span>\r\n  </a>\r\n  <button type="button" class="binf-btn csui-btn-action csui-btn-edit-start"\r\n          aria-label="'+this.escapeExpression((n=null!=(n=t.EditStartAria||(null!=e?e.EditStartAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"EditStartAria","hash":{}}):n))+'" tabindex="'+this.escapeExpression((n=null!=(n=t.tabindex||(null!=e?e.tabindex:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"tabindex","hash":{}}):n))+'">\r\n    <span class="icon icon-edit" title="'+this.escapeExpression((n=null!=(n=t.EditStartTooltip||(null!=e?e.EditStartTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"EditStartTooltip","hash":{}}):n))+'"></span>\r\n  </button>\r\n  <button type="button" class="binf-btn csui-btn-action csui-btn-delete"\r\n          aria-label="'+this.escapeExpression((n=null!=(n=t.DeleteAria||(null!=e?e.DeleteAria:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"DeleteAria","hash":{}}):n))+'" tabindex="'+this.escapeExpression((n=null!=(n=t.tabindex||(null!=e?e.tabindex:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"tabindex","hash":{}}):n))+'">\r\n    <span class="icon icon-circle-close" title="'+this.escapeExpression((n=null!=(n=t.DeleteTooltip||(null!=e?e.DeleteTooltip:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"DeleteTooltip","hash":{}}):n))+'"></span>\r\n  </button><span class="csui-favorite-group-arrow-overlay"></span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return null!=(n=t.if.call(e,null!=e?e.isRename:e,{"name":"if","hash":{},"fn":this.program(1,s,0),"inverse":this.program(3,s,0)}))?n:""}});return i.registerPartial("csui_widgets_favorites_impl_favorites2.group",s),s}),csui.define("css!csui/widgets/favorites/impl/favorites2.groups.view",[],function(){}),csui.define("csui/widgets/favorites/impl/favorites2.group.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/hammer","csui/utils/log","csui/utils/base","csui/dialogs/modal.alert/modal.alert","hbs!csui/widgets/favorites/impl/favorites2.group","i18n!csui/widgets/favorites/impl/nls/lang","css!csui/widgets/favorites/impl/favorites2.groups.view"],function(e,t,i,s,n,o,r,l,a,c){"use strict";return s.ItemView.extend({"className":"csui-favorite-group","template":a,"tagName":"li","initialize":function(e){this.parent=e.parent,this.groupsView=e.groupsView,this._dragData=e.dragData,this._useEditMode=e.useEditMode,this._dragAndDropEnabled=e.dragAndDropEnabled},"ui":{"groupNameButton":".csui-favorite-group-name-link","nameInput":".csui-favorite-group-input-name","cancelButton":".csui-btn-edit-cancel","startEditButton":".csui-btn-edit-start","deleteButton":".csui-btn-delete"},"templateHelpers":function(){var e=this.model.get("name");return{"tabindex":this.model.get("isTabable")&&!this._isReadonly()?"0":"-1","isRename":this.model.get("isRename"),"name":e,"groupNameAria":e==c.fav_ungrouped?c.fav_ungroupedAria:i.str.sformat(c.favoritesGroupAria,e),"namePlaceholder":c.addFavoriteNamePlaceHolder,"EditCancelTooltip":c.addFavoriteCancelButtonLabel,"EditCancelAria":c.addFavoriteCancelButtonAria,"EditStartTooltip":c.editGroupButtonLabel,"EditStartAria":c.editGroupButtonAria,"DeleteTooltip":c.deleteGroupButtonLabel,"DeleteAria":c.deleteGroupButtonAria}},"modelEvents":{"change":"render"},"onRender":function(){var e=this.className;this.model.get("isSelected")&&(e+=" binf-active");var t=this.model.get("isSingleGroupEditing"),i=this.model.get("isRename");i&&(e+=" csui-favorite-group-rename");var s=this._isReadonly();s&&(e+=" csui-favorite-group-readonly"),this.dragStarted&&(e+=" csui-dragstarted");var n=!(s||i||t||this._useEditMode||this.dragStarted||!this._dragAndDropEnabled);this.$el.attr("draggable",n),this.$el.find("a.csui-favorite-group-name-link").attr("draggable",n),this.$el.attr("class",e),!this._useEditMode||s||i||this._assignTouchControl(),this.model.isNew()&&this.model.get("isRename")&&this._startEditing()},"onDomRefresh":function(){if(this.model.isNew()||this.model.get("isRename"))this.ui.nameInput.focus();else if(this._hasFocus&&this.isRendered){var e=this;setTimeout(function(){e.isRendered&&e._setFocus()},100)}},"onDestroy":function(){this.hammer&&this.hammer.destroy()},"_startDragOperation":function(){this._dragData.clear();var e=this.model.get("tab_id");return-1!==e&&(this._dragData.set("groupId",e),this.dragStarted=!0,!0)},"_stopDragOperation":function(){this.dragStarted=!1,this._dragData.clear(),this._removeDragline(),this._removeDragStarted()},"_moveItemsToThisGroup":function(){var e,i=this.model.get("tab_id");if(void 0!==i){if(!this.model.get("isGroupsEditing")&&this._dragData.get("favorites")&&this._dragData.get("favorites").length&&void 0!==this._dragData.get("groupId"))return e={"idSources":this._dragData.get("favorites"),"tabIdSource":this._dragData.get("groupId"),"tabIdDestination":i},this.trigger("dropped:favorite",e),e.savePromise;if(void 0!==this._dragData.get("groupId"))return e={"tabIdSource":this._dragData.get("groupId"),"tabIdDestination":i,"dropAfter":this._dropAfter},this.trigger("group:dropped",e),e.savePromise;var s=t.Deferred();return s.reject(),s.promise()}},"_selectThisGroup":function(){var e={"groupModel":this.model};this.triggerMethod("before:group:selected",e),e.cancel||this.triggerMethod("group:selected",e)},"_isReadonly":function(){return-1===this.model.get("tab_id")||this.model.get("isReadonly")},"events":{"click @ui.cancelButton":function(e){e.preventDefault(),e.stopPropagation(),this._cancelEdit()},"click @ui.startEditButton":function(e){e.preventDefault(),e.stopPropagation(),this._startEditing()},"click @ui.deleteButton":function(e){e.preventDefault(),e.stopPropagation();var t=this;l.confirmQuestion(c.deleteGroupConfirmatonText,c.deleteGroupConfirmatonTitle,{"buttons":l.OkCancel}).fail(function(){t._setFocus()}).done(function(e){t.triggerMethod("group:delete",{"model":t.model})})},"focus @ui.groupNameButton":function(e){this._hasFocus=!0,this.trigger("group:focused")},"focus @ui.startEditButton":function(e){this._hasStartEditButtonFocus=!0},"focusout @ui.startEditButton":function(e){this._hasStartEditButtonFocus=!1},"focus @ui.deleteButton":function(e){this._hasDeleteButtonFocus=!0},"focusout @ui.deleteButton":function(e){this._hasDeleteButtonFocus=!1},"keydown @ui.nameInput":function(e){switch(e.keyCode){case 13:e.preventDefault(),e.stopPropagation(),this._save();break;case 27:e.preventDefault(),e.stopPropagation(),this._cancelEdit()}},"keydown":function(e){var t=this.model.get("tab_id"),i=this.model.get("isRename"),s=r.isMacintosh();switch(e.keyCode){case 88:(s&&e.metaKey&&!e.ctrlKey||!s&&!e.metaKey&&e.ctrlKey)&&(e.preventDefault(),e.stopPropagation(),this._dragData.unset("favorites"),-1===t?this._dragData.unset("favorites"):this._dragData.set({"groupId":t}));break;case 86:if(s&&e.metaKey&&!e.ctrlKey||!s&&!e.metaKey&&e.ctrlKey){e.preventDefault(),e.stopPropagation();if(t===this._dragData.get("groupId"))return;this._dropAfter=!1;var n=this;this._moveItemsToThisGroup().then(function(){n._selectThisGroup()})}break;case 37:this._hasFocus&&!i&&(this._hasStartEditButtonFocus?(e.preventDefault(),e.stopPropagation(),this.ui.groupNameButton.focus()):this._hasDeleteButtonFocus&&(e.preventDefault(),e.stopPropagation(),this.ui.startEditButton.focus()));break;case 39:this._hasFocus&&!i&&(this._hasStartEditButtonFocus?(e.preventDefault(),e.stopPropagation(),this.ui.deleteButton.focus()):this._hasDeleteButtonFocus||(e.preventDefault(),e.stopPropagation(),this.ui.startEditButton.focus()))}},"click":function(e){if(!e.ctrlKey){if(e.preventDefault(),this.model.isNew()||this.model.get("isRename")||this.model.get("isGroupsEditing"))return;this._selectThisGroup()}},"dragstart":function(e){this._startDragOperation()&&e.originalEvent.dataTransfer.setData("text","")},"dragover":function(e){if(!this.dragStarted){var t=this.model.get("tab_id");if(void 0!==t)if(this._dragData.get("favorites")&&0!==this._dragData.get("favorites").length){if(this._dragData.get("favorites")&&this._dragData.get("favorites").length){if(this._dragData.get("groupId")===t)return;this.$el.addClass("csui-dragover"),e.preventDefault()}}else{var i=this.$el.height(),s=this.model.get("tab_id"),n=e.offsetY>i/2;this._moveNotPossible(this.model.collection,this._dragData.get("groupId"),s,n)?(this._removeDragline(),this._dropAfter=void 0,e.preventDefault()):n?-1===s?(this._removeDragline(),this._dropAfter=void 0):(void 0!==this._dropAfter&&!1!==this._dropAfter||(this._removeDragline(),this.$el.after('<div class="csui-favorite-group csui-dragline">'),this._dropAfter=!0),e.preventDefault()):(void 0!==this._dropAfter&&!0!==this._dropAfter||(this._removeDragline(),this.$el.before('<div class="csui-favorite-group csui-dragline">'),this._dropAfter=!1),e.preventDefault())}}},"drop":function(e){this.$el.removeClass("csui-dragover"),e.preventDefault(),this._moveItemsToThisGroup(),this._removeDragline()},"dragleave":function(e){this._removeDragline(),this.$el.removeClass("csui-dragover")},"dragend":function(e){e.preventDefault(),this._stopDragOperation()}},"_cancelEdit":function(){this.model.isNew()?this.triggerMethod("group:delete",{"model":this.model}):(this.model.set("isRename",!1),this.trigger("group:finished:editing"))},"_moveNotPossible":function(e,t,i,s){var n={"idSource":t,"idDestination":i,"moveAfterDestination":s};return this.trigger("group:before:dropped",n),n.cancel},"_setFocus":function(){this.ui.groupNameButton.length>0&&this.ui.groupNameButton.focus()},"_assignTouchControl":function(){this.hammer&&this.hammer.destroy();var e=this.model.get("isGroupsEditing");if(this.$el.length>0&&!e){this.hammer=new n.Manager(this.$el[0]);var t=new n.Press({"time":500});this.hammer.add([t]),this.hammer.on("press",i.bind(this._onPress,this))}},"_onPress":function(){this._startEditing()},"_startEditing":function(){this.model.set("isRename",!0),this.trigger("group:editing",{"model":this.model})},"_save":function(){var e=this.ui.nameInput.val();e&&(this.model.set("name",e),this.triggerMethod("group:changed",{"model":this.model}))},"_removeDragline":function(){this.parent.$el.find(".csui-favorite-group.csui-dragline").remove(),delete this._dropAfter},"_removeDragStarted":function(){this.parent.$el.find(".csui-dragstarted").removeClass("csui-dragstarted")}})}),csui.define("css!csui/widgets/favorites/impl/favorites2.groups.rows.view",[],function(){}),csui.define("csui/widgets/favorites/impl/favorites2.groups.rows.view",["module","csui/lib/jquery","csui/lib/marionette","csui/widgets/favorites/impl/favorites2.group.view","css!csui/widgets/favorites/impl/favorites2.groups.rows.view"],function(e,t,i,s){"use strict";return i.CollectionView.extend({"className":"csui-favorite-groups-rows","tagName":"ul","childView":s,"childViewOptions":function(){return{"parent":this,"groupsView":this.options.parent,"groupsViewStateModel":this.options.groupsViewStateModel,"dragData":this.options.dragData,"useEditMode":this._useEditMode,"dragAndDropEnabled":this.options.dragAndDropEnabled}},"initialize":function(e){this._useEditMode=e&&e.useEditMode},"events":{"focusout":function(e){e.relatedTarget&&0==t.contains(this.el,e.relatedTarget)&&this.trigger("groups:focusout")}}})}),csui.define("hbs!csui/widgets/favorites/impl/favorites2.groups.footer",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"1":function(e,t,i,s){return'    <p class="csui-groups-footer-text">'+this.escapeExpression(this.lambda(e,e))+"</p>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-groups-footer-wrapper binf-hidden">\r\n'+(null!=(n=t.each.call(e,null!=e?e.texts:e,{"name":"each","hash":{},"fn":this.program(1,s,0),"inverse":this.noop}))?n:"")+"</div>"}});return i.registerPartial("csui_widgets_favorites_impl_favorites2.groups.footer",s),s}),csui.define("css!csui/widgets/favorites/impl/favorites2.groups.footer.view",[],function(){}),csui.define("csui/widgets/favorites/impl/favorites2.groups.footer.view",["module","csui/lib/marionette","csui/utils/contexts/factories/favorite2groups","i18n!csui/widgets/favorites/impl/nls/lang","hbs!csui/widgets/favorites/impl/favorites2.groups.footer","css!csui/widgets/favorites/impl/favorites2.groups.footer.view"],function(e,t,i,s,n){"use strict";return t.ItemView.extend({"className":"csui-favorite-groups-footer","template":n,"initialize":function(){this.groups=this.options.groups||this.context.getCollection(i,{"detached":!0,"permanent":!0}),this.listenTo(this.groups,"reset",this._groupsChanged),this.listenTo(this.groups,"update",this._groupsChanged)},"templateHelpers":function(){return{"texts":[s.groupHint1,s.groupHint2]}},"_groupsChanged":function(){this.groups.length>1?this.$el.find(".csui-groups-footer-wrapper").addClass("binf-hidden"):this.$el.find(".csui-groups-footer-wrapper").removeClass("binf-hidden")}})}),csui.define("hbs!csui/widgets/favorites/impl/favorites2.groups",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-favorite-groups-header-region"></div>\r\n<div class="csui-favorite-groups-rows-region binf-flex-column"></div>\r\n<div class="csui-favorite-groups-footer-region"></div>'}});return i.registerPartial("csui_widgets_favorites_impl_favorites2.groups",s),s}),csui.define("csui/widgets/favorites/impl/favorites2.groups.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/globalmessage/globalmessage","csui/utils/contexts/factories/favorite2groups","csui/models/favorite2group","csui/widgets/favorites/impl/favorites2.groups.header.view","csui/widgets/favorites/impl/favorites2.groups.rows.view","csui/widgets/favorites/impl/favorites2.groups.footer.view","csui/controls/progressblocker/blocker","i18n!csui/widgets/favorites/impl/nls/lang","hbs!csui/widgets/favorites/impl/favorites2.groups","css!csui/widgets/favorites/impl/favorites2.groups.view"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b){"use strict";return n.LayoutView.extend({"className":"csui-favorite-groups","template":b,"ui":{},"regions":{"headerRegion":".csui-favorite-groups-header-region","rowsRegion":".csui-favorite-groups-rows-region","footerRegion":".csui-favorite-groups-footer-region"},"behaviors":{"PerfectScrolling":{"behaviorClass":l,"contentParent":".csui-favorite-groups-rows","suppressScrollX":!0}},"constructor":function t(s){s||(s={});e.config();i.defaults(s,{}),t.__super__.constructor.call(this,s),this.options.blockingParentView?m.delegate(this,this.options.blockingParentView):m.imbue(this)},"initialize":function(){var e=this;this.collection=this.options.collection||this.context.getCollection(c,{"detached":!0,"permanent":!0}),this._useEditMode=r.isTouchBrowser(),this._isSingleGroupEditing=!1,this._isGroupsEditing=!1,this._dragData=this.options.dragData,this.options.collection&&(this.collection.fetched=!1),this.listenTo(this.collection,"reset",function(){this.collection.each(function(e,t){t>0?e.set("isTabable",!1):e.set("isTabable",!0)})}),this.headerView=new d({"useEditMode":this._useEditMode}),this.rowsView=new h({"dragData":this._dragData,"parent":this,"collection":this.collection,"sort":!0,"useEditMode":this._useEditMode,"dragAndDropEnabled":this.options.dragAndDropEnabled}),this.footerView=new p({"groups":this.collection}),this.listenTo(this.rowsView,"childview:group:focused",function(e){this._setFocusAtView(e)}),this.listenTo(this.rowsView,"groups:focusout",function(){this.$el.find(".csui-favorite-group.csui-in-focus").removeClass("csui-in-focus"),this.$el.removeClass("csui-favorite-groups-has-group-in-focus"),this.rowsView.children.each(function(e){delete e._hasFocus})}),this.listenTo(this.rowsView,"childview:before:group:selected",function(e,t){this._isSingleGroupEditing?t.cancel=!0:this.triggerMethod("before:group:selected",e)}),this.listenTo(this.rowsView,"childview:group:selected",function(e,t){this._modelOfNewlySelectedGroup(e)&&(this.triggerMethod("group:selected",e),this.selectGroup(e),this._tryReSetFocus())}),this.listenTo(this.rowsView,"childview:group:before:dropped",function(e,t){this._checkMoveNotPossible(t.idSource,t.idDestination,t.moveAfterDestination)&&(t.cancel=!0)}),this.listenTo(this.rowsView,"childview:group:dropped",function(e,t){this.triggerMethod("group:dropped",t)}),this.listenTo(this.rowsView,"childview:dropped:favorite",function(e,t){this.triggerMethod("dropped:favorite",t)}),this.listenTo(this.rowsView,"childview:group:editing",function(e,t){this._setSingleGroupEditingMode(e)}),this.listenTo(this.rowsView,"childview:group:changed",function(e,t){var i=t.model;this._saveGroup(i),this._setSingleGroupEditingMode(!1),this._setGroupsEditingMode(!1),this._tryReSetFocus()}),this.listenTo(this.rowsView,"childview:group:delete",function(t,i){var s=i.model;s.isNew()?(s.destroy(),e._setSingleGroupEditingMode(!1),e._setGroupsEditingMode(!1),e.triggerMethod("group:deleted",s)):s.destroy({"wait":!0}).then(function(){e._setSingleGroupEditingMode(!1),e._setGroupsEditingMode(!1),e.triggerMethod("group:deleted",s)}),this._tryReSetFocus()}),this.listenTo(this.rowsView,"childview:group:finished:editing",function(){this._setSingleGroupEditingMode(!1)}),this.listenTo(this.headerView,"add:item",function(e){if(!this._isSingleGroupEditing){this._isSingleGroupEditing=!0,this.headerView.isAddEnabled(!1);var t=new u({"name":"","order":1,"isRename":!0},{"connector":this.collection.connector});this.collection.add(t,{"at":0})}}),this.listenTo(this.headerView,"toggleEditMode:on",function(){this._setGroupsEditingMode(!0)}),this.listenTo(this.headerView,"toggleEditMode:off",function(){this._editingView?(this._editingView._save(),this._setSingleGroupEditingMode(!1)):this._setGroupsEditingMode(!1)})},"events":{"keydown":function(e){var t;switch(e.keyCode){case 38:if(e.preventDefault(),e.stopPropagation(),!this._isSingleGroupEditing&&void 0!==this._focusedModelIndex&&this._focusedModelIndex>0){t=this.collection.at(this._focusedModelIndex);var i=this.collection.at(this._focusedModelIndex-1),s=this.rowsView.children.findByModel(i);this._setFocusAtView(s),t.set("isTabable",!1),i.set("isTabable",!0)}break;case 40:if(e.preventDefault(),e.stopPropagation(),!this._isSingleGroupEditing&&void 0!==this._focusedModelIndex&&this._focusedModelIndex<this.collection.length-1){t=this.collection.at(this._focusedModelIndex);var n=this.collection.at(this._focusedModelIndex+1),o=this.rowsView.children.findByModel(n);this._setFocusAtView(o),t.set("isTabable",!1),n.set("isTabable",!0)}}}},"onRender":function(){this._updateGroupsCssClasses(),this.headerRegion.show(this.headerView),this.rowsRegion.show(this.rowsView),this.$el.find(".csui-favorite-groups-rows-region").attr("role","navigation").attr("aria-label",f.favoriteGroupsNavAria),this.footerRegion.show(this.footerView)},"onBeforeDestroy":function(){this._isSingleGroupEditing&&this._editingView.model.isNew()&&this._editingView.model.destroy()},"_setFocusAtView":function(e){this.rowsView.children.each(function(t){t.cid!==e.cid&&(delete t._hasFocus,t.$el.removeClass("csui-in-focus"))}),e._hasFocus=!0,e.$el.addClass("csui-in-focus"),this.$el.addClass("csui-favorite-groups-has-group-in-focus"),this._focusedModelIndex=this.collection.indexOf(e.model)},"_setFocusedByIndex":function(e){var t=this.rowsView.collection.at(e),i=this.rowsView.children.findByModel(t);this._setFocusAtView(i)},"_tryReSetFocus":function(){if(!this._isSingleGroupEditing&&void 0!==this._focusedModelIndex){var e=this.collection.at(this._focusedModelIndex);if(e){var t=this.rowsView.children.findByModel(e);t&&t._setFocus()}}},"_setGroupsEditingMode":function(e){var t=this._isGroupsEditing=e;this._updateGroupsCssClasses(),this.collection.each(function(e){e.set("isGroupsEditing",t)}),this.triggerMethod("group:any:editing",{"on":e})},"_setSingleGroupEditingMode":function(e){var t;e?(this._isSingleGroupEditing=!0,this._editingView=e,this.headerView.isAddEnabled(!1),t={"on":!0,"groupModel":e.model}):(this._editingView=void 0,this._isSingleGroupEditing=!1,this.headerView.isAddEnabled(!0),t={"on":!1});var i=this._isSingleGroupEditing;this._updateGroupsCssClasses(),this.collection.each(function(e){e.set("isSingleGroupEditing",i)}),this.triggerMethod("group:any:editing",t)},"_updateGroupsCssClasses":function(){this._useEditMode&&this.$el.addClass("csui-favorite-groups-has-groups-editing"),this._isSingleGroupEditing||this._isGroupsEditing?(this.$el.removeClass("csui-favorite-groups-editing-none"),this.$el.addClass("csui-favorite-groups-editing-any")):(this.$el.addClass("csui-favorite-groups-editing-none"),this.$el.removeClass("csui-favorite-groups-editing-any")),this._isSingleGroupEditing&&!this._isGroupsEditing?this.$el.addClass("csui-favorite-single-group-editing"):this.$el.removeClass("csui-favorite-single-group-editing"),!this._isSingleGroupEditing&&this._isGroupsEditing?this.$el.addClass("csui-favorite-groups-editing"):this.$el.removeClass("csui-favorite-groups-editing")},"_checkMoveNotPossible":function(e,t,i){var s=this.collection.get(e),n=this.collection.get(t),o=this.collection.indexOf(s),r=this.collection.indexOf(n);return o<r&&(r-=1),i&&(r+=1),o===r},"_modelOfNewlySelectedGroup":function(e){var t;return e instanceof s.Model?t=e:e instanceof s.View&&(t=e.model),!t||this.selectedGroup&&t.get("tab_id")==this.selectedGroup.get("tab_id")?void 0:t},"selectGroup":function(e){var t=this._modelOfNewlySelectedGroup(e);t&&(this.selectedGroup&&this.selectedGroup.set("isSelected",!1),t.set("isSelected",!0),this.selectedGroup=t)},"_endEditing":function(e){e.isNew()||e.set({"isRename":!1}),this._setSingleGroupEditingMode(!1)},"_saveGroup":function(e){var i=this;e.save({},{"wait":!0}).then(function(){i._endEditing(e)}).fail(function(i){e.trigger("error",e);var s;if(i&&i.responseJSON&&i.responseJSON.error)s=i.responseJSON.error;else{var n=r.MessageHelper.toHtml();r.MessageHelper.reset(),s=t(n).text()}o.error("Saving failed. ",s)&&console.error(o.last),a.showMessage("error",f.errorFavoriteGroupSaveFailed+" "+s)})}})}),csui.define("csui/widgets/favorites/impl/favorites2.table.columns",["csui/lib/underscore","csui/lib/backbone","i18n!csui/widgets/favorites/impl/nls/lang"],function(e,t,i){"use strict";var s=t.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),n=t.Collection.extend({"model":s,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new n(this.map(function(e){return e.attributes}))},"resetCollection":function(i,n){if(i){var o=0,r=e.map(i,function(i){var n=i instanceof t.Model?i.toJSON():i;return o+=10,new s(e.defaults(n,{"key":n.column_key,"sequence":o}))});this.reset(r,n)}}});return new n([{"key":"type","sequence":10,"permanentColumn":!0},{"key":"favorite_name","title":i.favoriteColumnNameTitle,"cellViewClassname":"csui/controls/table/cells/name.view","sequence":20,"permanentColumn":!0,"isNaming":!0},{"key":"reserved","sequence":30,"noTitleInHeader":!0},{"key":"parent_id","sequence":40},{"key":"favorite","sequence":910,"noTitleInHeader":!0,"permanentColumn":!0}])}),csui.define("hbs!csui/widgets/favorites/impl/favorites2.table",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-rowselection-toolbar"></div>\r\n<div class="csui-favorite-masterdetail-view">\r\n  <div class="csui-favorite-groups-view"></div>\r\n  <div class="csui-table-view"></div>\r\n</div>'}});return i.registerPartial("csui_widgets_favorites_impl_favorites2.table",s),s}),csui.define("css!csui/widgets/favorites/impl/favorites2.table.view",[],function(){}),csui.define("csui/widgets/favorites/impl/favorites2.table.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/favorite2groups","csui/models/favorite2columns","csui/utils/contexts/factories/favorites2","csui/models/favorites2","csui/widgets/favorites/toolbaritems","csui/widgets/favorites/toolbaritems.masks","csui/controls/progressblocker/blocker","csui/widgets/favorites/impl/favorites2.groups.view","csui/controls/table/table.view","csui/utils/commands","csui/controls/toolbar/toolbar.view","csui/controls/toolbar/delayed.toolbar.view","csui/controls/tableactionbar/tableactionbar.view","csui/controls/toolbar/toolbar.command.controller","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/default.action/default.action.behavior","csui/controls/tile/behaviors/infinite.scrolling.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/globalmessage/globalmessage","csui/widgets/favorites/impl/favorites2.table.columns","hbs!csui/widgets/favorites/impl/favorites2.table","i18n!csui/widgets/favorites/impl/nls/lang","csui/behaviors/table.rowselection.toolbar/table.rowselection.toolbar.behavior","csui/lib/perfect-scrollbar","css!csui/widgets/favorites/impl/favorites2.table.view"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b,g,v,w,y,_,C,T,x,S,I,k,V,A,E,M){"use strict";var D=e.config();i.defaults(D,{"defaultPageSize":30,"showGroupsRegion":!0,"dragAndDropEnabled":!0});var F=b.extend({"constructor":function e(t){e.__super__.constructor.apply(this,arguments)},"behaviors":{"PerfectScrolling":{"behaviorClass":S,"contentParent":"tbody","suppressScrollX":!0},"InfiniteScrolling":{"behaviorClass":x,"contentParent":"tbody","content":"tbody>tr:visible"},"TabableRegion":{"behaviorClass":I}}}),P=n.LayoutView.extend({"className":"csui-fav2-table","template":A,"ui":{"tableView":".csui-table-view"},"regions":{"toolbarRegion":".csui-rowselection-toolbar","groupsRegion":".csui-favorite-groups-view","tableRegion":".csui-table-view"},"behaviors":{"DefaultAction":{"behaviorClass":T},"TableRowSelectionToolbar":{"behaviorClass":M}},"constructor":function e(t){t||(t={}),i.defaults(t,{"pageSize":D.defaultPageSize,"showGroupsRegion":D.showGroupsRegion,"clearFilterOnChange":D.clearFilterOnChange,"resetOrderOnChange":D.resetOrderOnChange,"resetLimitOnChange":D.resetLimitOnChange,"fixedFilterOnChange":D.fixedFilterOnChange,"dragAndDropEnabled":D.dragAndDropEnabled},{"showInlineActionBarOnHover":!0,"forceInlineActionBarOnClick":!1,"inlineActionBarStyle":"csui-table-actionbar-bubble","clearFilterOnChange":!0,"resetOrderOnChange":!1,"resetLimitOnChange":!0,"fixedFilterOnChange":!1,"toolbarItems":h}),t.toolbarItemsMasks||(t.toolbarItemsMasks=new p),this.context=t.context,this.connector=this.context.getObject(l),this.commands=t.commands||g,this.commandController=new _({"commands":this.commands,"nameAttribute":"favorite_name"}),this.favoritesTableOptions={"isFavoritesTable":!0},
this.tableColumns=this.options.tableColumns||V.deepClone(),m.imbue(this),e.__super__.constructor.call(this,t),this.propagateEventsToRegions()},"initialize":function(){this.collection=new d(void 0,{"connector":this.connector,"autoreset":!0,"skip":0,"top":this.options.pageSize});var e=this.defaultActionController.actionItems.getAllCommandSignatures(g);this.collection.setResourceScope(u.getDefaultResourceScope()),this.collection.setDefaultActionCommands(e),this.collection.setEnabledDelayRestCommands(!0),this.groups=this.options.groups||this.context.getCollection(a,{"detached":!0,"permanent":!0}),this.groups.favorites.setResourceScope(u.getDefaultsOnlyResourceScope()),this.groups.favorites.setEnabledDelayRestCommands(!1),this.columns=this.collection.columns||new c(void 0,{"connector":this.connector}),this._dragData=new s.Model,this._allowDragging=!0,this.collection.delayedActions&&this.listenTo(this.collection.delayedActions,"error",function(e,t,i){var s=new r.Error(t);k.showMessage("error",s.message)}),this.listenTo(this.groups,"request",this.blockActions),this.listenTo(this.groups,"sync error destroy",this.unblockActions),this.listenTo(this.groups,"reset",this._trySelectGroup),this.listenTo(this.groups,"bulk:update",function(){this._saveAllFavorites()}),this.setGroupsView(),this.setTableView(),this.tableView.listenTo(this.groups,"sync error destroy",this.tableView.enableEmptyViewText)},"_setSelectedGroup":function(e){this.selectedGroup=e,this.favoritesTableOptions.selectedGroup=e},"_trySelectGroup":function(){var e;e=void 0!==this.selectedGroup?this.groups.get(this.selectedGroup):this.groups.find(function(e){return e.favorites&&e.favorites.length>0||-1===e.get("tab_id")}),e?(0===this.columns.length&&this.columns.reset(e.favorites.columns.models,{"silent":!0}),this._setTableColumns(e.favorites.columns,{"silent":!0}),this.collection.populate(e.favorites.models,{"parse":!1}),this._setSelectedGroup(e),this.groupsView.selectGroup(e)):(delete this.selectedGroup,delete this.favoritesTableOptions.selectedGroup,this.collection.populate([]))},"_setTableColumns":function(e,t){if(!this.options.tableColumns&&e&&e.models){var s=this,n=["permanentColumn","noTitleInHeader","title","align","widthFactor","isNaming"],o=i.map(e.models,function(e){var t=e.toJSON(),o=e.get("column_key")||e.get("key"),r=s.tableColumns.findWhere({"key":o});return r&&i.each(n,function(e){var i=r.get(e);void 0!==i&&void 0===t[e]&&(t[e]=i)}),t});this.tableColumns.resetCollection(o,t)}},"_saveAllFavorites":function(){var e=this,i=t.Deferred();return this.blockActions(),this._dragData.clear(),this.groups.saveAll().then(function(){o.debug("Complete set of favorite information saved")&&console.log(o.last),e._updateTabIdsInSelectedGroup(),i.resolve()}).fail(function(t){t&&(o.error("failed to save complete set of favorite information: "+t.statusText)&&console.log(o.last),k.showMessage("error",E.errorFavoritesSaveFailed+" "+t.statusText),e.groups.fetch({"reload":!0}),i.reject())}).always(function(){e.unblockActions()}),i.promise()},"_updateTabIdsInSelectedGroup":function(){var e=this.collection;if(this.selectedGroup){var t=this.selectedGroup,i=t.get("tab_id");e.each(function(s,n){t.favorites.at(n);e.remove(s,{"silent":!0}),s.set("favorite_tab_id",i,{"silent":!0}),e.add(s,{"at":n,"silent":!0})})}},"_moveModel":function(e,t,i,s){var n=e.get(t),o=e.get(i),r=e.indexOf(n),l=e.indexOf(o);return r<l&&(l-=1),s&&(l+=1),r!=l&&(e.remove(n),e.add(n,{"at":l}),!0)},"_moveAndSaveFavorites":function(e,t,s){var n=this.groups.get(this.selectedGroup);return this.blockActions(),i.each(e,function(e){this.collection.get(e)&&(this._moveModel(this.collection,e,t,s),this._moveModel(n.favorites,e,t,s))},this),this.unblockActions(),this._saveAllFavorites()},"setGroupsView":function(){this.groupsView=new f({"connector":this.connector,"collection":this.groups,"dragData":this._dragData,"blockingParentView":this,"dragAndDropEnabled":this.options.dragAndDropEnabled}),this.listenTo(this.groupsView,"group:selected",function(e){this.collection.populate(e.model.favorites.models,{"parse":!1}),this._setSelectedGroup(e.model)}),this.listenTo(this.groupsView,"group:any:editing",function(e){this._allowDragging=!e.on,this._updateDraggable()}),this.listenTo(this.groupsView,"group:deleted",function(e){if(this.selectedGroup){var t=e.get("tab_id");this.selectedGroup.get("tab_id")===t&&(delete this.selectedGroup,this._trySelectGroup())}}),this.listenTo(this.groupsView,"group:dropped",function(e){var t=this,i=this.groups,s=e.tabIdSource,n=e.tabIdDestination;if(this._moveModel(i,s,n,e.dropAfter)){var o=this.groups.get(s),r=this.groups.indexOf(o);e.savePromise=this._saveAllFavorites().then(function(){t.groupsView._setFocusedByIndex(r),t.groupsView._tryReSetFocus()})}}),this.listenTo(this.groupsView,"dropped:favorite",function(e){var t=e.idSources;if(i.isArray(t)&&0!==t.length){var s=this.groups,n=this.collection,o=e.tabIdDestination,r=s.get(e.tabIdSource),l=this.selectedGroup.get("tab_id");i.each(t,function(t){var i=r.favorites.get(t);r.favorites.remove(i),s.get(o).favorites.add(i),l===e.tabIdSource?(i=n.get(t),n.remove(i),i.set("csuiIsSelected",!1)):l===o&&n.add(i)}),e.savePromise=this._saveAllFavorites()}})},"_removeDragline":function(){this.tableView.$el.find(".csui-dragline").remove(),this.tableView.$el.find("tr.csui-no-border").removeClass("csui-no-border"),delete this._dropAfter},"_updateDraggable":function(){if(this._allowDragging){if(!1===r.isAppleMobile()&&this.options.dragAndDropEnabled){var e=this.tableView.getSelectedChildren().length;if(e>0){var t=this.tableView.$el.find("tr[draggable=true]");t.attr("draggable",!1),t=this.tableView.$el.find("tr.binf-active"),t.attr("draggable",!0)}else this.tableView.$el.find("tr:not(.csui-table-row-shows-inlineform)").attr("draggable",!0)}}else{this.tableView.$el.find("tr[draggable=true]").attr("draggable",!1)}},"_handleKeydown":function(e,t){var s,n=r.isMacintosh();switch(e.keyCode){case 88:if(n&&e.metaKey&&!e.ctrlKey||!n&&!e.metaKey&&e.ctrlKey){e.preventDefault(),e.stopPropagation();var o=this.selectedGroup.get("tab_id");s=[],this._dragData.set({"groupId":o,"favorites":s});var l=this.tableView.getSelectedChildren();if(l.length>0)i.each(l,function(e){s.push(e.get("id"))});else{var a=this.tableView.getFocusedChild();a&&s.push(a.get("id"))}this.tableView.trigger("closeOther"),this.tableView.cancelAnyExistingInlineForm.call(this.tableView)}break;case 86:if(n&&e.metaKey&&!e.ctrlKey||!n&&!e.metaKey&&e.ctrlKey){if(e.preventDefault(),e.stopPropagation(),!(s=this._dragData.get("favorites"))||0===s.length)return;var c=t,u=c.get("id");if(i.contains(s,u))return;try{this._moveAndSaveFavorites(this._dragData.get("favorites"),u,!1)}catch(e){}}}},"setTableView":function(){this.tableView=new F({"context":this.options.context,"connector":this.connector,"collection":this.collection,"columns":this.columns,"tableColumns":this.tableColumns,"pageSize":this.options.pageSize,"originatingView":this,"columnsWithSearch":["favorite_name"],"orderBy":this.options.orderBy,"filterBy":this.options.filterBy,"nameEdit":!1,"favoritesTableOptions":this.favoritesTableOptions,"actionItems":this.defaultActionController.actionItems,"commands":this.defaultActionController.commands,"blockingParentView":this,"tableTexts":{"zeroRecords":E.emptyGroupText},"inlineBar":{"viewClass":y,"options":i.extend({"collection":this.options.toolbarItems.inlineActionbar,"toolItemsMask":this.options.toolbarItemsMasks.toolbars.inlineActionbar,"delayedActions":this.collection.delayedActions,"container":this.collection.node,"containerCollection":this.collection,"commandExecutionOptions":{"nameAttribute":"favorite_name"}},this.options.toolbarItems.inlineActionbar.options,{"inlineBarStyle":this.options.inlineActionBarStyle,"forceInlineBarOnClick":this.options.forceInlineActionBarOnClick,"showInlineBarOnHover":this.options.showInlineActionBarOnHover})}});var e=this;this.listenTo(this.tableView,"tableRowRendered",function(i){var s=t(i.target);s.on("focusin",function(t){e._tableRowWithFocus=i}),s.on("focusout",function(t){delete e._tableRowWithFocus}),s.on("keydown",function(t){e._handleKeydown.call(e,t,i.node)})}),this.listenTo(this.tableView,"tableRowRendered",function(s){var n=t(s.target);n.find("a").attr("draggable",!1),!1===r.isAppleMobile()&&this.options.dragAndDropEnabled&&!1===n.hasClass("csui-table-row-shows-inlineform")&&n.attr("draggable",!0),n.on("dragstart",function(s){var n=e.selectedGroup.get("tab_id"),o=[];e._dragData.set({"groupId":n,"favorites":o,"sourceIndex":s.currentTarget._DT_RowIndex});var r=e.tableView.getSelectedChildren();if(r.length>0)i.each(r,function(e){o.push(e.get("id"))});else{var l=e.collection.at(e._dragData.get("sourceIndex"));o.push(l.get("id")),t(s.currentTarget).removeClass("csui-state-hover")}s.originalEvent.dataTransfer.setData("text",""),e.tableView.trigger("closeOther"),e.tableView.cancelAnyExistingInlineForm.call(e.tableView)}),n.on("dragover",function(i){if(e._dragData.get("favorites")&&0!==e._dragData.get("favorites").length){var s=e._dragData.get("sourceIndex"),n=i.currentTarget._DT_RowIndex;if(void 0!==s&&s!==n){i.preventDefault();var o=t('<tr class="csui-dragline">'),r=t(i.currentTarget).height();i.offsetY>r/2?void 0!==e._dropAfter&&!1!==e._dropAfter||(e._removeDragline.call(e),t(i.currentTarget).after(o),e._dropAfter=!0):void 0!==e._dropAfter&&!0!==e._dropAfter||(e._removeDragline.call(e),t(i.currentTarget).before(o),0===n&&o.before('<tr class="csui-dragline csu-dragline-spacer">'),e._dropAfter=!1),o.next().addClass("csui-no-border")}}}),n.on("drop",function(i){var n=e._dragData.get("sourceIndex"),o=i.currentTarget._DT_RowIndex,r=s.node,l=r.get("id");if(void 0!==n&&n!==o){i.preventDefault();try{if(e._dragData.get("favorites")&&e._dragData.get("groupId")){var a=t(i.currentTarget).height(),c=i.offsetY>a/2;e._moveAndSaveFavorites(e._dragData.get("favorites"),l,c)}}catch(e){}e._removeDragline()}}),n.on("dragleave",function(t){e._removeDragline()}),n.on("dragend",function(t){t.preventDefault(),e._removeDragline(),e._dragData.clear()})}),this.listenTo(this.tableView,"tableRowSelected",this._updateDraggable),this.listenTo(this.tableView,"tableRowUnselected",this._updateDraggable),this.listenTo(this,"render",function(){this.groupsRegion.show(this.groupsView),this.tableRegion.show(this.tableView),this.groups.ensureFetched({"reload":!0}),!1===this.options.showGroupsRegion&&this.groupsRegion.$el.hide(),delete this._tableRowWithFocus}),this.listenTo(this.tableView,"execute:defaultAction",function(e){var t={"node":e};if(this.trigger("before:defaultAction",t),!t.cancel){var i=this;this.defaultActionController.executeAction(e,{"context":this.options.context,"originatingView":this}).done(function(){i.trigger("executed:defaultAction",t)})}})},"_addFavoriteAttribute":function(e){return e.each(function(e){e.set("favorite",!0)},this),!0}});return i.extend(P.prototype,C),P}),csui.define("hbs!csui/widgets/myassignments/impl/myassignmentstable",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-myassignmentstable">\r\n  <div id="tableviewMA"></div>\r\n  <div id="paginationviewMA"></div>\r\n</div>\r\n'}});return i.registerPartial("csui_widgets_myassignments_impl_myassignmentstable",s),s}),csui.define("css!csui/widgets/myassignments/impl/myassignmentstable",[],function(){}),csui.define("csui/widgets/myassignments/impl/myassignmentstable.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/contexts/factories/myassignmentscolumns","csui/utils/contexts/factories/myassignments","csui/controls/table/rows/description/description.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/widgets/myassignments/myassignments.columns","csui/widgets/nodestable/nodestable.view","hbs!csui/widgets/myassignments/impl/myassignmentstable","i18n!csui/widgets/myassignments/impl/nls/lang","css!csui/widgets/myassignments/impl/myassignmentstable"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p){"use strict";var m=/\baccessibleTable\b(?:=([^&]*)?)?/i.exec(location.search);m=m&&"false"!==m[1];var f=d.extend({"template":h,"className":"","regions":{"tableRegion":"#tableviewMA","paginationRegion":"#paginationviewMA"},"constructor":function(e){d.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"initialize":function(){this.collection=this.options.collection||this.context.getCollection(l),this.columns=this.collection.columns||this.context.getCollection(r),i.defaults(this.options,{"orderBy":"date_due asc","tableColumns":u}),this.setTableView({"nameEdit":!1,"descriptionRowView":a,"descriptionRowViewOptions":{"firstColumnIndex":1,"lastColumnIndex":2,"showDescriptions":!m,"collapsedHeightIsOneLine":!1},"selectRows":"none","selectColumn":!1,"haveDetailsRowExpandCollapseColumn":!1,"tableColumns":this.options.tableColumns,"tableTexts":{"zeroRecords":p.emptyListText},"inlineBar":{"options":{}}}),this.setPagination(),this.options.collection&&(this.collection.fetched=!1)},"onDestroy":function(){this.options.collection&&this.collection.setResourceScope(this._originalScope),d.prototype.onDestroy.call(this)},"onRender":function(){this.options.collection&&!this.collection.fetched&&(this._originalScope=this.collection.getResourceScope(),this.collection.setResourceScope(l.getDefaultResourceScope()),this.collection.setExpand("assignments",["from_user_id","location_id","workflow_id","workflow_subworkflow_id","workflow_subworkflow_task_id"]),this.collection.fetch({"reload":!0})),this.tableRegion.show(this.tableView),this.paginationRegion.show(this.paginationView)}});return i.extend(f.prototype,c),f}),csui.define("hbs!csui/widgets/recentlyaccessed/impl/recentlyaccessedtable",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-recentlyaccessedtable">\r\n  <div class="csui-rowselection-toolbar"></div>\r\n  <div id="tableviewRA"></div>\r\n  <div id="paginationviewRA"></div>\r\n</div>\r\n'}});return i.registerPartial("csui_widgets_recentlyaccessed_impl_recentlyaccessedtable",s),s}),csui.define("css!csui/widgets/recentlyaccessed/impl/recentlyaccessedtable",[],function(){}),csui.define("csui/widgets/recentlyaccessed/impl/recentlyaccessedtable.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/utils/contexts/factories/recentlyaccessedcolumns","csui/utils/contexts/factories/recentlyaccessed","csui/widgets/recentlyaccessed/recentlyaccessed.columns","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/widgets/nodestable/nodestable.view","csui/utils/commands","csui/controls/globalmessage/globalmessage","csui/widgets/recentlyaccessed/toolbaritems","csui/widgets/recentlyaccessed/toolbaritems.masks","hbs!csui/widgets/recentlyaccessed/impl/recentlyaccessedtable","i18n!csui/widgets/recentlyaccessed/impl/nls/lang","csui/behaviors/table.rowselection.toolbar/table.rowselection.toolbar.behavior","css!csui/widgets/recentlyaccessed/impl/recentlyaccessedtable"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b,g,v){"use strict";var w=d.extend({"template":b,"className":"","regions":{"toolbarRegion":".csui-rowselection-toolbar","tableRegion":"#tableviewRA","paginationRegion":"#paginationviewRA"},"constructor":function(e){d.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"behaviors":i.extend({"TableRowSelectionToolbar":{"behaviorClass":v}},d.prototype.behaviors),"initialize":function(){this.collection=this.options.collection||this.context.getCollection(a),this._allCommands=this.defaultActionController.actionItems.getAllCommandSignatures(h),this.collection.setResourceScope(a.getDefaultResourceScope()),this.collection.setDefaultActionCommands(this._allCommands),this.collection.setEnabledDelayRestCommands(!0),this.collection.delayedActions&&this.listenTo(this.collection.delayedActions,"error",function(e,t,i){var s=new r.Error(t);p.showMessage("error",s.message)}),this.columns=this.collection.columns||this.context.getCollection(l),i.defaults(this.options,{"orderBy":"access_date_last desc","tableColumns":c,"toolbarItems":m}),this.options.toolbarItemsMasks||(this.options.toolbarItemsMasks=new f),this.setTableView({"orderBy":this.options.orderBy,"filterBy":this.options.filterBy,"nameEdit":!1,"haveDetailsRowExpandCollapseColumn":!1,"tableColumns":this.options.tableColumns,"tableTexts":{"zeroRecords":g.emptyListText}}),this.setPagination(),this.options.collection&&(this.collection.fetched=!1)},"onRender":function(){this.options.collection&&!this.options.collection.fetched&&(this._originalScope=this.collection.getResourceScope(),this.collection.setResourceScope(a.getDefaultResourceScope()),this.collection.setExpand("properties",["parent_id","reserved_user_id"]),this.collection.setDefaultActionCommands(this._allCommands),this.collection.setEnabledDelayRestCommands(!0),this.collection.fetch({"reload":!0})),this.tableRegion.show(this.tableView),this.paginationRegion.show(this.paginationView)},"onDestroy":function(){this.options.collection&&this.collection.setResourceScope(this._originalScope),d.prototype.onDestroy.call(this)}});return i.extend(w.prototype,u),w}),csui.define("hbs!csui/widgets/permissions/impl/permissions.lookup/permissions.lookup",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div id="csui-permissions-user-picker" class="csui-permissions-user-picker"></div>\r\n<div id="user"></div>'}});return i.registerPartial("csui_widgets_permissions_impl_permissions.lookup_permissions.lookup",s),s}),csui.define("csui/widgets/permissions/impl/permissions.lookup/permissions.lookup.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","i18n!csui/widgets/permissions/impl/nls/lang","hbs!csui/widgets/permissions/impl/permissions.lookup/permissions.lookup","css!csui/widgets/permissions/impl/permissions"],function(e,t,i,s,n,o){return i.ItemView.extend({"className":"cs-permissions-lookup","template":o,"initialize":function(e){this.options=e},"constructor":function(e){e||(e={}),e.data||(e.data={}),this.options=e,i.ItemView.prototype.constructor.call(this,e)},"onShow":function(){var t=this;csui.require(["csui/controls/userpicker/userpicker.view"],function(s){t.pickerView=new s({"context":t.options.context,"memberFilter":{"type":[0,1]},"widgetoptions":t.options,"placeholder":n.PermissionLookupPlaceHolder,"prettyScrolling":!0,"limit":20,"model":t.options.userPickerModel,"id_input":e.uniqueId("csui-permissions-user-picker-input")}),new i.Region({"el":t.$el.find("#csui-permissions-user-picker")}).show(t.pickerView),t.listenTo(t.pickerView,"item:change",t.processItemChange),t.listenTo(t.pickerView,"item:clear",t.processItemChange)})},"processItemChange":function(){var e=arguments.length>0&&arguments[0].item,t={"id":e?e.get("id"):"","name":e?e.get("name_formatted"):"","group_id":e&&e.get("group_id")?e.get("group_id").id:"","initials":e?e.get("initials"):"","photo_url":e?e.get("photo_url"):""};this.options.userPickerModel.set(t)}})}),csui.define("csui/widgets/permissions/impl/permissions.list/permissions.dropdown.menu.items",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/permissions/impl/permissions.list/permissions.dropdown.menu.items"],function(e,t,i,s,n){"use strict";var o={"dropdownMenuList":new i({"main":[{"signature":"adduserorgroup","name":t.AddUserOrGroups},{"signature":"addownerorgroup","name":t.AddOwnerOrGroup},{"signature":"restorepublicaccess","name":t.RestorePublicAccess}]},{"maxItemsShown":0,"dropDownIcon":"icon icon-expandArrowDown"})};return n&&function(t){e.each(t,function(t){e.each(t,function(t,i){var n=o[i];if(!n)throw new Error("Invalid target toolbar: "+i);e.each(t,function(e){e=new s(e),n.addItem(e)})})})}(n),o}),csui.define("csui/models/permission/permission.response.mixin",["csui/lib/underscore","csui/utils/base"],function(e,t){"use strict";return{"mixin":function(t){return e.extend(t,{"makePermissionResponse":function(e){return this},"parsePermissionResponse":function(t,i,s){if(t.results&&t.results.data&&t.results.data.permissions&&!e.isEmpty(t.results.data.permissions)){var n=t.results.data.permissions;if(e.isArray(n)){n=e.reject(n,function(e){return"public"===e.type&&!e.permissions});var o=e.find(n,function(e){return"owner"===e.type}),r=e.find(n,function(e){return"group"===e.type});o&&o.permissions&&r&&!r.permissions&&(n=e.reject(n,function(e){return"group"===e.type&&!e.permissions})),o&&!o.permissions&&r&&r.permissions&&(n=e.reject(n,function(e){return"owner"===e.type&&!e.permissions})),o&&!o.permissions&&r&&!r.permissions&&(n=e.reject(n,function(e){return"group"===e.type&&!e.permissions}))}else e.isObject(n)&&(n=[],t.results.data.permissions&&t.results.data.permissions.permissions.length>0&&n.push(t.results.data.permissions));t.results.data.permissions=n}}})}}}),csui.define("csui/models/permission/nodeuserpermissions",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/permission/nodepermission.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/browsable.mixin","csui/models/browsable/v2.response.mixin","csui/models/mixins/v2.expandable/v2.expandable.mixin","csui/models/permission/permission.response.mixin"],function(e,t,i,s,n,o,r,l,a,c,u,d){"use strict";var h=e.config();i.defaults(h,{"defaultPageSize":30});var p=s.Collection.extend({"model":o,"constructor":function(e,t){t=i.defaults({},t,{"top":h.defaultPageSize},t),s.Collection.prototype.constructor.apply(this,arguments),this.makeFetchable(t),this.options=t,this.includeActions=t.includeActions,this.query=this.options.query,this.makeConnectable(t).makeFetchable(t).makeBrowsable(t).makeBrowsableV2Response(t).makePermissionResponse(t)},"isFetchable":function(){return!0},"url":function(){var e,t=n.combine(this.connector.connection.url,"nodes",this.options.node.get("id"));return t=t.replace("/v1","/v2"),this.options.memberId?(t+="/permissions/effective/"+this.options.memberId,e=n.combineQueryString({"expand":"permissions{right_id}"},e)):e=n.combineQueryString({"fields":["properties{container, name, type, versions_control_advanced, permissions_model}","permissions{right_id, permissions, type}","versions{version_id}"],"expand":["permissions{right_id}"]},e),e&&(t+="?"+e),t},"parse":function(e,t){if(e.results&&e.results.data&&(this.parsePermissionResponse(e,t,this.options.clearEmptyPermissionModel),!this.options.node.get("isNotFound")))return this.nodeName=e.results.data.properties?e.results.data.properties.name:"",(void 0===this.isContainer||e.results.data.properties)&&(this.isContainer=!e.results.data.properties||e.results.data.properties.container),e.results.data.permissions},"setOrder":function(e,t){if(this.orderBy!=e)return this.orderBy=e,!1!==t&&this.fetch({"skipSort":!1}),!0},"processForEmptyOwner":function(){this.findWhere({"type":"owner"})||this.findWhere({"type":"group"})||this.add({"permissions":null,"right_id":null,"type":"owner"},{"at":0})},"addPublicAccess":function(e){this.findWhere({"type":"owner"})&&this.findWhere({"type":"group"})?this.add(e,{"at":2}):this.add(e,{"at":1})},"addOwnerOrGroup":function(e){var t=this.findWhere({"type":"owner"});if(t&&null===t.get("permissions")){var i=this.at(0);this.remove(i,{"silent":!0}),this.add(e,{"at":0})}else this.add(e,{"at":"owner"===e.get("type")?0:1})}});return l.mixin(p.prototype),a.mixin(p.prototype),c.mixin(p.prototype),r.mixin(p.prototype),u.mixin(p.prototype),d.mixin(p.prototype),p}),csui.define("csui/utils/contexts/factories/permission.list.factory",["require","module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","csui/models/permission/nodeuserpermissions","csui/utils/commands","csui/utils/base"],function(e,t,i,s,n,o,r,l,a){return n.extend({"propertyPrefix":"nodeUserPermissions","constructor":function(e,l){n.prototype.constructor.apply(this,arguments);var a=this.options.nodeUserPermissions||{};if(!(a instanceof s.Collection)){var c=e.getObject(o,l),u=l.nodeUserPermissions.memberFilter,d=t.config();a=new r(a.models,i.extend({"connector":c,"query":u,"nodeId":this.options.model.get("id")},a.options,d.options,{"autofetch":!0,"autoreset":!0}))}this.property=a},"isFetchable":function(){return this.property.isFetchable()},"fetch":function(e){this.property.fetch({"success":i.bind(this._onNodeUserPermissionsFetched,this,e),"error":i.bind(this._onNodeUserPermissionsFailed,this,e)})},"_onNodeUserPermissionsFetched":function(e){return!0},"_onNodeUserPermissionsFailed":function(e,t,i){var s=new a.RequestErrorMessage(i);csui.require(["csui/dialogs/modal.alert/modal.alert"],function(e){e.showError(s.toString())})}})}),csui.define("csui/widgets/permissions/impl/permissions.list/toolbaritems",["csui/lib/underscore","csui/utils/base","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!csui/widgets/permissions/toolbaritems"],function(e,t,i,s,n,o){"use strict";var r={"inlineToolbar":new s({"other":[{"signature":"ChangeOwnerPermission","name":i.ToolbarItemChangeOwnerPermission,"icon":"icon icon-owner-change"},{"signature":"DeletePermission","name":i.ToolbarItemDeletePermission,"icon":"icon icon-toolbar-delete"},{"signature":"EditPermission","name":i.ToolbarItemEditPermission,"icon":"icon icon-toolbar-edit"},{"signature":"ApplyPermission","name":i.ToolbarItemApplyPermission,"icon":"icon icon-toolbar-share"}]},{"maxItemsShown":t.isTouchBrowser()?1:3,"dropDownText":i.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more"})};return o&&function(t){e.each(t,function(t){e.each(t,function(t,i){var s=r[i];if(!s)throw new Error("Invalid target toolbar: "+i);e.each(t,function(e){e=new n(e),s.addItem(e)})})})}(o),r}),csui.define("csui/widgets/permissions/impl/permissions.list/toolbaritems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,t,i,s){"use strict";function n(){var n=e.config(),r=new s;this.toolbars=t.reduce(o,function(e,s){var o=new i(r,{"normalize":!1});return t.each(n,function(e,t){(e=e[s])&&o.extendMask(e)}),o.storeMask(),e[s]=o,e},{})}var o=["inlineToolbar"];return n.toolbars=o,n}),csui.define("csui/widgets/permissions/impl/permissions.list/permission.table.columns",["csui/lib/underscore","csui/lib/backbone","csui/models/permission/permission.table.columns.model","i18n!csui/widgets/permissions/impl/nls/lang","csui-ext!csui/widgets/permissions/table.columns"],function(e,t,i,s,n){var o=t.Collection.extend({"model":i,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new o(this.map(function(e){return e.attributes}))}}),r=[{"key":"right_id","column_key":"right_id","column_name":s.right_id,"sequence":20,"permanentColumn":!0,"containsInlineActions":!0},{"key":"permissions","column_key":"permissions","column_name":s.permission_level,"sequence":40,"permanentColumn":!0},{"column_key":"addpermissions","key":"addpermissions","name":"","sortable":!1,"alignment":"center","permanentColumn":!0,"isToolbar":!0,"sequence":999,"className":"csui-inlinetoolbar-touch"}];return n&&e.each(n,function(t){e.each(t,function(e,t){r.push(e)})}),new o(r)}),csui.define("hbs!csui/widgets/permissions/impl/permissions.content",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){return'<div class="csui-permission-lookup-container"></div>\r\n<div class="csui-permissions-list-container"></div>\r\n<div class="csui-permissions-empty-actions binf-hidden">\r\n  <div class="csui-addMember-container">\r\n    <span class="csui-icon add_user"></span>\r\n    <span class="csui-addMember"></span>\r\n  </div>\r\n  <div class="csui-grantAccess-container binf-hidden">\r\n    <span class="csui-icon icon_permmision_owner"></span>\r\n    <span class="csui-grantAccess"></span>\r\n  </div>\r\n</div>'}});return i.registerPartial("csui_widgets_permissions_impl_permissions.content",s),s}),csui.define("hbs!csui/widgets/permissions/impl/permissions.list/permissions.empty",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return"<span>"+this.escapeExpression((n=null!=(n=t.message||(null!=e?e.message:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"message","hash":{}}):n))+"</span>"}});return i.registerPartial("csui_widgets_permissions_impl_permissions.list_permissions.empty",s),s}),csui.define("csui/widgets/permissions/impl/permissions.content.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/models/node/node.model","csui/widgets/permissions/impl/permissions.lookup/permissions.lookup.view","csui/controls/table.list/table.list.view","csui/widgets/permissions/impl/permissions.list/permissions.dropdown.menu.items","csui/controls/form/pub.sub","csui/utils/commands","csui/utils/contexts/factories/member","csui/utils/contexts/factories/permission.list.factory","csui/widgets/permissions/impl/permissions.list/toolbaritems","csui/widgets/permissions/impl/permissions.list/toolbaritems.masks","csui/widgets/permissions/impl/permissions.list/permission.table.columns","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/controls/progressblocker/blocker","csui/dialogs/members.picker/members.picker.wizard","i18n!csui/widgets/permissions/impl/nls/lang","hbs!csui/widgets/permissions/impl/permissions.content","hbs!csui/widgets/permissions/impl/permissions.list/permissions.empty","css!csui/widgets/permissions/impl/permissions"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b,g,v,w,y){var _=i.ItemView.extend({"className":"csui-table-empty","template":y,"templateHelpers":function(){return{"message":e.str.sformat(v.emptyPermissionListMsg,this.model.get("name"))}},"constructor":function(e){i.ItemView.prototype.constructor.apply(this,arguments)}}),C=i.LayoutView.extend({"className":"cs-permissions-content","template":w,"regions":{"lookupRegion":".csui-permission-lookup-container","listRegion":".csui-permissions-list-container"},"ui":{"permissionList":".csui-permissions-list-container","emptyActionsContainer":".csui-permissions-empty-actions","addMemberToGroup":".csui-addMember","grantAccessToMember":".csui-grantAccess"},"events":{"click @ui.addMemberToGroup":"onClickAddMember"},"onClickAddMember":function(i){var s=this,n=t.Deferred(),o=s.options.originatingView,r=s.originalCollection&&s.originalCollection.models&&s.originalCollection.models.length>0?s.originalCollection.models:s.permissionCollection.models;r=e.filter(r,function(e){return e.get("right_id_expand")&&1===e.get("right_id_expand").type}),new g({"command":"adduserorgroup","context":o.context,"connector":o.model.connector,"dialogClass":"cs-permission-group-picker","displayName":v.allUsersAndGroups,"dialogTitle":v.addUsersAndGroups,"startLocation":"acl.groups","displayStartLocation":!0,"selectedMember":s.memberFilter,"showUserPicker":!0,"authUser":s.options.authUser,"adduserorgroup":!0,"buttons":[{"id":"Add","label":v.addButtonLabel,"default":!0,"toolTip":v.addButtonTooltip},{"id":"Cancel","label":v.cancelButtonLabel,"disabled":!1,"close":!0,"toolTip":v.cancelButtonTooltip}],"nodeModel":o.model,"availablePermissions":s.options.collection.availablePermissions,"startLocations":["acl.groups"],"selectableMembers":r},s).show().done(function(){
n.resolve.apply(n,arguments)}).fail(function(e){n.reject.apply(n,arguments)})},"constructor":function(t){t||(t={}),t.toolbarItems||(t.toolbarItems=h),t.toolbarItemsMasks||(t.toolbarItemsMasks=new p),this.options=t,i.LayoutView.prototype.constructor.call(this,t),b.imbue(this),this.memberFilter=this.options.context.getModel(u),this.collection=this.options.collection,this.listenTo(this.memberFilter,"change",function(){if(this.collection.isFetchable()){var t=this,i=(this.permissionsListView.tableHeaderView.options.userPermissionsModel.get("permissions"),this.options.authUser&&this.options.authUser.get("privilege_user_admin_rights"));if(t.edit_permissions=i,this.memberFilter.get("id")){this.originalCollection||(this.originalCollection=this.options.collection.clone()),this.options.filteredPermissions=!0;var s=e.filter(this.originalCollection.models,function(e){return e.get("right_id")===this.memberFilter.get("id")},this),n=e.filter(t.originalCollection.models,function(e){return e.get("right_id_expand")&&1===e.get("right_id_expand").type},this);if(this.collection.models=s,this.permissionsListView)this.collection.options.memberId=this.memberFilter.get("id"),s.length>0?this.permissionsListView.trigger("update:table",this.collection):(this.collection.options.clearEmptyPermissionModel=!0,this.collection.fetch().then(function(i){if(i.results.data&&i.results.data.permissions&&0===i.results.data.permissions.length&&t.edit_permissions&&(t.ui.permissionList.addClass("empty-permission-list"),n.length>0)){t.ui.emptyActionsContainer.removeClass("binf-hidden");var s=e.str.sformat(v.addMemberToGroup,t.memberFilter.get("name")),o=e.str.sformat(v.grantAccessToMember,t.memberFilter.get("name"));t.ui.addMemberToGroup.text(s),t.ui.grantAccessToMember.text(o),t.ui.addMemberToGroup.attr("title",s),t.ui.grantAccessToMember.attr("title",o)}},this));else if(this.model.set("isNotFound",!0),this.collection.options.memberId=this.memberFilter.get("id"),this.collection.fetch(),i&&(this.ui.permissionList.addClass("empty-permission-list"),n.length>0)){this.ui.emptyActionsContainer.removeClass("binf-hidden");var o=e.str.sformat(v.addMemberToGroup,this.memberFilter.get("name")),r=e.str.sformat(v.grantAccessToMember,this.memberFilter.get("name"));this.ui.addMemberToGroup.text(o),this.ui.grantAccessToMember.text(r),this.ui.addMemberToGroup.attr("title",o),this.ui.grantAccessToMember.attr("title",r)}}else this.ui.emptyActionsContainer.addClass("binf-hidden"),this.ui.permissionList.removeClass("empty-permission-list"),this.model.set("isNotFound",!1),this.options.filteredPermissions=!1,this.originalCollection=void 0,this.collection.options.memberId=this.memberFilter.get("id"),this.collection.fetch()}}),this.permissionsLookupView=new o(e.extend({"originatingView":this.options.originatingView,"userPickerModel":this.memberFilter},this.options)),this.admin_permissions=this.options.authUser&&this.options.authUser.get("privilege_system_admin_rights"),this.columnCollection=m.clone(),this.updateColumnsCollection(),this.permissionsListView=new r(e.extend({"originatingView":this.options.originatingView,"context":this.options.context,"memberFilter":this.memberFilter,"toolbarItems":this.options.toolbarItems,"toolbarItemsMasks":this.options.toolbarItemsMasks,"collection":this.collection,"tableColumns":this.columnCollection,"emptyView":_,"emptyViewModel":this.memberFilter,"applyTo":this.options.applyTo,"admin_permissions":this.admin_permissions,"hasPermissionAction":this.options.hasPermissionAction},this.options)),this._isCollectionEditable()&&this.listenTo(this.permissionsListView,"render",this.createPermissionDropDown),this.listenTo(this.options.authenticatedUserPermissions,"change",this._updatePermissionTable),this.listenTo(this.permissionsListView,"render",this._resizePermissionTable),this.listenTo(this.permissionsListView,"scroll",this._handleScroll),this.listenTo(this.permissionsListView,"resizetable",this._resizePermissionTable),this.propagateEventsToViews(this.permissionsLookupView,this.permissionsListView)},"updateColumnsCollection":function(){var e;e=this.options.hasPermissionAction&&(this.admin_permissions||this.options.authenticatedUserPermissions&&this.options.authenticatedUserPermissions.hasEditPermissionRights())?m.models:m.filter(function(e){return!e.attributes.isToolbar}),this.columnCollection.set(e,{"remove":!0})},"_updatePermissionTable":function(){this._isCollectionEditable()||(this.permissionsListView.$el.find(".csui-add-permission").addClass("binf-hidden"),this.permissionsListView.$el.find(".csui-add-owner-or-group .csui-user-display-name").text(v.NoOwnerAssigned))},"_resizePermissionTable":function(e){var t=this.$el.find(".csui-table-body");t&&(t.parents(".csui-table-list").hasClass("csui-table-list-no-scrollable")&&t.parents(".csui-table-list").removeClass("csui-table-list-no-scrollable"),t.height()>t.parent().height()?t.parents(".csui-table-list").removeClass("csui-table-list-no-scrollable"):t.parents(".csui-table-list").addClass("csui-table-list-no-scrollable"))},"_isCollectionEditable":function(){var e=this.collection.options.authenticatedUserPermissions;return e&&e.hasEditPermissionRights()||this.admin_permissions},"showAddPermissionDropDown":function(e){"true"!==e.target.getAttribute("aria-expanded")&&this.createMenuItems(e)},"createPermissionDropDown":function(){if(this._isCollectionEditable()){var t=this.permissionsListView.$el.find(".csui-add-permission").addClass("icon-toolbarAdd").addClass("binf-dropdown-toggle"),i=t.closest(".csui-table-header-cell");t.attr({"data-binf-toggle":"dropdown","aria-expanded":"false","tabindex":"-1","aria-label":v.AddUserOrGroup,"title":v.AddDropdownTitle,"role":"button"}),t.bind("click",e.bind(this.showAddPermissionDropDown,this)),this.dropDownEl=t,i.bind("keydown",e.bind(this.onKeyInView,this))}},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||(this.$(e.target).hasClass("csui-toolitem")?this.$(e.target).click():this.$el.find(".csui-add-permission").click())},"createMenuItems":function(i){var s,n,o,r,a=t(i.target).parent().addClass("binf-dropdown"),u=l.dropdownMenuList,d={};s=t('<ul class="binf-dropdown-menu" role="menu"></ul>'),this.options.filteredPermissions?(e.extend(this.originalCollection.options,this.collection.options),d.permissionCollection=this.originalCollection):d.permissionCollection=this.collection,u.collection.models.forEach(function(e){o=e.get("signature");var t=c.findWhere({"signature":o});d.toolItem=e,t&&"disabled"!==o&&t.enabled(d)&&(t.set("startLocation",d.startLocation),n='<li data-csui-command="'+e.get("signature")+'"><a tabindex="-1" class="csui-toolitem">'+e.get("name")+"</a></li>",s.append(n))}),a.find("ul").remove(),a.append(s),r=this.permissionsListView.$el.find(".csui-add-permission").parent().find(".csui-toolitem"),r.bind("click",e.bind(this.executeToolItemAction,this))},"executeToolItemAction":function(t){var i=this;this.commands=c;var s=t.target.parentElement.getAttribute("data-csui-command"),n=this.commands.findWhere({"signature":s}),o={"startLocation":n.get("startLocation"),"context":this.options.context,"permissionCollection":this.collection,"originalCollection":this.originalCollection,"nodeModel":this.model,"originatingView":this,"connector":this.model.connector,"nodeId":this.model.get("id"),"applyTo":this.options.applyTo};n&&n.enabled(o)&&(this._=e,n.execute(o).done(e.bind(function(e){if(i.permissionsLookupView.pickerView&&i.permissionsLookupView.pickerView.ui.searchclear.is(":visible")?i.permissionsLookupView.pickerView.ui.searchclear.click():e.get("addOwnerGroup")?i.collection.addOwnerOrGroup(e):e.get("publicAccess")?i.collection.addPublicAccess(e):i.collection.add(e),i.originalCollection&&i.originalCollection.models){var t=this.collection.models.filter(function(e){for(var t in i.originalCollection.models)if(e.get("right_id")===i.originalCollection.models[t].get("right_id")&&e.get("type")===i.originalCollection.models[t].get("type")||null===e.get("type"))return!1;return!0});t.length>0&&"owner"===t[0].get("type")&&i.originalCollection.findWhere({"type":"owner"})&&i.originalCollection.remove(i.originalCollection.findWhere({"type":"owner"})),i.originalCollection.models.push(t[0])}},this)).always(function(){i.dropDownEl.focus()}))},"onRender":function(){this.lookupRegion.show(this.permissionsLookupView),this.listRegion.show(this.permissionsListView)},"onBeforeDestroy":function(){this.collection.options.memberId&&(delete this.collection.options.memberId,this.memberFilter.set({"id":"","group_id":"","name":""},{"silent":!0}))},"_blockActions":function(){var e=this.options.originatingView;e&&e.blockActions&&e.blockActions()},"_unblockActions":function(){var e=this.options.originatingView;e&&e.unblockActions&&e.unblockActions()},"_handleScroll":function(e){this.options.originatingView&&this.options.originatingView.trigger("scroll",e)}});return e.extend(C.prototype,f),C}),csui.define("hbs!csui/widgets/permissions/impl/no.permissions",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<div class="csui-no-permission">\r\n  '+this.escapeExpression((n=null!=(n=t.messages||(null!=e?e.messages:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"messages","hash":{}}):n))+"\r\n</div>"}});return i.registerPartial("csui_widgets_permissions_impl_no.permissions",s),s}),csui.define("csui/widgets/permissions/permissions.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/models/node/node.model","csui/widgets/permissions/impl/permissions.content.view","csui/utils/contexts/factories/node","csui/utils/contexts/factories/user","csui/utils/contexts/factories/permission.list.factory","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/utils/nodesprites","csui/utils/command.error","csui/controls/progressblocker/blocker","csui/utils/commandhelper","csui/models/nodechildren","csui/dialogs/modal.alert/modal.alert","csui/utils/commands","csui/utils/contexts/factories/usernodepermission","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/utils/taskqueue","hbs!csui/widgets/permissions/impl/no.permissions","i18n!csui/widgets/permissions/impl/nls/lang","css!csui/widgets/permissions/impl/permissions"],function(e,t,i,s,n,o,r,l,a,c,u,d,h,p,m,f,b,g,v,w,y,_,C){var T=e.config();t.defaults(T,{"parallelism":3});var x=s.ItemView.extend({"className":"cs-permissions","behaviors":{"TabablesBehavior":{"behaviorClass":w,"recursiveNavigation":!0,"containTabFocus":!0}},"isTabable":function(){return this.$("*[tabindex]").length>0},"currentlyFocusedElement":function(e){var t=this.$("*[tabindex]");return i(e&&e.shiftKey?t[t.length-1]:t[0])},"template":!1,"events":{"focusin .csui-permissions-user-picker":"onFocusInUserPicker"},"constructor":function(e){var i=this;if(e||(e={}),e.data||(e.data={}),e.model||(e.model=e.context.getModel(l,{"attributes":e.data.id&&{"id":e.data.id},"temporary":!0})),this.options=e,this.context=e.context,this.user=this.options.context.getModel(a),s.ItemView.prototype.constructor.call(this,e),p.imbue(this),this.hasPermissionAction=e.model&&e.model.actions&&!!e.model.actions.get({"signature":"permissions"}),this.hasPermissionAction){this.options.model&&this.options.model.models&&this.options.model.models.length>0&&(this.options.model=this.options.model.models[0]),this.collection=this.options.collection=this.options.context.getCollection(c,this.options),this.collection.options.node=this.options.model;var n=this.context.getModel(v);n.node=this.options.model,n.node.set("isNotFound",!1),n.fetch().done(function(){i.collection.options.authenticatedUserPermissions=n,i.collection.fetch({"success":t.bind(i.onPermissionsRequestSuccess,i,i.options),"error":t.bind(i.onPermissionsRequestFailed,i,i.options)})}).fail(function(e){new h(e)}),this._blockActions(),this.listenTo(this,"permission:level:clicked",this._handlePermissionLevelClicked),this.listenTo(this,"permission:level:focus",this._handlePermissionLevelFocus),this.listenTo(this,"permission:inlineaction:clicked",this._hidePopovers)}},"onRender":function(){if(!this.hasPermissionAction){var e=this.model.get("type_name")?this.model.get("type_name"):this.model.get("shortcutNode")&&this.model.get("shortcutNode").get("type_name"),s=i("<div />",{"class":"csui-no-permissions-container","html":_({"messages":t.str.sformat(C.noPermissionsAvailable,e)})});this.$el.html(s)}},"_hidePopovers":function(){if(this.$el.parents("body")&&this.$el.parents("body").find(".csui-edit-permission-popover-container .binf-popover")){var e=this.$el.parents("body").find(".csui-edit-permission-popover-container .binf-popover");e.data("binf.popover")&&e.binf_popover("destroy")}},"onFocusInUserPicker":function(e){var t=this.$el.find(".binf-popover.binf-in");t.data("binf.popover")&&t.binf_popover("destroy")},"onPermissionsRequestSuccess":function(e){this.permissionsContentView&&(this.cancelEventsToViewsPropagation(this.permissionsContentView),this.permissionsContentView.destroy());var i=e.collection.options.authenticatedUserPermissions&&e.collection.options.authenticatedUserPermissions.get("permissions")&&e.collection.options.authenticatedUserPermissions.get("permissions").indexOf("edit_permissions"),s=e.model.get("container");i>=0&&s&&(e.applyTo={},this.fetchPermissionsPreCheck(e)),this.permissionsContentView=new r(t.defaults({"originatingView":this,"context":e.context,"collection":e.collection,"applyTo":e.applyTo,"authUser":this.user,"authenticatedUserPermissions":e.collection&&e.collection.options.authenticatedUserPermissions,"hasPermissionAction":this.hasPermissionAction},e)),this.propagateEventsToViews(this.permissionsContentView),this.renderContent(),this._unblockActions()},"onPermissionsRequestFailed":function(e,t,i){var s=new n.RequestErrorMessage(i);b.showError(s.toString()),this._unblockActions()},"fetchPermissionsPreCheck":function(e){this.options=e,this.options.applyTo.subTypes=[];var s=this,n=[0,204,207,215,298,3030202],o=new y({"parallelism":T.parallelism}),r=s.model.get("id"),l=s.model.connector.connection.url.replace("v1","v2")+"/nodes/"+r+"/descendents/subtypes/exists?sub_types=",a=t.map(n,function(e){var t=i.Deferred();return o.pending.add({"worker":function(){var n=s.model.connector.extendAjaxOptions({"url":l+e,"type":"GET","data":{"include_sub_items":!1}});return i.ajax(n).done(function(e){void 0!==e.results.data.subtypes_info&&s.options.applyTo.subTypes.push(e.results.data.subtypes_info[0].id),s.options.applyTo.thresholdExceeded=e.results.data.threshold_exceeded,t.resolve(e)}).fail(function(e){t.reject(e)}),t.promise()}}),t.promise(a)});return i.whenAll.apply(i,a)},"renderContent":function(){var e=this.options.model.fetching;if(e)return e.done(t.bind(this.render,this));if(this.permissionsContentView){var i=this.permissionsContentView.render();s.triggerMethodOn(i,"before:show",i,this),this.$el.append(i.el),s.triggerMethodOn(i,"show",i,this)}},"onBeforeDestroy":function(){this.permissionsContentView&&(this.cancelEventsToViewsPropagation(this.permissionsContentView),this.permissionsContentView.destroy())},"_closePermissions":function(){var e=this.options.model;1===e.get("type")&&e.original&&0===e.original.get("type")?this.trigger("permissions:close"):this.trigger("permissions:close:without:animation")},"_blockActions":function(){var e=this.options.originatingView&&this.options.originatingView.$el.is("visible")?this.options.originatingView:this;e&&e.blockActions&&e.blockActions()},"_unblockActions":function(){var e=this.options.originatingView&&this.options.originatingView.$el.is("visible")?this.options.originatingView:this;e&&e.unblockActions&&e.unblockActions()},"_handlePermissionLevelClicked":function(e){this._hidePopovers();var t=this,i=e.cellView;if(!i.$el.data("binf.popover")){var s=g.get("EditPermission"),n={"model":i.model,"targetView":{"permissions":i},"originatingView":this,"applyTo":this.options.applyTo,"authUser":this.user,"admin_permissions":this.user.get("privilege_user_admin_rights")},o=i.$el.closest(".csui-table-row");if(o.addClass("active-row"),t.trigger("block:view:actions"),s.enabled(n)){var r=s.execute(n);m.handleExecutionResults(r,{"command":s,"suppressSuccessMessage":n.suppressSuccessMessage,"suppressFailMessage":n.suppressFailMessage}).done(function(e){s.allowCollectionRefetch&&t.collection.totalCount>t.collection.topCount&&t.collection.fetch()}).always(function(){t.trigger("unblock:view:actions"),o.removeClass("active-row"),t.unblockActions&&t.unblockActions(),i.$el.focus()})}else csui.require(["csui/widgets/permissions/impl/edit/edit.permission.helper"],function(e){t.editPermissionHelper=new e({"permissionModel":i.model,"popoverPlacement":"left","popoverAtBodyElement":!t.options.originatingView||!t.options.originatingView.options.isExpandedView,"popoverTragetElement":i.$el,"readonly":!0,"originatingView":t}),t.editPermissionHelper.showCustomPermissionPopover(),t.editPermissionHelper.listenTo(t.editPermissionHelper,"closed:permission:level:popover",function(){t.editPermissionHelper.destroy(),t.trigger("unblock:view:actions"),i.$el.closest(".csui-table-row").removeClass("active-row")})})}},"_handlePermissionLevelFocus":function(e){this._hidePopovers();var t=this,i=e.cellView;if(!i.$el.data("binf.popover")){i.model,this.options.applyTo,this.user,this.user.get("privilege_user_admin_rights");i.$el.closest(".csui-table-row").addClass("active-row"),t.trigger("block:view:actions"),csui.require(["csui/widgets/permissions/impl/edit/edit.permission.helper"],function(e){t.editPermissionHelper=new e({"permissionModel":i.model,"popoverPlacement":"left","popoverAtBodyElement":!t.options.originatingView||!t.options.originatingView.options.isExpandedView,"popoverTragetElement":i.$el,"readonly":!0,"originatingView":t}),t.editPermissionHelper.showCustomPermissionPopover(),t.editPermissionHelper.listenTo(t.editPermissionHelper,"closed:permission:level:popover",function(){t.editPermissionHelper.destroy(),t.trigger("unblock:view:actions"),i.$el.closest(".csui-table-row").removeClass("active-row"),i.$el.focus()})})}}});return t.extend(x.prototype,u),x}),csui.define("hbs!csui/widgets/permissions/impl/edit/apply.permission/impl/header/apply.permission.header",["module","hbs","csui/lib/handlebars"],function(e,t,i){var s=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,s){var n;return'<h4 class="binf-modal-title">\r\n  <span class="icon icon-notification-information"></span>\r\n  <span class="title-text csui-apply-permission-header-title" title="'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+'">'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+"</span>\r\n</h4>"}});return i.registerPartial("csui_widgets_permissions_impl_edit_apply.permission_impl_header_apply.permission.header",s),s}),csui.define("csui/widgets/permissions/impl/edit/apply.permission/impl/header/apply.permission.header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","hbs!csui/widgets/permissions/impl/edit/apply.permission/impl/header/apply.permission.header","i18n!csui/widgets/permissions/impl/edit/apply.permission/impl/nls/lang","css!csui/widgets/permissions/impl/permissions"],function(e,t,i,s,n){"use strict";return i.ItemView.extend({"template":s,"templateHelpers":function(){var t="";if(this.options.removePermission){var i=this.options.permissionModel&&this.options.permissionModel.get("right_id_expand")&&this.options.permissionModel.get("right_id_expand").name_formatted;i=this.options.permissionModel&&"public"===this.options.permissionModel.get("type")?n.publicAccess:i,t=e.str.sformat(n.removePermissionHeaderTitle,i)}else t=this.options.restorePublicAccess?n.restorePublicAccessHeaderTitle:n.applyPermissionHeaderTitle;return{"title":t}},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)}})}),csui.define("csui/widgets/permissions/impl/edit/edit.permission.helper",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/controls/dialog/dialog.view","i18n","csui/models/permission/nodepermission.model","csui/widgets/permissions/impl/edit/permission.level.selector/permission.level.selector.view","csui/widgets/permissions/impl/edit/permission.attributes/permission.attributes.view","csui/widgets/permissions/impl/edit/apply.permission/apply.permission.view","csui/widgets/permissions/impl/edit/apply.permission/impl/header/apply.permission.header.view","csui/controls/progressblocker/blocker","i18n!csui/widgets/permissions/impl/nls/lang"],function(e,t,i,s,n,o,r,l,a,c,u,d,h){"use strict";return i.Object.extend({"constructor":function(e){i.Object.prototype.constructor.apply(this,arguments)},"initialize":function(t){this.uniqueViewId="view"+e.uniqueId(),this.options.readonly||this._showSelectPermissionLevelPopover()},"_showSelectPermissionLevelPopover":function(){this.permissionLevelSelectorView&&this.permissionLevelSelectorView.destroy(),this.permissionLevelSelectorView=new l({"permissionModel":this.options.permissionModel}),this.permissionLevelSelectorView.render(),this.listenTo(this.permissionLevelSelectorView,"permission:level:selected",this._permissionLevelSelected),this.currentPopoverView=this.permissionLevelSelectorView,this.popoverContainerClassname="",this.showPopover()},"showCustomPermissionPopover":function(){this.permissionAttributesView&&this.permissionAttributesView.destroy(),this.permissionAttributesView=new a({"model":this.options.permissionModel,"readonly":this.options.readonly,"node":this.options.originatingView&&this.options.originatingView.model}),this.permissionAttributesView.render(),this.listenTo(this.permissionAttributesView,"permission:attribute:save:clicked",this._permissionAttributesSelected),this.listenTo(this.permissionAttributesView,"permission:attribute:cancel:clicked",this.closePopover),this.currentPopoverView=this.permissionAttributesView,this.popoverContainerClassname="csui-permission-attribute-popover-container ",this.showPopover()},"_permissionLevelSelected":function(){var e=this.permissionLevelSelectorView.selected;e!==r.PERMISSION_LEVEL_CUSTOM?(this.showingPopover&&this.closePopover(!0),this.permissions=r.getPermissionsByLevelExceptCustom(e,!this.options.originatingView||this.options.originatingView.model.get("container")),this.options.originatingView&&this.options.originatingView.model&&this.options.originatingView.model.get("container")&&"advanced"===this.options.originatingView.model.get("permissions_model")?(this._applyDialog=this.showApplyPermissionDialog(),this._applyDialog.show()):this.triggerMethod("permissions:selected",{"permissions":this.permissions})):this.showCustomPermissionPopover()},"showApplyPermissionDialog":function(){var t=new u;this._view=new c({"context":this.options.originatingView.context,"model":this.options.originatingView.model,"applyTo":this.options.applyTo,"permissionModel":this.options.permissionModel});var i=new n({"headerView":t,"view":this._view,"className":"csui-permissions-apply-dialog","midSize":!0,"buttons":[{"id":"apply","label":h.applyButtonLabel,"toolTip":h.applyButtonLabel,"default":!0,"click":e.bind(this.onClickApplyButton,this)},{"label":h.cancelButtonLabel,"toolTip":h.cancelButtonLabel,"close":!0}]});return i.listenTo(i,"hide",e.bind(this.onHideDialog,this)),d.imbue(i),i},"onClickApplyButton":function(e){var t=e.dialog.$el.find(".csui-subtypes-option:checked").map(function(){return this.value}).toArray(),i=e.dialog.options.view.model.get("container"),s=e.dialog.options.view.options.permissionModel&&e.dialog.options.view.options.permissionModel.get("right_id"),n=e.dialog.options.view.model.get("permissions_model"),o=i&&"advanced"===n&&e.dialog.options.view.subFolderSelected?2:i&&"advanced"===n?3:0;this.triggerMethod("permissions:selected",{"permissions":this.permissions,"apply_to":o,"right_id":s,"include_sub_types":t});this._applyDialog.destroy(),this._blockActions()},"onHideDialog":function(){var e=this.options.originatingView;e&&e.trigger("unblock:view:actions")},"_blockActions":function(){var e=this.options.originatingView;e&&e.blockActions&&e.blockActions()},"_unblockActions":function(){var e=this.options.originatingView;e&&e.unblockActions&&e.unblockActions()},"unblockActions":function(){this._unblockActions()},"_permissionAttributesSelected":function(e){this.permissions=e,this.showingPopover&&this.closePopover(!0),this.options.originatingView&&this.options.originatingView.model&&this.options.originatingView.model.get("container")?(this._applyDialog=this.showApplyPermissionDialog(),this._applyDialog.show()):this.triggerMethod("permissions:selected",{"permissions":this.permissions})},"showPopover":function(){var i=this.options.popoverPlacement,s=!1;o&&o.settings.rtl&&(i="left"===i?"right":"left",s=!0);var n={"html":!0,"content":e.bind(function(){return this.currentPopoverView.el},this),"trigger":"manual","placement":i};this.options.popoverAtBodyElement&&(this.popoverContainerClassname+="csui-edit-permission-popover-container "+this.uniqueViewId,this.popoverContainerSelector=".csui-edit-permission-popover-container."+this.uniqueViewId,this.$popoverEl?this._getPopoverParent().addClass(this.popoverContainerClassname):t("body").append('<div class="binf-widgets '+this.popoverContainerClassname+'"></div>'),n=e.extend(n,{"container":this.popoverContainerSelector})),this.$popoverEl=this.options.popoverTragetElement,this.$popoverEl.binf_popover(n).binf_popover("show");for(var r,l,a,c,u=this._getPopoverParent().find(".binf-popover"),d=this._getPopoverParent().find(".binf-popover").find(".csui-tree-split"),h=d.length-1,p=0;p<d.length;h--,p++)l=t(d[h]).width()*p,a=t(d[h]).closest(".csui-tree-child").find(".csui-separator"),d[h]===d[d.length-1]?r=u.find(".csui-permission-attribute-tree").outerHeight():(r=Math.round(t(d[h]).closest("li").position().top+t(d[h]).closest(".csui-tree-child").outerHeight()),l+=p),s?(t(d[h]).css({"height":r,"left":l}),a.css({"width":u.find(".csui-tree-container").width()-l,"left":l}),t(d[h]).closest(".csui-tree-child").css({"padding-left":l+t(d[h]).width()})):(t(d[h]).css({"height":r,"right":l}),a.css({"width":u.find(".csui-tree-container").width()-l,"right":l}),t(d[h]).closest(".csui-tree-child").css({"padding-right":l+t(d[h]).width()}));c=o&&o.settings.rtl?parseInt(u.css("left"))+u.find(".binf-arrow").outerWidth():parseInt(u.css("left"))-u.find(".binf-arrow").outerWidth(),u.css("left",c),this.$popoverEl.on("shown.binf.popover",e.bind(function(e){this.currentPopoverView&&this.currentPopoverView.currentlyFocusedElement&&this.currentPopoverView.currentlyFocusedElement().focus(),t(document).on("mousedown."+this.uniqueViewId,{"view":this},this._handleClickEvent),t(window).bind("resize."+this.uniqueViewId,{"view":this},this._onWindowResize),this.options.popoverAtBodyElement&&(t(document).on("scroll",{"view":this},this._handleScrollEvent),this.options.originatingView&&this.listenToOnce(this.options.originatingView,"scroll",function(e){e.data={"view":this},this._handleScrollEvent(e)})),t("body").on("keydown."+this.uniqueViewId,{"view":this},this._handleKeyEvents),this.triggerMethod("shown:permission:level:popover")},this)),this.$popoverEl.on("hidden.binf.popover",e.bind(function(e){this.$popoverEl.focus(),this.currentPopoverView&&this.currentPopoverView.destroy(),this.currentPopoverView=void 0,this.options.popoverAtBodyElement&&t(this.popoverContainerSelector).remove()},this)),this.showingPopover=!0},"_onWindowResize":function(e){if(e&&e.data&&e.data.view){var t=e.data.view;t.showingPopover&&t.closePopover()}},"_handleKeyEvents":function(e){if(e&&e.data&&e.data.view){var t=e.data.view;(t.getOption("readonly")&&(9===e.keyCode||13===e.keyCode)||27===e.keyCode)&&t.showingPopover&&t.closePopover()}},"_handleClickEvent":function(e){if(!t(e.target).closest(".binf-popover").length){var i;e&&e.data&&e.data.view&&(i=e.data.view,t(document).off("mousedown."+this.uniqueViewId,i._handleClickEvent)),i&&i.closePopover()}},"_handleScrollEvent":function(e){if(!t(e.target).closest(".binf-popover").length){var i;e&&e.data&&e.data.view&&(i=e.data.view,t(document).off("scroll",i._handleScrollEvent)),i&&i.closePopover()}},"closePopover":function(e){this.$popoverEl&&this.$popoverEl.data("binf.popover")&&(t(document).off("mousedown."+this.uniqueViewId,this._handleClickEvent),t(document).off("scroll",this._handleScrollEvent),t(window).unbind("resize."+this.uniqueViewId,this._onWindowResize),this.currentPopoverView&&this.currentPopoverView.$el.off("keydown",this._handleKeyEvents),this.$popoverEl.binf_popover("destroy"),this.showingPopover=!1,e||this.triggerMethod("closed:permission:level:popover")),this.$popoverEl.focus()},"_getPopoverParent":function(){return this.options.popoverAtBodyElement?t(this.popoverContainerSelector):this.$popoverEl.parent()},"onBeforeDestroy":function(){this.closePopover(!0)}})}),csui.define("json!csui/widgets/nodestable/nodestable.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{title}}","description":"{{description}}","kind":"fullpage","schema":{"type":"object","properties":{"containerId":{"title":"{{containerIdTitle}}","description":"{{containerIdDescription}}","type":"integer"},"pageSize":{"title":"{{pageSizeTitle}}","description":"{{pageSizeDescription}}","type":"integer","minimum":5,"maximum":100,"default":30},"pageSizes":{"title":"{{pageSizesTitle}}","description":"{{pageSizesDescription}}","type":"array","minItems":1,"maxItems":6,"items":{"type":"integer","minimum":5,"maximum":100},"default":[30,50,100]}}},"options":{"fields":{"containerId":{"type":"otcs_node_picker","type_control":{"parameters":{"select_types":[-1]}}}}},"actions":[{"toolItems":"csui/widgets/nodestable/toolbaritems","toolItemMasks":"csui/widgets/nodestable/toolbaritems.masks","toolbars":[{"id":"tableHeaderToolbar","title":"{{tableHeaderToolbarTitle}}","description":"{{tableHeaderToolbarDescription}}"},{"id":"inlineActionbar","title":"{{inlineActionbarTitle}}","description":"{{inlineActionbarDescription}}"},{"id":"leftToolbar","title":"{{leftToolbarTitle}}","description":"{{leftToolbarDescription}}"},{"id":"rightToolbar","title":"{{rightToolbarTitle}}","description":"{{rightToolbarDescription}}"}]},{"toolItems":"csui/widgets/nodestable/headermenuitems","toolItemMasks":"csui/widgets/nodestable/headermenuitems.mask","toolbars":[{"id":"headerMenuToolbar","title":"{{headerMenuTitle}}","description":"{{headerMenuDescription}}"}]}]}),csui.define("csui/widgets/nodestable/impl/nls/nodestable.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/nodestable/impl/nls/root/nodestable.manifest",{"title":"Node Browsing Table","description":"Provides a tabular view on objects stored in a container.","containerIdTitle":"Container","containerIdDescription":"A container object to browse children of.","pageSizeTitle":"Default Page Size","pageSizeDescription":"The maximum object count to be displayed in the table body by default.","pageSizesTitle":"Available Page Sizes","pageSizesDescription":"A list of maximum displayed object counts in the table body to be chosen from.","leftToolbarTitle":"Left Header Toolbar","leftToolbarDescription":"Toolbar on the left side of the name of the currently opened container.","rightToolbarTitle":"Right Header Toolbar","rightToolbarDescription":"Toolbar on the right side of the name of the currently opened container.","tableHeaderToolbarTitle":"Table Header Toolbar","tableHeaderToolbarDescription":"Toolbar, which is activated in the table header, once a table row is selected.","inlineActionbarTitle":"Inline Action Bar","inlineActionbarDescription":"Toolbar, which is displayed inside a table row, when the mouse cursor is moving above it.","headerMenuTitle":"Container Context Menu",
"headerMenuDescription":"Context menu, which is displayed when clicking on the arrow on the right side of the name of the currently opened container."}),csui.define("bundles/csui-browse",["csui/behaviors/item.name/item.name.behavior","csui/behaviors/table.rowselection.toolbar/table.rowselection.toolbar.behavior","csui/controls/conflict.resolver/impl/conflict.dialog/conflict.dialog","csui/controls/conflict.resolver/impl/collection.conflicts/collection.conflicts.view","csui/controls/conflict.resolver/conflict.resolver","csui/controls/dialog/dialog.view","csui/controls/draganddrop/draganddrop.view","csui/controls/fileupload/fileupload","csui/controls/fileupload/impl/addversion.controller","csui/controls/pagination/nodespagination.view","csui/controls/tableactionbar/tableactionbar.view","csui/controls/item.title/item.title.view","csui/controls/table/table.columns","csui/controls/table/table.view","csui/controls/table.list/table.list.view","csui/controls/table/inlineforms/inlineform.factory","csui/controls/tabletoolbar/tabletoolbar.view","csui/controls/table.configuration.toolbar/configuration.toolbar.dropdown.view","csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view","csui/controls/table/inlineforms/favorite/favorite.view","csui/controls/table/inlineforms/generic/generic.view","csui/controls/table/inlineforms/inlineform/impl/inlineform.view","csui/controls/table/inlineforms/inlineform.registry","csui/controls/table/inlineforms/permissions/user.picker/user.picker.view","csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/celleditor/celleditor.view","csui/controls/table/cells/cell.factory","csui/controls/table/cells/cell.registry","csui/controls/table/cells/date/date.view","csui/controls/table/cells/datetime/datetime.view","csui/controls/table/cells/duedate/duedate.view","csui/controls/table/cells/favorite/favorite.view","csui/controls/table/cells/member/member.view","csui/controls/table/cells/name/name.view","csui/controls/table/cells/node.state/node.state.view","csui/controls/table/cells/parent/parent.view","csui/controls/table/cells/priority/priority.view","csui/controls/table/cells/reservation/reservation.view","csui/controls/table/cells/searchbox/searchbox.view","csui/controls/table/cells/select/select.view","csui/controls/table/cells/size/size.view","csui/controls/table/cells/status/status.view","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/text/text.view","csui/controls/table/cells/type.icon/type.icon.view","csui/controls/table/cells/user/user.view","csui/controls/table/cells/permission/permission.level.view","csui/controls/tree/tree.view","csui/controls/table/cells/node.state/impl/node.state.icons","csui/controls/table/rows/description/description.view","csui/controls/table/rows/metadata/metadatarow.view","csui/controls/thumbnail/thumbnail.view","csui/controls/thumbnail/thumbnail.content","csui/controls/thumbnail/content/content.registry","csui/controls/thumbnail/content/content.factory","csui/controls/thumbnail/content/favorite/favorite.view","csui/controls/thumbnail/content/node.state/node.state.view","csui/controls/thumbnail/content/name/name.view","csui/controls/thumbnail/content/member/member.view","csui/controls/thumbnail/content/thumbnail.icon/thumbnail.icon.view","csui/controls/thumbnail/content/overview/overview.view","csui/controls/thumbnail/content/select/select.view","csui/controls/thumbnail/content/size/size.view","csui/controls/thumbnail/content/date/date.view","csui/controls/thumbnail/content/node.state/node.state.view","csui/controls/thumbnail/content/node.state/impl/node.state.icons","csui/controls/thumbnail/content/node.state/impl/reservation/reservation.view","csui/controls/thumbnail/content/overview/overview.content","csui/controls/thumbnail/content/overview/properties.overview","csui/controls/wizard/wizard.view","csui/dialogs/node.picker/node.picker","csui/dialogs/node.picker/start.locations/location.base.factory","csui/dialogs/node.picker/start.locations/node.base.factory","csui/dialogs/node.picker/start.locations/start.location.collection","csui/dialogs/node.picker/start.locations/current.location/current.location.factory","csui/dialogs/node.picker/start.locations/enterprise.volume/enterprise.volume.factory","csui/dialogs/node.picker/start.locations/favorites/favorites.factory","csui/dialogs/node.picker/start.locations/personal.volume/personal.volume.factory","csui/dialogs/node.picker/start.locations/category.volume/category.volume.factory","csui/dialogs/node.picker/start.locations/perspective.assets.volume/perspective.assets.volume.factory","csui/dialogs/node.picker/start.locations/recent.containers/recent.containers.factory","csui/dialogs/node.picker/start.locations/search.location/search.location.factory","csui/dialogs/node.picker/start.locations/default.location/default.location.factory","csui/dialogs/members.picker/members.picker.wizard","csui/dialogs/members.picker/start.locations/location.base.factory","csui/dialogs/members.picker/start.locations/start.location.collection","csui/dialogs/members.picker/start.locations/current.group/current.group.factory","csui/dialogs/members.picker/start.locations/all.members/all.members.factory","csui/dialogs/members.picker/start.locations/member.groups/member.groups.factory","csui/dialogs/members.picker/start.locations/recent.groups/recent.groups.factory","csui/dialogs/members.picker/start.locations/all.groups/all.groups.factory","csui/dialogs/members.picker/start.locations/acl.groups/acl.groups.factory","csui/dialogs/members.picker/start.locations/acl.groups/impl/acl.groups.collection","csui/integration/folderbrowser/folderbrowser.widget","csui/integration/target.picker/target.picker","csui/integration/v1.widgets.wrapper","csui/integration/permission.header/permission.header.view","csui/integration/permission/table/cells/security.permission.cell","csui/integration/permission/table/permission.table.columns","csui/integration/folderbrowser/impl/nodestable.toolitems","csui/lib/jquery.dataTables.bootstrap/js/dataTables.bootstrap","csui/lib/jquery.dataTables/js/jquery.dataTables","csui/lib/jquery.dataTables.tableTools/js/dataTables.tableTools","csui/widgets/search.results/impl/search.results.factory","json!csui/utils/contexts/perspective/impl/perspectives/metadata.json","json!csui/utils/contexts/perspective/impl/perspectives/metadata.navigation.json","json!csui/utils/contexts/perspective/impl/perspectives/document.overview.json","csui/widgets/nodestable/nodestable.view","csui/utils/testutils/async.test.utils","csui/utils/toolitem.masks/children.toolitems.mask","csui/utils/toolitem.masks/creation.toolitems.mask","csui/widgets/favorites/toolbaritems","csui/widgets/favorites/toolbaritems.masks","csui/widgets/nodestable/headermenuitems","csui/widgets/nodestable/headermenuitems.mask","csui/widgets/nodestable/toolbaritems","csui/widgets/nodestable/toolbaritems.masks","csui/widgets/recentlyaccessed/toolbaritems","csui/widgets/recentlyaccessed/toolbaritems.masks","csui/widgets/favorites/tileview.toolbaritems","csui/widgets/recentlyaccessed/tileview.toolbaritems","csui/widgets/favorites/impl/favorites2.table.view","csui/widgets/favorites/favorite.star.view","csui/widgets/myassignments/impl/myassignmentstable.view","csui/widgets/recentlyaccessed/impl/recentlyaccessedtable.view","csui/widgets/permissions/permissions.view","csui/widgets/permissions/impl/edit/permission.level.selector/permission.level.selector.view","csui/widgets/permissions/impl/edit/edit.permission.helper","json!csui/widgets/nodestable/nodestable.manifest.json","i18n!csui/widgets/nodestable/impl/nls/nodestable.manifest","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/tabletoolbar/impl/nls/root/localized.strings"],{}),csui.require(["require","css"],function(e,t){t.styleLoad(e,"csui/bundles/csui-browse",!0)});
//# sourceMappingURL=csui-browse.js.map