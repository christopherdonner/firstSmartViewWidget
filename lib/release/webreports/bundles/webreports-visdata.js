csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.expanding.behavior",["require","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/tile/behaviors/expanding.behavior"],function(e,t,i,a,n){"use strict";function s(e){var i=this.options||{},a=i[e];return t.isFunction(a)?i[e].call(this.view):a}return n.extend({"_expand":function(){if(this.view&&this.view.contentView&&!this.view.contentView.collection.isEmpty()){var a=this.getOption("expandedView"),n=a.prototype instanceof i.View?a:a.call(this.view),l=["csui/controls/dialog/dialog.view"],r=this;t.isString(n)&&l.push(n),e(l,function(e){t.isString(n)&&(n=arguments[1]);var i=s.call(r,"expandedViewOptions"),a=new n(i);r._dialog=new e({"iconLeft":s.call(r,"titleBarIcon"),"imageLeftUrl":s.call(r,"titleBarImageUrl"),"imageLeftClass":s.call(r,"titleBarImageClass"),"title":s.call(r,"dialogTitle"),"iconRight":s.call(r,"dialogTitleIconRight"),"className":"cs-expanded "+(s.call(r,"dialogClassName")||""),"buttons":i.data.buttons,"largeSize":!0,"view":a}),r.listenTo(r._dialog,"hide",function(){r.triggerMethod("collapse"),i.data.isExpanded=!1}),i.data.isExpanded=!0,r.view.overlayVisible&&r.view.ui.toggleSettings.trigger("click"),r._dialog.show()})}}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/filtered.count.facets",["csui/lib/underscore","csui/lib/jquery","csui/models/facets"],function(e,t,i){"use strict";return i.extend({"constructor":function(e,t){i.prototype.constructor.apply(this,arguments),this.filters=t&&t.filters||[]},"addFilter":function(e){return this.filters.push(e),JSON.parse(JSON.stringify(this.filters))},"removeFilter":function(e,t){var i=this.filters[e];return i.values.splice(t,1),0===i.values.length&&this.filters.splice(e,1),JSON.parse(JSON.stringify(this.filters))},"clearFilters":function(){return this.filters&&this.filters.length>0&&(this.filters=[]),[]}})}),csui.define("webreports/utils/url.webreports",["csui/lib/underscore","csui/utils/url","csui/utils/contexts/factories/node"],function(e,t,i){return e.extend({"appendWebReportParameters":function(t,i){return e.isUndefined(i)||(t=e.isArray(i)?this.combineQueryString(t,this._serializeWebReportParameters(i)):this.combineQueryString(t,i)),t},"appendCurrentContainer":function(t,i){var a;return e.isUndefined(i)||(a=this.getCurrentContainerID(i))&&(t=this.combineQueryString(t,"csuiContainerID="+a)),t},"appendSWRCellID":function(e,t){var i;return t&&t.data&&t.data.swrLaunchCell&&t.data.swrLaunchCell.id&&("number"!=typeof(i=parseInt(t.data.swrLaunchCell.id,10))||isNaN(i)||(e=this.combineQueryString(e,"subwebreport_id="+i))),e},"getCurrentContainerID":function(t){var a,n=t.getModel(i);return e.isUndefined(n)||(a=n.get("id")),a},"_serializeWebReportParameters":function(t){var i="";return e.each(t,function(e){""!==e.name&&(i.length?i+="&"+e.name+"="+e.value:i+=e.name+"="+e.value)}),i},"getWebReportParametersAsData":function(t){var i={};return e.isArray(t)&&e.each(t,function(e){""!==e.name&&(i[e.name]=e.value)}),i},"getDataAsWebReportParameters":function(t){var i=[];return e.isObject(t)&&e.mapObject(t,function(e,t){i.push({"name":t,"value":e})}),i}},t)}),csui.define("webreports/widgets/visual.data.filtered.count/impl/models/visualdata/visual.data.model",["csui/lib/underscore","csui/lib/backbone","webreports/utils/url.webreports","csui/models/mixins/connectable/connectable.mixin"],function(e,t,i,a){return t.Model.extend({"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments)}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/overlay.model",["csui/lib/underscore","csui/lib/backbone"],function(e,t){return t.Model.extend({"defaults":{"vis_type":"","active_column":"","active_column_formatted":"","count_column":"","column_names":[],"column_names_formatted":[],"sort_by":"Count","sort_order":"desc","view_value_as_percentage":!1,"group_after":10,"fc_filters":[]},"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments)}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.column.model",["csui/lib/backbone"],function(e){return e.Model.extend({"defaults":{"active_column":!1,"client_format":{"type":"none"},"column_key":"","count_column":!1,"data_type":10,"id":void 0,"name":"","tag_format":""},"constructor":function(t,i){e.Model.prototype.constructor.apply(this,arguments)}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.column.collection",["csui/lib/backbone","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.column.model"],function(e,t){return e.Collection.extend({"constructor":function(t,i){e.Collection.prototype.constructor.apply(this,arguments)},"model":t})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/root/visual.data.lang",{"dialogTitle":"Visual Data Filtered Count","barChart":"Bar chart","pieChart":"Pie chart","donutChart":"Donut chart","scatterChart":"Scatter chart","areaChart":"Area chart","lineChart":"Line chart","chartType":"Chart type","activeColumn":"Active column","sortBy":"Sort by","count":"Count","asc":"asc","desc":"desc","filters":"Filters","showValuesAs":"Show values as","groupAfter":"Group after","dontGroup":"Don't group","items":"items","actual":"Actual","percentage":"Percentage","update":"Update","cancel":"Cancel","launchReport":"Launch WebReport","launchReportTooltip":"Launch a classic WebReport in a new window using the current filter configuration.","tooManyRows":"Please refine your filter further. The maximum number of items that can be processed is ","noValue":"(No value)","invalidActiveColumn":"An invalid Active Column was specified.","emptyChartText":"No results found.","settings":"Settings"}),csui.define("webreports/widgets/visual.data.filtered.count/impl/models/visualdata/visual.data.collection",["csui/lib/underscore","csui/lib/backbone","csui/lib/d3","csui/dialogs/modal.alert/modal.alert","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/filtered.count.facets","csui/models/facettopics","webreports/utils/url.webreports","webreports/widgets/visual.data.filtered.count/impl/models/visualdata/visual.data.model","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/overlay.model","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.column.collection","csui/models/mixins/connectable/connectable.mixin","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang","csui/utils/deepClone/deepClone"],function(e,t,i,a,n,s,l,r,o,c,u,d){var p=t.Collection.extend({"constructor":function(i,a){t.Collection.prototype.constructor.apply(this,arguments),e.isUndefined(a)&&(a={}),a&&a.id&&!this.id&&(this.id=a.id),this.options=a,this.makeConnectable(a),this.overlayModel=new o({"vis_type":a.type,"active_column":a.activeColumn,"sort_by":a.sortBy||"Count","sort_order":a.sortOrder||"desc","view_value_as_percentage":a.viewValueAsPercentage,"group_after":a.groupAfter,"fc_filters":a.filters||[]}),this.listenTo(this.overlayModel,"change",this.onOverlayUpdate)},"model":r,"url":function(){return this.connector.connection.url+"/nodes/"+this.id+"/output"},"parse":function(e){return e.data&&e.data.length>0?(this._isEmpty=!1,this._isFetched=!0,this.grouped_on_server=e.grouped_on_server||!1,this.sorted_on_server=e.sorted_on_server||!1,this.setColumns(e.columns),this._isResponseValid(e)?(e.grouped_on_server?(this.groupedData=e,e.fc_filters&&this.overlayModel.set({"fc_filters":e.fc_filters},{"silent":!0})):this.rawCollection=e.data,this.filteredData=this.sortGroupAndFilter(),this.filteredData):void 0):(this._isEmpty=!0,this._isFetched=!0,[])},"_isEmpty":!0,"_isFetched":!1,"isEmpty":function(){return this._isEmpty&&this._isFetched},"isFetched":function(){return this._isFetched},"_isResponseValid":function(e){var t=!0;return e.grouped_on_server||this._isActiveColumnValid(e)||(a.showError(d.invalidActiveColumn),t=!1),t},"_isActiveColumnValid":function(t){return!e.isUndefined(this._getCaseInsensitiveProperty(e.first(t.data),this.getActiveColumn()))},"filteredData":{},"rawCollection":{},"overlayModel":{},"getFilteredCountParms":function(){var t={};return t.filterable=!0===this.options.filterable,t.expandable=!0===this.options.expandable,e.extend(t,this.overlayModel.attributes),"ordinal"===t.sort_by&&(t.sort_by=t.active_column),t.fc_filters=JSON.stringify(t.fc_filters),t},"getFilteredCountQuery":function(){var t,i={},a=this.options.context||void 0,n=this.options.parameters||void 0;return e.isUndefined(n)||(i=e.extend(i,l.getWebReportParametersAsData(n))),t=l.getCurrentContainerID(a),e.isUndefined(t)||(i=e.extend(i,{"csuiContainerID":t})),i=e.extend(i,this.getFilteredCountParms())},"getActiveColumn":function(){var e,t;return this.columns&&(t=this.columns.findWhere({"active_column":!0}))&&(e=t.get("name")),e},"getCountColumn":function(){var e,t;return this.columns&&(t=this.columns.findWhere({"count_column":!0}))&&(e=t.get("name")),e},"getFilters":function(){return e.deepClone(this.overlayModel.get("fc_filters"))},"getSortOptions":function(){return{"sortBy":this.overlayModel.get("sort_by"),"sortOrder":this.overlayModel.get("sort_order")}},"getTotalCount":function(){return this.models.reduce(function(e,t){return e+t.get("value")},0)},"getPercentageOfTotal":function(e){return e/this.getTotalCount()*100},"getGroupAfter":function(){return this.overlayModel.get("group_after")},"mapFacetData":function(i){var a=[],l=this.columns.toJSON(),r=e.findWhere(l,{"active_column":!0}),o={},c={},u=[];o[r.id]=e.map(i,e.bind(function(t){return{"name":t.key_formatted||t.key,"value":e.isUndefined(t.key)?t.key_formatted:t.key,"total":t.value,"percentage":this.getPercentageOfTotal(t.value)}},this)),o[r.id]=e.reject(o[r.id],function(e){return"Other"===e.name}),a[0]=o,e.each(l,function(e){c[e.id]=e}),e.each(a,e.bind(function(i){var a,n=e.keys(i)[0],l=i[n],r={},o=-1,d=[];this.facetFilters&&this.facetFilters.filters&&(d=this._getAppliedFacetNames(),o=d.indexOf(c[n].name)),r[n]=c[n],c[n].name=c[n].name_formatted,a=new t.Model(c[n]),a.topics=-1===o?new s(l):new s,u.push(a)},this)),this.facetFilters?this.facetFilters.reset(u):this.facetFilters=new n(u)},"_getAppliedFacetNames":function(){return e.map(this.facetFilters.filters,e.bind(function(e){return this.getActiveColumnByFormattedName(e.facetName)},this))},"mapFilterData":function(t){return e.map(t,function(e){return{"facetName":e.column,"values":[{"topicName":e.value}]}})},"unmapFilterData":function(t){var i=e.map(t.values,function(e){return e.topicName});return i=this.resolveToActualValues(i),{"column":this.getActiveColumnByFormattedName(t.facetName),"operator":"IN","value":i}},"resolveToActualValues":function(t){var i,a=this.map(function(e){return e.get("key")});return this.models[0].has("key_formatted")?(i=this.map(function(e){return e.get("key_formatted")}),e.map(t,e.bind(function(e){var t=i.indexOf(e);return-1!==t&&(e=a[t]),e},this))):t},"addFilter":function(e){var t=this._getNextActiveColumn(),i=this.getFilters();i.push(this.unmapFilterData(e)),this.overlayModel.set({"fc_filters":i,"active_column":t,"active_column_formatted":this._getFormattedActiveColumnByName(t)})},"clearFilters":function(){var e=this._getNextActiveColumn();this.overlayModel.set({"fc_filters":[],"active_column":e,"active_column_formatted":this._getFormattedActiveColumnByName(e)})},"_getNextActiveColumn":function(){var t=this.overlayModel.get("column_names"),i=this._getAppliedFacetNames(),a=e.difference(t,i);return 0===a.length?e.first(i):0!==i.length?e.first(a):e.first(t)},"getActiveColumnByFormattedName":function(e){return this.columns.findWhere({"name_formatted":e}).get("name")},"_getFormattedActiveColumnByName":function(e){var t=this.columns.findWhere({"name":e});return t.get("name_formatted")||t.get("name")},"_getCaseInsensitiveProperty":function(t,i){return t&&i?t[i]||t[e.find(e.keys(t),function(e){return e.toLowerCase()===i.toLowerCase()})]:void 0},"updateFilters":function(t,i){var a,n,s=this.getFilters(),l=s.length,r=[],o=!1,c=!1;e.each(s,function(e){c=!1,e.column===t?e.value.length>1&&(n=e.value.indexOf(i),-1!==n?(e.value.splice(n,1),c=!0,o=!0):c=!0):c=!0,c&&r.push(e)}),a=this._getNextActiveColumn(),r.length>0?(this.overlayModel.set({"fc_filters":r,"active_column":a,"active_column_formatted":this._getFormattedActiveColumnByName(a)}),o&&l===r.length&&this.overlayModel.trigger("change",this.overlayModel)):this.overlayModel.set({"active_column":a,"active_column_formatted":this._getFormattedActiveColumnByName(a)})},"updateColumnModels":function(t){var i=this.columns.models;e.each(i,function(e){!0===e.get("active_column")&&e.get("name")!==t&&e.set({"active_column":!1}),e.get("name")===t&&e.set({"active_column":!0})}),this.columns.set(i)},"setColumns":function(t){var i,a=e.findWhere(t,{"active_column":!0}),n=e.findWhere(t,{"count_column":!0});(!a||!n)&&(t=e.map(t,e.bind(function(e){return this.options.activeColumn&&e.name.toLowerCase()===this.options.activeColumn.toLowerCase()&&(e.active_column=!0),this.options.countColumn&&e.name.toLowerCase()===this.options.countColumn.toLowerCase()&&(e.active_column=!0),e},this))),this.columns=new c(t),this.setColumnNames(),i=this.getActiveColumn(),this.overlayModel.set({"active_column":i,"active_column_formatted":this._getFormattedActiveColumnByName(i),"count_column":this.getCountColumn()},{"silent":!0})},"setColumnNames":function(){var t=this.columns.filter(function(e){return!0!==e.get("count_column")});this.overlayModel.set({"column_names":e.map(t,function(e){return e.get("name")})},{"silent":!0}),this.overlayModel.set({"column_names_formatted":e.map(t,function(e){return e.get("name_formatted")||e.get("name")})},{"silent":!0})},"sortGroupAndFilter":function(e){var t,i;return this.grouped_on_server?(t=this._mapGroupedData(),(!this.sorted_on_server||e&&e.sort)&&(t=this.sortNest(t,this.getSortOptions()))):(i=this.nest(this.filterBy(this.rawCollection,this.getFilters()),this.getActiveColumn()),t=this.groupOutlyingValues(this.sortNest(i,this.getSortOptions()),this.getGroupAfter())),this.mapFacetData(t),this.facetFilters.filters||(this.facetFilters.filters=this.mapFilterData(this.getFilters()),this.facetFilters.trigger("reset")),t},"_mapGroupedData":function(){var t={};return this.groupedData&&this.groupedData.data&&(t=e.map(this.groupedData.data,function(e){var t=this.getActiveColumn(),i=this.getCountColumn(),a=this._getCaseInsensitiveProperty(e,t+"_formatted")||this._getCaseInsensitiveProperty(e,t),n=this._getCaseInsensitiveProperty(e,i+"_formatted")||this._getCaseInsensitiveProperty(e,i);return{"key":e[t],"key_formatted":this._removeEmptyValues(a),"value":e[i],"value_formatted":n}},this)),t},"_removeEmptyValues":function(e){return null===e||""===e||void 0===e?d.noValue:e},"nest":function(t,i){var a,n,s,l=[],r={};return e.each(t,e.bind(function(t){n=this._removeEmptyValues(t[i]),a=e.findIndex(l,function(e){return e.key===n}),-1===a?l.push({"key":n,"key_formatted":n.toString(),"value":1,"value_formatted":"1"}):(r=l[a],s=r.value,s+=1,r.value=s,r.value_formatted=s.toString(),l[a]=r)},this)),l},"filterBy":function(t,i){function a(e){var t,i=this._removeEmptyValues(e[n]);switch(l){case"==":t=i===s;break;case"IN":t=-1!==s.indexOf(i);break;default:t=-1!==s.indexOf(i)}return t}var n=null,s=null,l=null;return e.each(i,e.bind(function(i){s=this._removeEmptyValues(i.value),n=i.column,l=i.operator,t=t.filter(e.bind(a,this))},this)),t},"sortNest":function(e,t){var a,n,s=[];return a=t.sortBy,n=t.sortOrder,e=e.sort(function(e,t){switch(a.toLowerCase()){case"ordinal":s=isNaN(e.key)?i.ascending(e.key,t.key):e.key-t.key;break;case"count":s=e.value-t.value}return s}),"asc"===n?e:e.reverse()},"groupOutlyingValues":function(t,i){if(t.length>i+1&&i>-1){var a=t.slice(0,i),n=t.slice(i),s=e.pluck(n,"value"),l=e.reduce(s,function(e,t){return e+t},0),r={"key":"Other","value":l};return a.push(r),a}return t},"onOverlayUpdate":function(){var t=this.overlayModel.changedAttributes(),i=0===e.keys(e.omit(t,["sort_by","sort_order","view_value_as_percentage"])).length,a=this.grouped_on_server&&!i;e.has(t,"column_names")||(a?(this._isFetched=!1,this._isEmpty=!0,this.fetch({"type":"POST"})):i?this.reset(this.sortGroupAndFilter({"sort":!0})):(e.has(t,"active_column")&&this.updateColumnModels(t.active_column),this.reset(this.sortGroupAndFilter())))}});u.mixin(p.prototype);var h=p.prototype.fetch;return p.prototype.fetch=function(t){t||(t={});var i,a={"format":"webreport","method":"GET"},n=this.getFilteredCountQuery();return a=e.extend(a,n),i={"type":"POST","data":a},t?e.extend(t,i):t=i,h.call(this,t)},p}),csui.define("webreports/widgets/visual.data.filtered.count/impl/utils/contexts/factories/visual.data.collection.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","webreports/widgets/visual.data.filtered.count/impl/models/visualdata/visual.data.collection"],function(e,t,i,a,n,s){return a.extend({"propertyPrefix":"visualdata","constructor":function(l,r){a.prototype.constructor.apply(this,arguments);var o=l.getObject(n,r);r.connector=o;var c=this.options.visualdata||{};if(!(c instanceof i.Collection)){var u=e.config();c=new s(c.models,t.extend({"connector":o},c.attributes,u.options,{"autoreset":!0}))}this.property=c},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("webreports/mixins/webreports.view.mixin",["csui/lib/underscore","webreports/utils/url.webreports"],function(e,t){"use strict";return{"mixin":function(i){return e.extend(i,{"setCommonModelOptions":function(i){var a,n={};return i&&i.data&&(e.has(i.data,"parameters")&&(a=i.data.parameters,e.isUndefined(a)||"object"!=typeof a||(e.extend(n,{"parameters":a}),e.extend(n,t.getWebReportParametersAsData(a)))),i.data.id&&e.extend(n,{"id":i.data.id}),i.context&&e.extend(n,{"context":i.context})),n}})}}}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.content",["module","hbs","csui/lib/handlebars"],function(e,t,i){var a=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,a){return'<div class="visual-data-container"></div>'}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_visual.data.content",a),a}),csui.define("css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data",[],function(){}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.content.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/lib/numeral","csui/lib/d3","csui/controls/progressblocker/blocker","csui/controls/list/emptylist.view","webreports/widgets/visual.data.filtered.count/impl/utils/contexts/factories/visual.data.collection.factory","webreports/mixins/webreports.view.mixin","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.content","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data"],function(e,t,i,a,n,s,l,r,o,c,u,d){var p=i.ItemView.extend({"defaults":{"marginTop":20,"marginRight":20,"marginBottom":100,"marginLeft":60,"groupAfter":10,"groupAfterMax":20},"groupAfterValidValues":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"ui":{"dataVisContainer":" .visual-data-container","dataVisOverlay":" .visual-data-overlay"},"visType":"","constructor":function(a){if(a&&a.data){var n,s=!e.has(a.data,"header")||!e.isBoolean(a.data.header)||a.data.header,r=!e.has(a.data,"scroll")||!e.isBoolean(a.data.scroll)||a.data.scroll,c=!(!e.has(a.data,"filterable")||!e.isBoolean(a.data.filterable))&&a.data.filterable,u=!(!e.has(a.data,"expandable")||!e.isBoolean(a.data.expandable))&&a.data.expandable,d=!(!e.has(a.data,"viewValueAsPercentage")||!e.isBoolean(a.data.viewValueAsPercentage))&&a.data.viewValueAsPercentage,p=e.has(a.data,"groupAfter")&&-1!==this.groupAfterValidValues.indexOf(parseInt(a.data.groupAfter,10))?parseInt(a.data.groupAfter,10):this.defaults.groupAfter||5;a.data.header=s,a.data.scroll=r,a.data.visType=this.visType,a.data.groupAfter=p,a.data.filterable=c,a.data.expandable=u,a.data.viewValueAsPercentage=d,n=this.setCommonModelOptions(a),e.extend(n,{"visType":a.data.type,"type":a.data.type,"activeColumn":a.data.activeColumn,"filters":a.data.filters,"filterable":c,"expandable":u,"viewValueAsPercentage":d,"sortBy":a.data.sortBy,"sortOrder":a.data.sortOrder,"groupAfter":p}),l.imbue({"parent":this}),a.collection=a.context.getCollection(o,{"attributes":n}),this.listenTo(a.collection,"sync",this.resetAndRender).listenTo(a.collection,"reset",this.resetAndRender).listenTo(a.collection,"request",this.blockActions).listenTo(a.collection,"sync error",this.unblockActions)}i.ItemView.prototype.constructor.apply(this,arguments),this.onWinRefresh=e.bind(this.resetAndRender,this),t(window).on("resize.app",this.onWinRefresh),this.model=a.collection.overlayModel},"template":d,"className":"visual-data-wrapper","changeChartType":function(){console.log("change chart!"),console.log(this),this.visType=this.model.get("vis_type"),this.resetAndRender()},"onDomRefresh":function(){this.collection.isFetched()&&(this.draw(),this.isChartRendered=!0)},"callBackAlreadyHit":!1,"appendVisElements":function(){},"update":function(){},"isChartRendered":!1,"createRootElement":function(){var i=this.width()>0?this.width():t(this.$el).width()-this.marginLeft()-this.marginRight(),a=this.height()>0?this.height():t(this.$el).height()-this.marginTop()-this.marginBottom();this.uniqueID&&t("#"+this.uniqueID).length&&t("#"+this.uniqueID).remove(),this.uniqueID=e.uniqueId("vis_"),this.visElement=s.select(this.ui.dataVisContainer[0]).append(this.rootElementType).attr("id",this.uniqueID).attr("width",i+this.marginLeft()+this.marginRight()).attr("height",a+this.marginTop()+this.marginBottom())},"onDestroy":function(){t(window).off("resize.app",this.onWinRefresh)},"draw":function(){this.collection.isEmpty()?this.renderEmptyView():(this.createRootElement(),this.appendVisElements(),this.update())},"renderEmptyView":function(){var e=this.ui.dataVisContainer.closest(".tile-content"),t=new r({"text":u.emptyChartText});e.html(t.render().el),e.siblings(".visual-data-btn-settings").addClass("binf-hidden"),e.siblings(".tile-footer").children(".tile-expand").addClass("binf-hidden")},"resetAndRender":function(){this.render()},"checkSign":function(e){return Math.sign||function(e){return e=+e,0===e||isNaN(e)?Number(e):e>0?1:-1}},"shortenText":function(e){e=e||"";return e=e.length>=20?e.substr(0,20)+"\u2026":e},"formatCount":function(e){var t,i;switch(this.collection.columns.findWhere({"count_column":!0}).get("client_format").type){case"si":t=this.shortenNumber(e);break;case"bytes":i=e<1024?"0b":"0.0b",t=n(e).format(i);break;default:t=e.toString()}return t},"shortenNumber":function(e){e=e.toPrecision(3)||0,e=Number(e);var t=s.format(".3s");return e<1e3&&e>-1e3?e.toString():t(e)},"width":function(){return this.$el.parent().width()-this.marginLeft()-this.marginRight()},"height":function(){return this.$el.parent().height()-this.marginTop()-this.marginBottom()},"marginTop":function(){return this.defaults.marginTop},"marginBottom":function(){return this.defaults.marginBottom},"marginLeft":function(){return this.defaults.marginLeft},"marginRight":function(){return this.defaults.marginRight},"rootElementType":"svg"});return c.mixin(p.prototype),p}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.overlay",["module","hbs","csui/lib/handlebars"],function(e,t,i){var a=i.template({"1":function(e,t,i,a){return"binf-hidden"},"3":function(e,t,i,a){var n,s;return'                        <option value="'+this.escapeExpression((s=null!=(s=t.column||(null!=e?e.column:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"column","hash":{}}):s))+'" '+(null!=(n=t.if.call(e,null!=e?e.selected:e,{"name":"if","hash":{},"fn":this.program(4,a,0),"inverse":this.noop}))?n:"")+">"+this.escapeExpression((s=null!=(s=t.column_formatted||(null!=e?e.column_formatted:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"column_formatted","hash":{}}):s))+"</option>\r\n"},"4":function(e,t,i,a){return'selected="selected"'},"6":function(e,t,i,a){var n,s;return'                    <option value="'+this.escapeExpression((s=null!=(s=t.value||(null!=e?e.value:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"value","hash":{}}):s))+'" '+(null!=(n=t.if.call(e,null!=e?e.selected:e,{"name":"if","hash":{},"fn":this.program(4,a,0),"inverse":this.noop}))?n:"")+">"+this.escapeExpression((s=null!=(s=t.label||(null!=e?e.label:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"label","hash":{}}):s))+"</option>\r\n"},"8":function(e,t,i,a){var n,s;return'                    <option value="'+this.escapeExpression((s=null!=(s=t.value||(null!=e?e.value:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"value","hash":{}}):s))+'" '+(null!=(n=t.if.call(e,null!=e?e.selected:e,{"name":"if","hash":{},"fn":this.program(4,a,0),"inverse":this.noop}))?n:"")+">"+this.escapeExpression((s=null!=(s=t.display||(null!=e?e.display:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"display","hash":{}}):s))+"</option>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,a){var n,s;return'<div id="'+this.escapeExpression((s=null!=(s=t.id||(null!=e?e.id:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{}}):s))+'" class="visual-data-controls">\r\n    <div class="visual-data-control-group controls-lhs '+(null!=(n=t.unless.call(e,null!=e?e.multipleColumns:e,{"name":"unless","hash":{},"fn":this.program(1,a,0),"inverse":this.noop}))?n:"")+'">\r\n        <ul>\r\n            <li>\r\n                <label for="'+this.escapeExpression((s=null!=(s=t.id||(null!=e?e.id:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{}}):s))+'_visual-data-active-column">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.lang:e)?n.activeColumn:n,e))+'</label>\r\n                <select name="visual-data-active-column" id="'+this.escapeExpression((s=null!=(s=t.id||(null!=e?e.id:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{}}):s))+'_visual-data-active-column">\r\n'+(null!=(n=t.each.call(e,null!=e?e.columnnames:e,{"name":"each","hash":{},"fn":this.program(3,a,0),"inverse":this.noop}))?n:"")+'                </select>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div class="visual-data-control-group controls-rhs">\r\n        <ul>\r\n            <li> <label for="'+this.escapeExpression((s=null!=(s=t.id||(null!=e?e.id:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{}}):s))+'_visual-data-sort-options">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.lang:e)?n.sortBy:n,e))+'</label><select name="visual-data-sort-options" id="'+this.escapeExpression((s=null!=(s=t.id||(null!=e?e.id:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{}}):s))+'_visual-data-sort-options">\r\n'+(null!=(n=t.each.call(e,null!=e?e.sortOptions:e,{"name":"each","hash":{},"fn":this.program(6,a,0),"inverse":this.noop}))?n:"")+'            </select></li>\r\n            <li><label for="'+this.escapeExpression((s=null!=(s=t.id||(null!=e?e.id:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{}}):s))+'_visual-data-value-as-percentage">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.lang:e)?n.showValuesAs:n,e))+'</label><select name="visual-data-value-as-percentage" id="'+this.escapeExpression((s=null!=(s=t.id||(null!=e?e.id:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{}}):s))+'_visual-data-value-as-percentage">\r\n'+(null!=(n=t.each.call(e,null!=e?e.viewValueAsPercentage:e,{"name":"each","hash":{},"fn":this.program(6,a,0),"inverse":this.noop}))?n:"")+'            </select></li>\r\n            <li><label for="'+this.escapeExpression((s=null!=(s=t.id||(null!=e?e.id:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{}}):s))+'_visual-data-group-after">'+this.escapeExpression(this.lambda(null!=(n=null!=e?e.lang:e)?n.groupAfter:n,e))+'</label> <select name="visual-data-group-after" id="'+this.escapeExpression((s=null!=(s=t.id||(null!=e?e.id:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{}}):s))+'_visual-data-group-after">\r\n'+(null!=(n=t.each.call(e,null!=e?e.groupAfter:e,{"name":"each","hash":{},"fn":this.program(8,a,0),"inverse":this.noop}))?n:"")+"            </select></li>\r\n        </ul>\r\n    </div>\r\n</div>"}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_visual.data.overlay",a),a}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.overlay.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.overlay","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data"],function(e,t,i,a,n,s){return i.ItemView.extend({"constructor":function(t){this.model=t.overlayModel,this.uniqueID=e.uniqueId("visual-data-controls_"),i.ItemView.prototype.constructor.apply(this,arguments)},"ui":function(){return{"settingsField":"#"+this.uniqueID+" select"}},"template":s,"events":{"change @ui.settingsField":"onChangeSetting"},"templateHelpers":function(){var t=e.map([2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],function(e){return{"value":e,"display":e,"selected":this.model.get("group_after")===e}},this),i=[{"visType":"bar","name":n.barChart,"selected":"bar"===this.model.get("vis_type")},{"visType":"donut","name":n.donutChart,"selected":"donut"===this.model.get("vis_type")},{"visType":"pie","name":n.pieChart,"selected":"pie"===this.model.get("vis_type")}],a=[{"value":"true","selected":this.model.get("view_value_as_percentage"),"label":n.percentage},{"value":"false","selected":!this.model.get("view_value_as_percentage"),"label":n.actual}],s=[{"value":"Count|asc","selected":"Count"===this.model.get("sort_by")&&"asc"===this.model.get("sort_order"),"label":n.count+":"+n.asc},{"value":"Count|desc","selected":"Count"===this.model.get("sort_by")&&"desc"===this.model.get("sort_order"),"label":n.count+":"+n.desc},{"value":"ordinal|asc","selected":"ordinal"===this.model.get("sort_by")&&"asc"===this.model.get("sort_order"),"label":n.activeColumn+":"+n.asc},{"value":"ordinal|desc","selected":"ordinal"===this.model.get("sort_by")&&"desc"===this.model.get("sort_order"),"label":n.activeColumn+":"+n.desc}],l=e.map(this.model.get("column_names"),function(e,t){return{"column":e,"column_formatted":this.model.get("column_names_formatted")[t],"selected":this.model.get("active_column")===e}},this);return{"chartoptions":i,"columnnames":l,"groupAfter":t,"viewValueAsPercentage":a,"sortOptions":s,"lang":n,"id":this.uniqueID,"multipleColumns":l.length>1}},"onChangeSetting":function(e){e.preventDefault(),this.updateSettings()},"updateSettings":function(){var i,a,n,s,l,r=t("#"+this.uniqueID+" select"),o=r.serializeArray();o=e.object(e.map(o,e.values)),i=o["visual-data-active-column"],n=o["visual-data-sort-options"],n=n.split("|"),s=n[0],l=n[1],a=t("#"+this.uniqueID+" select[name='visual-data-active-column'] option[value='"+i+"']").text(),
this.model.set({"active_column":i,"active_column_formatted":a,"sort_by":s,"sort_order":l,"view_value_as_percentage":"true"===o["visual-data-value-as-percentage"].toLowerCase(),"group_after":+o["visual-data-group-after"]})}})}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/facet.bar",["module","hbs","csui/lib/handlebars"],function(e,t,i){var a=i.template({"1":function(e,t,i,a){var n;return'<div class="csui-header">'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+"</div>\r\n"},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,a){var n,s;return(null!=(n=t.if.call(e,null!=e?e.header:e,{"name":"if","hash":{},"fn":this.program(1,a,0),"inverse":this.noop}))?n:"")+'\r\n\x3c!--outer/inner wrappers used to size and identify when number of --\x3e\r\n\x3c!--chicklets cannot fit within provided outer wrapper width.--\x3e\r\n<div class="csui-facet-list-area">\r\n  <ol class="csui-facet-list"></ol>\r\n  <div class="binf-dropdown dropdown-facet-list csui-hidden">\r\n    <button type="button" class="binf-btn binf-btn-default binf-dropdown-toggle"\r\n            data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="true">\r\n      <span class="csui-icon icon-more"></span>\r\n    </button>\r\n    <ul class="binf-dropdown-menu" role="menu" aria-labelledby="'+this.escapeExpression((s=null!=(s=t.id||(null!=e?e.id:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"id","hash":{}}):s))+'">\r\n    </ul>\r\n  </div>\r\n</div>\r\n\r\n<div class="csui-clear-all" tabindex="-1">\r\n  <div class=\'cs-icon binf-close\'></div>\r\n  <div class=\'clear-label\'>'+this.escapeExpression((s=null!=(s=t.clearAll||(null!=e?e.clearAll:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"clearAll","hash":{}}):s))+"</div>\r\n</div>\r\n\r\n\r\n\r\n"}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_facet.bar_impl_facet.bar",a),a}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/facet.item",["module","hbs","csui/lib/handlebars"],function(e,t,i){var a=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,a){var n;return'\r\n<li class="csui-facet-item zero-height">\r\n  <a tabindex="-1">\r\n  <span class="csui-label">'+this.escapeExpression((n=null!=(n=t.label||(null!=e?e.label:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"label","hash":{}}):n))+'</span>\r\n  <span class="csui-icon binf-close" data-facet="'+this.escapeExpression((n=null!=(n=t.facetIndex||(null!=e?e.facetIndex:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"facetIndex","hash":{}}):n))+'" data-topic="'+this.escapeExpression((n=null!=(n=t.topicIndex||(null!=e?e.topicIndex:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"topicIndex","hash":{}}):n))+'"></span>\r\n  </a>\r\n</li>\r\n'}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_facet.bar_impl_facet.item",a),a}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/nls/root/lang",{"clearAll":"Clear all"}),csui.define("css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/facet.bar",[],function(){}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/facet.bar.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/models/facets","csui/models/facettopics","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/facet.bar","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/facet.item","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/nls/lang","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/impl/facet.bar"],function(e,t,i,a,n,s,l,r,o,c){return a.ItemView.extend({"listItemContext":o,"template":r,"className":"csui-facet-bar","ui":{"facetListArea":"> div.csui-facet-list-area","facetList":"> div.csui-facet-list-area .csui-facet-list","facetDropdown":".dropdown-facet-list","facetDropdownList":".dropdown-facet-list > ul","dropdownBtn":".binf-dropdown button","facetHeaderLabel":"> .csui-header","clearAll":".csui-clear-all"},"triggers":{"click .csui-clear-all":"clear:all"},"events":{"click .csui-facet-item .binf-close":"onRemoveFilter","keydown":"onKeyInView"},"behaviors":{"TabableRegion":{"behaviorClass":l}},"templateHelpers":function(){var e=this.options;return{"clearAll":c.clearAll,"header":e.header,"label":e.label}},"constructor":function(i){i||(i={}),a.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.collection,"reset",this.render,this),this.onWinResize=t.bind(function(){this.render()},this),e(window).bind("resize.facetview",this.onWinResize)},"currentlyFocusedElement":function(){var i=this.ui.dropdownBtn,a=this.$(".csui-facet-item > a[tabindex=-1]");return a.length&&(a.prop("tabindex",0),t.isFunction(this.ui.clearAll.prop)&&this.ui.clearAll.prop("tabindex",0)),t.isFunction(this.ui.facetDropdown.hasClass)&&(this.ui.facetDropdown.hasClass("csui-hidden")?i.prop("tabindex",-1):i.prop("tabindex",0)),e(this.$("[tabindex]")[0])},"onKeyInView":function(t){var i=t.keyCode,a=!0,n=e(t.target);switch(i){case 46:n.parent().hasClass("csui-facet-item")&&(n=n.find(".binf-close"),this.trigger("remove:filter",{"facetIndex":n.attr("data-facet"),"filterIndex":n.attr("data-topic")}),a=!1);break;case 13:n.hasClass("csui-clear-all")&&(this.trigger("remove:all"),a=!1);break;case 32:a=!1}return a},"onDestroy":function(){e(window).unbind("resize.facetview",this.onWinResize)},"onRender":function(){this.collection.filters.length>0?this.$el.show():this.$el.hide()},"onDomRefresh":function(){this.ui.facetList[0].innerHTML="";var e=this.collection.filters,t=this.addToFacetBar(e);t&&(this.ui.facetDropdown.removeClass("csui-hidden"),this.addToOverFlowDropDown(e,t))},"addToOverFlowDropDown":function(t,i){for(var a=i.startFilter,n=this.ui.facetDropdownList;a<t.length;a++)for(var s=t[a],l=s.values,r=a===i.startFilter?i.startValue:0;r<l.length;r++){var o=s.facetName+" : "+l[r].topicName,c=e(this.listItemContext({"label":o,"facetIndex":a,"topicIndex":r}));c.removeClass("zero-height"),n.append(c)}},"addToFacetBar":function(t){for(var i=this.ui,a=i.facetListArea,n=i.facetList,s=0;s<t.length;s++)for(var l=t[s],r=l.values,o=0;o<r.length;o++){var c=l.facetName+" : "+r[o].topicName,u=e(this.listItemContext({"label":c,"facetIndex":s,"topicIndex":o}));n.append(u);var d=a.width(),p=i.facetDropdown.width(),h=n.width()+p;if(!(h<d))return u.remove(),{"startFilter":s,"startValue":o};u.removeClass("zero-height")}},"onClearAll":function(){this.trigger("remove:all")},"onRemoveFilter":function(t){var i=e(t.target);this.trigger("remove:filter",{"facetIndex":i.attr("data-facet"),"filterIndex":i.attr("data-topic")})},"applyFilter":function(e){this.trigger("apply:filter",e.newFilter)},"updateHeaderLabel":function(e){this.options.label=e,this.ui.facetHeaderLabel.text(e)}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.key.navigation",["csui/lib/underscore","csui/lib/jquery"],function(e,t){"use strict";return{"onKeyInView":function(e){var t=e.keyCode,i=!1;switch(t){case 27:this.trigger("escape:focus"),this.activeChild.removeClass("csui-focus");break;case 32:case 13:this.execute(this.activeChild);break;case 38:case 33:case 40:case 34:if(this.activeChild&&this.activeChild.hasClass("csui-focus"))break;i=!0;break;case 9:if(this.activeChild&&this.$el.hasClass("csui-focus")){i=this.tab(e.shiftKey);break}i=!0;break;default:i=!0}return i},"execute":function(e){this.$el.addClass("csui-focus"),this.$el.find(".facet-disabled").length?this.onShowFacet():this.setfocus(e)},"setfocus":function(e){if(e&&e.is(":visible")||(e=this.getActiveChild()),e.hasClass("csui-focus"))switch(e){case this.ui.facetHeaderIcon:if(this.ui.facetHeader.hasClass("binf-disabled"))break;e.trigger("click"),e.addClass("csui-focus");break;case this.ui.apply:case this.ui.cancel:e.trigger("click"),this.trigger("escape:focus"),this.activeChild=void 0;break;case this.ui.facetMore:e.trigger("click"),e===this.ui.facetMore&&this.activateChild(e)}else this.activateChild(e)},"tab":function(e){var t=this.$el.find(".csui-facet-item:not(.binf-hidden)");return!this.activeChild.hasClass("csui-focus")||(this.activeChild=e?this._getPrevActiveChild(t):this._getNextActiveChild(t),this.activateChild(this.activeChild),!1)},"activateChild":function(e){e||(e=this.getActiveChild()),this.prevChild&&this.prevChild.removeClass("csui-focus"),e.addClass("csui-focus"),e.focus(),this.prevChild=this.activeChild},"getActiveChild":function(){var e=this.$el.find(".csui-facet-item:not(.binf-hidden)");return this.activeChild&&this.activeChild.is(":visible")||(this.ui.facetHeaderIcon.hasClass(".icon-expandArrowDown")?this.activeChild=this.ui.facetHeaderIcon:(this.activeChild=t(e[0]).find("span"),this.activeChildIndex=0)),this.activeChild},"cursorNextFilter":function(e,i,a){var n=this.$el.find(".csui-facet-item:not(.binf-hidden)"),s=n.length-1;this.activeChildIndex=i?0===this.activeChildIndex?s:--this.activeChildIndex:this.activeChildIndex===s?0:++this.activeChildIndex,a.hasClass("icon")?this.activeChild=t(n[this.activeChildIndex]).find("span"):this.activeChild=t(n[this.activeChildIndex]).find(".csui-filter-name"),this.children.findByIndex(this.activeChildIndex).activeChild=this.activeChild,this.activateChild(this.activeChild)},"_getLastFilterFocus":function(e){var t=this.activeChildIndex;return this.activeChildIndex=t&&t<e.length?t:0,this.children.findByIndex(this.activeChildIndex).activeChild},"_getNextActiveChild":function(e){var t=this.activeChild;switch(this.activeChild){case this.ui.facetHeaderIcon:this.ui.facetHeaderIcon.hasClass("icon-expandArrowUp")&&(t=this._getLastFilterFocus(e));break;case this.ui.facetMore:this.$el.find(".csui-multi-select").length>0&&(t=this.ui.apply);break;case this.ui.cancel:break;case this.ui.apply:t=this.ui.cancel;break;default:this.ui.facetMore.length>0?t=this.ui.facetMore:this.$el.find(".csui-multi-select").length>0&&(t=this.ui.apply)}return t},"_getPrevActiveChild":function(e){var t=this.activeChild;switch(this.activeChild){case this.ui.facetHeaderIcon:break;case this.ui.facetMore:t=this._getLastFilterFocus(e);break;case this.ui.cancel:t=this.ui.apply;break;case this.ui.apply:t=this.ui.facetMore.length>0?this.ui.facetMore:this._getLastFilterFocus(e);break;default:if(this.ui.facetHeader.hasClass("binf-disabled"))break;t=this.ui.facetHeaderIcon}return t}}}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.item",["module","hbs","csui/lib/handlebars"],function(e,t,i){var a=i.template({"1":function(e,t,i,a){var n;return'    <span class="icon icon-checkbox '+this.escapeExpression((n=null!=(n=t.showOnHover||(null!=e?e.showOnHover:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"showOnHover","hash":{}}):n))+'" tabindex="-1">\r\n    <input type="checkbox" />\r\n  </span>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,a){var n,s;return(null!=(n=t.if.call(e,null!=e?e.enableCheckBox:e,{"name":"if","hash":{},"fn":this.program(1,a,0),"inverse":this.noop}))?n:"")+'<div class="csui-filter-name" tabindex="-1" title="'+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+" ("+this.escapeExpression((s=null!=(s=t.total||(null!=e?e.total:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"total","hash":{}}):s))+')">\r\n    <div class="csui-name">'+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'</div>\r\n    <div class="csui-total">'+this.escapeExpression((s=null!=(s=t.total||(null!=e?e.total:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"total","hash":{}}):s))+"</div>\r\n</div>"}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_facet.panel_impl_facet_facet.item",a),a}),csui.define("css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.item",[],function(){}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.item.view",["csui/lib/jquery","csui/utils/base","csui/lib/underscore","csui/lib/marionette","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.item","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.item"],function(e,t,i,a,n){return a.ItemView.extend({"template":n,"className":"csui-facet-item","constructor":function(e){a.ItemView.prototype.constructor.apply(this,arguments),this.showInputOnHover=!t.isTouchBrowser(),this.uniqueID=i.uniqueId("visual-data-controls_")},"triggers":{"click .csui-filter-name":"single:filter:select"},"events":{"click input":"onCheckBoxSelect","change input":"onChangeValue","keydown > span":"onKeyInView","keydown .csui-filter-name":"onKeyInView"},"ui":{"icon":"> span","checkbox":"> span input","filterName":"> .csui-filter-name"},"templateHelpers":function(){return{"showOnHover":this.showInputOnHover?"":"csui-showAlways","id":this.uniqueID,"enableCheckBox":this.options.enableCheckBoxes}},"onKeyInView":function(t){var i=t.keyCode,a=e(t.target);switch(i){case 32:case 13:a.hasClass("icon")?this.ui.checkbox.trigger("click"):this.trigger("single:filter:select",this);break;case 39:case 37:this.activeChild=a.hasClass("icon")?this.ui.filterName:this.ui.icon,this.activeChild.focus();break;case 38:case 40:this.trigger("keyupdown",38===i,a);break;default:return!0}return!1},"onCheckBoxSelect":function(e){this.trigger("multi:filter:select",this)},"onChangeValue":function(e){var t=e.target;t.disabled?this.ui.icon.removeClass("icon-checkbox icon-checkbox-selected").addClass("icon-checkbox-disabled"):t.checked?this.ui.icon.removeClass("icon-checkbox icon-checkbox-disabled").addClass("icon-checkbox-selected"):this.ui.icon.removeClass("icon-checkbox-selected icon-checkbox-disabled").addClass("icon-checkbox")},"getIndex":function(){return this._index}})}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet",["module","hbs","csui/lib/handlebars"],function(e,t,i){var a=i.template({"1":function(e,t,i,a){var n;return'    <div class="csui-filter-more" tabindex="-1">\r\n        <div class="csui-more-text">'+this.escapeExpression((n=null!=(n=t.more||(null!=e?e.more:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"more","hash":{}}):n))+'</div>\r\n        <div class="cs-icon '+this.escapeExpression((n=null!=(n=t["more-icon"]||(null!=e?e["more-icon"]:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"more-icon","hash":{}}):n))+'"></div>\r\n    </div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,a){var n,s;return'<div class="csui-facet-header">\r\n  <div class="header-label" title="'+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'">'+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"name","hash":{}}):s))+'</div>\r\n  <div class="header-count" title="'+this.escapeExpression((s=null!=(s=t.count||(null!=e?e.count:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"count","hash":{}}):s))+'"> ('+this.escapeExpression((s=null!=(s=t.count||(null!=e?e.count:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"count","hash":{}}):s))+')</div>\r\n  <div class="cs-icon csui-button-icon icon-expandArrowUp" tabindex="-1"></div>\r\n  <div class="csui-right-shadow"></div>\r\n</div>\r\n\r\n<div class="csui-facet-content '+this.escapeExpression((s=null!=(s=t["show-content"]||(null!=e?e["show-content"]:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"show-content","hash":{}}):s))+'">\r\n  <div class="cs-filter-group"></div>\r\n'+(null!=(n=t.if.call(e,null!=e?e.more:e,{"name":"if","hash":{},"fn":this.program(1,a,0),"inverse":this.noop}))?n:"")+'  <div class="csui-facet-controls '+this.escapeExpression((s=null!=(s=t["show-controls"]||(null!=e?e["show-controls"]:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"show-controls","hash":{}}):s))+'">\r\n      <button class="csui-btn binf-btn binf-btn-primary csui-apply">'+this.escapeExpression((s=null!=(s=t.apply||(null!=e?e.apply:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"apply","hash":{}}):s))+'</button>\r\n      <button class="csui-btn binf-btn binf-btn-secondary csui-clear">'+this.escapeExpression((s=null!=(s=t.clear||(null!=e?e.clear:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"clear","hash":{}}):s))+"</button>\r\n</div>\r\n\r\n</div>\r\n"}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_facet.panel_impl_facet_facet",a),a}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/nls/root/lang",{"facetTitle":"Refine by","searchIconTooltip":"Search by {0}","searchClearIconTooltip":"Clear all","emptyFacetMessage":"No filters available.","emptyFilteredFacetMessage":"No more filters available.","loadingFacetMessage":"Loading filters...","failedFacetMessage":"Loading filters failed.","noFiles":"No drop files were provided.","addTypeDenied":"Cannot add documents to {1}.","showMore":"Show more","showLess":"Show less","apply":"Apply","clear":"Cancel"}),csui.define("css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet",[],function(){}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/models/facettopics","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.key.navigation","csui/utils/log","csui/behaviors/keyboard.navigation/tabable.region.behavior","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.item.view","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/nls/lang","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet"],function(e,t,i,a,n,s,l,r,o,c,u){var d=a.CompositeView.extend({"childView":o,"template":c,"className":"csui-facet","childViewContainer":".cs-filter-group","ui":{"facetContent":".csui-facet-content","facetHeader":".csui-facet-header","facetHeaderIcon":".csui-facet-header > .cs-icon","facetSubmitControls":".csui-facet-controls","facetCollapseControls":".csui-facet-collapse-controls","facetMoreText":".csui-more-text","facetMoreIcon":".csui-filter-more .cs-icon","facetMore":".csui-filter-more","apply":".csui-facet-controls .csui-apply","cancel":".csui-facet-controls .csui-clear","selectCount":".header-count"},"childEvents":{"single:filter:select":"onSingleFilterSelect","multi:filter:select":"onMultiFilterSelect","keyupdown":"cursorNextFilter","keyleftright":"cursorInsideFilter"},"events":{"click .csui-filter-more:not(.binf-disabled)":"onShowMore","click .csui-facet-header":"onShowFacet","mouseleave":"onMouseLeave","keydown":"onKeyInView"},"triggers":{"click .csui-clear":"clear:all","click .csui-apply":"apply:all"},"templateHelpers":function(){var e=this.showAll?u.showLess:u.showMore;return{"more":this.collection.length>this.itemsToShow?e:void 0,"more-icon":this.showAll?"icon-expandArrowUp":"icon-expandArrowDown","apply":u.apply,"clear":u.clear,"show-controls":this.selectItems.length>0?"csui-multi-select":"","show-content":this.showFacet?"":"binf-hidden"}},"childViewOptions":function(){return{"enableCheckBoxes":this.options.enableCheckBoxes}},"constructor":function(e){a.CompositeView.prototype.constructor.apply(this,arguments),this.$el.attr("tabindex",0),this.options=e||{},this.collection=this.model.topics,this.itemsToShow=this.model.get("items_to_show"),this.showAll=!1,this.showFacet=!0,this.selectItems=[]},"onClearAll":function(){var e=this.$el.find("input:checkbox");this.selectItems=[],this.ui.facetCollapseControls.removeClass("multi-select"),this.ui.selectCount.text("(0)"),e.prop("checked",!1).trigger("change"),this._setDisabledFilters(0),this.$el.removeClass("multi-select"),this._updateFacetSubmitControls(),this.ui.facetHeader.removeClass("binf-disabled"),this.trigger("activate:facet",this)},"onApplyAll":function(){var e=this.model,t=this._getFilterArray();this.newFilter={"id":e.get("id"),"facetName":e.get("name"),"values":t},this.trigger("apply:filter")},"onAddChild":function(e){if(e.getIndex()>=this.itemsToShow){var t=this.showAll?"more":"more binf-hidden";e.$el.addClass(t)}},"onRender":function(){0===this.collection.length&&this.$el.hide()},"onSingleFilterSelect":function(e){if(!e.$el.hasClass("binf-disabled"))if(this.$el.hasClass("multi-select"))e.$el.find("input:checkbox").click();else{var t=this.model;this.newFilter={"id":t.get("id"),"facetName":t.get("name"),"values":[{"id":e.model.get("value"),"topicName":e.model.get("name")}]},this.trigger("apply:filter")}},"onShowMore":function(e){e&&(e.preventDefault(),e.stopPropagation()),this.showAll=!this.showAll,this._setMoreLabel(this.showAll),this.trigger("facet:size:change")},"onShowFacet":function(e){if(e&&(e.preventDefault(),e.stopPropagation()),this.showFacet=!this.showFacet,this.showFacet)this.ui.facetContent.removeClass("binf-hidden"),this.ui.facetCollapseControls.removeClass("multi-select"),this.ui.facetHeaderIcon[0].className="cs-icon csui-button-icon icon-expandArrowUp";else{var t=this.$el.find("input:checked").length;this.ui.facetContent.addClass("binf-hidden"),this.ui.facetHeaderIcon[0].className="cs-icon csui-button-icon icon-expandArrowDown",t&&this.ui.facetCollapseControls.addClass("multi-select")}this.trigger("facet:size:change")},"onMouseLeave":function(e){e.preventDefault(),e.stopPropagation()},"getIndex":function(){return this._index},"onMultiFilterSelect":function(e){var t=this.$el.find("input:checked").length;this._updateSelectList(e),this._updateFacetSubmitControls(t),this._setDisabledFilters(t),this.selectItems=0===t?[]:this.selectItems,this.trigger("activate:facet",this)},"_updateFacetSubmitControls":function(){this.$el.find("input:checked").length>0?(this.ui.facetSubmitControls.addClass("csui-multi-select"),this.$el.addClass("multi-select"),this.ui.facetHeader.addClass("binf-disabled")):(this.ui.facetSubmitControls.removeClass("csui-multi-select"),this.$el.removeClass("multi-select"),this.ui.facetHeader.removeClass("binf-disabled"))},"_updateSelectList":function(e){var t=e.getIndex();this.selectItems[t]?delete this.selectItems[t]:this.selectItems[t]=e},"_setDisabledFilters":function(e){var t=this.$el.find("input:not(:checked)"),i=e;e<5?(t.prop("disabled",!1).trigger("change"),t.parent().parent().removeClass("binf-disabled")):(t.prop("disabled",!0).trigger("change"),t.parent().parent().addClass("binf-disabled")),this.ui.selectCount.text(i)},"_setMoreLabel":function(e){var t=this.$el.find(".csui-facet-item.more");this.ui.facetMoreIcon[0]&&(e?(t.removeClass("binf-hidden"),this.ui.facetMoreIcon[0].className="cs-icon icon-expandArrowUp",this.ui.facetMoreText.text(u.showLess)):(t.addClass("binf-hidden"),this.ui.facetMoreIcon[0].className="cs-icon icon-expandArrowDown",this.ui.facetMoreText.text(u.showMore))),this.trigger("facet:size:change")},"_getFilterArray":function(){var e=[];return t.each(this.selectItems,function(t){t&&e.push({"id":t.model.get("value"),"topicName":t.model.get("name")})}),e}});return d.version="1.0",t.extend(d.prototype,s),d}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet.panel.key.navigation",["csui/lib/underscore","csui/lib/jquery"],function(e,t){"use strict";return{"currentlyFocusedElement":function(){var e=this.$(".cs-list-group .csui-facet[tabindex=-1]");return e.length&&e.prop("tabindex",0),this.getActiveChild()},"onSetNextChildFocus":function(e){this.activeChildIndex=e.getIndex()},"accActivateTabableRegion":function(){t(document).unbind("mousedown",this._onRemoveKeyboardFocus),t(document).bind("mousedown",this._onRemoveKeyboardFocus)},"_removeKeyboardFocus":function(){this.$el.find(".csui-focus").removeClass("csui-focus"),t(document).unbind("mousedown",this._onRemoveKeyboardFocus)},"onKeyInView":function(e){switch(e.keyCode){case 38:case 33:this._getPrevActiveChild().focus();break;case 40:case 34:this._getNextActiveChild().focus();break;default:return!0}return!1},"resetFacetFocus":function(e){e.$el.focus()},"getActiveChild":function(){if(!this.$childViewContainer)return t();if(!this.activeChild){var e=this.$childViewContainer[0];e&&e.childNodes[0]&&(this.activeChild=t(e.childNodes[0]),this.activeChildIndex=0)}return this.activeChild},"_getNextActiveChild":function(){var e=this.$childViewContainer[0].childNodes;return e.length-1>this.activeChildIndex?this.activeChildIndex++:this.activeChildIndex=0,t(e[this.activeChildIndex])},"_getPrevActiveChild":function(){var e=this.$childViewContainer[0].childNodes;return this.activeChildIndex>0?this.activeChildIndex--:this.activeChildIndex=e.length-1,t(e[this.activeChildIndex])}}}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet.panel",["module","hbs","csui/lib/handlebars"],function(e,t,i){var a=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,a){var n;return'<div class="cs-header binf-panel-heading">\r\n  <span class="cs-title">'+this.escapeExpression((n=null!=(n=t.title||(null!=e?e.title:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"title","hash":{}}):n))+'</span>\r\n</div>\r\n\r\n\x3c!--<div class="csui-horizontal-separator"></div>--\x3e\r\n<div class="cs-content">\r\n  <div class="cs-list-group"></div>\r\n</div>\r\n\r\n\x3c!--Need one shadow strip over the header and one over cs-content. The reason why one over the entire\r\n    simple list will not work, is because cs-content has a z-index of 5 with a scroll index of 8. If\r\n    we had one shadow strip with an index higher than cs-content, the scroll-bar will not show.--\x3e\r\n<div class="csui-right-shadow"></div>\r\n\r\n'}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_facet.panel_impl_facet.panel",a),a}),csui.define("css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet.panel",[],function(){}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/facet.panel.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/models/facets","csui/models/facettopics","csui/controls/list/simplelist.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet/facet.view","csui/behaviors/collection.state/collection.state.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet.panel.key.navigation","csui/controls/progressblocker/blocker","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet.panel","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/nls/lang","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/impl/facet.panel"],function(e,t,i,a,n,s,l,r,o,c,u,d,p){"use strict";var h=s.extend({"template":d,"className":"cs-simplelist csui-facet-panel","behaviors":{"CollectionState":{"behaviorClass":r,"stateMessages":function(){return{"empty":e.isEmpty(this.collection.filters)?p.emptyFacetMessage:p.emptyFilteredFacetMessage,"loading":p.loadingFacetMessage,"failed":p.failedFacetMessage}}},"TabableRegion":{"behaviorClass":o}},"childView":l,"childViewOptions":function(){return{"enableCheckBoxes":this.options.enableCheckBoxes}},"childEvents":{"apply:filter":"applyFilter","activate:facet":"setActiveFacet","facet:size:change":"_updateScrollbar","escape:focus":"resetFacetFocus"},"events":{"keydown":"onKeyInView"},"onAddChild":function(e){var t=e.$el,i=this;e.getIndex()===this.collection.length-1&&t.css("border-bottom","0px"),t.on("focus",function(){i.onSetNextChildFocus(e)})},"constructor":function(t){s.prototype.constructor.apply(this,arguments),this.options.data.title=p.facetTitle,this._onRemoveKeyboardFocus=e.bind(this._removeKeyboardFocus,this),this.options.blockingParentView?u.delegate(this,this.options.blockingParentView):u.imbue({"parent":this,"local":this.options.blockingLocal})},"isTabable":function(){return!this.$el.parent().hasClass("binf-hidden")},"onRenderCollection":function(){this.trigger("refresh:tabindexes")},"onBeforeDestroy":function(){t(document).unbind("mousedown",this._onRemoveKeyboardFocus)},"applyFilter":function(e){this.trigger("apply:filter",e.newFilter)},"setActiveFacet":function(e){e.selectItems.length>0?this.children.each(function(t){t.getIndex()!==e.getIndex()&&t.$el.find(".csui-facet-content").addClass("facet-disabled")}):this.$el.find(".csui-facet-content").removeClass("facet-disabled")},"_updateScrollbar":function(){this.triggerMethod("update:scrollbar",this)}});return e.extend(h.prototype,c),h}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.expanded",["module","hbs","csui/lib/handlebars"],function(e,t,i){var a=i.template({"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,a){return'<div class="visual-data-expanded-view-wrapper">\r\n    <div class="csui-facet-table-container">\r\n        <div id="facetview"></div>\r\n        \x3c!--outer div is needed in order to float table contents right to accommodate  facets--\x3e\r\n        <div id="outertablecontainer" class="reduce-for-facets">\r\n            \x3c!--inner div is needed in order to have tableview sized to remaining height of container--\x3e\r\n            <div id="innertablecontainer">\r\n                <div class="facetbarview"></div>\r\n                <div class="visual-data-controls-parent"></div>\r\n                <div class="visual-data-visualization"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_visual.data.expanded",a),a}),csui.define("css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.expanded",[],function(){}),
csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.expanded.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.bar/facet.bar.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/facet.panel/facet.panel.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.overlay.view","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.expanded","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.expanded"],function(e,t,i,a,n,s,l,r,o){return a.LayoutView.extend({"className":"expanded-visualization-container","template":o,"regions":{"chicklets":".facetbarview","facetRegion":"#facetview","visualizationControls":".visual-data-controls-parent","visualization":".visual-data-visualization"},"constructor":function(e){var t;a.LayoutView.prototype.constructor.apply(this,arguments),this.contentView=e.data.expandedContentView,this.facetFilters=this.contentView.collection.facetFilters,t=this.contentView.collection.getFilters(),0===this.facetFilters.filters.length&&t.length>0&&(this.facetFilters.filters=this.contentView.collection.mapFilterData(t))},"callBackAlreadyHit":!1,"onDomRefresh":function(){this.callBackAlreadyHit&&(this._renderFacetBar(),this._renderFacetPanel(),this._renderExpandedControls(),this._renderChart()),this.callBackAlreadyHit=!0},"_clearFilters":function(){this.facetFilters.clearFilters(),this.contentView.collection.clearFilters()},"_addToFacetFilter":function(e){this.facetFilters.addFilter(e),this.contentView.collection.addFilter(e),this._renderFacetBar(),this._renderExpandedControls(),this._renderFacetPanel()},"_renderChart":function(){this.getRegion("visualization").show(this.contentView),this.contentView.resetAndRender()},"_renderFacetBar":function(){this.facetBarView=new n({"collection":this.facetFilters}),this.listenTo(this.facetBarView,"remove:filter",this._removeFacetFilter,this).listenTo(this.facetBarView,"remove:all",this._removeAll,this).listenTo(this.contentView,"apply:filter",this._addToFacetFilter,this),this.facetFilters.filters.length>0&&this.getRegion("chicklets").show(this.facetBarView)},"_renderFacetPanel":function(){this.getRegion("facetRegion").empty(),this._setFacetView(),this.getRegion("facetRegion").show(this.facetView)},"_setFacetView":function(){this.facetView=new s({"collection":this.facetFilters,"enableCheckBoxes":!0,"blockingLocal":!0}),this.listenTo(this.facetView,"apply:filter",this._addToFacetFilter)},"_renderExpandedControls":function(){this.expandedControls=new l({"overlayModel":this.contentView.collection.overlayModel}),this.getRegion("visualizationControls").show(this.expandedControls)},"_removeFacetFilter":function(e){var t=this.contentView.collection.getActiveColumnByFormattedName(this.facetFilters.filters[e.facetIndex].facetName),i=this.facetFilters.filters[e.facetIndex].values[e.filterIndex].id;0===this.facetFilters.removeFilter(e.facetIndex,e.filterIndex).length?(this.contentView.collection.clearFilters(t,i),this.getRegion("chicklets").empty()):this.contentView.collection.updateFilters(t,i),this._renderExpandedControls()},"_removeAll":function(){this._clearFilters(),this.getRegion("chicklets").empty(),this._renderExpandedControls()}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.bar.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/d3","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.content.view"],function(e,t,i,a){return a.extend({"constructor":function(e){a.prototype.constructor.apply(this,arguments)},"visType":"bar","defaults":{"marginTop":20,"marginRight":20,"marginBottom":100,"marginLeft":80,"groupAfter":15},"appendVisElements":function(){this.visElement=this.visElement.append("g").attr("transform","translate("+this.marginLeft()+","+this.marginTop()+")").attr("class","bar-chart")},"update":function(){function t(e){return s.collection.overlayModel.get("view_value_as_percentage")?(e.get("value")/o*100).toFixed(1)+"%":s.formatCount(e.get("value"))}function a(){return f(0)}function n(e){return f(e.get("value"))}var s=this,l=s.visElement,r=s.collection.models,o=r.reduce(function(e,t){return e+t.get("value")},0),c=this.width(),u=this.height(),d=i.schemeCategory20,p=i.scaleOrdinal(d),h=i.scaleBand().range([0,c]).round(!0).padding(.1),f=i.scaleLinear(),m=i.extent(r.map(function(e){return e.get("value")})),v=i.axisBottom(h).tickFormat(s.shortenText),g=i.axisLeft(f).tickFormat(e.bind(s.formatCount,s));m=m[0]>0?[0,m[1]]:m,f.domain(m).range([u,0]).nice(),h.domain(r.map(function(e){return s.collection.grouped_on_server?e.get("key_formatted"):e.get("key")}));l.selectAll(".bar").data(r).enter().append("rect").attr("class",function(){return"bar"}).attr("fill-opacity",.9).style("fill",function(e,t){return p(t)}).style("stroke",function(e,t){return p(t)}).attr("x",function(e){return h(s.collection.grouped_on_server?e.get("key_formatted"):e.get("key"))}).attr("y",function(e){return e.get("value")<0?a():n(e)}).attr("width",h.bandwidth()).attr("height",function(e){return Math.abs(n(e)-a())});l.append("g").attr("class","chart-labels").selectAll("text").data(r).enter().append("text").style("text-anchor","middle").text(t).attr("class",function(){return this.getBoundingClientRect().width<=h.bandwidth()?"chart-label":"chart-label hidden"}).attr("x",function(e){return s.collection.grouped_on_server?h(e.get("key_formatted"))+h.bandwidth()/2:h(e.get("key"))+h.bandwidth()/2}).attr("y",function(e){var t=Math.abs(u-n(e)),l=a()-n(e),r=0;return-1===s.checkSign(e.get("value"))?(l<-24?(r=-6,i.select(this).classed("outside",!1)):(r=16,i.select(this).classed("outside",!0)),u+r-t):(l>24?(r=16,i.select(this).classed("outside",!1)):(r=-6,i.select(this).classed("outside",!0)),u+r-t)});var b=!1;l.append("g").attr("class","x axis").attr("transform","translate(0,"+u+")").call(v).selectAll("text").style("text-anchor","middle").attr("dy","6").attr("class",function(){return this.getBoundingClientRect().width>=h.bandwidth()&&(b=!0),null}),b&&l.select(".x.axis").selectAll("text").attr("transform","rotate(-30)").style("text-anchor","end"),l.append("g").attr("class","x axis zero").attr("transform","translate(0,"+a()+")").call(v.tickFormat("").tickSize(0)),l.append("g").call(g).attr("class","y axis"),l.append("g").call(g.tickFormat("").tickSize(-c)).selectAll("line").attr("class","gridline"),l.append("text").attr("class","y-label").text("Total count").attr("transform","rotate(-90)").attr("y",15-this.marginLeft()).attr("x",-u/2).attr("dy","1em").style("text-anchor","middle"),l.append("text").attr("class","x-label").text(this.model.get("active_column_formatted")).attr("y",u+this.marginBottom()-15).attr("x",c/2).attr("dx","1em").style("text-anchor","middle"),l.append("text").attr("class","total").attr("text-anchor","left").attr("alignment-baseline","baseline").attr("y",u+this.marginBottom()-15).attr("x",0-this.marginLeft()+20).text("Total: "+s.formatCount(o))}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.pie.view",["csui/lib/underscore","csui/lib/d3","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.content.view"],function(e,t,i){return i.extend({"constructor":function(e){i.prototype.constructor.apply(this,arguments)},"defaults":{"marginTop":40,"marginRight":30,"marginBottom":40,"marginLeft":30,"groupAfter":5},"visType":"pie","appendVisElements":function(){this.visElement.append("g").attr("transform","translate("+this.marginLeft()+","+this.marginTop()+")").attr("class","vis-wrapper"),this.visElement.select(".vis-wrapper").append("g").attr("class","pie-chart").attr("transform","translate("+this.width()/3+","+this.height()/2+")"),this.visElement.select(".vis-wrapper").append("g").attr("class","pie-legend-container").attr("height",this.height()).attr("transform","translate("+(this.width()/3*2+40)+","+this.height()/2+")")},"update":function(){function e(e,t){var i=c[t].get("value"),a=((e.endAngle-e.startAngle)/(2*Math.PI)*100).toFixed(1),n=e.endAngle-e.startAngle,l=s.collection.overlayModel.get("view_value_as_percentage")?a+" %":s.formatCount(i);return l=h*n>=44&&h>=100?l:""}function i(e,t,i){var a=(e.startAngle+e.endAngle)/2;return"translate("+Math.sin(a)*i+","+-Math.cos(a)*i+")"}function a(e,t){return l.selectAll(".arc path,.pie-legend rect,.pie-legend text").filter(function(t,i){return t.index!==e.index}),i(e,t,15)}function n(e,t){return l.selectAll(".arc path,.pie-legend rect").attr("fill-opacity",f),i(e,t,0)}var s=this,l=s.visElement,r=t.schemeCategory20,o=t.scaleOrdinal(r),c=s.collection.models,u=c.reduce(function(e,t){return e+t.get("value")},0),d=this.width(),p=this.height(),h=Math.min(d/3,p/2),f=.9,m=t.arc().innerRadius(0).outerRadius(h-10),v=t.arc().innerRadius(h-10).outerRadius(h+30),g=t.pie().sort(null).value(function(e){return e.get("value")}),b=l.select(".pie-chart").selectAll(".arc").data(g(c)).enter().append("g").attr("class",function(){return"arc"});b.append("path").attr("d",m).attr("fill-opacity",f).style("fill",function(e,t){return o(t)}),b.append("text").attr("class","chart-label outside").attr("transform",function(e){return"translate("+v.centroid(e)+")"}).attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",14).text(e);var w=l.select(".pie-legend-container"),y=w.selectAll(".pie-legend").data(g(c)).enter().append("g").attr("class","pie-legend").on("mouseover",function(e){l.selectAll(".arc").filter(function(t,i){return t.index===e.index}).attr("transform",a)}).on("mouseout",function(e){l.selectAll(".arc").filter(function(t,i){return t.index===e.index}).attr("transform",n)}),x=function(){var e,t=c.length||1;return e=2*p/t/2,e=e<14?14:e,e=e>24?24:e}();w.style("font-size",x/2+"px"),y.append("text").attr("class","pie-legend-text").attr("dy","1.2em").attr("transform",function(e,t){var i=x*c.length/2;return"translate("+(x+10)+","+(t*x-i)+")"}).text(function(e,t){return s.collection.grouped_on_server?e.data.get("key_formatted"):e.data.get("key")}),y.append("rect").attr("class","pie-legend-swatch").attr("width","2em").attr("height",x-4).attr("fill-opacity",f).attr("transform",function(e,t){var i=x*c.length/2;return"translate(0,"+(t*x-i)+")"}).attr("fill",function(e,t){return o(t)}),l.select(".vis-wrapper").append("g").attr("class","pie-total-container").append("text").attr("class","total").attr("text-anchor","left").attr("alignment-baseline","baseline").attr("y",p+this.marginBottom()-15).attr("x",0-this.marginLeft()+20).text("Total: "+s.formatCount(u)),w.append("text").attr("class","pie-legend-active-column").attr("transform","rotate(-90)").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("y",0).attr("x",0).attr("dy",-20).text(this.model.get("active_column_formatted"))}})}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.donut.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/d3","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.content.view"],function(e,t,i,a){return a.extend({"constructor":function(e){a.prototype.constructor.apply(this,arguments)},"defaults":{"marginTop":30,"marginRight":30,"marginBottom":30,"marginLeft":30,"groupAfter":5},"visType":"donut","appendVisElements":function(){this.visElement.append("g").attr("transform","translate("+this.marginLeft()+","+this.marginTop()+")").attr("class","vis-wrapper"),this.visElement.select(".vis-wrapper").append("g").attr("class","pie-chart").attr("transform","translate("+this.width()/3+","+this.height()/2+")"),this.visElement.select(".vis-wrapper").append("g").attr("class","pie-legend-container").attr("transform","translate("+(this.width()/3*2+40)+","+this.height()/2+")")},"update":function(){function e(e,t){var i=u[t].get("value"),a=((e.endAngle-e.startAngle)/(2*Math.PI)*100).toFixed(1),n=e.endAngle-e.startAngle,s=l.collection.overlayModel.get("view_value_as_percentage")?a+" %":l.formatCount(i);return s=f*n>=44&&f>=100?s:""}function t(e,t,i){var a=(e.startAngle+e.endAngle)/2;return"translate("+Math.sin(a)*i+","+-Math.cos(a)*i+")"}function a(e,i){return r.selectAll(".arc path,.pie-legend rect,.pie-legend text").filter(function(t,i){return t.index!==e.index}),t(e,i,15)}function n(e,i){return r.selectAll(".arc path,.pie-legend rect").attr("fill-opacity",m),t(e,i,0)}function s(e){var t=l.formatCount(d).length,i=[1.4,1.6,1.8,2,2.2,2.4,2.6,2.8];return e/(t<=i.length?i[t-1]:12)}var l=this,r=l.visElement,o=i.schemeCategory20,c=i.scaleOrdinal(o),u=l.collection.models,d=u.reduce(function(e,t){return e+t.get("value")},0),p=this.$el[0].clientWidth-this.marginLeft()-this.marginRight(),h=this.$el[0].clientHeight-this.marginTop()-this.marginBottom(),f=Math.min(p/3,h/2),m=.9,v=i.arc().innerRadius(f/1.5).outerRadius(f),g=i.pie().sort(null).value(function(e){return e.get("value")}),b=r.select(".pie-chart").selectAll(".arc").data(g(u)).enter().append("g").attr("class",function(){return"arc"});b.append("path").attr("d",v).attr("fill-opacity",m).style("fill",function(e,t){return c(t)}),b.append("text").attr("class","chart-label").attr("transform",function(e){return"translate("+v.centroid(e)+")"}).attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",14).text(e);var w=r.select(".pie-legend-container"),y=w.selectAll(".pie-legend").data(g(u)).enter().append("g").attr("class","pie-legend").on("mouseover",function(e){r.selectAll(".arc").filter(function(t,i){return t.index===e.index}).attr("transform",a)}).on("mouseout",function(e){r.selectAll(".arc").filter(function(t,i){return t.index===e.index}).attr("transform",n)}),x=function(){var e,t=u.length||1;return e=2*h/t/2,e=e<14?14:e,e=e>24?24:e}();w.style("font-size",x/2+"px"),y.append("text").attr("class","pie-legend-text").attr("dy","1.2em").attr("transform",function(e,t){var i=x*u.length/2;return"translate("+(x+10)+","+(t*x-i)+")"}).text(function(e,t){return l.collection.grouped_on_server?e.data.get("key_formatted"):e.data.get("key")}),y.append("rect").attr("class","pie-legend-swatch").attr("width","2em").attr("height",x-4).attr("fill-opacity",m).attr("transform",function(e,t){var i=x*u.length/2;return"translate(0,"+(t*x-i)+")"}).attr("fill",function(e,t){return c(t)});var _=r.select(".pie-chart").append("g").attr("class","pie-total-container"),C=s(f/1.5)>=10?s(f/1.5):10;_.append("g").attr("class","pie-total-label-disc").append("circle").attr("cx",0).attr("cy",0).attr("r",f/1.5-10),_.append("text").attr("transform","translate(0,"+-C/1.5+")").attr("class","pie-total-label").attr("text-anchor","middle").attr("font-size",C/2.3).text(function(){return C/2.3>=8?"Total":""}),_.append("text").attr("class","total").attr("transform","translate(0,"+C/10+")").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",C).text(l.formatCount(d)),w.append("text").attr("class","pie-legend-active-column").attr("transform","rotate(-90)").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("y",0).attr("x",0).attr("dy",-20).text(this.model.get("active_column_formatted"))}})}),csui.define("hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.tile",["module","hbs","csui/lib/handlebars"],function(e,t,i){var a=i.template({"1":function(e,t,i,a){var n;return'        <div class="tile-type-icon">\r\n            <span class="icon title-icon '+this.escapeExpression((n=null!=(n=t.icon||(null!=e?e.icon:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"icon","hash":{}}):n))+'" aria-hidden="true"></span>\r\n        </div>\r\n'},"3":function(e,t,i,a){var n;return null!=(n=t.if.call(e,null!=e?e.imageUrl:e,{"name":"if","hash":{},"fn":this.program(4,a,0),"inverse":this.noop}))?n:""},"4":function(e,t,i,a){var n;return'            <div class="tile-type-image '+this.escapeExpression((n=null!=(n=t.imageClass||(null!=e?e.imageClass:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"imageClass","hash":{}}):n))+'">\r\n                <img src="'+this.escapeExpression((n=null!=(n=t.imageUrl||(null!=e?e.imageUrl:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"imageUrl","hash":{}}):n))+'" aria-hidden="true">\r\n            </div>\r\n'},"6":function(e,t,i,a){var n;return'\x3c!-- Note: the options button must be available even when there is no header. In the case of no header, it will be positioned absolute --\x3e\r\n<div class="csui-favorite csui-acc-tab-region visual-data-btn-settings">\r\n    <span class="binf-glyphicon binf-glyphicon-cog" role="button" tabindex="0" aria-label="'+this.escapeExpression((n=null!=(n=t.settings||(null!=e?e.settings:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{"name":"settings","hash":{}}):n))+'"></span>\r\n</div>\r\n'},"compiler":[6,">= 2.0.0-beta.1"],"main":function(e,t,i,a){var n,s;return'<div class="tile-header">\r\n\r\n'+(null!=(n=t.if.call(e,null!=e?e.icon:e,{"name":"if","hash":{},"fn":this.program(1,a,0),"inverse":this.program(3,a,0)}))?n:"")+'\r\n    <div class="tile-title" title="'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"title","hash":{}}):s))+'">\r\n        <h2 class="csui-heading">'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"title","hash":{}}):s))+'</h2>\r\n    </div>\r\n\r\n    <div class="tile-controls" title="'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{"name":"title","hash":{}}):s))+'"></div>\r\n\r\n</div>\r\n\r\n<div class="tile-content"></div>\r\n\r\n<div class="tile-footer"></div>\r\n\r\n<div class="visual-data-overlay-clip">\r\n    <div class="visual-data-overlay">\r\n        <div class="visual-data-overlay-content binf-modal-dialog">\r\n        <form class="csui-inlineform-group visual-data-settings-form">\r\n            <div class="binf-modal-content">\r\n                <div class="binf-modal-body">\r\n                    <div class="visual-data-controls-parent"></div>\r\n                </div>\r\n            </div>\r\n        </form>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n'+(null!=(n=t.if.call(e,null!=e?e.filterable:e,{"name":"if","hash":{},"fn":this.program(6,a,0),"inverse":this.noop}))?n:"")}});return i.registerPartial("webreports_widgets_visual.data.filtered.count_impl_controls_visualdata_impl_visual.data.tile",a),a}),csui.define("css!webreports/style/webreports",[],function(){}),csui.define("webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/controls/tile/tile.view","csui/utils/contexts/factories/connector","csui/utils/url","csui/utils/base","csui/dialogs/modal.alert/modal.alert","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.expanding.behavior","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.content.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.overlay.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.expanded.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.bar.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.pie.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.donut.view","i18n!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/nls/visual.data.lang","hbs!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data.tile","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data","css!webreports/style/webreports.css"],function(e,t,i,a,n,s,l,r,o,c,u,d,p,h,f,m,v,g){return n.extend({"contentView":u,"ui":{"overlayClip":".visual-data-overlay-clip","toggleSettings":".visual-data-btn-settings span","overlay":".visual-data-overlay"},"constructor":function(e){e.data&&e.data.contentView&&(this.contentView=e.data.contentView),this.contentViewOptions=e,e.context&&(this.connector=e.context.getObject(s,e)),n.prototype.constructor.apply(this,arguments)},"behaviors":function(){var t={},i=this.options.data.launchButtonConfig;return this.launchable=this.options.data.expandable&&i&&i.launchButtons&&i.launchButtons.length>0,this.options.data.expandable&&(t.Expanding={"behaviorClass":c,"titleBarIcon":function(){return this.options.data.titleBarIcon},"dialogTitle":function(){return r.getClosestLocalizedString(this.options.data.title,v.dialogTitle)},"dialogTitleIconRight":"icon-tileCollapse","dialogClassName":"webreports-visual-data","expandedView":function(){return p},"expandedViewOptions":function(){var t,a=this.options;switch(this.options.data.type){case"bar":t=h;break;case"pie":t=f;break;case"donut":t=m;break;default:return!1}return this.launchable&&(this.rowLimit=i.rowLimit,a.data.buttons=e.map(i.launchButtons,e.bind(function(t){return{"label":r.getClosestLocalizedString(t.launchButtonLabel,v.launchReport),"toolTip":r.getClosestLocalizedString(t.launchButtonTooltip,v.launchReportTooltip),"click":e.bind(function(){this.checkRowLimit(this.contentView.collection.getTotalCount(),this.rowLimit)?this._launchReport(t.launchButtonID):o.showError(v.tooManyRows+this.rowLimit)},this)}},this))),a.data.isExpanded=!0,a.data.expandedContentView=new t(this.contentView.options),a}}),t},"regions":function(){return e.extend({"visualizationControls":".visual-data-controls-parent"},n.prototype.regions)},"events":{"click @ui.toggleSettings":"toggleSettings","keyup @ui.toggleSettings":"toggleSettings"},"checkRowLimit":function(e,t){var i;return i=t?t<=5e4?t:5e4:5e3,this.rowLimit=i,e<=i},"toggleSettings":function(e){if(e.preventDefault(),"click"===e.type||"keyup"===e.type&&(13===e.keyCode||32===e.keyCode))if(this.overlayVisible)t(".visual-data-overlay",this.$el).removeClass("visible"),this.overlayVisible=!1;else{var i=new d({"overlayModel":this.contentView.collection.overlayModel});this.getRegion("visualizationControls").show(i),t(".visual-data-overlay",this.$el).addClass("visible"),this.overlayVisible=!0}},"template":g,"templateHelpers":function(){var t={"title":r.getClosestLocalizedString(this.options.data.title,v.dialogTitle),"icon":this.options.data.titleBarIcon||"title-webreports","activeColumn":this.options.data.activeColumn||"","filterable":this.options.data.filterable,"settings":v.settings};return!0===this.options.data.header&&e.extend(t,{"header":this.options.data.header}),t},"_launchReport":function(i){var a,n=new l(this.connector.connection.url).getCgiScript(),s=t("<form></form>"),r=this.contentView.collection.getFilteredCountParms(),o={"func":"ll","objAction":"RunReport","objId":i,"nexturl":location.href},c=e.extend(o,r);c.total_count=this.contentView.collection.getTotalCount(),s.attr("method","POST").attr("action",n).attr("target","_blank").attr("id","launch-webreport-form"),e.each(e.keys(c),function(e){a=t("<input>").attr("type","hidden").attr("name",e).val(c[e]),s.append(a)}),t(".binf-modal-footer").append(s),s.submit(),t("#launch-webreport-form").remove()}})}),csui.define("webreports/widgets/visual.data.filtered.count/visual.data.filtered.count.view",["csui/lib/underscore","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visual.data.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.donut.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.bar.view","webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/visualizations/visual.data.pie.view","css!webreports/widgets/visual.data.filtered.count/impl/controls/visualdata/impl/visual.data"],function(e,t,i,a,n){return t.extend({"constructor":function(i){i.data.titleBarIcon=e.has(i.data,"titleBarIcon")?"title-icon "+i.data.titleBarIcon:"title-icon title-webreports",this.contentView=this._getContentView(i),this.contentViewOptions=i,t.prototype.constructor.apply(this,arguments)},"_getContentView":function(e){var t=a;if(e&&e.data&&e.data.type)switch(e.data.type){case"donut":t=i;break;case"pie":t=n;break;default:t=a}return t}})}),csui.define("json!webreports/widgets/visual.data.filtered.count/visual.data.filtered.count.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{widgetTitle}}","description":"{{widgetDescription}}","kind":"header","supportedKinds":["tile","header"],"schema":{"type":"object","properties":{"title":{"title":"{{tileTitle}}","description":"{{tileDescription}}","type":"object"},"type":{"title":"{{typeTitle}}","description":"{{typeDescription}}","type":"string","enum":["bar","donut","pie"],"default":"bar"},"id":{"title":"{{sourceTitle}}","description":"{{sourceDescription}}","type":"integer"},"activeColumn":{"title":"{{activeTitle}}","description":"{{activeDescription}}","type":"string"},"viewValueAsPercentage":{"title":"{{percentTitle}}","description":"{{percentDescription}}","type":"boolean","enum":[!0,!1],"default":!1},"groupAfter":{"title":"{{groupTitle}}","type":"integer","description":"{{groupDescription}}","enum":[-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"default":-1},"sortBy":{"title":"{{sortTitle}}","description":"{{sortDescription}}","type":"string","enum":["ordinal","Count"],"default":"Count"},"sortOrder":{"title":"{{directionTitle}}","description":"{{directionDescription}}","type":"string","enum":["desc","asc"],"default":"desc"},"filterable":{"title":"{{optionsTitle}}","description":"{{optionsDescription}}","type":"boolean","enum":[!0,!1],"default":!1},"expandable":{"title":"{{expandedTitle}}","description":"{{expandedDescription}}","type":"boolean","enum":[!0,!1],"default":!1},"launchButtonConfig":{"type":"object","title":"{{buttonTitle}}","description":"{{buttonDescription}}","properties":{"rowLimit":{"title":"{{maxTitle}}","description":"{{maxDescription}}","type":"integer"},"launchButtons":{"type":"array","title":"{{customButtonTitle}}","description":"{{customButtonDescription}}","items":{"type":"object","title":"{{addButtonTitle}}","description":"{{addButtonDescription}}","properties":{"launchButtonID":{"title":"{{reportButtonTitle}}","description":"{{reportButtonDescription}}","type":"integer"},"launchButtonLabel":{"title":"{{labelButtonTitle}}","description":"{{labelButtonDescription}}","type":"object"},"launchButtonTooltip":{"title":"{{buttonToolTitle}}","description":"{{buttonToolDescription}}","type":"object"}}}}}},"parameters":{"type":"array","title":"{{paramSourceTitle}}","description":"{{paramSourceDescription}}","items":{"type":"object","title":"{{paramPairTitle}}","description":"{{paramPairDescription}}","properties":{"name":{"type":"string","title":"{{paramNameTitle}}","description":"{{paramNameDescription}}"},"value":{"type":"string","title":"{{paramValueTitle}}","description":"{{paramValueDescription}}"}}}}},"required":["activeColumn","id"]},"options":{"fields":{"id":{"type":"otcs_node_picker","type_control":{"parameters":{"select_types":[30303]}}},"title":{"type":"otcs_multilingual_string"},"launchButtonConfig":{"fields":{"launchButtons":{"items":{"fields":{"launchButtonID":{"type":"otcs_node_picker","type_control":{"parameters":{"select_types":[30303]}}},"launchButtonLabel":{"type":"otcs_multilingual_string"},"launchButtonTooltip":{"type":"otcs_multilingual_string"}}}}}},"type":{"type":"select","optionLabels":["{{optionsTypeBar}}","{{optionsTypeDonut}}","{{optionsTypePie}}"]},"groupAfter":{"type":"select","optionLabels":["{{optionsGroupAfterDefault}}","2","3","4","{{optionsPieDonutDefault}}","6","7","8","9","10","11","12","13","14","{{optionsBarDefault}}","16","17","18","19","20"]},"sortBy":{"type":"select","optionLabels":["{{optionsSortByActive}}","{{optionsSortByCount}}"]},"sortOrder":{"type":"select","optionLabels":["{{optionsSortOrderDsc}}","{{optionsSortOrderAsc}}"]}}}}),csui.define("webreports/widgets/visual.data.filtered.count/impl/nls/visual.data.filtered.count.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("webreports/widgets/visual.data.filtered.count/impl/nls/root/visual.data.filtered.count.manifest",{"widgetTitle":"Visual Count","widgetDescription":"This widget visualizes the total count of values matching given criteria.","tileTitle":"Title","tileDescription":"Enter the title for the widget. This title appears in the Tile header.","typeTitle":"Chart Type","typeDescription":"Select the type of chart appropriate for your data.","sourceTitle":"Source WebReport","sourceDescription":"Browse to select the WebReport that retrieves the data that you want to visualize.","activeTitle":"Active Column","activeDescription":"Enter the name of the data source column that provides the matching values to be counted.","optionsTitle":"Chart Options","optionsDescription":"Choose whether end users have access to chart filtering options in the Tile view.","expandedTitle":"Expanded View","expandedDescription":"Choose whether end users have access to the Expanded view of the chart.","percentTitle":"Values as Percentage","percentDescription":"Choose whether to show the chart values as percentages of the total count or as the actual count.","groupTitle":"Group After","groupDescription":"Select the threshold for the number of discrete values whose total count will appear in the chart. Values above the threshold will be grouped as 'Other' and the combined total will appear. The Chart Default is a threshold value appropriate to the chart type.","sortTitle":"Sort By","sortDescription":"Select whether to sort the chart by the value names in the Active Column or by the count of the values.","directionTitle":"Sort Direction","directionDescription":"Select whether to sort the chart in Ascending or Descending order.","buttonTitle":"Button WebReports","buttonDescription":"Configure the options for Button WebReports launched by Custom Buttons in the Expanded view","maxTitle":"Maximum Items to Process","maxDescription":"Enter the maximum number of data items to pass to the Button WebReport.","customButtonTitle":"Custom Buttons","customButtonDescription":"Set the properties for the Custom Button that appears in the Expanded View, then click the 'Add To Array' button. Repeat as required to add multiple buttons.","addButtonTitle":"Add Custom Buttons","addButtonDescription":"Configure custom buttons that will appear in the Expanded view and which will launch Button Webreports.","reportButtonTitle":"Button WebReport","reportButtonDescription":"Browse to select the WebReport that will open when you click the button.","labelButtonTitle":"Button Label","labelButtonDescription":"Enter a custom label for the button.","buttonToolTitle":"Button Tooltip","buttonToolDescription":"Enter a tool tip for the button.","paramSourceTitle":"Source Parameters","paramSourceDescription":"Specify one or more Key/Value pairs of parameters to pass into the Source WebReport, as required.","paramPairTitle":"Source Parameters","paramPairDescription":"Specify one or more Key/Value pairs of parameters to pass into the Source WebReport, as required.","paramNameTitle":"Parameter Name","paramNameDescription":"The name of the URL parameter.","paramValueTitle":"Parameter Value","paramValueDescription":"The value of the URL parameter.","optionsTypeBar":"Bar","optionsTypeDonut":"Donut","optionsTypePie":"Pie","optionsGroupAfterDefault":"Use Chart Default","optionsPieDonutDefault":"5 - Pie and Donut default",
"optionsBarDefault":"15 - Bar default","optionsSortByActive":"Active Column","optionsSortByCount":"Count","optionsSortOrderDsc":"Descending","optionsSortOrderAsc":"Ascending"}),csui.define("bundles/webreports-visdata",["webreports/widgets/visual.data.filtered.count/visual.data.filtered.count.view","json!webreports/widgets/visual.data.filtered.count/visual.data.filtered.count.manifest.json","i18n!webreports/widgets/visual.data.filtered.count/impl/nls/visual.data.filtered.count.manifest"],{}),csui.require(["require","css"],function(e,t){t.styleLoad(e,"webreports/bundles/webreports-visdata")});
//# sourceMappingURL=webreports-visdata.js.map